/*! (C) 2023 Conviva, Inc. All rights reserved. Confidential and proprietary. */
!function(t,e){"function"==typeof define&&define.amd?define(e):("object"==typeof exports||"object"==typeof module&&module.exports)&&(module.exports=e()),void 0===t||!t||t.Conviva||t.ConvivaLoading||(t.ConvivaLoading=!0,t.Conviva=e(),delete t.ConvivaLoading)}(this,(function(){var t={};return function(){"use strict";var e,n,i,o,a,s,r,l,u,c,h,f,d,E,v,g,p,A,T,C,S,R,y,P,N,m,O,_,I,D,M,L,w,b,U,F,V,k,K,Y,G,H,B,W,x,q,j,X,J,Z,$,Q,z,tt,et,nt,it,ot,at,st,rt,lt,ut={};function ct(){var t,e="";for("-"===n&&s(e="-");n>="0"&&n<="9";)e+=n,s();if("."===n)for(e+=".";s()&&n>="0"&&n<="9";)e+=n;if("e"===n||"E"===n)for(e+=n,s(),"-"!==n&&"+"!==n||(e+=n,s());n>="0"&&n<="9";)e+=n,s();if(t=+e,!isNaN(t))return t;a("Bad number")}function ht(t){return t<10?"0"+t:t}function ft(t){return L.lastIndex=0,L.test(t)?'"'+t.replace(L,(function(t){var e=U[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+t+'"'}c=t.Constants={version:"4.7.2",CUSTOMER_KEY:"customerKey",GATEWAY_URL:"gatewayUrl",LOG_LEVEL:"logLevel",ASSET_NAME:"Conviva.assetName",PLAYER_NAME:"Conviva.applicationName",APPLICATION_VERSION:"c3.app.version",IS_LIVE:"Conviva.streamType",ENCODED_FRAMERATE:"Conviva.encodedFrameRate",DEFAULT_RESOURCE:"Conviva.defaultResource",STREAM_URL:"Conviva.streamUrl",VIEWER_ID:"Conviva.viewerId",DURATION:"Conviva.duration",UTM_TRACKING_URL:"c3.cm.utmTrackingUrl",POD_INDEX:"podIndex",POD_POSITION:"podPosition",POD_DURATION:"podDuration",AD_TYPE:"adType",MODULE_NAME:"Conviva.moduleName",MODULE_VERSION:"Conviva.moduleVersion",FRAMEWORK_NAME:"Conviva.frameworkName",FRAMEWORK_VERSION:"Conviva.frameworkVersion",i:"Constants not yet configured",o:"Invalid : Did you report playback ended?",u:"Invalid : Did you report ad playback ended?",h:"Player cannot be null",l:"PlaybackAnlytics already built",v:"PlaybackAnlytics not yet built",Playback:{BITRATE:"BITRATE",AVG_BITRATE:"AVG_BITRATE",PLAY_HEAD_TIME:"PLAY_HEAD_TIME",RESOLUTION:"RESOLUTION",BUFFER_LENGTH:"BUFFER_LENGTH",PLAYER_STATE:"PLAYER_STATE",RENDERED_FRAMERATE:"RENDERED_FRAMERATE",SEEK_STARTED:"SEEK_STARTED",SEEK_ENDED:"SEEK_ENDED",CDN_IP:"CDN_IP",DROPPED_FRAMES_TOTAL:"DROPPED_FRAMES_TOTAL",DROPPED_FRAMES_COUNT:"DROPPED_FRAMES_COUNT",AUDIO_LANGUAGE:"AUDIO_LANGUAGE",SUBTITLES_LANGUAGE:"SUBTITLES_LANGUAGE",CLOSED_CAPTIONS_LANGUAGE:"CLOSED_CAPTIONS_LANGUAGE"},Network:{SIGNAL_STRENGTH:"SIGNAL_STRENGTH",LINK_ENCRYPTION:"LINK_ENCRYPTION",CONNECTION_TYPE:"CONNECTION_TYPE"},ErrorSeverity:{FATAL:1,WARNING:0},NO_SESSION_KEY:-2,AdPosition:{PREROLL:"Pre-roll",MIDROLL:"Mid-roll",POSTROLL:"Post-roll"},AdPlayer:{CONTENT:"CONTENT",SEPARATE:"SEPARATE"},DeviceType:{DESKTOP:"DESKTOP",CONSOLE:"Console",SETTOP:"Settop",MOBILE:"Mobile",TABLET:"Tablet",SMARTTV:"SmartTV"},AdType:{CLIENT_SIDE:"Client Side",SERVER_SIDE:"Server Side"},AdSlates:{BLACKOUT_SLATE:"Blackout slate",TECHNICAL_DIFFICULTIES_SLATE:"Technical Difficulties slate",COMMERCIAL_SLATE:"Commercial Break slate",OTHER_SLATE:"Other slate",VPAID:"VPAID",REGULAR:"Regular Ad"},AdServingType:{INLINE:"Inline",WRAPPER:"Wrapper"},DeviceCategory:{ANDROID_DEVICE:"AND",APPLE_DEVICE:"APL",CHROMECAST:"CHR",DESKTOP_APP:"DSKAPP",DEVICE_SIMULATOR:"SIMULATOR",LG_TV:"LGTV",NINTENDO:"NINTENDO",PLAYSTATION:"PS",ROKU:"RK",SAMSUNG_TV:"SAMSUNGTV",SMART_TV:"TV",SET_TOP_BOX:"STB",TIVO:"TIVO",WEB:"WEB",WINDOWS_DEVICE:"WIN",XBOX:"XB",KAIOS_DEVICE:"KAIOS"},LogLevel:{DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},PlayerState:{STOPPED:"STOPPED",PLAYING:"PLAYING",BUFFERING:"BUFFERING",PAUSED:"PAUSED",UNKNOWN:"UNKNOWN",NOT_MONITORED:"NOT_MONITORED"},Events:{USER_WAIT_STARTED:"Conviva.UserWaitStarted",USER_WAIT_ENDED:"Conviva.UserWaitEnded",BUMPER_VIDEO_STARTED:"Conviva.BumperVideoStarted",BUMPER_VIDEO_ENDED:"Conviva.BumperVideoEnded",AD_REQUESTED:"Conviva.AdRequested",AD_RESPONSE:"Conviva.AdResponse",AD_SLOT_STARTED:"Conviva.SlotStarted",AD_ATTEMPTED:"Conviva.AdAttempted",AD_SLOT_ENDED:"Conviva.SlotEnded",AD_IMPRESSION_START:"Conviva.AdImpression",AD_START:"Conviva.AdStart",AD_FIRST_QUARTILE:"Conviva.AdFirstQuartile",AD_MID_QUARTILE:"Conviva.AdMidQuartile",AD_THIRD_QUARTILE:"Conviva.AdThirdQuartile",AD_COMPLETE:"Conviva.AdComplete",AD_END:"Conviva.AdEnd",AD_IMPRESSION_END:"Conviva.AdImpressionEnd",AD_SKIPPED:"Conviva.AdSkipped",AD_ERROR:"Conviva.AdError",AD_PROGRESS:"Conviva.AdProgress",AD_CLOSE:"Conviva.AdClose",CONTENT_PAUSED:"Conviva.PauseContent",CONTENT_RESUMED:"Conviva.ResumeContent",POD_START:"Conviva.PodStart",POD_END:"Conviva.PodEnd"},ErrorType:{ERROR_UNKNOWN:"ERROR_UNKNOWN",ERROR_IO:"ERROR_IO",ERROR_TIMEOUT:"ERROR_TIMEOUT",ERROR_NULL_ASSET:"ERROR_NULL_ASSET",ERROR_MISSING_PARAMETER:"ERROR_MISSING_PARAMETER",ERROR_NO_AD_AVAILABLE:"ERROR_NO_AD_AVAILABLE",ERROR_PARSE:"ERROR_PARSE",ERROR_INVALID_VALUE:"ERROR_INVALID_VALUE",ERROR_INVALID_SLOT:"ERROR_INVALID_SLOT",ERROR_3P_COMPONENT:"ERROR_3P_COMPONENT",ERROR_UNSUPPORTED_3P_FEATURE:"ERROR_UNSUPPORTED_3P_FEATURE",ERROR_DEVICE_LIMIT:"ERROR_DEVICE_LIMIT",ERROR_UNMATCHED_SLOT_SIZE:"ERROR_UNMATCHED_SLOT_SIZE"},StreamType:{UNKNOWN:"UNKNOWN",LIVE:"LIVE",VOD:"VOD"},CallbackFunctions:{CONSOLE_LOG:"consoleLog",MAKE_REQUEST:"makeRequest",SAVE_DATA:"saveData",LOAD_DATA:"loadData",GET_EPOCH_TIME_IN_MS:"getEpochTimeInMs",CREATE_TIMER:"createTimer",GENERATE_HASH:"generateHash",BASE64_ENCODE:"base64Encode"},DeviceMetadata:{BRAND:"DeviceBrand",MANUFACTURER:"DeviceManufacturer",MODEL:"DeviceModel",TYPE:"DeviceType",VERSION:"DeviceVersion",OS_NAME:"OperatingSystemName",OS_VERSION:"OperatingSystemVersion",CATEGORY:"DeviceCategory",SCREEN_RESOLUTION_WIDTH:"ScreenWidth",SCREEN_RESOLUTION_HEIGHT:"ScreenHeight",SCREEN_RESOLUTION_SCALE_FACTOR:"ScaleFactor"},AD_PRELOAD_FEATURE:"adPreloading",AD_TAG_URL:"adTagUrl",IMASDK_CONTENT_PLAYER:"imaMainContentPlayer",CONVIVA_AD_MODULE:"convivaAdModule",CONVIVA_MODULE:"convivaModule",MEDIA_ELEMENT:"mediaElement",APP_TRACKER_EVENT:{TYPE:"convivaVideoEvent",INIT:"c3.sdk.init",VIDEO_ATTEMPT:"c3.video.attempt",VIDEO_END:"c3.video.end",VIDEO_PLAY:"c3.video.play",VIDEO_PAUSE:"c3.video.pause",VIDEO_BUFFERING:"c3.video.buffering",VIDEO_ERROR:"c3.video.error",SDK_CUSTOM_EVENT:"c3.sdk.custom_event",VIDEO_CUSTOM_EVENT:"c3.video.custom_event",AD_BREAK_START:"c3.ad.ad_break_start",AD_BREAK_END:"c3.ad.ad_break_end",VIDEO_METADATA_CHANGE:"c3.video.set_content_info",VIDEO_BITRATE_SWITCH:"c3.video.bitrate_switch"}},(h=t.Client=function(){var t=this;this._=null,this.R=!1,this.version=h.version,this.p=null,this.A=null,this.T=null,this.S=-1,this.O=null,this.N=null,this.g=null,this.I=null,this.C=-1,this.m=!1,this.D={},this.P=function(){t.p},this.L={},this.M=null,this.U=null,this.V=null,this.k=function(){this.g.F("Client.makeIPV4IPV6GlobalSessions",(function(){var e;t.I&&null!==(e=t.I.get(X.B))&&e!==G.H&&t.A&&((e=new d).custom["c3.IPV4IPV6GlobalSession"]="T",e.custom["c3.domain"]=t.O.G.indexOf(f.j)>-1?f.j:f.K,t.W=t.A.Y(e,null),(e=new d).custom["c3.IPV4IPV6GlobalSession"]="T",e.custom["c3.domain"]=t.O.q.indexOf(f.J)>-1?f.J:f.X,t.Z=t.A.Y(e,null))}))},this.$=function(e){t.g.F("Client.updateConnectionType",(function(){if(t.M=e,t.A){var n,i=t.A.tt();for(n in i)i[n].nt(e)}}))},this.it=function(e){t.g.F("Client.updateLinkEncryption",(function(){if(t.U=e,t.A){var n,i=t.A.tt();for(n in i)i[n].et(e)}}))},this.ot=function(e){t.g.F("Client.updateSignalStrength",(function(){t.V=e}))},function(e,n,i,o){if(!(e instanceof f))throw new Error("clientSettings parameter should be an instance of ClientSettings.");if(!(n instanceof R))throw new Error("systemFactory parameter should be an instance of SystemFactory.");e.gatewayUrl!==f.rt+f.ut&&e.gatewayUrl!==f.ht+f.ut||(this.R=!0),o&&(this.version=o),this.O=e.ct(),this.T=n,this.T.lt("SDK",this.O,this.version),this.g=this.T.dt(this.version),this.g.F("Client.init",(function(){if(t.I=t.T.vt(),t.I.Et(),t.C=t.I.get(X._t),-1!==t.C&&void 0!==t.C&&null!==t.C||(t.C=et.Rt()),t.A=t.T.At(t,t.O,t.I),i)for(var e in i)switch(e){case c.Network.CONNECTION_TYPE:t.$(i[e]);break;case c.Network.LINK_ENCRYPTION:t.it(i[e]);break;case c.Network.SIGNAL_STRENGTH:t.ot(i[e])}t.k()}),(function(t){throw new Error("Client constructor failed: "+t.message)}))}.apply(this,arguments),this.release=function(){this.m||this.g.F("Client.release",(function(){t.p,t.A.Tt(),t.A=null,t.S=-1,t.C=-1,t.g=null,t.O=null,t.N=null,t.T=null,t.m=!0}))},this.createSession=function(e,n,i){var o=h.NO_SESSION_KEY;return this.m||(!e||e instanceof d)&&this.g.F("Client.createSession",(function(){o=t.A.St(e,W.Nt.Ot,n,(i?c:t).version)})),o},this.createAdSession=function(e,n,i,o,a){var s=h.NO_SESSION_KEY;return this.m||(!n||n instanceof d)&&this.g.F("Client.createAdSession",(function(){var r,l;n||(n=new d),Q.gt(e)&&e!==h.NO_SESSION_KEY&&(r=t.A.It(e))&&(l=n.custom[c.APPLICATION_VERSION],r.wt&&r.wt.Ct&&(!n.viewerId&&r.wt.Ct.viewerId&&(n.viewerId=r.wt.Ct.viewerId),!n.applicationName&&r.wt.Ct.applicationName&&(n.applicationName=r.wt.Ct.applicationName),n.streamType===c.StreamType.UNKNOWN&&r.wt.Ct.streamType!==c.StreamType.UNKNOWN&&(n.streamType=r.wt.Ct.streamType),void 0!==l&&l||void 0!==(l=r.wt.Ct.custom[c.APPLICATION_VERSION])&&l&&(n.custom[c.APPLICATION_VERSION]=l)),n.custom["c3.csid"]=Q.yt(r.C)),s=t.A.St(n,W.Nt.Dt,i,(o?c:t).version,a)})),s},this.reportError=function(e,n,i){this.m||!Q.Pt(n)||i!==h.ErrorSeverity.FATAL&&i!==h.ErrorSeverity.WARNING||this.g.F("Client.reportError",(function(){var o=t.A.It(e);o&&o.bt(n,i)}))},this.updateContentMetadata=function(e,n){this.m||n instanceof d&&this.g.F("Client.updateContentMetadata",(function(){var i,o=t.A.It(e);o&&(i=n.ct(),o.Lt(i))}))},this.detachPlayer=function(e){this.m||this.g.F("Client.detachPlayer",(function(){var n=t.A.It(e);n&&n.Mt()}))},this.Ut=function(e){this.m||this.g.F("Client.offFocus",(function(){var n=t.A.It(e);n&&n.Ut()}))},this.attachPlayer=function(e,n){this.m||n instanceof E&&this.g.F("Client.attachPlayer",(function(){var i=t.A.It(e);i&&i.Vt(n)}))},this.kt=function(e){this.m||this.g.F("Client.onFocus",(function(){var n=t.A.It(e);n&&n.kt()}))},this.contentPreload=function(e){this.m||this.g.F("Client.contentPreload",(function(){var n=t.A.It(e);n&&n.Ft()}))},this.contentStart=function(e){this.m||this.g.F("Client.contentStart",(function(){var n=t.A.It(e);n&&n.Bt()}))},this.sendCustomEvent=function(e,n,i){this.m||Q.Pt(n)&&(Q.Ht(i),this.g.F("Client.sendCustomEvent",(function(){e===h.NO_SESSION_KEY&&(t.S<0&&(o=new d,t.S=t.A.Y(o,null)),e=t.S);var o=Q.Gt(i),a=t.A.jt(e);a&&a.Kt(n,o)})))},this.adStart=function(e,n,i,o){this.m||n!==h.AdStream.CONTENT&&n!==h.AdStream.SEPARATE||i!==h.AdPlayer.CONTENT&&i!==h.AdPlayer.SEPARATE||(o!==h.AdPosition.PREROLL&&o!==h.AdPosition.MIDROLL&&h.AdPosition.POSTROLL,this.g.F("Client.adStart",(function(){var a=t.A.It(e);a&&a.Wt(n,i,o)})))},this.adEnd=function(e){this.m||this.g.F("Client.adEnd",(function(){var n=t.A.It(e);n&&n.Yt()}))},this.cleanupSession=function(e){this.m||e!==h.NO_SESSION_KEY&&this.g.F("Client.cleanupSession",(function(){t.A.It(e)&&t.A.xt(e)}))},this.getAttachedPlayer=function(e){var n=null;return this.m||e!==h.NO_SESSION_KEY&&this.g.F("Client.getAttachedPlayer",(function(){var i=t.A.It(e);i&&(n=i.qt())})),n},this.isPlayerAttached=function(t){return!this.m&&null!==this.getAttachedPlayer(t)},this.getPlayerStateManager=function(e){if(this.m)throw new Error("This instance of Conviva.Client has been released.");return new E(this.T,(e?c:t).version)},this.releasePlayerStateManager=function(t){if(this.m)throw new Error("This instance of Conviva.Client has been released.");this.g.F("Client.releasePlayerStateManager",(function(){t instanceof E&&t.release()}))},this.Jt=function(){return this.O},this.getId=function(){return this.C},this.getSessionId=function(e){var n;return this.m?c.NO_SESSION_KEY:(n=null,this.g.F("Client.getSessionId",(function(){var i=t.A.It(e);i&&(n=i.Xt())})),n)},this.getClientId=function(e){var n;return this.m?null:(n=null,this.g.F("Client.getClientId",(function(){var i=t.A.It(e);i&&(n=i.Qt())})),n)},this.Zt=function(e,n,i){this.m||this.g.F("Client.updateCustomMetric",(function(){var o=t.A.It(e);o&&o.Zt(n,i)}))},this.setUniqueIdentifier=function(t,e){if(this.m)throw new Error("This instance of Conviva.Client has been released.");if(!t||void 0===t||"{}"===JSON.stringify(t))throw new Error("Identifiers are not set. No action taken !!");for(var n in t)this.D[n]=t[n];e&&(this.P=e)},this.setUserPreferenceForDataCollection=function(t,e){if(this.m)throw new Error("This instance of Conviva.Client has been released.");if(!t||void 0===t||"{}"===JSON.stringify(t))throw new Error("Identifiers are not set. No action taken !!");for(var n in t)"false"===t[n]?this.L[n]=e?X.$t.zt:X.$t.tn:this.L[n]=X.$t.nn},this.setUserPreferenceForDataDeletion=function(t){if(this.m)throw new Error("This instance of Conviva.Client has been released.");if(!t||void 0===t||"{}"===JSON.stringify(t))throw new Error("Identifiers are not set. No action taken !!");for(var e in t)"true"===t[e]?this.L[e]=X.$t.en:this.L[e]=X.$t.nn},this.getConfig=function(){if(this.m)throw new Error("This instance of Conviva.Client has been released.");return this.I}}).version="4.7.2L",h.NO_SESSION_KEY=c.NO_SESSION_KEY,h.AdPosition={PREROLL:c.AdPosition.PREROLL,MIDROLL:c.AdPosition.MIDROLL,POSTROLL:c.AdPosition.POSTROLL},h.AdStream={CONTENT:c.AdPlayer.CONTENT,SEPARATE:c.AdPlayer.SEPARATE},h.AdPlayer={CONTENT:c.AdPlayer.CONTENT,SEPARATE:c.AdPlayer.SEPARATE},h.ErrorSeverity={FATAL:c.ErrorSeverity.FATAL,WARNING:c.ErrorSeverity.WARNING},h.DeviceType={DESKTOP:c.DeviceType.DESKTOP,CONSOLE:c.DeviceType.CONSOLE,SETTOP:c.DeviceType.SETTOP,MOBILE:c.DeviceType.MOBILE,TABLET:c.DeviceType.TABLET,SMARTTV:c.DeviceType.SMARTTV},h.AdTechnology={CLIENT_SIDE:c.AdType.CLIENT_SIDE,SERVER_SIDE:c.AdType.SERVER_SIDE},h.AdType={BLACKOUT_SLATE:c.AdSlates.BLACKOUT_SLATE,TECHNICAL_DIFFICULTIES_SLATE:c.AdSlates.TECHNICAL_DIFFICULTIES_SLATE,COMMERCIAL_SLATE:c.AdSlates.COMMERCIAL_SLATE,OTHER_SLATE:c.AdSlates.OTHER_SLATE,VPAID:c.AdSlates.VPAID,REGULAR:c.AdSlates.REGULAR},h.AdServingType={INLINE:c.AdServingType.INLINE,WRAPPER:c.AdServingType.WRAPPER},h.DeviceCategory={ANDROID_DEVICE:c.DeviceCategory.ANDROID_DEVICE,APPLE_DEVICE:c.DeviceCategory.APPLE_DEVICE,CHROMECAST:c.DeviceCategory.CHROMECAST,DESKTOP_APP:c.DeviceCategory.DESKTOP_APP,DEVICE_SIMULATOR:c.DeviceCategory.DEVICE_SIMULATOR,LG_TV:c.DeviceCategory.LG_TV,NINTENDO:c.DeviceCategory.NINTENDO,PLAYSTATION:c.DeviceCategory.PLAYSTATION,ROKU:c.DeviceCategory.ROKU,SAMSUNG_TV:c.DeviceCategory.SAMSUNG_TV,SMART_TV:c.DeviceCategory.SMART_TV,SET_TOP_BOX:c.DeviceCategory.SET_TOP_BOX,TIVO:c.DeviceCategory.TIVO,WEB:c.DeviceCategory.WEB,WINDOWS_DEVICE:c.DeviceCategory.WINDOWS_DEVICE,XBOX:c.DeviceCategory.XBOX,KAIOS_DEVICE:c.DeviceCategory.KAIOS_DEVICE},(f=t.ClientSettings=function(){var t=this;this.on=null,Q.rn(this,"customerKey",(function(){return this.on})),Q.un(this,"customerKey",(function(t){Q.Pt(t)&&(this.on=t)})),this.hn=f.fn,Q.rn(this,"heartbeatInterval",(function(){return this.hn})),Q.un(this,"heartbeatInterval",(function(t){var e;"number"==typeof t&&(e=Q.cn(t))===t&&(this.hn=e)})),this.ln=null,this.G=null,this.q=null,Q.rn(this,"gatewayUrl",(function(){return this.ln})),Q.un(this,"gatewayUrl",(function(t){var e;!Q.Pt(t)||"https"!==(e=t.split("://"))[0]&&"http"!==e[0]||-1===t.indexOf(".com",t.length-4)||(this.ln=t)})),function(t){if(!Q.Pt(t))throw new Error("customerKey must be valid");this.customerKey=t}.apply(this,arguments),this.equals=function(t){return this.customerKey===t.customerKey&&this.gatewayUrl===t.gatewayUrl&&this.heartbeatInterval===t.heartbeatInterval},this.ct=function(){var e=new f(this.customerKey);return e.gatewayUrl=function(e){if(Q.Pt(e)){var n,i=e.split("://");if("https"===i[0]||"http"===i[0])return i[1]!==f.ut&&-1!==i[1].indexOf(f.ut)?(n=i[1].split(f.ut),t.G="https://"+n[0]+f.j,t.q="https://"+n[0]+f.J):i[1]!==f.dn&&-1!==i[1].indexOf("testonly.conviva.com")?(n=i[1].split("testonly.conviva.com"),t.G="https://"+n[0]+f.K,t.q="https://"+n[0]+f.X):i[1]===f.dn?(t.G="https://"+t.customerKey+"."+f.K,t.q="https://"+t.customerKey+"."+f.X):(t.G="https://"+t.customerKey+"."+f.j,t.q="https://"+t.customerKey+"."+f.J,e="https://"+t.customerKey+"."+f.ut),e}return t.G="https://"+t.customerKey+"."+f.j,t.q="https://"+t.customerKey+"."+f.J,"https://"+t.customerKey+"."+f.ut}(this.gatewayUrl),e.heartbeatInterval=this.heartbeatInterval,e.G=this.G,e.q=this.q,e}}).sn="https://conviva.testonly.conviva.com",f.vn="https://cws.conviva.com",f.ut="cws.conviva.com",f.j="ipv4.cws.conviva.com",f.J="ipv6.cws.conviva.com",f.dn="conviva.testonly.conviva.com",f.K="ipv4.testonly.conviva.com",f.X="ipv6.testonly.conviva.com",f.rt="https://",f.ht="http://",f.En=5,f.fn=20,(d=t.ContentMetadata=function(){this._n=null,Q.rn(this,"assetName",(function(){return this._n})),Q.un(this,"assetName",(function(t){"string"==typeof t&&(this._n=t)})),this.Rn={},Q.rn(this,"custom",(function(){return this.Rn})),Q.un(this,"custom",(function(t){"object"==typeof t&&(this.Rn=Q.Gt(t))})),this.An=null,Q.rn(this,"defaultResource",(function(){return this.An})),Q.un(this,"defaultResource",(function(t){"string"==typeof t&&(this.An=t)})),this.Tn=null,Q.rn(this,"viewerId",(function(){return this.Tn})),Q.un(this,"viewerId",(function(t){"string"==typeof t&&(this.Tn=t)})),this.Sn=null,Q.rn(this,"applicationName",(function(){return this.Sn})),Q.un(this,"applicationName",(function(t){"string"==typeof t&&(this.Sn=t)})),this.On=null,Q.rn(this,"streamUrl",(function(){return this.On})),Q.un(this,"streamUrl",(function(t){"string"==typeof t&&(this.On=t)})),this.Nn=d.StreamType.UNKNOWN,Q.rn(this,"streamType",(function(){return this.Nn})),Q.un(this,"streamType",(function(t){t!==d.StreamType.UNKNOWN&&t!==d.StreamType.VOD&&t!==d.StreamType.LIVE||(this.Nn=t)})),this.gn=-1,Q.rn(this,"duration",(function(){return this.gn})),Q.un(this,"duration",(function(t){this.gn=nt.In(t)})),this.wn=-1,Q.rn(this,"encodedFrameRate",(function(){return this.wn})),Q.un(this,"encodedFrameRate",(function(t){this.wn=nt.In(t)})),function(){}.apply(this,arguments),this.ct=function(){var t,e=new d;for(t in e.assetName=this.assetName,e.applicationName=this.applicationName,e.streamUrl=this.streamUrl,e.viewerId=this.viewerId,e.defaultResource=this.defaultResource,e.streamType=this.streamType,e.duration=this.duration,e.encodedFrameRate=this.encodedFrameRate,this.custom)e.custom[t]=this.custom[t];return e}}).StreamType={UNKNOWN:c.StreamType.UNKNOWN,LIVE:c.StreamType.LIVE,VOD:c.StreamType.VOD},t.ErrorType={ERROR_UNKNOWN:c.ErrorType.ERROR_UNKNOWN,ERROR_IO:c.ErrorType.ERROR_IO,ERROR_TIMEOUT:c.ErrorType.ERROR_TIMEOUT,ERROR_NULL_ASSET:c.ErrorType.ERROR_NULL_ASSET,ERROR_MISSING_PARAMETER:c.ErrorType.ERROR_MISSING_PARAMETER,ERROR_NO_AD_AVAILABLE:c.ErrorType.ERROR_NO_AD_AVAILABLE,ERROR_PARSE:c.ErrorType.ERROR_PARSE,ERROR_INVALID_VALUE:c.ErrorType.ERROR_INVALID_VALUE,ERROR_INVALID_SLOT:c.ErrorType.ERROR_INVALID_SLOT,ERROR_3P_COMPONENT:c.ErrorType.ERROR_3P_COMPONENT,ERROR_UNSUPPORTED_3P_FEATURE:c.ErrorType.ERROR_UNSUPPORTED_3P_FEATURE,ERROR_DEVICE_LIMIT:c.ErrorType.ERROR_DEVICE_LIMIT,ERROR_UNMATCHED_SLOT_SIZE:c.ErrorType.ERROR_UNMATCHED_SLOT_SIZE},t.Events={AD_REQUESTED:c.Events.AD_REQUESTED,AD_RESPONSE:c.Events.AD_RESPONSE,AD_SLOT_STARTED:c.Events.AD_SLOT_STARTED,AD_ATTEMPTED:c.Events.AD_ATTEMPTED,AD_SLOT_ENDED:c.Events.AD_SLOT_ENDED,AD_IMPRESSION_START:c.Events.AD_IMPRESSION_START,AD_START:c.Events.AD_START,AD_FIRST_QUARTILE:c.Events.AD_FIRST_QUARTILE,AD_MID_QUARTILE:c.Events.AD_MID_QUARTILE,AD_THIRD_QUARTILE:c.Events.AD_THIRD_QUARTILE,AD_COMPLETE:c.Events.AD_COMPLETE,AD_END:c.Events.AD_END,AD_IMPRESSION_END:c.Events.AD_IMPRESSION_END,AD_SKIPPED:c.Events.AD_SKIPPED,AD_ERROR:c.Events.AD_ERROR,AD_PROGRESS:c.Events.AD_PROGRESS,AD_CLOSE:c.Events.AD_CLOSE,CONTENT_PAUSED:c.Events.CONTENT_PAUSED,CONTENT_RESUMED:c.Events.CONTENT_RESUMED,POD_START:c.Events.POD_START,POD_END:c.Events.POD_END},(E=t.PlayerStateManager=function(){var e=this;e.Cn=null,e.yn=-2,e.Dn=-2,e.Pn=E.PlayerState.UNKNOWN,e.bn={},e.Ln=-2,e.wn=-2,e.gn=-2,e.Mn=null,e.Un=null,e.On=null,e.Vn=null,e.kn=null,e.Fn=-1,e.Bn=-1,e.M=null,e.U=null,e.Hn=null,e.Gn=[],e.m=!1,e.jn=null,e.Kn=null,e.Wn=null,this.release=function(){e.m||e.g.F("PlayerStateManager.release",(function(){e.Cn&&e.Cn.Yn(),e.xn(),e.T=null,e.g=null,e.m=!0}))},this.setPlayheadTime=function(){},this.setBufferLength=function(){},this.setRenderedFrameRate=function(){},this.getEncodedFrameRate=function(){return e.wn},this.setEncodedFrameRate=function(t){e.m||e.g.F("PlayerStateManager.setEncodedFrameRate",(function(){var n=nt.In(t);n>=-1&&(e.wn=n,e.Cn)&&e.Cn.qn(e.wn)}))},this.getDuration=function(){return e.gn},this.setClientMeasureInterface=function(e){Q.Jn(e,new t.ClientMeasureInterface,"ClientMeasureInterface"),this.Xn=e},this.getPHT=function(){return this.Xn&&"function"==typeof this.Xn.getPHT?this.Xn.getPHT():E.DEFAULT_PHT},this.getBufferLength=function(){return this.Xn&&"function"==typeof this.Xn.getBufferLength?this.Xn.getBufferLength():E.DEFAULT_BUFFER_LENGTH},this.getSignalStrength=function(){return this.Xn&&"function"==typeof this.Xn.getSignalStrength?this.Xn.getSignalStrength():E.DEFAULT_SIGNAL_STRENGTH},this.getRenderedFrameRate=function(){return this.Xn&&"function"==typeof this.Xn.getRenderedFrameRate?this.Xn.getRenderedFrameRate():E.DEFAULT_RENDERED_FRAME_RATE},this.setDuration=function(t){e.m||e.g.F("PlayerStateManager.setDuration",(function(){var n=nt.In(t);n>=-1&&(e.gn=n,e.Cn)&&e.Cn.Qn(e.gn)}))},this.getStreamUrl=function(){return e.On},this.setStreamUrl=function(t){e.m||e.g.F("PlayerStateManager.setStreamUrl",(function(){t&&(e.On=t,e.Cn)&&e.Cn.Zn(e.On)}))},this.zn=function(){return e.Vn},this.$n=function(){return e.kn},this.setModuleNameAndVersion=function(t,n){e.Vn=t,e.kn=n},this.ti=function(){return e.Un},this.setPlayerType=function(t){e.m||e.g.F("PlayerStateManager.setPlayerType",(function(){e.Un=t,e.Cn&&e.Cn.ni(e.Un)}))},this.ii=function(){return e.Mn},this.setPlayerVersion=function(t){e.m||e.g.F("PlayerStateManager.setPlayerVersion",(function(){e.Mn=t,e.Cn&&e.Cn.ei(e.Mn)}))},this.si=function(){return e.jn},this.setAudioLang=function(t){e.m||e.g.F("PlayerStateManager.setAudioLang",(function(){e.jn=t,e.Cn&&e.Cn.oi(e.jn)}))},this.ri=function(){return e.Kn},this.setSubtitleLang=function(t){e.m||e.g.F("PlayerStateManager.setSubtitleLang",(function(){e.Kn=t,e.Cn&&e.Cn.ui(e.Kn)}))},this.hi=function(){return e.Wn},this.setCcLang=function(t){e.m||e.g.F("PlayerStateManager.setCCLang",(function(){e.Wn=t,e.Cn&&e.Cn.ai(e.Wn)}))},this.setMonitoringNotifier=function(t){return!e.m&&!e.Cn&&(e.Cn=t,e.p,!0)},this.xn=function(){e.m||(e.Cn=null,e.p)},this.fi=function(){e.setPlayerState(e.getPlayerState()),e.setBitrateKbps(e.ci()),e.setAvgBitrateKbps(e.li()),e.setDuration(e.getDuration()),e.setEncodedFrameRate(e.getEncodedFrameRate()),e.setStreamUrl(e.getStreamUrl()),e.setPlayerType(e.ti()),e.setPlayerVersion(e.ii()),e.setAudioLang(e.si()),e.setSubtitleLang(e.ri()),e.setCcLang(e.hi());for(var t=0;t<e.Gn.length;t++){var n=e.Gn[t];e.di(n)}e.Gn=[]},this.getPlayerState=function(){return e.Pn},this.setPlayerState=function(t){e.m||e.g.F("PlayerStateManager.setPlayerState",(function(){E.vi(t)&&(e.Pn=t,e.Cn)&&e.Cn.Ei(e.Pn)}))},this.ci=function(){return e.yn},this.setBitrateKbps=function(t){e.m||e.g.F("PlayerStateManager.setBitrateKbps",(function(){var n=nt.In(t);n>=-1&&(e.yn=n,e.Cn)&&e.Cn._i(e.yn)}))},this.li=function(){return e.Dn},this.setAvgBitrateKbps=function(t){e.m||e.g.F("PlayerStateManager.setAvgBitrateKbps",(function(){var n=nt.In(t);n>=-1&&(e.Dn=n,e.Cn)&&e.Cn.Ri(e.Dn)}))},this.setPlayerSeekStart=function(t){e.m||e.g.F("PlayerStateManager.setPlayerSeekStart()",(function(){e.Cn&&e.Cn.pi(E.SEEK_ACTIONS_TYPE.SEEK_START,t)}))},this.setPlayerSeekEnd=function(){e.m||e.g.F("PlayerStateManager.setPlayerSeekEnd()",(function(){e.Cn&&e.Cn.pi(E.SEEK_ACTIONS_TYPE.SEEK_END,-1)}))},this.setUserSeekButtonUp=function(){e.m||e.g.F("PlayerStateManager.setUserSeekButtonUp()",(function(){e.Cn&&e.Cn.pi(E.SEEK_ACTIONS_TYPE.BUTTON_UP,-1)}))},this.setUserSeekButtonDown=function(){e.m||e.g.F("PlayerStateManager.setUserSeekButtonDown()",(function(){e.Cn&&e.Cn.pi(E.SEEK_ACTIONS_TYPE.BUTTON_DOWN,-1)}))},this.setVideoResolutionWidth=function(t){e.m||e.g.F("PlayerStateManager.setVideoResolutionWidth()",(function(){var n=nt.In(t);n>0&&(e.Fn=n),e.Cn&&e.Cn.Ai(e.Fn)}))},this.setVideoResolutionHeight=function(t){e.m||e.g.F("PlayerStateManager.setVideoResolutionHeight()",(function(){var n=nt.In(t);n>0&&(e.Bn=n),e.Cn&&e.Cn.Ti(e.Bn)}))},this.setConnectionType=function(t){e.m||e.g.F("PlayerStateManager.setConnectionType()",(function(){e.M=t,e.Cn&&e.Cn.nt(e.M)}))},this.setLinkEncryption=function(t){e.m||e.g.F("PlayerStateManager.setLinkEncryption()",(function(){e.U=t,e.Cn&&e.Cn.et(e.U)}))},this.setSignalStrength=function(){},this.di=function(t){var n,i;e.Hn=t,e.Cn?(n=t.errorCode,i=t.severity,e.Cn.Si(n,i)):e.Gn.push(t)},this.sendError=function(t,n){e.m||e.g.F("PlayerStateManager.sendError",(function(){var i=new it(t,n);e.di(i)}))},this.reset=function(){e.m||e.g.F("PlayerStateManager.reset",(function(){e.yn=-2,e.Dn=-2,e.Pn=E.PlayerState.UNKNOWN,e.bn={},e.Ln=-1,e.wn=-1,e.gn=-1,e.Mn=null,e.Un=null,e.On=null,e.Hn=null,e.Gn=[]}))},this.setCDNServerIP=function(t){e.m||e.g.F("PlayerStateManager.setCDNServerIP",(function(){e.Cn&&e.Cn.Oi(t)}))},this.Ni=function(){return e.gi},this.setDroppedFramesTotal=function(t){e.m||e.g.F("PlayerStateManager.setDroppedFramesTotal",(function(){e.Cn&&e.Cn.Ii(t)}))},this.setDroppedFramesCount=function(t){e.m||e.g.F("PlayerStateManager.setDroppedFramesCount",(function(){e.Cn&&e.Cn.wi(t)}))},this.Ci=function(){return e.Hn},function(t,n){e.T=t,e.g=e.T.dt(n)}.apply(e,arguments)}).PlayerState={STOPPED:c.PlayerState.STOPPED,PLAYING:c.PlayerState.PLAYING,BUFFERING:c.PlayerState.BUFFERING,PAUSED:c.PlayerState.PAUSED,UNKNOWN:c.PlayerState.UNKNOWN,NOT_MONITORED:c.PlayerState.NOT_MONITORED},E.vi=function(t){return t===E.PlayerState.STOPPED||t===E.PlayerState.PLAYING||t===E.PlayerState.BUFFERING||t===E.PlayerState.PAUSED||t===E.PlayerState.UNKNOWN||t===E.PlayerState.NOT_MONITORED},E.SEEK_ACTIONS_TYPE={SEEK_START:"pss",SEEK_END:"pse",BUTTON_UP:"bu",BUTTON_DOWN:"bd"},E.DEFAULT_SIGNAL_STRENGTH=1e3,E.DEFAULT_RENDERED_FRAME_RATE=-1,E.DEFAULT_BUFFER_LENGTH=-1,E.DEFAULT_PHT=-1,t.ClientMeasureInterface=function(){this.getPHT=function(){},this.getBufferLength=function(){},this.getSignalStrength=function(){},this.getRenderedFrameRate=function(){}},v=t.HttpInterface=function(){this.makeRequest=function(){},this.release=function(){}},g=t.LoggingInterface=function(){this.consoleLog=function(){},this.release=function(){}},p=t.MetadataInterface=function(){this.getBrowserName=function(){},this.getBrowserVersion=function(){},this.getDeviceBrand=function(){},this.getDeviceManufacturer=function(){},this.getDeviceModel=function(){},this.getDeviceType=function(){},this.getDeviceVersion=function(){},this.getFrameworkName=function(){},this.getFrameworkVersion=function(){},this.getOperatingSystemName=function(){},this.getOperatingSystemVersion=function(){},this.getDeviceCategory=function(){},this.getScreenWidth=function(){},this.getScreenHeight=function(){},this.getScaleFactor=function(){},this.release=function(){}},A=t.StorageInterface=function(){this.saveData=function(){},this.loadData=function(){},this.release=function(){}},T=t.SystemInterface=function(){(function(t,e,n,i,o,a){Q.Jn(t,new C,"TimeInterface"),Q.Jn(e,new S,"TimerInterface"),Q.Jn(n,new v,"HttpInterface"),Q.Jn(i,new A,"StorageInterface"),Q.Jn(o,new p,"MetadataInterface"),Q.Jn(a,new g,"LoggingInterface"),this.yi=t,this.mi=e,this.Di=n,this.Pi=i,this.bi=o,this.Li=a}).apply(this,arguments),this.release=function(){this.yi&&(this.yi.release(),this.yi=null),this.mi&&(this.mi.release(),this.mi=null),this.Di&&(this.Di.release(),this.Di=null),this.Pi&&(this.Pi.release(),this.Pi=null),this.bi&&(this.bi.release(),this.bi=null),this.Li&&(this.Li.release(),this.Li=null)}},C=t.TimeInterface=function(){this.getEpochTimeMs=function(){},this.release=function(){}},S=t.TimerInterface=function(){this.createTimer=function(){},this.release=function(){}},R=t.SystemFactory=function(){var t=this;(function(t,e){if(!(t instanceof T))throw new Error("systemInterface parameter should be an instance of SystemInterface.");this.Mi=t,this.yi=this.Mi.yi,this.mi=this.Mi.mi,this.Di=this.Mi.Di,this.Pi=this.Mi.Pi,this.bi=this.Mi.bi,this.Li=this.Mi.Li,this.O=e instanceof y?e.ct():new y}).apply(this,arguments),this.lt=function(t,e,n){this.Ui=t,this.Vi=e,this.ki=n},this.release=function(){this.Mi.release(),this.Mi=null,this.Ui=null,this.O=null,this.Fi=null};this.buildLogger=function(){return new at(t.Li,t.yi,t.Jt(),t.Fi,t.Ui)},this.At=function(t,e,n){return new q(t,e,n,this)},this.Bi=function(t){return new tt(this.buildLogger(),this.Hi(),this.Vi,t)},this.Gi=function(){return new j(this.buildTimer(t.ki))},this.ji=function(){var t=new lt(this.buildLogger(),this.mi,new Z(this.buildLogger(),null,this.Jt()));return new j(t)},this.Hi=function(){return new ot(this.buildLogger(),this.Di,this.ji(),this.Jt())},this.dt=function(t){return new Z(this.buildLogger(),this.Bi(t),this.Jt())},this.buildTime=function(){return new rt(this.yi,this.buildLogger())},this.buildTimer=function(t){return new lt(this.buildLogger(),this.mi,this.dt(t))},this.Ki=function(){return new ut.Storage(this.buildLogger(),this.Pi,this.Gi(),this.Jt())},this.vt=function(){return new X(this.buildLogger(),this.Ki(),this.Wi())},this.Yi=function(t){return new st(this.buildLogger(),this.bi,this.dt(t))},this.xi=function(){return new G},this.qi=function(t,e){return new $(t,this.buildLogger(),this.Hi(),this.Wi(),e)},this.Ji=function(t,e,n,i,o){var a=this.qi(e,i.custom["c3.domain"]);return new W(this.Xi(),t,e,this.buildLogger(),this.dt(o),this.buildTimer(o),a,this.xi(),this.buildTime(),this.Qi(),n,i,o)},this.Zi=function(t,e,n,i,o,a,s){return t=this.Ji(t,e.ct(),n,a,s),new x(i,o,n,this.Yi(s),t,this.dt(s),this.buildLogger())},this.Xi=function(){return new J},this.Wi=function(){return new H},this.Qi=function(){return this.Fi},this.Jt=function(){return this.O},this.Fi=new z},(y=t.SystemSettings=function(){this.zi=y.$i,Q.rn(this,"logLevel",(function(){return this.zi})),Q.un(this,"logLevel",(function(t){var e;"number"==typeof t&&(e=Q.cn(t))===t&&e>=y.LogLevel.DEBUG&&e<=y.LogLevel.ERROR&&(this.zi=e)})),this.te=y.ne,Q.rn(this,"allowUncaughtExceptions",(function(){return this.te})),Q.un(this,"allowUncaughtExceptions",(function(t){Q.ie(t)&&(this.te=t)})),this.ee=y.se,Q.rn(this,"storageTimeout",(function(){return this.ee})),Q.un(this,"storageTimeout",(function(t){var e;"number"==typeof t&&(e=Q.cn(t))===t&&(this.ee=e)})),this.oe=y.re,Q.rn(this,"httpTimeout",(function(){return this.oe})),Q.un(this,"httpTimeout",(function(t){var e;"number"==typeof t&&(e=Q.cn(t))===t&&(this.oe=e)})),function(){}.apply(this,arguments),this.equals=function(t){return this.logLevel===t.logLevel&&this.allowUncaughtExceptions===t.allowUncaughtExceptions&&this.storageTimeout===t.storageTimeout&&this.httpTimeout===t.httpTimeout},this.ct=function(){var t=new y;return t.logLevel=this.logLevel,t.allowUncaughtExceptions=this.allowUncaughtExceptions,t.storageTimeout=this.storageTimeout,t.httpTimeout=this.httpTimeout,t}}).LogLevel={DEBUG:c.LogLevel.DEBUG,INFO:c.LogLevel.INFO,WARNING:c.LogLevel.WARNING,ERROR:c.LogLevel.ERROR,NONE:c.LogLevel.NONE},y.ue=y.LogLevel.DEBUG,y.$i=y.LogLevel.NONE,y.he=!0,y.ne=!1,y.se=10,y.re=10,P=ut.AdAnalytics=function(){var e=this;function n(t){e.ae?(Q.Ht(t)>0&&e.setAdInfo(t),e.ae.fe()||(e.ae.ce(e.le),e.ae.de(!0),e.getAdType()===c.AdType.SERVER_SIDE&&e.reportAdMetric(c.Playback.BITRATE,e.le.ve()))):e.p}e.Ee=null,e.T=null,e._e=null,e.le=null,e.ae=null,e.Re=null,e.pe=null,e.Ae=null,function(t,n,i){e.Ee=t,e.Ae=i,e.T=n,i&&(e.le=i.Te()),e._e=n.buildTimer(c.version),e.ae=new N(e.Ee,e._e),O.call(this)}.apply(this,arguments),this.setAdInfo=function(t){Q.Ht(t)<=0?e.p:(e.p,e.ae&&e.ae.Se(t))},this.setAdPlayerInfo=function(t){Q.Ht(t)<=0?e.p:(e.p,e.ae&&e.ae.Se(t))},this.reportAdMetric=function(){0===arguments.length?e.p:1===arguments.length?e.Oe(arguments[0]):2===arguments.length?e.Oe(arguments[0],arguments[1]):3===arguments.length?e.Oe(arguments[0],arguments[1],arguments[2]):4===arguments.length&&e.Oe(arguments[0],arguments[1],arguments[2],arguments[3])},this.setCallback=function(t){e.ae&&e.ae.Ne(t)},this.reportAdFailed=function(t,n){e.ae?(Q.Ht(n)>0&&e.setAdInfo(n),e.ae.fe()?(e.p,e.reportAdError(t,h.ErrorSeverity.FATAL),e.reportAdEnded()):(e.ae.ce(e.le),e.p,n=new it(t,h.ErrorSeverity.FATAL),e.ae.de(!0,n))):e.p},this.reportAdLoaded=function(t){e.p,n(t)},this.reportAdStarted=function(t){e.p,n(t)},this.reportAdEnded=function(){e.ae?(e.p,e.ae.fe()&&(e.ae.ce(null),e.ae.de(!1))):e.p},this.reportAdError=function(t,n){e.ae?(e.p,t=new it(t,n),e.ae.di(t)):e.p},this.reportAdPlayerEvent=function(t,n){if(Q.Pt(t))if(e.p,e.ae)switch(t){case c.Events.USER_WAIT_STARTED:case c.Events.BUMPER_VIDEO_STARTED:e.ae.Mt();break;case c.Events.USER_WAIT_ENDED:case c.Events.BUMPER_VIDEO_ENDED:e.ae.Vt();break;default:e.ae.ge(t,n)}else e.p;else e.p},this.reportAdSkipped=function(){e.ae?(e.p,e.reportAdPlayerEvent(c.Events.AD_SKIPPED),e.reportAdEnded()):e.p},this.release=function(){e.p,e.ae&&(e.ae.fe()&&(e.ae.ce(null),e.ae.de(!1)),e.ae.Ne(null),e.ae.Ie(),e.ae=null),void 0!==t.AdProxyMonitor&&e.pe&&(t.AdProxyMonitor.release(e.pe),e.pe=null)},this.setAdListener=function(n,i){n&&(void 0!==i&&void 0!==i.convivaModule?t.AdProxyMonitor=i.convivaModule.AdProxyMonitor:"undefined"!=typeof ConvivaModule&&(t.AdProxyMonitor=ConvivaModule.AdProxyMonitor),void 0!==t.AdProxyMonitor)&&(!n&&e.pe?(t.AdProxyMonitor.release(e.pe),e.pe=null):n&&e.pe?(t.AdProxyMonitor.release(e.pe),e.p,e.pe=t.AdProxyMonitor.initConvivaDropIn(n,i,this,t,e.T)):n&&!e.pe&&(e.p,e.pe=t.AdProxyMonitor.initConvivaDropIn(n,i,this,t,e.T)))},this.reportAdBreakStarted=function(t,n,i){e.le&&(e.p,e.we=t,e.Re=n,e.le.Ce(t,n,i))},this.reportAdBreakEnded=function(){e.le&&(e.p,e.we=null,e.Re=null,e.le.ye())},this.getSessionId=function(){return e.le?(e.p,e.ae.Xt()):c.NO_SESSION_KEY},this.getClientId=function(){return e.le?(e.p,e.ae.Qt()):null},this.getPlayerMonitor=function(){return e.le},this.getAdPlayerMonitor=function(){return e.ae},this.getVideoAnalytics=function(){return e.Ae},this.getAdType=function(){return e.le?e.le.we:null},this.me=function(){return e.le?e.le.Re:null},P.prototype=Object.create(O.prototype),P.prototype.constructor=P},N=ut.AdPlayerMonitorImpl=function(){var t=this;t.De=null,t.Pe=null,function(t,e){D.call(this,t,e)}.apply(this,arguments),this.ce=function(e){this.be()!==e&&(this.Le(),t.Pe=e||null)},this.be=function(){return t.Pe},this.Me=function(e){var n,i=this.be(),o={};o.error=e,t.De&&(t.Ue=t.De.getPlayerStateManager(!0),t.Ve(),t.Ue.setClientMeasureInterface(this),n=null,i&&(n=i.ke()),t.Fe=t.De.createAdSession(n,t.Ct,t.Ue,!0,o),void 0!==e)&&(t.Be(),t.Ie())},N.prototype=Object.create(D.prototype),N.prototype.constructor=N},m=t.Analytics={init:function(){if(this.Ee,arguments.length<=0)throw new Error("customerKey must be valid");var e=null,n=null,i=null;if("string"==typeof arguments[0]&&!Q.Pt(e=arguments[0]))throw new Error("customerKey must be valid");arguments.length>=2&&"object"==typeof arguments[1]&&(n=arguments[1]),arguments.length>=3&&"object"==typeof arguments[2]&&(i=arguments[2]);e=new f(e);var o=new y,a=(i=(Q.Ht(i)>0&&(i[c.GATEWAY_URL]&&(e.gatewayUrl=i[c.GATEWAY_URL]),i[c.LOG_LEVEL]>=0)&&(o.logLevel=i[c.LOG_LEVEL]),new t.Impl.Html5Logging),new t.Impl.Html5Storage),s=new t.Impl.Html5Http,r=new t.Impl.Html5Timer,l=new t.Impl.Html5Time;this.bi||(this.bi=new t.Impl.Html5Metadata),n&&(n[c.CallbackFunctions.CONSOLE_LOG]&&(i.consoleLog=n[c.CallbackFunctions.CONSOLE_LOG]),n[c.CallbackFunctions.MAKE_REQUEST]&&(s.makeRequest=n[c.CallbackFunctions.MAKE_REQUEST]),n[c.CallbackFunctions.SAVE_DATA]&&(a.saveData=n[c.CallbackFunctions.SAVE_DATA]),n[c.CallbackFunctions.LOAD_DATA]&&(a.loadData=n[c.CallbackFunctions.LOAD_DATA]),n[c.CallbackFunctions.GET_EPOCH_TIME_IN_MS]&&(l.getEpochTimeMs=n[c.CallbackFunctions.GET_EPOCH_TIME_IN_MS]),n[c.CallbackFunctions.CREATE_TIMER])&&(r.createTimer=n[c.CallbackFunctions.CREATE_TIMER]),this.Mi=new T(l,r,s,a,this.bi,i),this.T=new R(this.Mi,o),this.T.lt("Analytics",e),this.Ee=new h(e,this.T,this.He,m.version),this.Ee._=new _(this.Ee,this),this.Ee._.Ge()},release:function(){var t=0;if(this.je){for(t=0;t<this.je.length;t++){var e=this.je[t];e&&(e.release(),e.p=null,e._e=null,this.je.splice(t,1),t--)}this.je=null}if(this.Ke){for(t=0;t<this.Ke.length;t++){var n=this.Ke[t];n&&(n.release(),n.p=null,n._e=null,this.Ke.splice(t,1),t--)}this.Ke=null}this.T&&(this.T.release(),this.T=null),this.Ee&&(this.Ee.release(),this.Ee=null),this.Ee=null,this.p=null,this.Mi=null,this.bi=null,this.He=null},setUniqueIdentifier:function(t,e){if(!this.Ee)throw new Error(c.i);this.Ee.setUniqueIdentifier(t,e)},setUserPreferenceForDataCollection:function(t,e){if(!this.Ee)throw new Error(c.i);this.Ee.setUserPreferenceForDataCollection(t,e)},setUserPreferenceForDataDeletion:function(t){if(!this.Ee)throw new Error(c.i);this.Ee.setUserPreferenceForDataDeletion(t)},reportAppEvent:function(t,e){if(!this.Ee)throw new Error(c.i);this.Ee.sendCustomEvent(h.NO_SESSION_KEY,t,e)},reportAppBackgrounded:function(){if(!this.Ee)throw new Error(c.i);this.Ee.sendCustomEvent(h.NO_SESSION_KEY,"App.Backgrounded",null)},reportAppForegrounded:function(){if(!this.Ee)throw new Error(c.i);this.Ee.sendCustomEvent(h.NO_SESSION_KEY,"App.Foregrounded",null)},configureExistingClient:function(t){if(!(t instanceof h))throw new Error(c.i);this.Ee=t,this.T=this.Ee.T},buildVideoAnalytics:function(){var t;if(this.Ee)return t=new M(this.Ee,this.T),this.Ke||(this.Ke=[]),this.Ke.push(t),t;throw new Error(c.i)},buildAdAnalytics:function(t){if(this.Ee)return t=new P(this.Ee,this.T,t||null),this.je||(this.je=[]),this.je.push(t),t;throw new Error(c.i)},setDeviceMetadata:function(e){var n,i,o;arguments.length<=0||0===Q.Ht(e)||(this.bi||(this.bi=new t.Impl.Html5Metadata),e[c.DeviceMetadata.BRAND]&&(this.bi.getDeviceBrand=function(){return e[c.DeviceMetadata.BRAND]}),e[c.DeviceMetadata.MANUFACTURER]&&(this.bi.getDeviceManufacturer=function(){return e[c.DeviceMetadata.MANUFACTURER]}),e[c.DeviceMetadata.MODEL]&&(this.bi.getDeviceModel=function(){return e[c.DeviceMetadata.MODEL]}),e[c.DeviceMetadata.TYPE]&&(this.bi.getDeviceType=function(){return e[c.DeviceMetadata.TYPE]}),e[c.DeviceMetadata.VERSION]&&(this.bi.getDeviceVersion=function(){return e[c.DeviceMetadata.VERSION]}),e[c.DeviceMetadata.OS_NAME]&&(this.bi.getOperatingSystemName=function(){return e[c.DeviceMetadata.OS_NAME]}),e[c.DeviceMetadata.OS_VERSION]&&(this.bi.getOperatingSystemVersion=function(){return e[c.DeviceMetadata.OS_VERSION]}),e[c.DeviceMetadata.CATEGORY]&&(this.bi.getDeviceCategory=function(){return e[c.DeviceMetadata.CATEGORY]}),n=e[c.DeviceMetadata.SCREEN_RESOLUTION_WIDTH],Q.gt(n)&&(this.bi.getScreenWidth=function(){return n.toString()}),i=e[c.DeviceMetadata.SCREEN_RESOLUTION_HEIGHT],Q.gt(i)&&(this.bi.getScreenHeight=function(){return i.toString()}),o=e[c.DeviceMetadata.SCREEN_RESOLUTION_SCALE_FACTOR],Q.gt(o)&&(this.bi.getScaleFactor=function(){return o.toString()}))},reportDeviceMetric:function(t,e){switch(this.He||(this.He={}),t){case c.Network.CONNECTION_TYPE:Q.Pt(e)&&(this.He[t]=e,this.Ee)&&this.Ee.$(this.He[c.Network.CONNECTION_TYPE]);break;case c.Network.LINK_ENCRYPTION:Q.Pt(e)&&(this.He[t]=e,this.Ee)&&this.Ee.it(this.He[c.Network.LINK_ENCRYPTION]);break;case c.Network.SIGNAL_STRENGTH:var n=parseInt(e,10);Q.gt(n)&&E.DEFAULT_SIGNAL_STRENGTH!==n&&(this.He[t]=n,this.Ee)&&this.Ee.ot(n)}},version:"4.7.2"},O=ut.AnalyticsImpl=function(){var t=this;function e(){var e=!!t.ae,n=t.getAdType(),i=t.me();return n===c.AdType.SERVER_SIDE&&i===c.AdPlayer.CONTENT?O.Ye.We:n!==c.AdType.SERVER_SIDE||i!==c.AdPlayer.SEPARATE?n===c.AdType.CLIENT_SIDE&&i===c.AdPlayer.CONTENT||(n===c.AdType.CLIENT_SIDE&&c.AdPlayer.SEPARATE,e)?O.Ye.xe:O.Ye.qe:void 0}function n(e,n,i){e=parseInt(e,10),n=parseInt(n,10),isNaN(e)&&isNaN(n)||(isNaN(e),isNaN(n),!t.ae||i!==O.Ye.xe&&i!==O.Ye.We||t.ae.Je(e,n),!t.le)||i!==O.Ye.qe&&i!==O.Ye.We||t.le.Je(e,n)}function i(e,n){E.vi(e)&&(!t.ae||n!==O.Ye.xe&&n!==O.Ye.We||t.ae.Xe(e),t.le&&n===O.Ye.qe||n===O.Ye.We)&&t.le.Xe(e)}function o(e,n){e=parseInt(e,10),isNaN(e)||(!t.ae||n!==O.Ye.xe&&n!==O.Ye.We||t.ae.Qe(e),!t.le)||n!==O.Ye.qe&&n!==O.Ye.We||t.le.Qe(e)}function a(e,n){e=parseInt(e,10),isNaN(e)||(!t.ae||n!==O.Ye.xe&&n!==O.Ye.We||t.ae.Ze(e),!t.le)||n!==O.Ye.qe&&n!==O.Ye.We||t.le.Ze(e)}function s(e,n){e=parseInt(e,10),!t.ae||n!==O.Ye.xe&&n!==O.Ye.We||t.ae.ze(!0,e),!t.le||n!==O.Ye.qe&&n!==O.Ye.We||t.le.ze(!0,e)}function r(e){!t.ae||e!==O.Ye.xe&&e!==O.Ye.We||t.ae.ze(!1,-1),!t.le||e!==O.Ye.qe&&e!==O.Ye.We||t.le.ze(!1,-1)}function l(e,n){e=parseInt(e,10),isNaN(e)||(!t.ae||n!==O.Ye.xe&&n!==O.Ye.We||t.ae.$e(e),!t.le)||n!==O.Ye.qe&&n!==O.Ye.We||t.le.$e(e)}function u(e,n){e=parseInt(e,10),isNaN(e)||(!t.ae||n!==O.Ye.xe&&n!==O.Ye.We||t.ae.ts(e),!t.le)||n!==O.Ye.qe&&n!==O.Ye.We||t.le.ts(e)}function h(e,n){e=parseInt(e,10),isNaN(e)||(!t.ae||n!==O.Ye.xe&&n!==O.Ye.We||t.ae.ns(e),!t.le)||n!==O.Ye.qe&&n!==O.Ye.We||t.le.ns(e)}function f(e,n){var i;Q.Pt(e)&&(i=t.le.hi(),Q.Pt(i)&&"off"!==i&&"off"!==e&&d("off",n),!t.ae||n!==O.Ye.xe&&n!==O.Ye.We||t.ae.es(e),!t.le||n!==O.Ye.qe&&n!==O.Ye.We||t.le.es(e))}function d(e,n){var i;Q.Pt(e)&&(i=t.le.ri(),Q.Pt(i)&&"off"!==i&&"off"!==e&&f("off",n),!t.ae||n!==O.Ye.xe&&n!==O.Ye.We||t.ae.ss(e),!t.le||n!==O.Ye.qe&&n!==O.Ye.We||t.le.ss(e))}(function(){}).apply(this,arguments),this.Oe=function(E,v,g,p){switch(E){case c.Playback.BITRATE:p===O.Ye.xe?l(v,O.Ye.xe):l(v,e());break;case c.Playback.AVG_BITRATE:p===O.Ye.xe?u(v,O.Ye.xe):u(v,e());break;case c.Playback.PLAY_HEAD_TIME:p===O.Ye.xe?o(v,O.Ye.xe):o(v,e());break;case c.Playback.RESOLUTION:p===O.Ye.xe?n(v,g,O.Ye.xe):n(v,g,e());break;case c.Playback.BUFFER_LENGTH:p===O.Ye.xe?a(v,O.Ye.xe):a(v,e());break;case c.Playback.PLAYER_STATE:p===O.Ye.xe?i(v,O.Ye.xe):i(v,e());break;case c.Playback.RENDERED_FRAMERATE:p===O.Ye.xe?h(v,O.Ye.xe):h(v,e());break;case c.Playback.SEEK_STARTED:arguments.length>=2&&"CONVIVA"!==v?s(v,e()):g===O.Ye.xe?s(-1,O.Ye.xe):s(-1,e());break;case c.Playback.SEEK_ENDED:g===O.Ye.xe?r(O.Ye.xe):r(e());break;case c.Playback.CDN_IP:y=v,P=e(),Q.Pt(y)&&(!t.ae||P!==O.Ye.xe&&P!==O.Ye.We||t.ae.os(y),!t.le||P!==O.Ye.qe&&P!==O.Ye.We||t.le.os(y));break;case c.Playback.DROPPED_FRAMES_TOTAL:P=v,y=e(),P=parseInt(P,10),isNaN(P)||(!t.ae||y!==O.Ye.xe&&y!==O.Ye.We||t.ae.rs(P),!t.le)||y!==O.Ye.qe&&y!==O.Ye.We||t.le.rs(P);break;case c.Playback.DROPPED_FRAMES_COUNT:var A=v,T=e();A=parseInt(A,10),isNaN(A)||(!t.ae||T!==O.Ye.xe&&T!==O.Ye.We||t.ae.us(A),!t.le)||T!==O.Ye.qe&&T!==O.Ye.We||t.le.us(A);break;case c.Playback.AUDIO_LANGUAGE:T=v,A=e(),Q.Pt(T)&&(!t.ae||A!==O.Ye.xe&&A!==O.Ye.We||t.ae.hs(T),!t.le||A!==O.Ye.qe&&A!==O.Ye.We||t.le.hs(T));break;case c.Playback.SUBTITLES_LANGUAGE:f(v,e());break;case c.Playback.CLOSED_CAPTIONS_LANGUAGE:d(v,e());break;default:C=E,S=v,R=e(),Q.Pt(C)&&S&&(!t.ae||R!==O.Ye.xe&&R!==O.Ye.We||t.ae.Zt(C,S),!t.le||R!==O.Ye.qe&&R!==O.Ye.We||t.le.Zt(C,S))}var C,S,R,y,P}},ut.AnalyticsImpl.Ye={xe:1,qe:2,We:3},_=ut.AppAnalyticsHandler=function(){var t=this;t.Ee=null,t.fs=null,t.cs=null,t.ls=null,t.wt=null,function(e,n){t.Ee=e,t.fs=n,"undefined"!=typeof document&&document&&(t.cs=document.createEvent("HTMLEvents"),t.cs.initEvent(c.APP_TRACKER_EVENT.TYPE,!0,!0))}.apply(this,arguments),this.Ge=function(){t.ds(c.APP_TRACKER_EVENT.INIT)},this.vs=function(){t.ds(c.APP_TRACKER_EVENT.VIDEO_ATTEMPT)},this.Es=function(){t.ds(c.APP_TRACKER_EVENT.VIDEO_END),t.wt=null},this._s=function(e){t.ds(c.APP_TRACKER_EVENT.VIDEO_PLAY,e)},this.Rs=function(e){t.ds(c.APP_TRACKER_EVENT.VIDEO_PAUSE,e)},this.ps=function(e){t.ds(c.APP_TRACKER_EVENT.VIDEO_ERROR,e)},this.As=function(e){t.ds(c.APP_TRACKER_EVENT.VIDEO_BUFFERING,e)},this.Ts=function(e){t.ds(c.APP_TRACKER_EVENT.VIDEO_BITRATE_SWITCH,e)},this.Ss=function(e){t.ds(c.APP_TRACKER_EVENT.VIDEO_METADATA_CHANGE,e)},this.Os=function(e){e={cen:e.name,ced:e.data},t.ds(c.APP_TRACKER_EVENT.VIDEO_CUSTOM_EVENT,e)},this.Ns=function(e){e={cen:e.name,ced:e.data},t.ds(c.APP_TRACKER_EVENT.SDK_CUSTOM_EVENT,e)},this.gs=function(e){t.ds(c.APP_TRACKER_EVENT.AD_BREAK_START,{cen:"PodStart",ced:e})},this.Is=function(){t.ds(c.APP_TRACKER_EVENT.AD_BREAK_END,{cen:"PodEnd"})},this.ds=function(e,n){try{if(t.cs){if(t.ws(),t.cs.name=t.ls.name=e,t.cs.iid=t.ls.iid=t.Ee.getConfig().getIid(),t.cs.clid=t.ls.clid=t.Ee.getConfig().getClientId(),t.wt){var i=t.wt;if(i.Cs()?(t.cs.sid=t.ls.sid=i.ys.Xt(),t.cs.sst=t.ls.sst=i.Ds,t.cs.url=t.ls.url=i.On,t.cs.st=t.ls.st=i.Ps(),t.cs.an=t.ls.an=i._n,t.cs.pn=t.ls.pn=i.bs,t.cs.tags=t.ls.tags=JSON.stringify(i.Ct.Rn),t.cs.vid=t.ls.vid=i.Tn,i.Ls>=0&&(t.cs.cl=t.ls.cl=i.Ls),t.cs.lv=t.ls.lv=i.Ms,t.cs.fw=t.ls.fw=i.Us(),t.cs.fwv=t.ls.fwv=i.Vs(),t.cs.mn=t.ls.mn=i.Vn,t.cs.mv=t.ls.mv=i.kn,i.yn>=0&&(t.cs.br=t.ls.br=i.yn)):i.ks()&&(t.cs.sid=t.ls.sid=i.ys.Xt(),t.cs.sst=t.ls.sst=i.Ds,t.cs.st=t.ls.st=i.Ps(),t.cs.mn=t.ls.mn=i.Vn,t.cs.mv=t.ls.mv=i.kn),n)for(var o=Object.keys(n),a=0;a<o.length;a++)"object"==typeof n[o[a]]?t.cs[o[a]]=t.ls[o[a]]=JSON.stringify(n[o[a]]):t.cs[o[a]]=t.ls[o[a]]=n[o[a]]}"undefined"!=typeof document&&document&&document.dispatchEvent(t.cs)}}catch(e){throw new Error(e)}},this.ws=function(){if(null!==t.ls)for(var e=Object.keys(t.ls),n=0;n<e.length;n++)delete t.cs[e[n]];t.ls={}},this.Fs=function(e,n,i){try{((t.wt=i).Cs()||i.ks())&&(e===G.Bs?n[G.Hs][G.Gs]?n[G.Hs][G.Gs]===G.js?t._s(n):n[G.Hs][G.Gs]===G.Ks?t.As(n):n[G.Hs][G.Gs]===G.Ws&&t.Rs(n):n[G.Hs][G.Ys]?t.Ts(n):t.Ss(n):e===G.xs?t.ps({err:n[G.qs],ft:n[G.Js]}):e===G.Xs&&(n[G.Qs]===c.Events.POD_START?t.gs(n[G.Zs]):n[G.Qs]===c.Events.POD_END?t.Is(n[G.Zs]):t.wt.Cs()?t.Os({name:n[G.Qs],data:n[G.Zs]}):t.Ns({name:n[G.Qs],data:n[G.Zs]})))}catch(e){throw new Error(e)}}},I=ut.PlayerMonitor=function(){var t=this;this.zs=null,this.$s=null,this.Ct=null,this.no=null,this.Pn=E.PlayerState.UNKNOWN,this.io=-1,this.eo=-1,this.Gn=[],this.so=null,this.oo=null,this.ro=-2,this.uo=-2,this.Ln=-1,this.V=E.DEFAULT_SIGNAL_STRENGTH,this.ho=null,this.gi=null,this.U=null,this.M=null,this._e=null,this.ao=null,this.fo=null,this.co=null,this.lo=null,this.we=null,this.Re=null,this.jn=null,this.Kn=null,this.Wn=null,function(e){t._e=e}.apply(this,arguments),this.do=function(){return t.Pn},this.Xe=function(e){t.Pn!==e&&(t.Le(),t.Pn=e,t.vo())},this.Eo=function(){return t._o},this.Ro=function(){return t.po},this.ze=function(e,n){t.Le(),t._o=e,t.po=n,t.Ao()},this.To=function(){return t.io},this.Qe=function(e){t.io=e},this.So=function(){return t.eo},this.Ze=function(e){t.eo=e},this.ve=function(){return t.ro},this.$e=function(e){t.ro!==e&&(t.ro=e,t.vo())},this.Oo=function(){return t.uo},this.ts=function(e){t.uo!==e&&(t.uo=e,t.vo())},this.No=function(){return t.Ln},this.ns=function(e){t.Ln=e},this.Io=function(){return t.ho},this.os=function(e){t.ho=e,t.vo()},this.Ni=function(){return t.gi},this.rs=function(e){t.gi=e,t.vo()},this.us=function(e){t.wo(e)},this.Co=function(){return t.V},this.si=function(){return t.jn},this.ri=function(){return t.Kn},this.hi=function(){return t.Wn},this.hs=function(e){t.jn!==e&&(t.jn=e,t.vo())},this.es=function(e){t.Kn!==e&&(t.Kn=e,t.vo())},this.ss=function(e){t.Wn!==e&&(t.Wn=e,t.vo())},this.yo=function(){return t.mo},this.Do=function(){return t.Po},this.Je=function(e,n){n<0&&(n=0),t.mo===(e=e<0?0:e)&&t.Po===n||(t.mo=e,t.Po=n,t.vo())},this.bo=function(){return t.$s},this.Lo=function(){t.bo()&&(t.Ct=new d,t.no={},t.fo={},t.Mo())},this.Uo=function(e){(t.$s||e)&&(this.Le(),t.$s&&(t.$s=null,t.Lo()),e)&&(t.$s=Q.Vo(t.$s,e),t.Lo())},this.Se=function(e){if(e)if(t.Ct){var n,i=!1;for(n in e)if(t.Ct[n]!==e[n]){i=!0;break}i&&(t.Le(),t.$s=Q.Vo(e),t.Mo())}else t.Uo(e)},this.Ne=function(e){e?t.co!==e&&(t.co=e,t.ko()):(t.co=null,t.Be())},this.Le=function(){t.Fo||t.co&&(t.Fo=!0,t.co(),t.Fo=!1)},this.fe=function(){return t.zs},this.de=function(e,n){t.zs!==e&&(t.Le(),t.zs&&(t.Bo(),t.Be(),t.Ie()),t.zs=e,t.zs)&&t.Me(n)},this.Ho=function(){return t.so},this.Go=function(){return t.oo||null},this.jo=function(){return t.Gn},this.Ko=function(){t.Gn=[]},this.di=function(e){this.Le(),t.Gn.push(e),t.Si()},this.ge=function(e,n){t.Le(),t.so=e,t.oo=n,t.Wo()},this.Yo=function(){t.Le()},this.ko=function(){t.Be(),t.ao=t._e.create(t.Yo,1e3,"PlayerMonitor.update")},this.Be=function(){t.ao&&(t.ao(),t.ao=null)},this.Ce=function(e,n,i){t.lo=i,t.we=e,t.xo(),t.Re=n,t.we&&c.AdType.CLIENT_SIDE===t.we&&(t.Pn=c.PlayerState.UNKNOWN,t.qo(t.we,n,i?i[c.POD_POSITION]:null))},this.ye=function(){t.we&&c.AdType.CLIENT_SIDE===t.we&&(t.Jo(),t.Pn=c.PlayerState.UNKNOWN),t.Xo(),t.we=null,t.Re=null},this.Qo=function(){return t.lo},this.Zo=function(){return t.we},this.getContentMetadata=function(){return this.Ct},this.Ie=function(){this.zs=null,this.$s=null,this.Ct=null,this.no=null,this.Pn=E.PlayerState.UNKNOWN,this.io=-1,this.eo=-1,this.Gn=[],this.so=null,this.oo=null,this.ro=-2,this.uo=-2,this.Ln=-1,this.V=E.DEFAULT_SIGNAL_STRENGTH,this.ho=null,this.gi=null,this.U=null,this.M=null,this._e=null,this.ao=null,this.fo=null,this.co=null,this.lo=null,this.we=null,this.Re=null,this.jn=null,this.Kn=null,this.Wn=null,t.Ue=null,t.Fe=h.NO_SESSION_KEY}},D=ut.PlayerMonitorImpl=function(){var t=this;t.De=null,t.Ue=null,t.Fe=h.NO_SESSION_KEY,function(e,n){I.call(this,n),t.De=e}.apply(this,arguments),this.getPHT=function(){return t.To()},this.getBufferLength=function(){return t.So()},this.getRenderedFrameRate=function(){return t.No()},this.getSignalStrength=function(){return t.Co()},this.Ao=function(){t.Ue&&t._ContentSessionKey!==h.NO_SESSION_KEY&&(t.Eo()?t.Ue.setPlayerSeekStart(t.Ro()):t.Ue.setPlayerSeekEnd())},this.vo=function(){t.Ue&&(t.Ue.setPlayerState(t.do()),t.ve()>0&&t.Ue.setBitrateKbps(t.ve()),t.Oo()>0&&t.Ue.setAvgBitrateKbps(t.Oo()),t.yo()>0&&t.Ue.setVideoResolutionWidth(t.yo()),t.Do()>0&&t.Ue.setVideoResolutionHeight(t.Do()),t.Io()&&t.Ue.setCDNServerIP(t.Io()),Q.gt(t.Ni())&&t.Ue.setDroppedFramesTotal(t.Ni()),Q.Pt(t.si())&&t.Ue.setAudioLang(t.si()),Q.Pt(t.ri())&&t.Ue.setSubtitleLang(t.ri()),Q.Pt(t.hi()))&&t.Ue.setCcLang(t.hi())},this.Lt=function(){t.Fe!==h.NO_SESSION_KEY&&t.De&&t.De.updateContentMetadata(t.Fe,t.Ct)},this.Ve=function(){if(t.Ue){t.fo&&Q.Ht(t.fo)>0&&(t.fo[c.MODULE_NAME]&&t.fo[c.MODULE_VERSION]&&(e=t.fo[c.MODULE_NAME],n=t.fo[c.MODULE_VERSION],Q.Pt(e))&&Q.Pt(n)&&t.Ue.setModuleNameAndVersion(e,n),t.fo[c.FRAMEWORK_NAME]&&(e=t.fo[c.FRAMEWORK_NAME],Q.Pt(e))&&t.Ue.setPlayerType(e),t.fo[c.FRAMEWORK_VERSION])&&(n=t.fo[c.FRAMEWORK_VERSION],Q.Pt(n))&&t.Ue.setPlayerVersion(n);var e,n,i=t.jo();t.Ko();for(var o=0;o<i.length;o++){var a=i[o];t.Ue.di(a)}}},this.Jo=function(){t.Ue&&t.Fe!==h.NO_SESSION_KEY&&(t.vo(),this.zo())},this.Vt=function(){t.Ue&&t.Fe!==h.NO_SESSION_KEY&&(t.vo(),t.De.kt(t.Fe))},this.zo=function(){t.De&&t.Fe!==c.NO_SESSION_KEY&&t.De.adEnd(t.Fe)},this.qo=function(e,n,i){var o;t.Ue&&t.Fe!==c.NO_SESSION_KEY&&(o=null,c.AdType.CLIENT_SIDE===e?o=h.AdStream.SEPARATE:c.AdType.SERVER_SIDE===e&&(o=h.AdStream.CONTENT),t.$o(o,n,i))},this.Mt=function(){t.Ue&&t.Fe!==c.NO_SESSION_KEY&&t.De.Ut(t.Fe)},this.$o=function(e,n,i){t.De&&t.Fe!==c.NO_SESSION_KEY&&t.De.adStart(t.Fe,e,n,i)},this.Me=function(){if(t.De){t.Ue=t.De.getPlayerStateManager(!0),t.Ve(),t.Ue.setClientMeasureInterface(this);try{var e;t.Ct&&t.Ct.custom&&!t.Ct.custom[c.UTM_TRACKING_URL]&&(Array.prototype.filter||(Array.prototype.filter=function(t){if(null==this)throw new TypeError;var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var i,o=[],a=arguments.length>=2?arguments[1]:void 0,s=0;s<n;s++)s in e&&(i=e[s],t.call(a,i,s,e))&&o.push(i);return o}),""!==(e=Q.tr().split("?").join("").split("&").filter((function(t){return 2===t.split("=").length&&t.split("=")[0].toLowerCase().indexOf("utm_")>=0})).join("&")))&&(t.Ct.custom[c.UTM_TRACKING_URL]=e)}catch(e){t.p.error("PlayerMonitorImpl _createSession : "+e)}t.Fe=t.De.createSession(t.Ct,t.Ue,!0)}},this.Bo=function(){t.De&&(t.Ue&&(t.Ue.setPlayerState(c.PlayerState.STOPPED),t.Ue=null),t.Fe!==c.NO_SESSION_KEY)&&(t.De.cleanupSession(t.Fe),t.Fe=c.NO_SESSION_KEY)},this.Si=function(){if(t.De&&t.Fe!==h.NO_SESSION_KEY){var e=t.jo();t.Ko();for(var n=0;n<e.length;n++){var i=e[n];t.De.reportError(t.Fe,i.nr(),i.ir())}}},this.Wo=function(){t.Fe!==h.NO_SESSION_KEY&&t.De&&t.De.sendCustomEvent(t.Fe,t.Ho(),t.Go())},this.Mo=function(){var e,n=t.bo(),i=!1,o=!1;for(e in n){var a=n[e];if(Q.Pt(e)&&null!=a)switch(e){case c.STREAM_URL:o=!0,t.Ct.streamUrl=a;break;case c.ASSET_NAME:o=!0,t.Ct.assetName=a;break;case c.DEFAULT_RESOURCE:o=!0,t.Ct.defaultResource=a;break;case c.VIEWER_ID:o=!0,t.Ct.viewerId=a;break;case c.PLAYER_NAME:o=!0,t.Ct.applicationName=a;break;case c.DURATION:o=!0,t.Ct.duration=a;break;case c.IS_LIVE:o=!0,t.Ct.streamType=a;break;case c.ENCODED_FRAMERATE:o=!0,t.Ct.encodedFrameRate=a;break;case c.MODULE_NAME:case c.MODULE_VERSION:case c.FRAMEWORK_NAME:case c.FRAMEWORK_VERSION:i=!0,t.fo[e]=a;break;default:o=!0,t.Ct.custom[e]=a}}i&&this.Ve(),o&&this.Lt()},this.xo=function(){this.er(c.Events.POD_START)},this.Xo=function(){this.er(c.Events.POD_END)},this.er=function(e){var n,i,o;t.De&&t.Fe!==c.NO_SESSION_KEY&&(n={},(o=this.Qo())&&((i=o[c.POD_POSITION])&&(n[c.POD_POSITION]=i),(i=o[c.POD_INDEX])&&(n[c.POD_INDEX]=i+""),e===c.Events.POD_START)&&(i=o[c.POD_DURATION])&&(n[c.POD_DURATION]=i+""),(o=this.Zo())&&(n[c.AD_TYPE]=o),t.De.sendCustomEvent(t.Fe,e,n))},this.wo=function(e){t.Ue.setDroppedFramesCount(e)},this.sr=function(t){this.Fe===c.NO_SESSION_KEY&&t!==c.NO_SESSION_KEY&&(this.Fe=t)},this.ke=function(){return this.Fe},this.Xt=function(){return t.De.getSessionId(this.Fe)},this.Qt=function(){return t.De.getClientId(this.Fe)},this.Zt=function(e,n){t.De.Zt(this.Fe,e,n)},D.prototype=Object.create(I.prototype),D.prototype.constructor=D},t.Impl=t.Impl||{},t.Impl.Html5Http=function(){(function(){}).apply(this,arguments),this.makeRequest=function(){return this.makeRequestStandard.apply(this,arguments)},this.makeRequestStandard=function(t,e,n,i,o,a){var s=new XMLHttpRequest;return s.open(t,e,!0),i&&s.overrideMimeType&&(s.overrideMimeType=i),i&&s.setRequestHeader&&s.setRequestHeader("Content-Type",i),o>0&&(s.timeout=o,s.ontimeout=function(){s.ontimeout=s.onreadystatechange=null,a&&a(!1,"timeout after "+o+" ms")}),s.onreadystatechange=function(){4===s.readyState&&(s.ontimeout=s.onreadystatechange=null,200===s.status?a&&a(!0,s.responseText):a&&a(!1,"http status "+s.status))},s.send(n),null},this.release=function(){}},t.Impl=t.Impl||{},t.Impl.Html5Logging=function(){(function(){}).apply(this,arguments),this.consoleLog=function(t,e){"undefined"!=typeof console&&(console.log&&e===y.LogLevel.DEBUG||e===y.LogLevel.INFO?console.log(t):console.warn&&e===y.LogLevel.WARNING?console.warn(t):console.error&&e===y.LogLevel.ERROR&&console.error(t))},this.release=function(){}},t.Impl=t.Impl||{},t.Impl.Html5Metadata=function(){(function(){}).apply(this,arguments),this.getBrowserName=function(){return null},this.getBrowserVersion=function(){return null},this.getDeviceBrand=function(){return null},this.getDeviceManufacturer=function(){return null},this.getDeviceModel=function(){return null},this.getDeviceType=function(){return null},this.getDeviceVersion=function(){return null},this.getFrameworkName=function(){return null},this.getFrameworkVersion=function(){return null},this.getOperatingSystemName=function(){return null},this.getOperatingSystemVersion=function(){return null},this.getDeviceCategory=function(){return null},this.getScreenWidth=function(){return"undefined"!=typeof window&&window&&window.screen&&window.screen.width?window.screen.width.toString():null},this.getScreenHeight=function(){return"undefined"!=typeof window&&window&&window.screen&&window.screen.height?window.screen.height.toString():null},this.getScaleFactor=function(){return"undefined"!=typeof window&&window&&window.devicePixelRatio?window.devicePixelRatio.toString():null},this.release=function(){}},t.Impl=t.Impl||{},t.Impl.Html5Storage=function(){(function(){}).apply(this,arguments),this.saveData=function(t,e,n,i){t=t+"."+e;try{localStorage.setItem(t,n),i(!0,null)}catch(t){i(!1,t.toString())}},this.loadData=function(t,e,n){t=t+"."+e;try{n(!0,localStorage.getItem(t))}catch(t){n(!1,t.toString())}},this.release=function(){}},t.Impl=t.Impl||{},t.Impl.Html5Time=function(){(function(){}).apply(this,arguments),this.getEpochTimeMs=function(){return(new Date).getTime()},this.release=function(){}},t.Impl=t.Impl||{},t.Impl.Html5Timer=function(){(function(){}).apply(this,arguments),this.createTimer=function(t,e){var n=setInterval(t,e);return function(){-1!==n&&(clearInterval(n),n=-1)}},this.release=function(){}},M=ut.VideoAnalytics=function(){var e=this;e.Ee=null,e.T=null,e._e=null,e.le=null,e.pe=null,this.release=function(){e.p,e.le&&e.le.fe()&&e.le.de(!1),void 0!==t.ProxyMonitor&&e.pe&&(t.ProxyMonitor.release(e.pe),e.pe=null),e.le&&(e.le.Ne(null),e.le.Ie(),e.le=null),e._e=null},function(t,n){e.Ee=t,e.T=n,e._e=n.buildTimer(c.version),e.le=new D(e.Ee,e._e),O.call(this)}.apply(this,arguments),this.reportPlaybackRequested=function(t){e.p,e.le&&(Q.Ht(t)>0&&e.setContentInfo(t),e.le.fe()||(e.le.de(!0),e.Ee._.vs()))},this.reportPlaybackEnded=function(){e.p,e.le&&e.le.fe()&&(e.Ee._.Es(),e.le.de(!1),void 0!==t.ProxyMonitor&&e.pe&&(t.ProxyMonitor.release(e.pe),e.pe=null),e.le.Ne(null))},this.reportPlaybackFailed=function(t,n){e.le&&(Q.Ht(n)>0&&e.setContentInfo(n),e.le.fe()||e.le.de(!0),e.p,e.reportPlaybackError(t,h.ErrorSeverity.FATAL),e.reportPlaybackEnded())},this.setContentInfo=function(t){Q.Ht(t)<=0||e.le&&(e.p,e.le.Se(t))},this.setPlayerInfo=function(t){Q.Ht(t)<=0||e.le&&(e.p,e.le.Se(t))},this.reportPlaybackMetric=function(){0!==arguments.length&&(1===arguments.length?e.Oe(arguments[0]):2===arguments.length?e.Oe(arguments[0],arguments[1]):3===arguments.length?e.Oe(arguments[0],arguments[1],arguments[2]):4===arguments.length&&e.Oe(arguments[0],arguments[1],arguments[2],arguments[3]))},this.reportPlaybackError=function(t,n){e.le&&Q.Pt(t)&&(e.p,t=new it(t,n),e.le.di(t))},this.reportPlaybackEvent=function(t,n){if(Q.Pt(t)&&e.le&&(e.p,e.le))switch(t){case c.Events.USER_WAIT_STARTED:case c.Events.BUMPER_VIDEO_STARTED:e.le.Mt();break;case c.Events.USER_WAIT_ENDED:case c.Events.BUMPER_VIDEO_ENDED:e.le.Vt();break;default:e.le.ge(t,n)}},this.setCallback=function(t){e.p,e.le&&e.le.Ne(t)},this.reportAdBreakStarted=function(t,n,i){e.le&&(e.p,e.le.Ce(t,n,i))},this.reportAdBreakEnded=function(){e.le&&(e.p,e.le.ye())},this.setPlayer=function(n,i){var o,a;void 0!==n&&(i&&(o=i[c.CONVIVA_MODULE],a=i[c.MEDIA_ELEMENT]),void 0!==o?t.ProxyMonitor=o.ProxyMonitor:"undefined"!=typeof ConvivaModule&&(t.ProxyMonitor=ConvivaModule.ProxyMonitor),void 0!==t.ProxyMonitor)&&(e.p,!n&&e.pe?(t.ProxyMonitor.release(e.pe),e.pe=null):n?(e.pe&&t.ProxyMonitor.release(e.pe),e.p,e.pe=void 0!==a?t.ProxyMonitor.initConvivaDropIn(n,a,e.T,this,t):t.ProxyMonitor.initConvivaDropIn(n,e.T,this,t)):void 0!==a&&(e.pe=t.ProxyMonitor.initConvivaDropIn(n,a,e.T,this,t)))},this.setAdAnalytics=function(t){t?e.getAdType()&&(e.getAdType()===c.AdType.SERVER_SIDE?e.ae=t.getAdPlayerMonitor():e.getAdType()===c.AdType.CLIENT_SIDE&&e.p):e.ae=null},this.configureExistingSession=function(t){t!==c.NO_SESSION_KEY&&e.le&&(e.p,e.le.sr(t))},this.getSessionId=function(){return e.le?(e.p,e.le.Xt()):c.NO_SESSION_KEY},this.getClientId=function(){return e.le?(e.p,e.le.Qt()):null},this.Te=function(){return e.p,this.le},this.getAdType=function(){return e.le?e.le.we:null},this.me=function(){return e.le?e.le.Re:null},M.prototype=Object.create(O.prototype),M.prototype.constructor=M},ut.JsonParse=(o={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},a=function(t){throw{name:"SyntaxError",message:t,at:e,text:i}},s=function(t){return t&&t!==n&&a("Expected '"+t+"' instead of '"+n+"'"),n=i.charAt(e),e+=1,n},r=function(){var t,e,i,r="";if('"'===n)for(;s();){if('"'===n)return s(),r;if("\\"===n)if(s(),"u"===n){for(e=i=0;e<4&&(t=parseInt(s(),16),isFinite(t));e+=1)i=16*i+t;r+=String.fromCharCode(i)}else{if("string"!=typeof o[n])break;r+=o[n]}else r+=n}a("Bad string")},l=function(){for(;n&&n<=" ";)s()},u=function(){switch(l(),n){case"{":var t,e={};if("{"===n){if(s("{"),l(),"}"===n)return s("}"),e;for(;n;){if(t=r(),l(),s(":"),Object.hasOwnProperty.call(e,t)&&a('Duplicate key "'+t+'"'),e[t]=u(),l(),"}"===n)return s("}"),e;s(","),l()}}return void a("Bad object");case"[":var i=[];if("["===n){if(s("["),l(),"]"===n)return s("]"),i;for(;n;){if(i.push(u()),l(),"]"===n)return s("]"),i;s(","),l()}}return void a("Bad array");case'"':return r();case"-":return ct();default:return(n>="0"&&n<="9"?ct:function(){switch(n){case"t":return s("t"),s("r"),s("u"),s("e"),!0;case"f":return s("f"),s("a"),s("l"),s("s"),s("e"),!1;case"n":return s("n"),s("u"),s("l"),s("l"),null}a("Unexpected '"+n+"'")})()}},function(t,o){return i=t,e=0,n=" ",t=u(),l(),n&&a("Syntax error"),"function"==typeof o?function t(e,n){var i,a,s=e[n];if(s&&"object"==typeof s)for(i in s)Object.hasOwnProperty.call(s,i)&&(void 0!==(a=t(s,i))?s[i]=a:delete s[i]);return o.call(e,n,s)}({"":t},""):t}),V=ut.JSON2={},"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+ht(this.getUTCMonth()+1)+"-"+ht(this.getUTCDate())+"T"+ht(this.getUTCHours())+":"+ht(this.getUTCMinutes())+":"+ht(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}),"function"!=typeof V.stringify&&(L=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,U={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},V.stringify=function(t,e,n){var i;if(b=w="","number"==typeof n)for(i=0;i<n;i+=1)b+=" ";else"string"==typeof n&&(b=n);if(!(F=e)||"function"==typeof e||"object"==typeof e&&"number"==typeof e.length)return function t(e,n){var i,o,a,s,r,l=w,u=n[e];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(e)),typeof(u="function"==typeof F?F.call(n,e,u):u)){case"string":return ft(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(w+=b,r=[],Object.prototype.toString.apply(u)===Object.prototype.toString.apply([])){for(s=u.length,i=0;i<s;i+=1)r[i]=t(i,u)||"null";a=0===r.length?"[]":w?"[\n"+w+r.join(",\n"+w)+"\n"+l+"]":"["+r.join(",")+"]"}else{if(F&&"object"==typeof F)for(s=F.length,i=0;i<s;i+=1)"string"==typeof F[i]&&(a=t(o=F[i],u))&&r.push(ft(o)+(w?": ":":")+a);else for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(a=t(o,u))&&r.push(ft(o)+(w?": ":":")+a);a=0===r.length?"{}":w?"{\n"+w+r.join(",\n"+w)+"\n"+l+"}":"{"+r.join(",")+"}"}return w=l,a}}("",{"":t});throw new Error("JSON2.stringify")}),Y=ut.rr={ur:"0123456789abcdef",hr:function(t){for(var e="",n=7;n>=0;n--)e+=Y.ur.charAt(t>>4*n&15);return e},ar:function(t){for(var e=1+(t.length+8>>6),n=new Array(16*e),i=0;i<16*e;i++)n[i]=0;for(i=0;i<t.length;i++)n[i>>2]|=t.charCodeAt(i)<<24-i%4*8;return n[i>>2]|=128<<24-i%4*8,n[16*e-1]=8*t.length,n},cr:function(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n},lr:function(t,e){return t<<e|t>>>32-e},dr:function(t,e,n,i){return t<20?e&n|~e&i:!(t<40)&&t<60?e&n|e&i|n&i:e^n^i},vr:function(t){return t<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514},Er:function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return Y._r(e)},_r:function(t){if(""===t)return"";for(var e,n=Y.ar(t),i=new Array(80),o=1732584193,a=-271733879,s=-1732584194,r=271733878,l=-1009589776,u=0;u<n.length;u+=16){for(var c=o,h=a,f=s,d=r,E=l,v=0;v<80;v++)i[v]=v<16?n[u+v]:Y.lr(i[v-3]^i[v-8]^i[v-14]^i[v-16],1),e=Y.cr(Y.cr(Y.lr(o,5),Y.dr(v,a,s,r)),Y.cr(Y.cr(l,i[v]),Y.vr(v))),l=r,r=s,s=Y.lr(a,30),a=o,o=e;o=Y.cr(o,c),a=Y.cr(a,h),s=Y.cr(s,f),r=Y.cr(r,d),l=Y.cr(l,E)}return Y.hr(o)+Y.hr(a)+Y.hr(s)+Y.hr(r)+Y.hr(l)}},(G=ut.CwsProtocol=function(){this.Rr=function(t,e,n,i){return i.seq=t,i.st=e,i.t=n,i},this.pr=function(t,e){var n=G.Ar;return this.Rr(t,e,n,{})}}).version="2.6",G.Tr="/0/wsg",G.H="0",G.Sr=-1,G.Or=!1,G.Nr=2,G.gr=-1,G.Ir=-1,G.wr=1e3,G.Cr="sdk.js.1",G.Bs="CwsStateChangeEvent",G.xs="CwsErrorEvent",G.Ar="CwsSessionEndEvent",G.Xs="CwsCustomEvent",G.yr="CwsSeekEvent",G.mr="CwsDataSamplesEvent",G.Dr="ok",G.Pr="err",G.Lr="clid",G.Mr="cfg",G.Ur="evs",G.Vr="maxhbinfos",G.kr="slg",G.Fr="hbi",G.Br="gw",G.Hr="fp",G.Gr="csi_en",G.jr="CwsSessionHb",G.Kr="t",G.Wr="st",G.Yr="sst",G.qr="lv",G.Jr="seq",G.Xr="cid",G.Qr="clid",G.Zr="clv",G.zr="pver",G.$r="iid",G.tu="sid",G.nu="vid",G.iu="an",G.eu="pn",G.su="tags",G.ou="sf",G.ru="evs",G.uu="lg",G.hu="hbinfos",G.au="sdk",G.fu="pj",G.Gs="ps",G.Ys="br",G.cu="avgbr",G.lu="cl",G.du="efps",G.vu="afps",G.Eu="rfpstot",G._u="rfpscnt",G.Ru="rs",G.pu="pht",G.Au="bl",G.Tu="url",G.Su="caps",G.Ou="pm",G.Nu="w",G.gu="h",G.Iu="ct",G.wu="le",G.Cu="dftot",G.yu="dfcnt",G.mu="al",G.Du="sl",G.Pu="cal",G.bu="ss",G.Lu="csi_n",G.Mu="csi_t",G.Uu="csi_l",G.Vu="csi_v",G.ku="csi_c",G.Fu="sch",G.Bu="br",G.Hu="brv",G.Gu="dvb",G.ju="dvma",G.Ku="dvm",G.Wu="dvt",G.Yu="dvv",G.xu="sw",G.qu="sh",G.Ju="scf",G.Xu="fw",G.Qu="fwv",G.Zu="cc",G.zu="mn",G.$u="mv",G.th="os",G.nh="osv",G.ih="cat",G.eh="caps",G.sh="t",G.oh="seq",G.rh="st",G.uh="act",G.hh="skto",G.qs="err",G.Js="ft",G.Hs="new",G.ah="old",G.Qs="name",G.Zs="attr",G.fh="seq",G.lh="err",G.dh="rtt",G.Eh="ad",G._h="csi",G.Rh=function(t){switch(t){case E.PlayerState.STOPPED:return G.ph;case E.PlayerState.PLAYING:return G.js;case E.PlayerState.BUFFERING:return G.Ks;case E.PlayerState.PAUSED:return G.Ws;case E.PlayerState.NOT_MONITORED:return G.Ah;default:return G.Th}},G.ph=1,G.js=3,G.Ks=6,G.Ws=12,G.Ah=98,G.Th=100,G.Sh={Oh:0,Ot:1,Nh:2,gh:4},G.Ih={wh:0},H=ut.LibJSONInterface=function(){this.Ch=function(t){var e=null;try{e=V.stringify(t)}catch(t){}return e},this.yh=function(t){var e=null;try{e=ut.JsonParse(t)}catch(t){return e}return Q.mh(e)?e:null}},B=ut.CwsHeartbeat=function(){this.Dh={},function(){}.apply(this,arguments),this.get=function(){return this.Dh},this.Ph=function(t,e){this.Dh[t]=e},this.bh=function(t,e,n){this.Dh[t]||(this.Dh[t]={}),this.Dh[t][e]=n},this.Lh=function(t){this.Ph(G.Kr,t)},this.Mh=function(t){this.Ph(G.Wr,t)},this.Uh=function(t){this.Ph(G.Yr,t)},this.Vh=function(t){this.Ph(G.qr,t)},this.kh=function(t){this.Ph(G.Jr,t)},this.Fh=function(t){this.Ph(G.Xr,t)},this.Bh=function(t){this.Ph(G.Qr,t)},this.Hh=function(t){this.Ph(G.Zr,t)},this.Gh=function(t){this.Ph(G.zr,t)},this.jh=function(t){this.Ph(G.eh,t)},this.Kh=function(t){this.Ph(G.tu,t)},this.Wh=function(t){this.Ph(G.$r,t)},this.Yh=function(t){this.Ph(G.nu,t)},this.xh=function(t){this.Ph(G.iu,t)},this.qh=function(t){this.Ph(G.eu,t)},this.Jh=function(t){this.Ph(G.su,t)},this.Xh=function(t){this.Ph(G.ou,t)},this.Qh=function(t){this.Ph(G.Su,t)},this.Zh=function(t){this.Ph(G.ru,t)},this.zh=function(t){this.Ph(G.au,t)},this.$h=function(t){this.Ph(G.uu,t)},this.ta=function(t){this.Ph(G.hu,t)},this.Xe=function(t){this.Ph(G.Gs,t)},this.na=function(t){this.Ph(G.fu,t)},this.ia=function(t){this.Ph(G.lu,t)},this.ea=function(t){this.Ph(G.Ys,t)},this.sa=function(t){this.Ph(G.cu,t)},this.oa=function(t){this.Ph(G.Ru,t)},this.ra=function(t){this.Ph(G.du,t)},this.ua=function(t){this.Ph(G.vu,t)},this.ha=function(t){this.Ph(G._u,t)},this.aa=function(t){this.Ph(G.Eu,t)},this.fa=function(t){this.bh(G.Ou,G.Fu,t)},this.ca=function(t){this.bh(G.Ou,G.Bu,t)},this.la=function(t){this.bh(G.Ou,G.Hu,t)},this.da=function(t){this.bh(G.Ou,G.Gu,t)},this.va=function(t){this.bh(G.Ou,G.ju,t)},this.Ea=function(t){this.bh(G.Ou,G.Ku,t)},this._a=function(t){this.bh(G.Ou,G.Wu,t)},this.Ra=function(t){this.bh(G.Ou,G.Yu,t)},this.pa=function(t){this.bh(G.Ou,G.Xu,t),this.Ph(G.Xu,t)},this.Aa=function(t){this.bh(G.Ou,G.Qu,t),this.Ph(G.Qu,t)},this.Ta=function(t){this.bh(G.Ou,G.th,t.toUpperCase())},this.Sa=function(t){this.bh(G.Ou,G.nh,t)},this.Oa=function(t){this.bh(G.Ou,G.ih,t)},this.Na=function(t){this.bh(G.Ou,G.xu,t)},this.ga=function(t){this.bh(G.Ou,G.qu,t)},this.Ia=function(t){this.bh(G.Ou,G.Ju,t)},this.wa=function(t){this.Ph(G.Cu,t)},this.wo=function(t){this.Ph(G.yu,t)},this.Ca=function(t){this.Ph(G.pu,t)},this.ya=function(t){this.Ph(G.Au,t)},this.ma=function(t){this.Ph(G.Tu,t)},this.Da=function(t){this.Ph(G.Nu,t)},this.Pa=function(t){this.Ph(G.gu,t)},this.ba=function(t){this.Ph(G.Iu,t)},this.La=function(t){this.Ph(G.wu,t)},this.Ma=function(){this.Ph(G.Eh,!0)},this.Ua=function(t){this.Ph(G.bu,t)},this.setModuleName=function(t){this.bh(G.Zu,G.zu,t)},this.Va=function(t){this.bh(G.Zu,G.$u,t)},this.ka=function(t){this.Ph(G._h,t)},this.Fa=function(t){t&&this.Ph(G.Lu,t)},this.Ba=function(t){t&&this.Ph(G.Mu,t)},this.Ha=function(t){t&&this.Ph(G.Uu,t)},this.Ga=function(t){t&&this.Ph(G.Vu,t)},this.ja=function(t){t&&this.Ph(G.ku,t)},this.Ka=function(t){this.Ph(G.mu,t)},this.Wa=function(t){this.Ph(G.Du,t)},this.Ya=function(t){this.Ph(G.Pu,t)}},(W=ut.CwsSession=function(){var t=this;t.qa=null,t.Ct=null,t.Ds=0,t.Ja=0,t.Xa=G.Sh.Oh,t.Qa=G.Ih.wh,t.Za=[],t.za=-1,t.yn=-2,t.Dn=-2,t.gi=-1,t.$a=-1,t.tf=null,t.Pn=E.PlayerState.UNKNOWN,t.wn=-1,t.Ls=-1,t.On=null,t.Fn=-1,t.Bn=-1,t.Ue=null,t._n=null,t.Tn=null,t.bs=null,t.Ms=null,t.nf={},t.if=null,t.ef=null,t.sf=null,t.rf=null,t.uf=null,t.hf=null,t.af=null,t.ff=null,t.cf=null,t.lf=null,t.df=null,t.vf=null,t.Ef=null,t._f=null,t.Rf=null,t.Vn=null,t.kn=null,t.M=null,t.U=null,t.ho=null,t.pf=null,t.Af=!1,t.Tf=!1,t.Sf=!1,t.Of=!1,t.Nf=null,t.gf=1e3,t.If=0,t.wf=0,t.Cf={},t.D={},t.yf=!1,t.mf=null,t.Df=null,t.Pf=null,t.bf=null,t.Lf=null,t.Mf=null,t.Uf=12e4,t.Vf=G.Or,t.kf=!1,t.Ff=null,t.ki=null,t.jn=null,t.Kn=null,t.Wn=null,function(e,n,i,o,a,s,r,l,u,c,h,f,d){this.Bf=e,this.Ee=n,this.Vi=i,this.p=o,this.p.setModuleName("CwsSession"),this.g=a,this._e=s,this.Hf=r,this.Gf=l,this.jf=u,this.Fi=c,this.Kf=h,this.Ct=f,this.Ct&&(t.wn=this.Ct.encodedFrameRate,t.On=this.Ct.streamUrl,t.Ls=this.Ct.duration),this.Kf&&(t.Ff=t.Kf.get(X.B)),t.ki=d}.apply(this,arguments),this.Tt=function(){this.Kf=null,this.Fi=null,this.N=null,this.jf=null,this.Gf=null,this.Hf=null,this._e=null,this.g=null,this.p=null,this.Vi=null,this.Ee=null,this.Bf.Wf(),this.Bf=null,this.pf=null,this.Sf=!0},this.Yf=function(e){this.ys=e,this.xf=this.ys.xf,this.p.Kh(this.ys.C),this.Ds=this.jf.current(),this.Cs()||this.qf()?(this.Xa+=W.xa,t.p.info("start(): assetName="+t.Ct.assetName)):t.p.info("start()"+t.Jf())},this.Xf=function(){this.Of=!0},this.Qf=function(){this.p.debug("initialize()"),(this.Cs()||this.qf()||this.ks())&&(t.Zf(),t.zf(),t.$f(),this.Cs()||this.qf())&&t.tc()},this.nc=function(){this.p.debug("end(): schedule the last hb before session cleanup"+t.Jf()),this.ic(),this.ec(),this.sc(),this.oc()},this.rc=function(){this.Of||(this.oc(),this.uc())},this.ca=function(e){var n=t.if;n!==e&&e&&(t.p.debug("Change browserName from "+n+" to "+e),t.if=e)},this.la=function(e){var n=t.ef;n!==e&&e&&(t.p.debug("Change browserVersion from "+n+" to "+e),t.ef=e)},this.da=function(e){var n=t.sf;n!==e&&e&&(t.p.debug("Change deviceBrand from "+n+" to "+e),t.sf=e)},this.va=function(e){var n=t.rf;n!==e&&e&&(t.p.debug("Change deviceManufacturer from "+n+" to "+e),t.rf=e)},this.Ea=function(e){var n=t.uf;n!==e&&e&&(t.p.debug("Change deviceModel from "+n+" to "+e),t.uf=e)},this._a=function(e){var n=t.hf;n!==e&&e&&(t.p.debug("Change deviceType from "+n+" to "+e),t.hf=e)},this.Ra=function(e){var n=t.af;n!==e&&e&&(t.p.debug("Change deviceVersion from "+n+" to "+e),t.af=e)},this.Ta=function(e){var n=t.lf;n!==e&&e&&(t.p.debug("Change operatingSystemName from "+n+" to "+e),t.lf=e)},this.Sa=function(e){var n=t.df;n!==e&&e&&(t.p.debug("Change operatingSystemVersion from "+n+" to "+e),t.df=e)},this.Oa=function(e){var n=t.vf;n!==e&&e&&(t.p.debug("Change deviceCategory from "+n+" to "+e),t.vf=e)},this.Na=function(e){var n=t.Ef;n!==e&&e&&(t.p.debug("Change screenWidth from "+n+" to "+e),t.Ef=e)},this.ga=function(e){var n=t._f;n!==e&&e&&(t.p.debug("Change screenHeight from "+n+" to "+e),t._f=e)},this.Ia=function(e){var n=t.vf;n!==e&&e&&(t.p.debug("Change scaleFactor from "+n+" to "+e),t.Rf=e)},this.Us=function(){return t.ff},this.pa=function(e){var n=t.ff;n!==e&&e&&(t.p.debug("Change frameworkName from "+n+" to "+e),t.ff=e)},this.Vs=function(){return t.cf},this.Aa=function(e){var n=t.cf;n!==e&&e&&(t.p.debug("Change frameworkVersion from "+n+" to "+e),t.cf=e)},this.ma=function(e){var n;t.Ct.streamUrl||(n=t.On)!==e&&e&&(t.p.debug("Change stream url from "+n+" to "+e),t.On=e)},this.hc=function(){t.ec(),t.kf||(t.ac(),t.Mf=t._e.create(t.ac,t.Uf,"CwsSession.startCdnTimer"),t.p.debug("fetching cdn ip timer started"))},this.ec=function(){t.Mf&&(t.Mf(),t.fc(null,null,null,null,null),t.Mf=null)},this.ac=function(){t.p.debug("detectCDNServerIp(): For "+t.On),t.Vf?t.cc():t.ec()},this.cc=function(){try{var e;"function"==typeof XMLHttpRequest||"object"==typeof XMLHttpRequest?((e=new XMLHttpRequest).open("HEAD",t.On,!0),e.setRequestHeader("Pragma","akamai-x-cache-on"),e.onreadystatechange=function(){4===this.readyState&&(200===this.status&&(this.getAllResponseHeaders().indexOf("x-cache")>=0||this.getAllResponseHeaders().indexOf("X-Cache")>=0)?t.fc("Akamai","header","X-Cache",""+this.getResponseHeader("X-Cache"),""+this.status):t.fc("null","header","null","null",""+this.status))},e.send()):t.p.info("xmlhttpreq is not available here to fetch CDN Server Ip")}catch(e){t.p.info("Exception caught in makeAkamaiHeadRequest")}},this.fc=function(e,n,i,o,a){var s={},r={};t.mf!==e&&(null!==t.mf&&(r[G.Lu]=t.mf),t.mf=e,null===t.mf?s[G.Lu]="null":s[G.Lu]=t.mf),t.Df!==n&&(null!==t.Df&&(r[G.Mu]=t.Df),t.Df=n,null===t.Df?s[G.Mu]="null":s[G.Mu]=t.Df),t.Pf!==i&&(null!==t.Pf&&(r[G.Uu]=t.Pf),t.Pf=i,null===t.Pf?s[G.Uu]="null":s[G.Uu]=t.Pf),t.bf!==o&&(null!==t.bf&&(r[G.Vu]=t.bf),t.bf=o,null===t.bf?s[G.Vu]="null":s[G.Vu]=t.bf),t.Lf!==a&&(null!==t.Lf&&(r[G.ku]=t.Lf),t.Lf=a,null===t.Lf?s[G.ku]="null":s[G.ku]=t.Lf),"{}"!==JSON.stringify(s)&&t.lc(s,r)},this.dc=function(e){var n=t.yn;n!==e&&e>0&&(t.p.info("Change bitrate from "+n+" to "+e),t.vc(n,e),t.yn=e)},this.Ec=function(e){var n=t.Dn;n!==e&&e>0&&(t.p.info("Change Avg bitrate from "+n+" to "+e),t._c(n,e),t.Dn=e)},this.wa=function(e){var n=t.gi;n!==e&&e>=0&&(t.p.info("Change dropped frames total from "+n+" to "+e),t.Rc(n,e),t.gi=e)},this.wo=function(e){var n=t.$a,i=e+(-1===t.$a?0:t.$a);n!==e&&i>=0&&(t.p.info("Change dropped frames count from "+n+" to "+i),t.Ac(n,i),t.$a=i)},this.oa=function(e){var n=t.tf;n!==e&&e&&(t.p.info("Change resource from "+n+" to "+e),t.tf=e)},this.xh=function(e){t._n!==e&&e&&(t.p.info("Change assetName from "+t._n+" to "+e),t._n=e)},this.Vh=function(e){var n=t.Ms;n!==e&&Q.ie(e)&&(t.p.info("Change isLive from "+n+" to "+e),t.Ms=e)},this.Yh=function(e){var n=t.Tn;n!==e&&e&&(t.p.info("Change viewerId from "+n+" to "+e),t.Tn=e)},this.qh=function(e){var n=t.bs;n!==e&&e&&(t.p.info("Change playerName from "+n+" to "+e),t.bs=e)},this.Jh=function(e){var n=t.nf;!Q.Tc(n,e)&&e&&(t.p.info("Change tags from "+Q.Sc(n)+" to "+Q.Sc(e)),t.nf=e)},this.ra=function(e){t.Ct.encodedFrameRate>0||(t.p.debug("setEncodedFrameRate(): "+e),t.wn=e)},this.ia=function(e){t.Ct.duration>0||(t.p.debug("setContentLength(): "+e),t.Ls=e)},this.Xe=function(e){var n;t.Tf||e!==E.PlayerState.PLAYING||(t.Tf=!0,Q.Pt(t.Ct.viewerId)||t.p.error("Missing viewerId. viewerId should be updated before first frame is rendered."),Q.Pt(t.Ct.streamType)&&d.StreamType.UNKNOWN!==t.Ct.streamType||t.p.error("Missing streamType - Live or VOD. streamType should be updated before first frame is rendered."),Q.Pt(t.Ct.applicationName))||t.p.error("Missing applicationName. applicationName should be updated before first frame is rendered."),t.Pn!==e&&(n=t.Pn,t.p.info("setPlayerState(): changing player state from "+n+" to "+e),t.Oc(n,e),t.Pn=e)},this.Nc=function(e){var n=t.Fn;n!==e&&e>0&&(t.p.debug("Change stream resolution width from "+n+" to "+e),t.gc(n,e),t.Fn=e)},this.Ic=function(e){var n=t.Bn;n!==e&&e>0&&(t.p.debug("Change stream resolution height from "+n+" to "+e),t.wc(n,e),t.Bn=e)},this.ba=function(e){var n=t.M;n!==e&&e&&(t.p.debug("Change network connection type from "+n+" to "+e),t.Cc(n,e),t.M=e)},this.La=function(e){var n=t.U;n!==e&&e&&(t.p.debug("Change network link encryption from "+n+" to "+e),t.yc(n,e),t.U=e)},this.ka=function(e){t.kf=!0,t.ec();var n=t.ho;n!==e&&Q.Pt(e)&&(t.p.debug("Change CDN Server IP from "+n+" to "+e),t.mc(n,e),t.ho=e)},this.Ka=function(e){var n=t.jn;n!==e&&Q.Pt(e)&&!t.ys.Dc&&(t.p.info("Change Audio Lang from "+n+" to "+e),t.Pc(n,e),t.jn=e)},this.Wa=function(e){var n=t.Kn;n!==e&&Q.Pt(e)&&!t.ys.bc&&(t.p.info("Change Subtitle Lang from "+n+" to "+e),t.Lc(n,e),t.Kn=e)},this.Ya=function(e){var n=t.Wn;n!==e&&Q.Pt(e)&&!t.ys.Mc&&(t.p.info("Change Closed Caption Lang from "+n+" to "+e),t.Uc(n,e),t.Wn=e)},this.Vc=function(e){var n;t.p.debug("togglePauseJoin()"),t.Af===e?t.p.debug("togglePauseJoin(): same value, ignoring"):(e=t.Af,n=!t.Af,t.kc(e,n),t.Af=!t.Af)},this.Fc=function(e,n){t.Bc(e,n)},this.Hc=function(t,e){var n,i;e[G.sh]=t,e[G.rh]=this.Ps(),e[G.oh]=this.Bf.Gc(),this.Ue&&(n=nt.jc(this.Ue.getPHT(),0,null,-1),i=nt.jc(this.Ue.getBufferLength(),0,null,-1),n>=0&&(e[G.pu]=n),i>0)&&(e[G.Au]=i),this.Bf.Kc(e),this.Ee._&&this.Ee._.Fs(t,e,this)},this.Wc=function(e){t.Ue=e,t.Ue?t.Yc():t.xc()},this.ic=function(){var t=this.Gf.pr(this.qc(),this.Ps());this.Bf.Kc(t)},this.Bc=function(t,e){var n={};n[G.qs]=t,n[G.Js]=e,this.Hc(G.xs,n)},this.vc=function(t,e){var n={},i={};t>0&&(i[G.Ys]=t),n[G.Ys]=e,this.lc(n,i)},this._c=function(t,e){var n={},i={};t>0&&(i[G.cu]=t),n[G.cu]=e,this.lc(n,i)},this.Jc=function(t,e){var n={};n[G.uh]=t,e>=0&&(n[G.hh]=e),this.Hc(G.yr,n)},this.gc=function(t,e){var n={},i={};-1!==t&&(i[G.Nu]=t),n[G.Nu]=e,this.lc(n,i)},this.wc=function(t,e){var n={},i={};-1!==t&&(i[G.gu]=t),n[G.gu]=e,this.lc(n,i)},this.Cc=function(t,e){var n={},i={};null!==t&&(i[G.Iu]=t),n[G.Iu]=e,this.lc(n,i)},this.yc=function(t,e){var n={},i={};null!==t&&(i[G.wu]=t),n[G.wu]=e,this.lc(n,i)},this.mc=function(t,e){var n={},i={};Q.Pt(t)&&(i[G._h]=t),n[G._h]=e,this.lc(n,i)},this.Rc=function(t,e){var n={},i={};t>=0&&(i[G.Cu]=t),n[G.Cu]=e,this.lc(n,i)},this.Ac=function(t,e){var n={},i={};t>=0&&(i[G.yu]=t),n[G.yu]=e,this.lc(n,i)},this.Pc=function(t,e){var n={},i={};t!==e&&("string"==typeof t&&(i[G.mu]=t),n[G.mu]=e),this.lc(n,i)},this.Lc=function(t,e){var n={},i={};t!==e&&("string"==typeof t&&(i[G.Du]=t),n[G.Du]=e),this.lc(n,i)},this.Uc=function(t,e){var n={},i={};t!==e&&("string"==typeof t&&(i[G.Pu]=t),n[G.Pu]=e),this.lc(n,i)},this.kc=function(t,e){var n={},i={};i[G.fu]=t,n[G.fu]=e,this.lc(n,i)},this.Oc=function(t,e){var n={},i={};n[G.Gs]=G.Rh(e),i[G.Gs]=G.Rh(t),this.lc(n,i)},this.lc=function(t,e){var n={};n[G.Hs]=t,e&&Q.Ht(e)>0&&(n[G.ah]=e),this.Hc(G.Bs,n)},this.Xc=function(t,e){var n={};n[G.Qs]=t,Q.Ht(e)>0&&(n[G.Zs]=e),this.Hc(G.Xs,n)},this.sc=function(){t.qa&&(t.qa(),t.qa=null)},this.uc=function(){t.sc();var e=1e3*t.Vi.heartbeatInterval;t.qa=t._e.create(t.oc,e,"Session.sendHeartbeat:"+this.xf)},this.xc=function(){t.Nf&&(t.Nf(),t.Nf=null)},this.Yc=function(){t.xc(),t.Nf=t._e.create(t.Qc,t.gf,"Session.startRfpsTimer")},this.Zc=function(){var e={err:"pending"};e.seq=t.Ja-1,e.sentAt=t.Ps(),e.rtt=-1,t.Za.push(e);for(var n=0;n<t.Za.length;n++)"ok"===(e=t.Za[n]).err&&(t.Za.splice(n,1),n--)},this.zc=function(e,n){for(var i=0;i<t.Za.length;i++){var o=t.Za[i];o.seq===e&&(o.rtt=t.Ps()-o.sentAt,o.err=n)}},this.$c=function(e){for(var n=0;n<t.Za.length;n++){var i=t.Za[n];i.seq===e&&(i.rtt=t.Ps()-i.sentAt,i.err="ok")}},this.tl=function(){for(var e,n,i=t.Kf.get(X.nl),o=[],a=-1,s=0;s<t.Za.length;s++)if("ok"===(n=t.Za[s]).err){a=n.seq;break}for(var r=0;r<t.Za.length;r++)((e=(n=t.Za[r]).seq)<t.Ja-i||e<a)&&o.push(r);for(var l=[],u=0;u<t.Za.length;u++)e=(n=t.Za[u]).seq,o.indexOf(u)<0&&l.push(t.Za[u]);t.Za=l},this.il=function(){t.tl();for(var e=[],n=0;n<t.Za.length;n++){var i=t.Za[n],o={};o[G.fh]=i.seq,o[G.dh]=i.rtt,o[G.lh]=i.err,e.push(o)}return e},this.el=function(){var e,n=-1,i=-1,o=t.Bf.Wf();if(t.ks()&&0===o.length)return null;var a=new B,s=(a.Lh(G.jr),a.Fh(t.Vi.customerKey),a.Bh(t.Kf.get(X.B)),a.Kh(t.ys.C),a.kh(t.Ja),a.Gh(G.version),c.version);if(t.ki&&(s=t.ki),a.Hh(s),a.Wh(t.Ee.C),a.jh(0),t.Ee.M?a.ba(t.Ee.M):t.M&&a.ba(t.M),t.Ee.U?a.La(t.Ee.U):t.U&&a.La(t.U),Q.Pt(t.ho)&&a.ka(t.ho),a.fa(G.Cr),t.if&&a.ca(t.if),t.ef&&a.la(t.ef),t.sf&&a.da(t.sf),t.rf&&a.va(t.rf),t.uf&&a.Ea(t.uf),t.hf&&a._a(t.hf),t.af&&a.Ra(t.af),t.lf&&a.Ta(t.lf),t.df&&a.Sa(t.df),t.vf&&a.Oa(t.vf),t.ff&&a.pa(t.ff),t.cf&&a.Aa(t.cf),t.Ef&&!isNaN(t.Ef)&&a.Na(parseInt(t.Ef,10)),t._f&&!isNaN(t._f)&&a.ga(parseInt(t._f,10)),t.Rf&&!isNaN(t.Rf)?a.Ia(parseFloat(t.Rf)):(t.Ef&&!isNaN(t.Ef)||t._f&&!isNaN(t._f))&&a.Ia(1),t.Ue&&(t.Vn=t.Ue.zn(),t.Vn&&a.setModuleName(t.Vn),t.kn=t.Ue.$n(),t.kn&&a.Va(t.kn),t.Ue.ti()&&(t.ff=t.Ue.ti(),a.pa(t.ff)),t.Ue.ii())&&(t.cf=t.Ue.ii(),a.Aa(t.cf)),t.Tn&&a.Yh(t.Tn),Q.Ht(t.nf)>0&&a.Jh(t.nf),t.Cs()||t.qf()){if(t.qf()&&a.Ma(),t._n&&a.xh(t._n),a.Xh(t.Xa),s=G.Rh(t.Pn),a.Xe(s),a.na(t.Af),t.bs&&a.qh(t.bs),Q.ie(t.Ms)&&a.Vh(t.Ms),t.Ls>0&&a.ia(t.Ls),t.yn>0&&a.ea(t.yn),t.Dn>0&&a.sa(t.Dn),null!==t.tf&&a.oa(t.tf),t.wn>0&&a.ra(t.wn),t.Ue&&(n=nt.jc(t.Ue.getPHT(),0,null,-1),i=nt.jc(t.Ue.getBufferLength(),0,null,-1)),Q.gt(t.Ee.V)?e=t.Ee.V:t.Ue&&(e=t.Ue.getSignalStrength()),n>=0&&a.Ca(n),i>0&&a.ya(i),(s=t.sl())>0&&a.ua(s),t.wf>0&&a.aa(nt.jc(t.wf,0,null,-1)),t.If>0&&a.ha(nt.jc(t.If,0,null,-1)),e!==E.DEFAULT_SIGNAL_STRENGTH&&a.Ua(e),t.On&&a.ma(t.On),t.Fn>0&&a.Da(t.Fn),t.Bn>0&&a.Pa(t.Bn),t.gi>-1&&a.wa(t.gi),t.$a>-1&&(a.wo(t.$a),t.$a>0)&&(t.Ac(t.$a,0),t.$a=0),t.jn&&a.Ka(t.jn),t.Kn&&a.Wa(t.Kn),t.Wn&&a.Ya(t.Wn),void 0!==t.pf)for(var r in t.pf)a.Ph(r,t.pf[r])}else a.Xh(G.Sh.Oh);return o.length>0&&a.Zh(o),a.Qh(t.Qa),a.zh(!0),t.Kf.get(X.ol)&&a.$h(t.Fi.Wf()),t.Kf.get(X.nl)>0&&(n=t.il()).length>0&&a.ta(n),0===t.Ja&&(a=t.rl(a)),(a=0!==t.Ja?t.ul(a):a).Uh(t.Ds),a.Mh(t.Ps()),t.Vf&&(a.Fa(t.mf),a.Ba(t.Df),a.Ha(t.Pf),a.Ga(t.bf),a.ja(t.Lf)),t.Ja++,a.get()},this.ul=function(e){var n,i=t.D,o={};for(n in e.Dh.tags)Object.prototype.hasOwnProperty.call(i,n)||(o[n]=e.Dh.tags[n]);e.Dh.tags=o,t.D={};for(var a=0;a<t.Cf.length;a++)Object.prototype.hasOwnProperty.call(t.Ee.D,t.Cf[a])?Object.prototype.hasOwnProperty.call(t.Ee.L,t.Cf[a])?t.Ee.L[t.Cf[a]]===X.$t.tn?(t.D[X.hl+""+t.Cf[a]]=X.$t.tn,t.Ee.P("End-user chose to opt-out of personal data collection")):t.Ee.L[t.Cf[a]]===X.$t.en?(t.D[X.hl+""+t.Cf[a]]=X.$t.en,t.Ee.P("End-user chose to opt-out of personal data collection")):t.Ee.L[t.Cf[a]]===X.$t.zt?(t.D[X.hl+""+t.Cf[a]]=X.$t.zt,t.Ee.P("End-user used privacy settings and chose to opt-out of personal data collection")):(t.D[X.hl+""+t.Cf[a]]=t.Ee.D[t.Cf[a]],t.Ee.P("Data collection successful")):(t.D[X.hl+""+t.Cf[a]]=t.Ee.D[t.Cf[a]],t.Ee.P("Data collection successful")):t.D[X.hl+""+t.Cf[a]]=X.$t.al;var s,r={};for(s in i){var l=s.split(".");"{}"!==JSON.stringify(t.Cf)&&-1!==t.Cf.indexOf(""+l[2])||i[X.hl+""+l[2]]===X.$t.fl||(t.Ee.P("Data collection restricted from Conviva back-end"),t.D[X.hl+""+l[2]]=X.$t.fl,r[X.hl+""+l[2]]=X.$t.fl)}if("{}"!==JSON.stringify(t.D)){var u,c=Q.ll(t.D);for(u in e.Dh.tags)c[u]=e.Dh.tags[u];if(e.Dh.tags=c,!Q.Tc(i,t.D)){var h={};if("{}"!==JSON.stringify(r)&&(h[G.su]=r),"{}"!==JSON.stringify(i)){for(var f in i)t.D[f]&&i[f]!==t.D[f]&&(h[G.su]||(h[G.su]={}),h[G.su][f]=t.D[f]);for(var d in t.D)Object.prototype.hasOwnProperty.call(i,d)&&i[d]===t.D[d]||(h[G.su]||(h[G.su]={}),h[G.su][d]=t.D[d])}"{}"===JSON.stringify(i)&&(h[G.su]=t.D);var E,v,g={};g[G.Hs]=h,g[G.sh]=G.Bs,g[G.rh]=t.Ps(),g[G.oh]=t.Bf.Gc(),t.Ue&&(E=nt.jc(t.Ue.getPHT(),0,null,-1),v=nt.jc(t.Ue.getBufferLength(),0,null,-1),E>=0&&(g[G.pu]=E),v>0)&&(g[G.Au]=v),e.Dh.evs||(e.Dh.evs=[]),e.Dh.evs.push(g)}}return e},this.rl=function(e){var n=t.dl();if("{}"!==JSON.stringify(n)){var i,o=Q.ll(n);for(i in e.Dh.tags)o[i]=e.Dh.tags[i];e.Dh.tags=o;var a,s={};(n=(s[G.su]=n,{}))[G.Hs]=s,n[G.sh]=G.Bs,n[G.rh]=t.Ps(),n[G.oh]=t.Bf.Gc(),t.Ue&&(s=nt.jc(t.Ue.getPHT(),0,null,-1),a=nt.jc(t.Ue.getBufferLength(),0,null,-1),s>=0&&(n[G.pu]=s),a>0)&&(n[G.Au]=a),e.Dh.evs||(e.Dh.evs=[]),e.Dh.evs.push(n)}return e},this.dl=function(){var e={};if("undefined"!=typeof navigator&&navigator){if(e["c3.fp.cookie"]=void 0!==navigator.cookieEnabled&&navigator.cookieEnabled?""+navigator.cookieEnabled:"",e["c3.fp.memory"]=void 0!==navigator.deviceMemory&&navigator.deviceMemory?""+navigator.deviceMemory:"",e["c3.fp.hwConc"]=void 0!==navigator.hardwareConcurrency&&navigator.hardwareConcurrency?""+navigator.hardwareConcurrency:"",e["c3.fp.java"]=""+("function"!=typeof navigator.javaEnabled)?"false":navigator.javaEnabled(),e["c3.fp.lang"]=void 0!==navigator.language&&navigator.language?""+navigator.language:"",e["c3.fp.langs"]=void 0!==navigator.languages&&navigator.languages&&navigator.languages.length>0?""+navigator.languages.toString():"",e["c3.fp.maxTp"]=void 0!==navigator.maxTouchPoints&&navigator.maxTouchPoints?""+navigator.maxTouchPoints:"",e["c3.fp.plugins"]="",void 0!==navigator.plugins&&navigator.plugins&&navigator.plugins.length>0)for(var n=0;n<navigator.plugins.length;n++)e["c3.fp.plugins"]+=navigator.plugins[n].name+",";if(e["c3.fp.mime"]="",void 0!==navigator.mimeTypes&&navigator.mimeTypes&&navigator.mimeTypes.length>0)for(var i=0;i<navigator.mimeTypes.length;i++)e["c3.fp.mime"]+=navigator.mimeTypes[i].type+",";e["c3.fp.sysLang"]=void 0!==navigator.systemLanguage&&navigator.systemLanguage?""+navigator.systemLanguage:"",e["c3.fp.platform"]=void 0!==navigator.platform&&navigator.platform?""+navigator.platform:"",e["c3.fp.product"]=void 0!==navigator.product&&navigator.product?""+navigator.product:"",e["c3.fp.productSub"]=void 0!==navigator.productSub&&navigator.productSub?""+navigator.productSub:"",e["c3.fp.vendor"]=void 0!==navigator.vendor&&navigator.vendor?""+navigator.vendor:"",e["c3.fp.vendorSub"]=void 0!==navigator.vendorSub&&navigator.vendorSub?""+navigator.vendorSub:"";var o=t.vl();""!==o&&(e["c3.fp.canvFp"]=o)}return"undefined"!=typeof window&&window&&(void 0!==window.screen&&window.screen&&(e["c3.fp.availHeight"]=void 0!==window.screen.availHeight&&window.screen.availHeight?""+window.screen.availHeight:"",e["c3.fp.availWidth"]=void 0!==window.screen.availWidth&&window.screen.availWidth?""+window.screen.availWidth:"",e["c3.fp.height"]=void 0!==window.screen.height&&window.screen.height?""+window.screen.height:"",e["c3.fp.width"]=void 0!==window.screen.width&&window.screen.width?""+window.screen.width:"",e["c3.fp.colorDepth"]=void 0!==window.screen.colorDepth&&window.screen.colorDepth?""+window.screen.colorDepth:"",e["c3.fp.deviceXDPI"]=void 0!==window.screen.deviceXDPI&&window.screen.deviceXDPI?""+window.screen.deviceXDPI:"",e["c3.fp.deviceYDPI"]=void 0!==window.screen.deviceYDPI&&window.screen.deviceYDPI?""+window.screen.deviceYDPI:""),e["c3.fp.dpi"]=void 0!==window.devicePixelRatio&&window.devicePixelRatio?""+window.devicePixelRatio:"",e["c3.fp.secure"]="boolean"==typeof window.isSecureContext?""+window.isSecureContext:""),e},this.vl=function(){try{if("undefined"!=typeof document&&document){var t,e,n=document.createElement("CANVAS");if(void 0!==n&&n&&"function"==typeof n.getContext)return t=n.getContext("2d"),e="conviva",t.textBaseline="top",t.font="14px Arial",t.textBaseline="alphabetic",t.fillStyle="#f40",t.fillRect(void 0!==navigator.plugins&&navigator.plugins?navigator.plugins.length:0,void 0!==navigator.mimeTypes&&navigator.mimeTypes?navigator.mimeTypes.length:0,void 0!==navigator.product&&navigator.product?navigator.product.length:0,void 0!==navigator.vendor&&navigator.vendor?navigator.vendor.length:0),t.fillStyle="#069",t.fillText(e,void 0!==navigator.maxTouchPoints&&navigator.maxTouchPoints>=0?navigator.maxTouchPoints:0,void 0!==navigator.product&&navigator.product?navigator.product.length:0),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText(e,void 0!==navigator.deviceMemory&&navigator.deviceMemory?navigator.deviceMemory:0,void 0!==navigator.hardwareConcurrency&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:0),Y._r(n.toDataURL())}return""}catch(t){return""}},this.oc=function(){var e;t.Sf||(e=t.el())&&t.El(e)},this.Qc=function(){var e;t.Pn===E.PlayerState.PLAYING&&t.Ue&&(e=t.Ue.getRenderedFrameRate())>0&&(t.wf+=e,t.If++)},this.sl=function(){return t.wf>0&&t.If>0||(this.Qc(),t.wf>0&&t.If>0)?Q._l.Cast(+t.wf/t.If):E.DEFAULT_RENDERED_FRAME_RATE},this.El=function(e){t.Zc();var n=t.Ja-1;t.p.info("postHeartbeat(): Send HB["+n+"]"+t.Jf()),t.Hf.Rl(e,(function(e,i){t.pl(e,i,n)}))},this.pl=function(e,n,i){t.Sf||t.g.F("onHeartbeatResponse",(function(){var o,a;e?n?(t.p.debug("onHeartbeatResponse(): received valid response for HB["+i+"]"),t.$c(i),(o=n[G.Lr])&&o!==(a=t.Kf.get(X.B))&&(t.p.debug("onHeartbeatResponse(): setting the client id to "+o+" (from gateway)"),t.Kf.set(X.B,o),t.Kf.Al(),a===G.H)&&o!==G.H&&t.Ee.k(),(a=n[G.Pr])&&a!==G.Dr&&t.p.error("onHeartbeatResponse(): error from gateway: "+a),"object"==typeof(o=n[G.Mr])&&((a=o[G.Vr])>=0&&t.Kf.get(X.nl)!==a&&(t.p.debug("onHeartbeatResponse(): setting Maximum Heartbeat Infos to "+a+" (from gateway)"),t.Kf.set(X.nl,a)),a=o[G.kr],(a=!!Q.ie(a)&&a)!==t.Kf.get(X.ol)&&(t.p.debug("onHeartbeatResponse(): turning "+(a?"on":"off")+" sending of logs"),t.Kf.set(X.ol,a)),a=o[G.Fr],Q.gt(a)&&(a=Q._l.Cast(a))!==t.Vi.heartbeatInterval&&(t.p.debug("onHeartbeatResponse(): received hbIntervalMs from gateway: "+a),t.Vi.heartbeatInterval=a,t.qa)&&t.uc(),(a=o[G.Br])&&a!==t.Vi.gatewayUrl&&(t.p.debug("onHeartbeatResponse(): received gatewayUrl from gateway: "+a),t.Vi.gatewayUrl=a),t.Tl()||(t.Cf={},(a=o[G.Hr])&&(t.yf||(t.yf=!0),t.p.debug("onHeartbeatResponse(): received fp from gateway: "+a),t.Cf=a.split(",")),t.Vf=o[G.Gr],Q.ie(t.Vf)&&(t.Vf?(t.p.debug("onHeartbeatResponse(): enabling the CDN Server IP collection"),t.Mf||t.hc()):t.ec())))):t.p.warning("onHeartbeatResponse(): decoded heartbeat response is null."):(Q.Pt(a=n)?Q.Sl(a,"HTTP timeout")?t.p.warning("onHeartbeatResponse(): "+a):t.p.error("onHeartbeatResponse(): failed to send heartbeat: "+a):(a=x.Ol,t.p.error("onHeartbeatResponse(): "+a)),t.zc(i,a))}))},this.Ps=function(){return Q._l.Cast(t.jf.current()-t.Ds)},this.qc=function(){return this.Bf.Gc()},this.Jf=function(){return this.ks()?" (global session)":""},this.ks=function(){return this.xf===W.Nt.Oh},this.Tl=function(){return this.xf===W.Nt.Oh&&"T"===this.nf["c3.IPV4IPV6GlobalSession"]},this.Cs=function(){return this.xf===W.Nt.Ot},this.qf=function(){return this.xf===W.Nt.Dt},this.Lt=function(e){t.Nl(e),t.Zf()},this.Nl=function(e){var n={},i={};if(Q.Pt(e.assetName)&&!t.ys.gl&&(t.Ct.assetName!==e.assetName?(t.Ct.assetName&&(n[G.iu]=t.Ct.assetName),i[G.iu]=e.assetName,t.Ct.assetName=e.assetName):t.p.warning("mergeContentMetadata(): assetName was not changed.")),Q.Pt(e.applicationName)&&(t.Ct.applicationName!==e.applicationName?(t.Ct.applicationName&&(n[G.eu]=t.Ct.applicationName),i[G.eu]=e.applicationName,t.Ct.applicationName=e.applicationName):t.p.warning("mergeContentMetadata(): applicationName was not changed.")),Q.Pt(e.streamUrl)&&!t.ys.Il&&(t.Ct.streamUrl!==e.streamUrl?(t.Ct.streamUrl&&(n[G.Tu]=t.Ct.streamUrl),i[G.Tu]=e.streamUrl,t.Ct.streamUrl=e.streamUrl,t.On=t.Ct.streamUrl):t.p.warning("mergeContentMetadata(): streamUrl was not changed.")),Q.Pt(e.viewerId)&&(t.Ct.viewerId!==e.viewerId?(t.Ct.viewerId&&(n[G.nu]=t.Ct.viewerId),i[G.nu]=e.viewerId,t.Ct.viewerId=e.viewerId):t.p.warning("mergeContentMetadata(): viewerId was not changed.")),Q.Pt(e.defaultResource)&&!t.ys.wl&&(t.Ct.defaultResource!==e.defaultResource?(t.Ct.defaultResource&&(n[G.Ru]=t.Ct.defaultResource),i[G.Ru]=e.defaultResource,t.Ct.defaultResource=e.defaultResource):t.p.warning("mergeContentMetadata(): defaultResource was not changed.")),Q.gt(e.duration)&&e.duration>0&&!t.ys.Cl&&(t.Ct.duration!==e.duration?(t.Ls>0&&(n[G.lu]=t.Ls),i[G.lu]=e.duration,t.Ct.duration=e.duration,t.Ls=t.Ct.duration):t.p.warning("mergeContentMetadata(): duration was not changed.")),Q.gt(e.encodedFrameRate)&&e.encodedFrameRate>0&&!t.ys.yl&&(t.Ct.encodedFrameRate!==e.encodedFrameRate?(t.Ct.encodedFrameRate>-1&&(n[G.du]=t.Ct.encodedFrameRate),i[G.du]=e.encodedFrameRate,t.Ct.encodedFrameRate=e.encodedFrameRate,t.wn=t.Ct.encodedFrameRate):t.p.warning("mergeContentMetadata(): encodedFrameRate was not changed.")),e.streamType!==d.StreamType.UNKNOWN&&(t.Ct.streamType!==e.streamType?(t.Ct.streamType!==d.StreamType.UNKNOWN&&(t.Ct.streamType===d.StreamType.LIVE?n[G.qr]=!0:n[G.qr]=!1),e.streamType===d.StreamType.LIVE?i[G.qr]=!0:i[G.qr]=!1,t.Ct.streamType=e.streamType):t.p.warning("mergeContentMetadata(): streamType was not changed.")),Q.Ht(e.custom)>0){var o,a={},s={};for(o in e.custom)t.Ct.custom[o]!==e.custom[o]?(a[o]=e.custom[o],t.Ct.custom[o]&&(s[o]=t.Ct.custom[o]),t.Ct.custom[o]=e.custom[o]):t.p.info("mergeContentMetadata(): custom."+o+" was not changed.");Q.Ht(a)>0?(Q.Ht(s)>0&&(n[G.su]=s),i[G.su]=a):t.p.warning("mergeContentMetadata(): custom was not changed.")}Q.Ht(i)>0&&this.lc(i,n)},this.Zf=function(){var e;t.p.debug("setStatesFromContentMetadata()"),t.Ct.defaultResource&&this.oa(t.Ct.defaultResource),t.Ct.streamUrl&&this.ma(t.Ct.streamUrl),t.Ct.duration>0&&this.ia(t.Ct.duration),t.Ct.encodedFrameRate>0&&this.ra(t.Ct.encodedFrameRate),t.Ct.streamType!==d.StreamType.UNKNOWN&&(e=t.Ct.streamType===d.StreamType.LIVE,this.Vh(e)),t.Ct.assetName&&this.xh(t.Ct.assetName),t.Ct.viewerId&&this.Yh(t.Ct.viewerId),(t.Ct.applicationName||t.Ct.playerName)&&this.qh(t.Ct.applicationName||t.Ct.playerName),Q.Ht(t.Ct.custom)>0&&this.Jh(t.Ct.custom)},this.zf=function(){var e={};if(this.ks()||(t.Ct.assetName?e[G.iu]=t.Ct.assetName:t.p.warning("enqueueEventForContentMetadata(): assetName was not set."),t.Ct.applicationName?e[G.eu]=t.Ct.applicationName:t.p.warning("enqueueEventForContentMetadata(): applicationName was not set."),t.Ct.streamUrl?e[G.Tu]=t.Ct.streamUrl:t.p.warning("enqueueEventForContentMetadata(): streamUrl was not set."),t.Ct.viewerId?e[G.nu]=t.Ct.viewerId:t.p.warning("enqueueEventForContentMetadata(): viewerId was not set."),t.Ct.defaultResource?e[G.Ru]=t.Ct.defaultResource:t.p.warning("enqueueEventForContentMetadata(): defaultResource was not set."),t.Ct.duration>-1?e[G.lu]=t.Ct.duration:t.p.warning("enqueueEventForContentMetadata(): duration was not set."),t.Ct.encodedFrameRate>-1?e[G.du]=t.Ct.encodedFrameRate:t.p.warning("enqueueEventForContentMetadata(): encodedFrameRate was not set."),t.Ct.streamType!==d.StreamType.UNKNOWN?t.Ct.streamType===d.StreamType.LIVE?e[G.qr]=!0:e[G.qr]=!1:t.p.warning("enqueueEventForContentMetadata(): streamType was not set.")),Q.Ht(t.Ct.custom)>0)for(var n in e[G.su]={},t.Ct.custom)e[G.su][n]=t.Ct.custom[n];else this.ks()||t.p.warning("enqueueEventForContentMetadata(): custom tags were not set.");Q.Ht(e)>0&&this.lc(e,null)},this.tc=function(){t.Ct&&Q.Pt(t.Ct.assetName)||t.p.warning("Missing assetName during session creation"),t.Ct&&Q.Pt(t.Ct.defaultResource)||t.p.warning("Missing resource during session creation"),t.Ct&&Q.Pt(t.Ct.streamUrl)||t.p.warning("Missing streamUrl during session creation"),(!t.Ct||t.Ct.encodedFrameRate<=0)&&t.p.warning("Missing encodedFrameRate during session creation"),t.Ct&&Q.Pt(t.Ct.viewerId)||t.p.warning("Missing viewerId during session creation"),t.Ct&&t.Ct.streamType&&d.StreamType.UNKNOWN!==t.Ct.streamType||t.p.warning("Missing streamType during session creation"),t.Ct&&Q.Pt(t.Ct.applicationName)||t.p.warning("Missing applicationName during session creation"),(!t.Ct||t.Ct.duration<=0)&&t.p.warning("Missing duration during session creation")},this.Zt=function(e,n){t.pf||(t.pf={}),t.pf[e]=n},this.$f=function(){var e={};t.Ee.M&&(e[G.Iu]=t.Ee.M,t.M=t.Ee.M),t.Ee.U&&(e[G.wu]=t.Ee.U,t.U=t.Ee.U),Q.Ht(e)>0&&this.lc(e,null)}}).xa=G.Sh.Ot+G.Sh.Nh+G.Sh.gh,W.Nt={Ot:"Video",Oh:"Global",Dt:"Ad"},(x=ut.Session=function(){var t=this;t.Ue=null,t.C=0,t.xf=W.Nt.Ot,t.ml=!1,t.Sf=!1,t.Dl=!1,t.Pl=null,t.Re=null,t.bl=null,t.Ll=!1,t.Ml=E.PlayerState.NOT_MONITORED,t.Ul=!1,t.Vl=!1,t.kl=!1,t.yl=!1,t.Fl=!1,t.bc=!1,t.Mc=!1,t.Dc=!1,t.gl=!1,t.Il=!1,t.Bl=!1,t.Cl=!1,t.wl=!1,t.Hl=!1,function(t,e,n,i,o,a,s){this.C=t,this.xf=e,this.Kf=n,this.Gl=i,this.wt=o,this.g=a,this.p=s}.apply(t,arguments),this.Yf=function(e,n){t.wt.Yf(this),e&&t.Vt(e),t.Kf.jl()?t.Kl(n):t.Kf.Wl((function(){t.Kl(n)}))},this.cleanup=function(){t.ml=!0,t.wt.Xf(),t.Kf.jl()?t.Yl():t.Kf.Wl((function(){t.Yl()}))},this.xl=function(){(t.Cs()||t.qf())&&t.Ue&&t.ql(),t.g=null,t.Ee=null,t.Kf=null,t.Gl=null,t.wt.Tt(),t.wt=null,t.Sf=!0},this.Yl=function(){t.wt.nc(),t.xl()},this.Kl=function(e){t.wt.Qf(),t.Jl(),e?(t.bt(e.nr(),e.ir()),t.wt.Xe(E.PlayerState.STOPPED),t.wt.nc(),t.xl()):t.wt.rc()},this.Jl=function(){var e,n=t.Gl.get();(e=((e=((e=((e=((e=((e=((e=((e=((e=((e=((e=((e=((e=((e=((e=n[st.BROWSER_NAME])&&t.wt.ca(e),n[st.BROWSER_VERSION]))&&t.wt.la(e),n[st.DEVICE_BRAND]))&&t.wt.da(e),n[st.DEVICE_MANUFACTURER]))&&t.wt.va(e),n[st.DEVICE_MODEL]))&&t.wt.Ea(e),n[st.DEVICE_TYPE]))&&t.wt._a(e),n[st.DEVICE_VERSION]))&&t.wt.Ra(e),n[st.FRAMEWORK_NAME]))&&t.wt.pa(e),n[st.FRAMEWORK_VERSION]))&&t.wt.Aa(e),n[st.OPERATING_SYSTEM_NAME]))&&t.wt.Ta(e),n[st.OPERATING_SYSTEM_VERSION]))&&t.wt.Sa(e),n[st.DEVICE_CATEGORY]))&&t.wt.Oa(e),n[st.SCREEN_WIDTH]))&&t.wt.Na(e),n[st.SCREEN_HEIGHT]))&&t.wt.ga(e),n[st.SCALE_FACTOR]))&&t.wt.Ia(e)},this.Ei=function(e){t.wt.Pn===e||(t.wt.Pn===E.PlayerState.NOT_MONITORED&&e!==E.PlayerState.NOT_MONITORED&&(t.Ml=e),t.Ll)||t.wt.Xe(e)},this._i=function(e){t.Ul||t.wt.dc(e)},this.Ri=function(e){t.Ul||t.wt.Ec(e)},this.Ii=function(e){t.Vl||t.wt.wa(e)},this.wi=function(e){t.Vl||t.wt.wo(e)},this.pi=function(e,n){!Q.gt(n)&&t.Hl&&(n=-1),t.wt.Jc(e,n)},this.qn=function(e){e>0&&(t.yl||t.wt.ra(e))},this.Qn=function(e){e>0&&(t.Cl||t.wt.ia(e))},this.Zn=function(e){t.wt.ma(e)},this.Ai=function(e){t.wt.Nc(e)},this.Ti=function(e){t.wt.Ic(e)},this.nt=function(e){t.wt.ba(e)},this.et=function(e){t.wt.La(e)},this.ni=function(e){t.wt.Us()||t.wt.pa(e)},this.ei=function(e){t.wt.Vs()||t.wt.Aa(e)},this.Oi=function(e){t.wt.ka(e)},this.oi=function(e){t.wt.Ka(e)},this.ui=function(e){t.wt.Wa(e)},this.ai=function(e){t.wt.Ya(e)},this.Si=function(e,n){t.bt(e,n)},this.Yn=function(){t.ql()},this.Wt=function(e,n,i){t.Dl||(t.Dl=!0,t.Pl=e,t.Re=n,t.bl=i,t.wt.Vc(!0),t.Pl===h.AdStream.CONTENT||t.Re===h.AdPlayer.SEPARATE?(t.wt.Pn!==E.PlayerState.NOT_MONITORED&&(t.Ml=t.wt.Pn),t.wt.Xe(E.PlayerState.NOT_MONITORED),t.Ll=!0):t.Pl===h.AdStream.SEPARATE&&t.Re===h.AdPlayer.CONTENT&&(t.wt.Pn!==E.PlayerState.NOT_MONITORED&&(t.Ml=t.wt.Pn),t.wt.Xe(E.PlayerState.NOT_MONITORED),t.Ll=!0,t.Ul=!0,t.Vl=!0,t.yl=!0,t.kl=!0,t.bc=!0,t.Mc=!0,t.Dc=!0,t.gl=!0,t.Il=!0,t.Bl=!0,t.Cl=!0,t.wl=!0,t.Hl=!0))},this.Yt=function(){t.Dl&&(t.wt.Vc(!1),t.Pl===h.AdStream.CONTENT||t.Re===h.AdPlayer.SEPARATE?t.Xl||(t.Ll=!1,t.wt.Xe(t.Ml)):t.Pl===h.AdStream.SEPARATE&&t.Re===h.AdPlayer.CONTENT&&(t.Ul=!1,t.Vl=!1,t.yl=!1,t.kl=!1,t.Fl=!1,t.Xl||(t.Ll=!1,t.wt.Xe(t.Ml)),t.bc=!1,t.Mc=!1,t.Dc=!1,t.gl=!1,t.Il=!1,t.Bl=!1,t.Cl=!1,t.wl=!1,t.Hl=!1),t.Dl=!1,t.Pl=t.Re=t.bl=null)},this.Mt=function(){t.Ue&&t.Ue&&(t.g.F("Session.detachPlayer",(function(){t.Ue.xn()})),t.Ue=null,t.wt.Wc(null),t.wt.Xe(E.PlayerState.NOT_MONITORED))},this.ql=function(){t.Ue&&(t.g.F("Session.releasePlayerStateManager",(function(){t.Ue.xn()})),t.Ue=null,t.wt.Wc(null),t.wt.Xe(E.PlayerState.NOT_MONITORED))},this.Ut=function(){t.wt.Vc(!0),t.wt.Pn!==E.PlayerState.NOT_MONITORED&&(t.Ml=t.wt.Pn),t.wt.Xe(E.PlayerState.NOT_MONITORED),t.Ll=!0},this.Vt=function(e){t.Ue||e instanceof E&&t.g.F("Session.attachPlayer()",(function(){e.setMonitoringNotifier(t,t.C)&&(e.fi(),t.Ue=e,t.wt.Wc(t.Ue))}))},this.kt=function(){t.wt.Vc(!1),t.Ul=!1,t.Vl=!1,t.Ql=!1,t.kl=!1,t.Fl=!1,t.bc=!1,t.Mc=!1,t.Dc=!1,t.gl=!1,t.Il=!1,t.Bl=!1,t.Cl=!1,t.wl=!1,t.Hl=!1,t.Xl||(t.Ll=!1,t.Ml!==E.PlayerState.NOT_MONITORED&&t.wt.Xe(t.Ml))},this.qt=function(){return t.Ue},this.Ft=function(){t.Xl||(t.Xl=!0,t.Ll=!0)},this.Bt=function(){t.Xl&&(t.Xl=!1,t.Dl||(t.Ll=!1,t.Ml!==E.PlayerState.NOT_MONITORED&&t.wt.Xe(t.Ml)))},this.bt=function(e,n){!Q.Pt(e)||n!==h.ErrorSeverity.FATAL&&n!==h.ErrorSeverity.WARNING||t.Fl||(n=n===h.ErrorSeverity.FATAL,t.wt.Fc(e,n))},this.Lt=function(e){t.g.F("Session.updateContentMetadata",(function(){t.wt.Lt(e)}))},this.Kt=function(e,n){t.wt.Xc(e,n)},this.ks=function(){return t.xf===W.Nt.Oh},this.Cs=function(){return t.xf===W.Nt.Ot},this.qf=function(){return t.xf===W.Nt.Dt},this.Jf=function(){return t.ks()?" (global session)":""},this.Xt=function(){return this.C},this.Qt=function(){var e=null;return t.Kf.jl()?t.Kf.get(X.B):e},this.Zt=function(e,n){t.wt.Zt(e,n)}}).Ol="received no response (or a bad response) to heartbeat POST request",q=ut.SessionFactory=function(){var t=this;t.Fi=null,t.Zl=0,t.zl=null,function(e,n,i,o){t.Ee=e,t.Vi=n,t.Kf=i,t.T=o,t.Zl=0,t.zl={}}.apply(t,arguments),this.Tt=function(){for(var e in t.Fi=null,t.zl)t.zl[e].cleanup();t.zl=null,t.Zl=0},this.$l=function(){var e=t.Zl;return t.Zl++,e},this.St=function(e,n,i,o,a){return e||(e=new d),t.td(e,n,i,o,a)},this.Y=function(e){return t.td(e,W.Nt.Oh,void 0,c.version)},this.nd=function(){return et.ed()},this.td=function(e,n,i,o,a){return n=t.T.Zi(t.Ee,t.Vi,t.Kf,t.nd(),n,e.ct(),o),e=t.$l(),void 0!==a&&void 0!==a.error?n.Yf(i,a.error):(t.sd(e,n),n.Yf(i)),e},this.jt=function(e){return e=t.zl[e]},this.It=function(t){return!(t=this.jt(t))||t.Cs()||t.qf()?t:null},this.sd=function(e,n){t.zl[e]=n},this.od=function(e){delete t.zl[e]},this.xt=function(e){var n=t.jt(e);t.od(e),n.cleanup()},this.tt=function(){return t.zl}},j=ut.rd=function(t){this._e=t,this.ud=function(t,e,n){var i=!1;return this._e.createOnce((function(){i||t(!(i=!0),n+" ("+e+" ms)")}),e,"CallbackWithTimeout.wrap"),function(e,n){i||(i=!0,t(e,n))}}},(X=ut.Config=function(t,e,n){var i=this;this.ad=e,this.fd=n,this.ld={clientId:G.H,iid:G.Sr,sendLogs:!1,maxHbInfos:G.Nr},this.I=Q.ll(this.ld),this.dd=!1,this.vd=!1,this.Ed=[],this.jl=function(){return this.dd},this.Et=function(){this.ad.Et(X.hd,(function(t,e){t&&i._d(e),i.dd=!0,i.Rd()}))},this._d=function(t){var e;(t=this.fd.yh(t))?t&&(e=t[X.pd],t=t[X._t],e&&e!==G.H&&""!==e&&"null"!==e&&(this.I[X.B]=e),t!==G.Sr)&&""!==t&&"null"!==t&&(this.I[X._t]=t):this.vd=!0},this.Ad=function(){var t={};return t[X.pd]=this.I.clientId,this.fd.Ch(t)},this.Al=function(){this.ad.Al(X.hd,this.Ad(),(function(t,e){}))},this.Wl=function(t){this.jl()?t():this.Ed.push(t)},this.get=function(t){return this.dd?this.I[t]:null},this.set=function(t,e){this.dd&&(this.I[t]=e)},this.Rd=function(){for(var t;void 0!==(t=this.Ed.shift());)t()},this.getClientId=function(){return this.I.clientId},this.getIid=function(){return this.I.iid}}).hd="sdkConfig",X.pd="clId",X._t="iid",X.B="clientId",X.ol="sendLogs",X.nl="maxHbInfos",X.hl="c3.fp.",X.$t={al:"0",Td:"1",tn:"2",zt:"3",fl:"4",en:"5",nn:"6"},J=ut.EventQueue=function(){this.Sd=[],this.Od=0,this.Kc=function(t){this.Sd.push(t)},this.Gc=function(){var t=this.Od;return this.Od++,t},this.Wf=function(){var t=this.Sd;return this.Sd=[],t}},Z=ut.ExceptionCatcher=function(t,e,n){this.Nd=e,this.N=n,this.F=function(t,e,n){try{e()}catch(e){if(n)n(e);else{if(this.N.allowUncaughtExceptions)throw e;this.gd(t,e)}}},this.gd=function(t,e){if(t="Uncaught exception: "+t+": "+e.toString(),this.Nd)try{this.Nd.Rl(t)}catch(t){}}},$=ut.GatewayControl=function(t,e,n,i,o){var a=this;this.Vi=t,this.Id=n,this.fd=i,this.wd=o,this.Rl=function(t,e){var n=(this.wd?this.wd.indexOf("ipv4")>-1?this.Vi.G:this.Vi.q:this.Vi.gatewayUrl)+G.Tr;this.Id.Cd("POST",n,this.fd.Ch(t),"application/json",(function(t,n){var i;t?(i=a.fd.yh(n),e(t,i)):e(t,n)}))}},Q=ut.Lang={yd:function(t){return Q.Pt(t)&&t&&"undefined"!==t&&"null"!==t},Gt:function(t){var e,n,i={};for(e in t)Q.yd(e)&&(n=t[e],Q.yd(n))&&(i[e]=n);return i},Jn:function(t,e,n){if(!t)throw new Error("Expected "+n+" implementation is null.");for(var i in e)if("function"!=typeof t[i])throw new Error("Expected method "+i+" in "+n+" implementation.")},Ht:function(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n},yt:function(t){return""+t},md:function(t){return Math.floor(t)},cn:function(t){return Math.abs(Q.md(t))},Dd:function(t){return Boolean(t)},Pt:function(t){return"string"==typeof t&&""!==t},Sl:function(t,e){return"string"==typeof t&&"string"==typeof e&&"function"==typeof t.indexOf&&0===t.indexOf(e)},ie:function(t){return"boolean"==typeof t},Pd:function(t){return escape(t)},mh:function(t){return"object"==typeof t},Sc:function(t){var e,n="";for(e in t)n+=e+"="+t[e];return"Object{"+n+"}"},bd:function(t){var e,n=Q.ll(t);for(e in n)n[e]||delete n[e];return n},ll:function(t){var e,n={};for(e in t)n[e]=t[e];return n},Tc:function(t,e){if(typeof t!=typeof e)return!1;if(t instanceof Object&&e instanceof Object){if(Q.Ht(t)!==Q.Ht(e))return!1;for(var n in t)if(t[n]!==e[n])return!1;return!0}return t===e},Vo:function(){for(var t={},e=0;e<arguments.length;e++)for(var n in arguments[e])arguments[e][n]&&(t[n]=arguments[e][n]);return t},gt:function(t){return"number"==typeof t&&Math.round(t)===t},Ld:function(t){return"[object Array]"===Object.prototype.toString.call(t)},Md:function(t,e){if(t!==e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(Q.Ld(t[n])&&Q.Ld(e[n])){if(!Q.Md(t[n],e[n]))return!1}else if(t[n]!==e[n])return!1}return!0},Ud:function(){return void 0!==Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(t){return!1}}()},rn:function(t,e,n){if(Q.Ud())Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:n});else{if(void 0===t.__defineGetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineGetter__");t.__defineGetter__(e,n)}},un:function(t,e,n){if(Q.Ud())Object.defineProperty(t,e,{configurable:!0,set:n});else{if(void 0===t.__defineSetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineSetter__");t.__defineSetter__(e,n)}}},(k={two32:4294967296}).Vd=k.two32-1,k.kd=0,Q.Fd=k,Q.Fd.Cast=function(t){return(t=parseInt(t,10))>k.Vd?t%=k.two32:t<k.kd&&(t=k.two32-(t=-t%k.two32)),t},Q.Fd.Bd=function(t){return(t=parseInt(t,10))<=k.Vd&&t>=k.kd},K={Vd:2147483647,kd:-2147483648},Q._l=K,Q._l.Cast=function(t){return(t=parseInt(t,10))>K.Vd?t%=K.Vd:t<K.kd&&(t=K.Vd-(t=-t%K.Vd)),t},Q._l.Bd=function(t){return(t=parseInt(t,10))<=K.Vd&&t>=K.kd},Q.tr=function(){return window&&window.location&&window.location.search?window.location.search:""},Q.Hd=function(){return document&&document.referrer?document.referrer:""},z=ut.LogBuffer=function(){this.Gd=[],this.cr=function(t){this.Gd.length>=32&&this.Gd.shift(),this.Gd.push(t)},this.Wf=function(){var t=this.Gd;return this.Gd=[],t}},(tt=ut.Ping=function(t,e,n,i){this.Kd=!1,this.Wd=null,this.p=t,this.p.setModuleName("Ping"),this.Id=e,this.Vi=n,this.ki=i,this.Rl=function(t){this.Kd||(this.Kd=!0,t=this.Yd()+"&d="+Q.Pd(t.toString()),this.p.error("send(): "+t),this.Id.Cd("GET",t,null,null,null),this.Kd=!1)},this.Yd=function(){if(!this.Wd){var t=tt.xd+"?comp="+tt.jd+"&clv="+(this.ki||h.version);if(this.Vi&&(t+="&cid="+this.Vi.customerKey),t+="&sch="+G.Cr,!this.Vi)return t;this.Wd=t}return this.Wd}}).jd="sdkjs",tt.xd="https://pings.conviva.com/ping.ping",et=ut.qd={Jd:4294967295,Xd:2147483647,Qd:-2147483648,ed:function(){return Math.floor(Math.random()*et.Jd)+et.Qd},Rt:function(){return Math.floor(Math.random()*et.Jd)}},nt=ut.Zd={jc:function(t,e,n,i){return isNaN(t)||"number"!=typeof t||t===i?i:(i=Q.md(t),nt.zd(i,e,n))},zd:function(t,e,n){return Q.gt(n)&&t>n?t=n:Q.gt(e)&&t<e&&(t=e),t},In:function(t){return-1!==t&&-2!==t?nt.jc(t,0,null,-1):t}},it=ut.StreamerError=function(){var t=this;t.errorCode=null,t.severity=h.ErrorSeverity.FATAL,function(e,n){t.errorCode=e,t.severity=n}.apply(t,arguments),this.nr=function(){return t.errorCode},this.ir=function(){return t.severity}},ot=ut.HttpClient=function(t,e,n,i){this.Di=e,this.$d=n,this.N=i,this.Cd=function(t,e,n,i,o){var a=1e3*this.N.httpTimeout,s=null;o&&(s=this.$d.ud(o,a,"HTTP timeout")),this.Di.makeRequest(t,e,n,i,a,s)}},(at=ut.Logger=function(t,e,n,i,o){this.Li=t,this.yi=e,this.O=n,this.Fi=i,this.Ui=o,this.debug=function(t){this.log(t,y.LogLevel.DEBUG)},this.info=function(t){this.log(t,y.LogLevel.INFO)},this.warning=function(t){this.log(t,y.LogLevel.WARNING)},this.error=function(t){this.log(t,y.LogLevel.ERROR)},this.log=function(t,e){t=this.nv(t,e),this.Fi.cr(t),this.O.logLevel<=e&&this.Li.consoleLog(t,e)},this.iv=function(t){return"["+this.Vn+"] "+t},this.ev=function(t){return"["+this.Ui+"] "+t},this.sv=function(t){return"[Conviva] "+t},this.ov=function(t){return"["+(this.yi.getEpochTimeMs()/1e3).toFixed(3).toString()+"] "+t},this.rv=function(t,e){return"["+at.tv(e)+"] "+t},this.uv=function(t){return this.hv?"sid="+this.hv+" "+t:t},this.Kh=function(t){this.hv=t},this.setModuleName=function(t){this.Vn=t},this.nv=function(t,e){return this.sv(this.ov(this.rv(this.ev(this.iv(this.uv(t))),e)))}}).tv=function(t){var e;switch(t){case y.LogLevel.ERROR:e="ERROR";break;case y.LogLevel.WARNING:e="WARNING";break;case y.LogLevel.INFO:e="INFO";break;case y.LogLevel.DEBUG:e="DEBUG"}return e},ut.Storage=function(t,e,n,i){this.Pi=e,this.$d=n,this.N=i,this.Et=function(t,e){e=this.$d.ud(e,1e3*this.N.storageTimeout,"storage load timeout"),this.Pi.loadData(ut.Storage.av,t,e)},this.Al=function(t,e,n){n=this.$d.ud(n,1e3*this.N.storageTimeout,"storage save timeout"),this.Pi.saveData(ut.Storage.av,t,e,n)}},ut.Storage.av="Conviva",(st=ut.SystemMetadata=function(t,e,n){this.bi=e,this.g=n,this.fv=null,this.get=function(){return this.fv||this.retrieve(),this.fv},this.retrieve=function(){var t,e={},n=(e[st.BROWSER_NAME]=this.bi.getBrowserName,e[st.BROWSER_VERSION]=this.bi.getBrowserVersion,e[st.DEVICE_BRAND]=this.bi.getDeviceBrand,e[st.DEVICE_MANUFACTURER]=this.bi.getDeviceManufacturer,e[st.DEVICE_MODEL]=this.bi.getDeviceModel,e[st.DEVICE_TYPE]=this.bi.getDeviceType,e[st.DEVICE_VERSION]=this.bi.getDeviceVersion,e[st.FRAMEWORK_NAME]=this.bi.getFrameworkName,e[st.FRAMEWORK_VERSION]=this.bi.getFrameworkVersion,e[st.OPERATING_SYSTEM_NAME]=this.bi.getOperatingSystemName,e[st.OPERATING_SYSTEM_VERSION]=this.bi.getOperatingSystemVersion,e[st.DEVICE_CATEGORY]=this.bi.getDeviceCategory,e[st.SCREEN_WIDTH]=this.bi.getScreenWidth,e[st.SCREEN_HEIGHT]=this.bi.getScreenHeight,e[st.SCALE_FACTOR]=this.bi.getScaleFactor,this);for(t in e)!function(t,e){n.g.F("Session.getSystemMetadataSchema(): "+t,(function(){var i=e[t];e[t]=i.call(n.bi)}))}(t,e),Q.Pt(e[t])||delete e[t];var i=!1;if(void 0!==e[st.DEVICE_TYPE]){for(var o in h.DeviceType)if(e[st.DEVICE_TYPE]===h.DeviceType[o]){i=!0;break}i||delete e[st.DEVICE_TYPE]}if(i=!1,void 0!==e[st.DEVICE_CATEGORY]){for(var a in h.DeviceCategory)if(e[st.DEVICE_CATEGORY]===h.DeviceCategory[a]){i=!0;break}i||delete e[st.DEVICE_CATEGORY]}this.fv=Q.bd(e)}}).BROWSER_NAME="browserName",st.BROWSER_VERSION="browserVersion",st.DEVICE_BRAND="deviceBrand",st.DEVICE_MANUFACTURER="deviceManufacturer",st.DEVICE_MODEL="deviceModel",st.DEVICE_TYPE="deviceType",st.DEVICE_VERSION="deviceVersion",st.FRAMEWORK_NAME="frameworkName",st.FRAMEWORK_VERSION="frameworkVersion",st.OPERATING_SYSTEM_NAME="operatingSystemName",st.OPERATING_SYSTEM_VERSION="operatingSystemVersion",st.DEVICE_CATEGORY="deviceCategory",st.SCREEN_WIDTH="screenWidth",st.SCREEN_HEIGHT="screenHeight",st.SCALE_FACTOR="scaleFactor",rt=ut.Time=function(t,e){this.yi=t,this.p=e,this.current=function(){var t=this.yi.getEpochTimeMs();return Q.gt(t),t}},lt=ut.Timer=function(t,e,n){var i=this;this.mi=e,this.g=n,this.create=function(t,e,n){return this.createTimer((function(){i.g.F(n,(function(){t()}))}),e,n)},this.createOnce=function(t,e,n){var o={cancel:null};return o.cancel=this.createTimer((function(){i.g.F(n,(function(){o&&"function"==typeof o.cancel&&(o.cancel(),o.cancel=null,o=null),t()}))}),e,n),o.cancel},this.createTimer=function(t,e,n){return this.mi.createTimer(t,e,n)}}}(),t}));var ConvivaIma3Integration=function(t,e,n){var i=null==window.localStorage.getItem("sdsat_debug")||"false"==window.localStorage.getItem("sdsat_debug");function o(t,e){e||console.log(t)}o("<<++ConvivaIma3Integration - "+t.mediainfo.name,i);var a=this;window.convivaIntegration=this,this.videoPlayer=t,this.contentMetadata=n,this.videoPlayerContainer=t.el(),this.isAdBreakEnabled=!0;var r=null,l=null;this.initConvivaClient=function(){o("<<++initConvivaClient - "+t.mediainfo.name,i),Conviva.Analytics.init(e[Conviva.Constants.CUSTOMER_KEY],this.getConvivaCallbackFunctions(),e),Conviva.Analytics.setDeviceMetadata(this.getDeviceMetadata()),this.checkTabWinClose(this)},this.checkTabWinClose=function(e){o("<<++checkTabWinClose - "+t.mediainfo.name,i),window.addEventListener("unload",(function(){o("<<++unload ********- ",i),l&&(o("<<++reportAdEnded - ",i),l.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),l.reportAdEnded(),l.release()),r&&(o("<<++reportPlaybackEnded - ",i),r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),r.reportPlaybackEnded(),r.release())}))},this.getDeviceMetadataReal=function(){o("<<++getDeviceMetadataReal - "+t.mediainfo.name,i);const e=navigator.userAgent.toLowerCase();let n="Unknown",a="Unknown";if(e.includes("iphone"))n="Apple",a="iPhone";else if(e.includes("ipad"))n="Apple",a="iPad";else if(e.includes("macintosh")||e.includes("mac os"))n="Apple",a="Mac";else if(e.includes("android")){n="Android";const t=e.match(/android [\d.]+; (.*?);/);t&&t[1]&&(a=t[1])}else if(e.includes("windows")){n="Windows";const t=e.match(/windows nt [\d.]+; (.*?);/);t&&t[1]&&(a=t[1])}else if(e.includes("linux")){n="Linux";const t=e.match(/\((.*?)\)/);t&&t[1]&&(a=t[1])}return{BRAND:n,MANUFACTURER:n,MODEL:a,OS_NAME:navigator.platform,OS_VERSION:navigator.appVersion}},this.getDeviceMetadata=function(){o("<<++getDeviceMetadata - "+t.mediainfo.name,i);var e=this.getDeviceMetadataReal(),n=this.getDeviceMetadataReal();return n[Conviva.Constants.DeviceMetadata.BRAND]=e.BRAND,n[Conviva.Constants.DeviceMetadata.MANUFACTURER]=e.MANUFACTURER,n[Conviva.Constants.DeviceMetadata.MODEL]=e.MODEL,n[Conviva.Constants.DeviceMetadata.TYPE]=Conviva.Constants.DeviceType.DESKTOP,n[Conviva.Constants.DeviceMetadata.OS_NAME]=e.OS_NAME,n[Conviva.Constants.DeviceMetadata.OS_VERSION]=e.OS_VERSION,n[Conviva.Constants.DeviceMetadata.CATEGORY]=Conviva.Constants.DeviceCategory.WEB,n},this.getConvivaCallbackFunctions=function(){var t={};return t[Conviva.Constants.CallbackFunctions.CONSOLE_LOG]=function(t,e){"undefined"!=typeof console&&(console.log&&e===Conviva.SystemSettings.LogLevel.DEBUG||e===Conviva.SystemSettings.LogLevel.INFO?console.log(t):console.warn&&e===Conviva.SystemSettings.LogLevel.WARNING?console.warn(t):console.error&&e===Conviva.SystemSettings.LogLevel.ERROR&&console.error(t))},t[Conviva.Constants.CallbackFunctions.MAKE_REQUEST]=function(t,e,n,i,o,a){var s=new XMLHttpRequest;s.open(t,e,!0),i&&s.overrideMimeType&&(s.overrideMimeType=i),i&&s.setRequestHeader&&s.setRequestHeader("Content-Type",i),o>0&&(s.timeout=o,s.ontimeout=function(){s.ontimeout=s.onreadystatechange=null,a&&a(!1,"timeout after "+o+" ms")}),s.onreadystatechange=function(){4===s.readyState&&(s.ontimeout=s.onreadystatechange=null,200==s.status?a&&a(!0,s.responseText):a&&a(!1,"http status "+s.status))},s.send(n)},t[Conviva.Constants.CallbackFunctions.SAVE_DATA]=function(t,e,n,i){var o=t+"."+e;try{localStorage.setItem(o,n),i(!0,null)}catch(t){i(!1,t.toString())}},t[Conviva.Constants.CallbackFunctions.LOAD_DATA]=function(t,e,n){var i=t+"."+e;try{n(!0,localStorage.getItem(i))}catch(t){n(!1,t.toString())}},t[Conviva.Constants.CallbackFunctions.GET_EPOCH_TIME_IN_MS]=function(){return(new Date).getTime()},t[Conviva.Constants.CallbackFunctions.CREATE_TIMER]=function(t,e){var n=setInterval(t,e);return function(){-1!==n&&(clearInterval(n),n=-1)}},t},this.registerPlayerListeners=function(){o("<<++registerPlayerListeners - "+t.mediainfo.name,i),this.videoPlayer.on("pause",this.onPause.bind(this)),this.videoPlayer.on("playing",this.onPlaying.bind(this)),this.videoPlayer.on("play",this.onPlay.bind(this)),this.videoPlayer.on("loop",this.monitoringSessionInit.bind(this)),this.videoPlayer.on("waiting",this.onWaiting.bind(this)),this.videoPlayer.on("timeupdate",this.onTimeUpdate.bind(this)),this.videoPlayer.on("error",this.onError.bind(this)),this.videoPlayer.on("loadedmetadata",this.onLoadedMetadata.bind(this)),this.videoPlayer.on("seeking",this.onSeeking.bind(this)),this.videoPlayer.on("seeked",this.onSeeked.bind(this)),this.videoPlayer.on("ended",this.onEnded.bind(this)),this.videoPlayer.on("abort",this.onEnded.bind(this)),this.videoPlayer.on("stopcompleted",this.onEnded.bind(this)),this.videoPlayer.on("ima3-ads-manager-loaded",this.adsManagerLoaded.bind(this)),this.videoPlayer.on("ima3-ad-error",this.onAdsLoaderError.bind(this))},this.destroy=function(){o("<<++*******************destroy - "+t.mediainfo.name,i),r&&r.release(),l&&l.release(),this.adsManager&&this.adsManager.destroy(),this.videoPlayer.off("pause",this.onPause),this.videoPlayer.off("playing",this.onPlaying),this.videoPlayer.off("play",this.onPlay),this.videoPlayer.off("loop",this.monitoringSessionInit),this.videoPlayer.off("waiting",this.onWaiting),this.videoPlayer.off("timeupdate",this.onTimeUpdate),this.videoPlayer.off("error",this.onError),this.videoPlayer.off("loadedmetadata",this.onLoadedMetadata),this.videoPlayer.off("seeking",this.onSeeking),this.videoPlayer.off("seeked",this.onSeeked),this.videoPlayer.off("ended",this.onEnded),this.videoPlayer.off("stopcompleted",this.onEnded),this.videoPlayer.off("ima3-ads-manager-loaded",this.adsManagerLoaded),this.videoPlayer.off("ima3-ad-error",this.onAdsLoaderError),this.currentPodIndex=0},this.ConvivaAdsAnalyticsInit=function(){o("<<++ConvivaAdsAnalyticsInit - "+t.mediainfo.name,i),l=Conviva.Analytics.buildAdAnalytics(r);var e={};e[Conviva.Constants.FRAMEWORK_NAME]="Google IMA SDK",e[Conviva.Constants.FRAMEWORK_VERSION]=""+google.ima.VERSION,l.setAdPlayerInfo(e)},this.registerAdsManagerListeners=function(){o("<<++registerAdsManagerListeners - "+t.mediainfo.name,i),this.adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdsManagerError,!1,this);var e=[google.ima.AdEvent.Type.AD_BREAK_READY,google.ima.AdEvent.Type.AD_CAN_PLAY,google.ima.AdEvent.Type.AD_METADATA,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,google.ima.AdEvent.Type.CLICK,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,google.ima.AdEvent.Type.DURATION_CHANGE,google.ima.AdEvent.Type.EXPANDED_CHANGED,google.ima.AdEvent.Type.FIRST_QUARTILE,google.ima.AdEvent.Type.IMPRESSION,google.ima.AdEvent.Type.INTERACTION,google.ima.AdEvent.Type.LINEAR_CHANGED,google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.LOG,google.ima.AdEvent.Type.MIDPOINT,google.ima.AdEvent.Type.PAUSED,google.ima.AdEvent.Type.RESUMED,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,google.ima.AdEvent.Type.SKIPPED,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.THIRD_QUARTILE,google.ima.AdEvent.Type.USER_CLOSE,google.ima.AdEvent.Type.VIEWABLE_IMPRESSION,google.ima.AdEvent.Type.VOLUME_CHANGED,google.ima.AdEvent.Type.VOLUME_MUTED,google.ima.AdError.Type.AD_LOAD,google.ima.AdError.Type.AD_PLAY,google.ima.AdEvent.Type.AD_BUFFERING,google.ima.AdEvent.Type.AD_PROGRESS];for(var n in e)this.adsManager.addEventListener(e[n],this.onAdEvent,!1,this)},this.onLoadedMetadata=function(){if(o("<<++onLoadedMetadata - "+t.mediainfo.name,i),null!=r){var e=this.videoPlayer.mediainfo.duration;if(!isNaN(e)&&e!=1/0){var n={};n[Conviva.Constants.DURATION]=parseInt(e,10),r.setContentInfo(n)}var a=this.videoPlayer.tech(!0).vhs.playlists.media().attributes;r.reportPlaybackMetric(Conviva.Constants.Playback.RESOLUTION,a.RESOLUTION.width,a.RESOLUTION.height),r.reportPlaybackMetric(Conviva.Constants.Playback.BITRATE,a.BANDWIDTH/1024),r.reportPlaybackMetric(Conviva.Constants.Playback.RENDERED_FRAMERATE,a["FRAME-RATE"])}},this.monitoringSessionInit=function(){if(o("<<++monitoringSessionInit - "+t.mediainfo.name,i),null==r){var e={};e[Conviva.Constants.ASSET_NAME]="["+this.contentMetadata.assetID+"] "+this.contentMetadata.title,e[Conviva.Constants.STREAM_URL]=this.contentMetadata.url,e[Conviva.Constants.IS_LIVE]="true"==this.contentMetadata.live?Conviva.Constants.StreamType.LIVE:Conviva.Constants.StreamType.VOD,e[Conviva.Constants.PLAYER_NAME]=this.contentMetadata.playerName,e[Conviva.Constants.VIEWER_ID]=this.contentMetadata.adobeViewerID,e[Conviva.Constants.DURATION]=this.contentMetadata.durationSec,e[Conviva.Constants.DEFAULT_RESOURCE]="Akamai",e[Conviva.Constants.APPLICATION_VERSION]=_satellite.getVar("publish_ver")||"Launch PublishDate:2999-12-31 | sCode version:2.1.0",Object.assign(e,this.contentMetadata),r=Conviva.Analytics.buildVideoAnalytics(),window.convivaVideoAnalytics=r;var n={};n[Conviva.Constants.FRAMEWORK_NAME]="Brightcove Media Player",n[Conviva.Constants.FRAMEWORK_VERSION]=bc.VERSION,r.setPlayerInfo(n),r.reportPlaybackRequested(e),r.setCallback((function(){null!=r&&a.videoPlayer&&(r.reportPlaybackMetric(Conviva.Constants.Playback.PLAY_HEAD_TIME,a.videoPlayer.currentTime()/1e3),r.reportPlaybackMetric(Conviva.Constants.Playback.BUFFER_LENGTH,a.videoPlayer.buffered().length))})),this.contentPlaybackEnded=!1}},this.onPlay=function(){o("<<++onPlay - "+t.mediainfo.name,i),this.monitoringSessionInit(),this.contentPlaybackEnded&&(this.podIndex=1,this.podPosition=null,r&&r.release(),l&&l.release(),this.adsManager&&this.adsManager.destroy(),this.currentPodIndex=0)},this.onPlaying=function(){o("<<++onPlaying - "+t.mediainfo.name,i),null!=r&&r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PLAYING)},this.onPause=function(){o("<<++onPause - "+t.mediainfo.name,i),null!=r&&r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PAUSED)},this.onEmptied=function(){o("<<++onEmptied - "+t.mediainfo.name,i),null!=r&&r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.BUFFERING)},this.onWaiting=function(){o("<<++onWaiting - "+t.mediainfo.name,i),null!=r&&r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.BUFFERING)},this.onTimeUpdate=function(){if(t.currentTime()%5<=.25&&o("<<++onTimeUpdate - "+t.currentTime(),i),null!=r){var e=this.videoPlayer.tech(!0).vhs.playlists.media().attributes;r.reportPlaybackMetric(Conviva.Constants.Playback.RESOLUTION,e.RESOLUTION.width,e.RESOLUTION.height),r.reportPlaybackMetric(Conviva.Constants.Playback.BITRATE,e.BANDWIDTH/1024)}},this.onSeeking=function(){o("<<++onSeeking - "+t.mediainfo.name,i),null!=r&&r.reportPlaybackMetric(Conviva.Constants.Playback.SEEK_STARTED)},this.onSeeked=function(){o("<<++onSeeked - "+t.mediainfo.name,i),null!=r&&r.reportPlaybackMetric(Conviva.Constants.Playback.SEEK_ENDED)},this.onError=function(){o("<<++onError - "+t.mediainfo.name,i),null!=r?r.reportPlaybackFailed("Fatal error occured"):(r=Conviva.Analytics.buildVideoAnalytics()).reportPlaybackFailed("Fatal error occured"),r.release(),r=null,Conviva.Analytics.release(),this.contentPlaybackEnded=!0},this.onEnded=function(){o("<<++onEnded - "+t.mediainfo.name,i);try{null!=r&&(r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),r.reportPlaybackEnded(),r.release(),r=null,Conviva.Analytics.release(),this.destroy()),this.contentPlaybackEnded=!0}catch(t){o("<<++onEnded1 - "+t,i)}try{null!=r&&(r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),r.reportPlaybackEnded(),r.release(),r=null,Conviva.Analytics.release(),this.destroy()),this.contentPlaybackEnded=!0}catch(t){o("<<++onEnded2 - "+t,i)}},this.adsManagerLoaded=function(e){o("<<++adsManagerLoaded - "+t.mediainfo.name,i),this.adsManager=e.originalEvent.g,this.registerAdsManagerListeners()},this.onContentPauseRequested=function(e){if(o("<<++onContentPauseRequested - "+t.mediainfo.name,i),this.allAdsCompleted=!1,this.contentPauseRequested=!0,null!=r)if(this.currentPodIndex=e.getAd().getAdPodInfo().getPodIndex(),this.isAdBreakEnabled){this.podDuration=e.getAd().getDuration();var n=e.ad.getAdPodInfo().getPodIndex(),a=e.getAd().getAdPodInfo().getTotalAds();o("********Mid-roll = "+n+"  ***********adsPodTotal = "+a,i),0===this.currentPodIndex?this.podPosition="Pre-roll":-1===this.currentPodIndex?this.podPosition="Post-roll":(this.podPosition="Mid-roll "+n,this.podDuration=e.getAd().getDuration()*a);var s={};s[Conviva.Constants.POD_POSITION]=this.podPosition,s[Conviva.Constants.POD_DURATION]=this.podDuration,s[Conviva.Constants.POD_INDEX]=this.podIndex,r.reportAdBreakStarted(Conviva.Constants.AdType.CLIENT_SIDE,Conviva.Constants.AdPlayer.CONTENT,s)}else r.reportAdBreakStarted(Conviva.Constants.AdType.CLIENT_SIDE,Conviva.Constants.AdPlayer.CONTENT)},this.onContentResumeRequested=function(e){o("<<++onContentResumeRequested - "+t.mediainfo.name,i),this.allAdsCompleted=!1,null!=r&&(this.contentPauseRequested&&(this.isAdBreakEnabled?(r.reportAdBreakEnded(),this.podIndex++,this.podPosition=null):r.reportAdBreakEnded()),-1==this.currentPodIndex&&(r.reportPlaybackEnded(),r.release(),r=null,Conviva.Analytics.release(),this.contentPlaybackEnded=!0)),this.contentPauseRequested=!1},this.onAdEvent=function(e){o("<<++onAdEvent - "+t.mediainfo.name,i),o("Conviva captured event ---- +++ **** "+e.type,i),e.type==google.ima.AdEvent.Type.STARTED&&!0===e.getAd().isLinear()?this.onAdStart(e):e.type==google.ima.AdEvent.Type.RESUMED&&!0===e.getAd().isLinear()?null!=l&&l.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PLAYING):e.type==google.ima.AdEvent.Type.PAUSED&&!0===e.getAd().isLinear()?null!=l&&l.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PAUSED):e.type==google.ima.AdEvent.Type.COMPLETE&&!0===e.getAd().isLinear()?null!=l&&(l.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),l.reportAdEnded(),l.release(),l=null):e.type==google.ima.AdEvent.Type.SKIPPED&&!0===e.getAd().isLinear()?null!=l&&(l.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),l.reportAdSkipped(),l.release(),l=null):e.type==google.ima.AdEvent.Type.ALL_ADS_COMPLETED?(this.allAdsCompleted=!0,this.contentPlaybackEnded&&null!=r&&(r.reportPlaybackEnded(),r.release(),r=null,Conviva.Analytics.release())):e.type==google.ima.AdEvent.Type.LOG?this.onAdLogError(e):e.type==google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED?this.onContentPauseRequested(e):e.type==google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED?this.onContentResumeRequested(e):e.type==google.ima.AdEvent.Type.AD_BUFFERING?null!=l&&l.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.BUFFERING):e.type==google.ima.AdEvent.Type.AD_PROGRESS&&null!=l&&l.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PLAYING)},this.onAdStart=function(e){if(o("<<++onAdStart - "+t.mediainfo.name,i),null==l&&null!=r){l=Conviva.Analytics.buildAdAnalytics(r);var n={};n[Conviva.Constants.FRAMEWORK_NAME]="Google IMA SDK",n[Conviva.Constants.FRAMEWORK_VERSION]=""+google.ima.VERSION,l.setAdPlayerInfo(n)}if(null!=l){var a=this.getConvivaAdMetadata(e.getAd());l.reportAdStarted(a);var s=this.videoPlayer.tech(!0).vhs.playlists.media().attributes;l.reportAdMetric(Conviva.Constants.Playback.RESOLUTION,s.RESOLUTION.width,s.RESOLUTION.height),l.reportAdMetric(Conviva.Constants.Playback.BITRATE,s.BANDWIDTH/1024),l.reportAdMetric(Conviva.Constants.Playback.RENDERED_FRAMERATE,s["FRAME-RATE"])}},this.onAdsLoaderError=function(e){o("<<++onAdsLoaderError - "+t.mediainfo.name,i),this.reportAdFailed(e,"Ads Loader Error")},this.onAdsManagerError=function(e){o("<<++onAdsManagerError - "+t.mediainfo.name,i),o("Conviva captured Error ---- +++ **** "+e.type,i);var n=e.getError();this.handleAdError(n)},this.onAdLogError=function(e){o("<<++onAdLogError - "+t.mediainfo.name,i);var n=e.getAdData().adError;o("Conviva captured Error Type ---- +++ **** "+n.getType(),i),o("Conviva captured Error Code ---- +++ **** "+n.getErrorCode(),i),o("Conviva captured Error Message ---- +++ **** "+n.getMessage(),i)},this.getConvivaAdMetadata=function(e){o("<<++getConvivaAdMetadata - "+t.mediainfo.name,i);var a,r,l,u,c={};if(c[Conviva.Constants.ASSET_NAME]=e.getTitle(),c[Conviva.Constants.STREAM_URL]=e.getMediaUrl(),c[Conviva.Constants.PLAYER_NAME]=n.playerName,c[Conviva.Constants.VIEWER_ID]=n.adobeViewerID,c[Conviva.Constants.DURATION]=e.getDuration(),c[Conviva.Constants.IS_LIVE]=Conviva.Constants.StreamType.VOD,c[Conviva.Constants.ENCODED_FRAMERATE]=30,c[Conviva.Constants.DEFAULT_RESOURCE]="Akamai",c.adBitRate=""+e.getVastMediaBitrate(),e.getWrapperAdIds()&&0!==e.getWrapperAdIds().length){var h=e.getWrapperAdIds().length;a=e.getWrapperAdSystems()[h-1],r=e.getWrapperAdIds()[h-1],l=e.getWrapperCreativeIds()[h-1]}else a=e.getAdSystem(),r=e.getAdId(),l=e.getCreativeId();var f=e.getAdPodInfo().getPodIndex(),d=e.getAdPodInfo().getAdPosition();return o("********Mid-roll = "+f+"  ***********AdPosition = "+e.getAdPodInfo().getAdPosition(),i),0===f?u="Pre-roll":-1===f?u="Post-roll":(u="Mid-roll "+f,"undefined"!=typeof s&&(o("midrolll ********  M"+f+"S"+d,i),s.contextData.tmAdReq="",s.contextData.tmAdPlay="",s.contextData.tmAFLW="",s.contextData.tmIsCC="",s.contextData.tmMidroll="M"+f+"S"+d,s.Media.track(this.contentMetadata.live?t.mediainfo.name:"Live:"+t.mediainfo.name,t.currentTime()),s.Media.play(this.contentMetadata.live?t.mediainfo.name:"Live:"+t.mediainfo.name,t.currentTime()))),c["c3.ad.id"]=""+e.getAdId(),c["c3.ad.creativeId"]=""+e.getCreativeId(),c["c3.ad.technology"]="Client Side",c["c3.ad.system"]=""+e.getAdSystem(),c.adSequence=""+e.getAdPodInfo().getAdPosition(),c["c3.ad.mediaFileApiFramework"]=""+e.getApiFramework()==null?"NA":e.getApiFramework(),c["c3.ad.advertiser"]=""+e.getAdvertiserName(),c["c3.ad.position"]=u,c["c3.ad.adManagerName"]="Google IMA SDK",c["c3.ad.adManagerVersion"]=""+google.ima.VERSION,c["c3.ad.firstAdSystem"]=""+a,c["c3.ad.firstAdId"]=""+r,c["c3.ad.firstCreativeId"]=""+l,c},this.handleAdError=function(e){if(o("<<++handleAdError - "+t.mediainfo.name,i),e)switch(e.getType()){case google.ima.AdError.Type.AD_PLAY:this.handleAdPlayError(e);break;case google.ima.AdError.Type.AD_LOAD:this.handleAdLoadError(e)}},this.handleAdPlayError=function(e){o("<<++handleAdPlayError - "+t.mediainfo.name,i),this.reportAdFailed(e,"Ad Play Error")},this.handleAdLoadError=function(e){o("<<++handleAdLoadError - "+t.mediainfo.name,i),this.reportAdFailed(e,"Ad Load Error")},this.reportAdFailed=function(e,n){o("<<++reportAdFailed - "+t.mediainfo.name,i),e.getError&&"function"==typeof e.getError&&(e.getError().getType&&"function"==typeof e.getError().getType&&e.getError().getType()&&(errorMessage="Type: "+e.getError().getType()),e.getError().getType&&"function"==typeof e.getError().getErrorCode&&e.getError().getErrorCode()&&(null==errorMessage?errorMessage="Code: "+e.getError().getErrorCode():errorMessage+=", Code: "+e.getError().getErrorCode()),e.getError().getType&&"function"==typeof e.getError().getMessage&&e.getError().getMessage()&&(null==errorMessage?errorMessage="Message: "+e.getError().getMessage():errorMessage+=", Message: "+e.getError().getMessage())),null==errorMessage&&(errorMessage="Ad Request Failed");var a={};if(a[Conviva.Constants.ASSET_NAME]=n,a[Conviva.Constants.IS_LIVE]=Conviva.Constants.StreamType.VOD,a.applicationName=this.contentMetadata.applicationName,a[Conviva.Constants.PLAYER_NAME]=this.contentMetadata.playerName,a.viewerId=this.contentMetadata.adobeViewerID,a["c3.ad.technology"]="Client Side",a["c3.ad.adManagerName"]="Google IMA SDK",a["c3.ad.adManagerVersion"]=""+google.ima.VERSION,null==l){l=Conviva.Analytics.buildAdAnalytics(r);var s={};s[Conviva.Constants.FRAMEWORK_NAME]="Google IMA SDK",s[Conviva.Constants.FRAMEWORK_VERSION]=""+google.ima.VERSION,l.setAdPlayerInfo(s)}l.reportAdFailed(errorMessage,a),null!=l&&(l.release(),l=null)},this.adsManager=null,this.podIndex=1,this.podPosition=null,this.initConvivaClient(),this.registerPlayerListeners(),this.currentPodIndex=0};
           //plugin
            videojs.registerPlugin('AdobeConviva', function(options) {
                function log(m, p) {
                    if (!p) {
                        console.log(m)
                    }
                }
         
                var prod = true; 
                var adobe = true; 
                if (!options) {
                    console.log("Options has not been added, please add the options on video cloud")
                } else {
                    prod = options["env"] == "production";
                    adobe = options["adobe"];
                }

                var myPlayer = this;
                var isContentLoaded = false;
                var videoDuration;
                var mediaName;
                var adobeMediaName;            
                var mediaPlayerName = getHostName();
                var currentTime;
                var isPlaying = false;
                var videoEnd = false;
                var bitRate = 0;
                var isLive = false;

                var metadata = {};
                var firstPlay = false;
                var tmAdReq = false;
                var tmAdPlay = false;
                var tmAdBeacon = false;
                var tmCC = false;
                var tmAFLW = false;

                var integration, convivaIntegration;
                //Setting Up Conviva Configs default as test
                
                var TEST_CUSTOMER_KEY = options.testing.customerKey; //'69b93c2f8bf26c0edf513501a13f4da18556fb68';
                var TOUCHSTONE_SERVICE_URL = options.testing.gatewayUrl; //'https://telstra-afl.testonly.conviva.com';

                var convivaConfigs = {};
                convivaConfigs[Conviva.Constants.GATEWAY_URL] = TOUCHSTONE_SERVICE_URL;
                convivaConfigs[Conviva.Constants.LOG_LEVEL] = Conviva.Constants.LogLevel.ERROR;
                convivaConfigs[Conviva.Constants.CUSTOMER_KEY] = TEST_CUSTOMER_KEY;
                
                switch (prod)
                {
                    case true:
                        
                        convivaConfigs[Conviva.Constants.GATEWAY_URL] = options.production.gatewayUrl;
                        convivaConfigs[Conviva.Constants.LOG_LEVEL] = Conviva.Constants.LogLevel.ERROR;
                        convivaConfigs[Conviva.Constants.CUSTOMER_KEY] = options.production.customerKey;
                    break;    
                    case false:
                        convivaConfigs[Conviva.Constants.GATEWAY_URL] = options.testing.gatewayUrl;
                        convivaConfigs[Conviva.Constants.LOG_LEVEL] = Conviva.Constants.LogLevel.DEBUG;
                        convivaConfigs[Conviva.Constants.CUSTOMER_KEY] = options.testing.customerKey;
           
                    break;    
                }
                


                var viewerID = "random:" + Math.random() * 1e9;

                if (adobe) {
                    viewerID = s.visitor.getMarketingCloudVisitorID();
                }

                function ABDMediaOPEN() {
                    log("++ IN ABDMediaOPEN TOP ++", prod);

                    //Check the metadata is loaded
                    if (isContentLoaded) {
                        log("++ IN ABDMediaOPEN content loaded ++", prod);
                        //Get all required metadata
                        currentTime = myPlayer.currentTime();
                        mediaName = myPlayer.mediainfo.name;
                        videoDuration = myPlayer.mediainfo.duration;

                        buildMetadata();

                        //Open adobe Analytics Media Module	

                        adobe && s.Media.open(adobeMediaName, videoDuration, mediaPlayerName);

                        //Check if video is playing
                        //if (isPlaying) {
                        //    log("++IN ABDMediaOPEN video is playing " + mediaName + " | " + videoDuration, prod);
                        //Play Adobe Analytics Media module from beginning.
                        //    adobe && s.Media.play(adobeMediaName, currentTime);
                        // }
                    }
                }

                            
                //Used to reset the variables as when the next videos play, the play event is called before loadstart ...
                function resetVariables() {
                    isContentLoaded = false;
                    videoDuration = currentTime = "";
                    videoEnd = true;
                    bitRate = 0;
                    tmAdBeacon=false;
                    tmCC = false;
                    isLive=false;
                    adobeMediaName="";
                    tmAFLW=false;
                }
                //Used to build metadata 
                function buildMetadata() {
                         metadata = {};
                
                        metadata["id"] = myPlayer.mediainfo.id;
                        metadata["title"] = myPlayer.mediainfo.name;;
                        metadata["url"] = myPlayer.mediainfo.sources[0].src;
                        metadata["live"] = myPlayer.mediainfo.duration == 0 ? "true" : "false";
                        metadata["durationSec"] = ""+myPlayer.mediainfo.duration;
                        metadata["streamType"] = myPlayer.mediainfo.sources[0].type;
                        metadata["applicationName"] = getPlayerName();
                        isLive = myPlayer.mediainfo.duration == 0 ? true : false;
                        adobeMediaName = isLive ? "Live:"+myPlayer.mediainfo.name : myPlayer.mediainfo.name;
                        tmAFLW = /^aflw/i.test(myPlayer.mediainfo.custom_fields.competition); //check is aflw or afl    
                
                        //when live streaming append the matchname from the datalayer // may need to be fixed up
                        if (getSafe(()=>dataLayer.filter(function(obj) {
                            return obj.event === 'matchView'
                        })[0].matchName, false)) {
                            metadata["title"] = mediaName + " - " + dataLayer.filter(function(obj) {
                                return obj.event === 'matchView'
                            })[0].matchName;
                        }
                
                        //when unily grab the page title as well
                        var top_url = top_url = (window.location != window.parent.location) ? document.referrer != "" ? document.referrer : document.location.href : document.location.href;
                        var t_test = new URL(top_url);
                
                        if (/telstra\.unily\.com/.test(top_url) && t_test.pathname.length > 0) {
                            metadata["title"] = mediaName + " [" + t_test.pathname + "]";
                        }
                
                        //custom 
                        metadata["assetID"] = myPlayer.mediainfo.id;
                        metadata["channel"] = getHostName();
                        metadata["playerName"] = getPlayerName();
                
                        metadata["adobeViewerID"] = viewerID;
                
                        //createConvivaSession
                        userData = {}
                        userData["viewerID"] = viewerID;
                        userData["hostname"] = getHostName();
                
                        //add all custom fields 
                        Object.assign(metadata, myPlayer.mediainfo.customFields);
                        Object.assign(metadata, userData);
                
                        log(JSON.stringify(metadata), prod)
                }


               myPlayer.on('ima3-ads-manager-loaded', function(event) {
                  log("++ima3-ads-manager-loaded", prod); 
                  //myPlayer.ima3.toggleLogger(!prod);
                               
                });
                            
                myPlayer.on('loadstart', function() {
                    log("++loadstart * update *  " + myPlayer.mediainfo.name, prod);
                    //if(!prod)myPlayer.ima3.settings.serverUrl = 'https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/vmap_ad_samples&sz=640x480&cust_params=sample_ar%3Dpremidpostoptimizedpod&ciu_szs=300x250&gdfp_req=1&ad_rule=1&output=vmap&unviewed_position_start=1&env=vp&impl=s&cmsid=496&vid=short_onecue&correlator=';        
                    //if(!prod)myPlayer.ima3.settings.serverUrl = 'https://pubads.g.doubleclick.net/gampad/ads?iu=/7414/uatapp.ios.afl&sz=640x480&vid_d=600&allcues=60000,90000,110000&cust_params=po%3D0000501303&keyword%3DxAFLTestingx&ciu_szs=300x250&gdfp_req=1&ad_rule=1&output=vmap&unviewed_position_start=1&env=vp&impl=s&cmsid=496&vid=short_onecue&correlator=';        
                    buildMetadata();

                    //kill all old sessions                
                    if (integration) {
                       //integration.ConvivaIma3Integration(myPlayer,convivaConfigs,metadata);
                    integration = null;
                    }
                    //start new sessions
                       integration = new ConvivaIma3Integration(myPlayer,convivaConfigs,metadata );
                                
                    firstPlay = true;
                    //Check that metadata is loaded
                    if (myPlayer.mediainfo.name) {
                        isContentLoaded = true;
                        //Initiate Adobe Analytics Media Module tracking && Conviva Analytics
                    }
                });

                myPlayer.on('ads-request', function() {
                    log("++ads-ad-request - " + myPlayer.mediainfo.name, prod);
                    tmAdReq = true;
                });

                myPlayer.on('ads-ad-ended', function() {
                    log("++ads-ad-ended - " + myPlayer.mediainfo.name, prod);
                    tmAdPlay = true;
                });

                myPlayer.on('play', function() {
                    log("++play - " + myPlayer.mediainfo.name, prod);
                    isPlaying = true;
                    if (firstPlay) {
                        log("++ First Play via played - *****Video Start**** - " + myPlayer.mediainfo.name, prod);
                        firstPlay = false;
                        isContentLoaded = true;
                        ABDMediaOPEN();
                        //integration = new NewConvivaIntegration(myPlayer, convivaConfigs, metadata);
                        //convivaHelper.createConvivaSession(userData, metadata);
                        //convivaHelper.attachPlayerToSession();


                    }

                    if (videoEnd) {
                        //user has restarted video from end 
                        videoEnd = false;
                        isContentLoaded = false;
                        ABDMediaOPEN();
                        
                    }

                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        if (adobe && currentTime != 0 ) { //resume from pause
                            s.eVar63 = adobeMediaName;
                            s.Media.play(adobeMediaName, currentTime);

                        }

                    }
                });

                myPlayer.on("playing", function() {
                    log("++ In Playing ++", prod)

                    //convivaHelper.setPlayerWidthAndHeight(myPlayer.videoWidth(), myPlayer.videoHeight());
                    //convivaHelper.updatePlayerState("playing");
                                
                });

                myPlayer.on('pause', function() {
                    isPlaying = false;
                    log("++paused - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        adobe && s.Media.stop(adobeMediaName, currentTime);
                        //convivaHelper.updatePlayerState("pause");
                    }
                });

                myPlayer.on('progress', function() {
                    log("progressed - " + myPlayer.mediainfo.name, prod);

                });

                myPlayer.on('resize', function() {
                    log("resized - " + myPlayer.mediainfo.name, prod);
                });

                myPlayer.on('seeked', function() {
                    log("++seeked - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        adobe && s.Media.play(adobeMediaName, currentTime);
                        //convivaHelper.contentSeeked();
                    }
                });

                myPlayer.on('seeking', function() {
                    log("++seeking - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        adobe && s.Media.stop(adobeMediaName, currentTime);
                    }
                });

                myPlayer.on('stalled', function() {
                    log("++stalled - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.

                });

                myPlayer.on('timeupdate', function() {
                    
                    currentTime = myPlayer.currentTime();
                    if(myPlayer.currentTime() % 5 <= 0.25)log("++timeupdate - " + currentTime, prod);

                    // adobe keep alive if video is live
                    if(adobe && isLive && currentTime != 0 &&  currentTime % 300 <= 0.25 ){
                       log("++timeupdate - keep alive beacon " + currentTime, prod);
                            s.Media.track(adobeMediaName, currentTime);
                            s.Media.play(adobeMediaName, currentTime);

                        }

                    if (adobe && isPlaying && !tmAdBeacon && currentTime > 0) {

                        //s.Media.trackVars+= ",contextData.tmAdReq,contextData.tmAdPlay"
                        tmAdReq ? s.contextData['tmAdReq'] = "yes" : s.contextData['tmAdReq'] = "no";
                        tmAdPlay ? s.contextData['tmAdPlay'] = "yes" : s.contextData['tmAdPlay'] = "no";
                        tmAFLW ? s.contextData['tmAFLW'] = "yes" : s.contextData['tmAFLW'] = "no"; 
                        s.contextData['tmIsCC'] = "";

                        //s.tl();
                        tmAdBeacon = true;
                        log("++ In timeupdate and adreq adplay update ++ " + mediaName + " | " + videoDuration, prod);
                        //Play Adobe Analytics Media module from beginning.
                        s.Media.play(adobeMediaName, currentTime);
                    }

                    if(adobe && isPlaying && !tmCC && currentTime > 0 ) {

                     var tracks = myPlayer.textTracks();
                
                     for (var i = 0; i < tracks.length; i++) {
                     var track = tracks[i];
                
                     // Find the English captions track and mark it as "showing".
                     if (track.kind === 'captions' && track.mode === 'showing') {
                         //track.mode = 'showing';
                         s.contextData['tmAdReq'] = "";
                         s.contextData['tmAdPlay'] = "";
                         s.contextData['tmAFLW'] = "";
                         s.contextData['tmMidroll']= "";
                                     
                         s.contextData['tmIsCC'] = "yes";
                         log("++ In timeupdate and CC turned on by user ++ " + mediaName + " | " + videoDuration, prod);
                         tmCC = true;
                          //send info to adobe 
                          s.Media.track(adobeMediaName, currentTime);
                          s.Media.play(adobeMediaName, currentTime);
                       }
                      }
                    }

                });

                myPlayer.on('volumechange', function() {
                    log("++volumechange - " + myPlayer.mediainfo.name, prod);
                });

                myPlayer.on('waiting', function() {
                    log("++waiting - " + myPlayer.mediainfo.name, prod);
                    if (isContentLoaded) {//convivaHelper.updatePlayerState("waiting");
                    }
                });

                myPlayer.on('durationchange', function() {
                    log("++durationchange - " + myPlayer.mediainfo.name, prod);
                     myPlayer.mediainfo.duration > myPlayer.duration() ? myPlayer.mediainfo.duration = myPlayer.mediainfo.duration : myPlayer.mediainfo.duration = myPlayer.duration()
                });

                myPlayer.on('ended', function() {
                    log("++ended - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        adobe && s.Media.stop(adobeMediaName, currentTime);
                        adobe && s.Media.close(adobeMediaName);
                        //convivaHelper.updatePlayerState("ended");
                        //convivaHelper.cleanupConvivaSession();
                        resetVariables();
                    }
                });
                            
                myPlayer.on('abort', function() {
                    log("++abort - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        adobe && s.Media.stop(adobeMediaName, currentTime);
                        adobe && s.Media.close(adobeMediaName);
                        //convivaHelper.updatePlayerState("ended");
                        //convivaHelper.cleanupConvivaSession();
                        resetVariables();
                });                            

                myPlayer.on("bc-catalog-error", function() {
                    log("++ In Catalog Error ++", prod);
                    var error = myPlayer.error_;
                    var code = error.code;
                    var message = error.message;
                    var type = error.type;
                    //convivaHelper.contentReportError(code + ": " + message + " " + type, Conviva.Client.ErrorSeverity.FATAL);
                    //convivaHelper.cleanupConvivaSession();
                });

                myPlayer.on("error", function() {
                    log("++ In Error ++", prod);
                    var error = myPlayer.error_;
                    var code = error.code;
                    var message = error.message;
                    var type = error.type;
                    //convivaHelper.contentReportError(code + ": " + message + " " + type, Conviva.Client.ErrorSeverity.FATAL);
                    //convivaHelper.cleanupConvivaSession();
                });

                myPlayer.on('fullscreenchange', function() {
                    log("++fullscreenchange - " + myPlayer.mediainfo.name, prod);
                });

                myPlayer.on('loadedalldata', function() {
                    log("++loadedalldata - " + myPlayer.mediainfo.name, prod);

                });

                myPlayer.on('loadeddata', function() {
                    log("++loadeddata ++ " + myPlayer.mediainfo.name, prod);

                    //integration.collectContentMetdata();
                    //    adobe && s.Media.stop(adobeMediaName, currentTime);
                    //    adobe && s.Media.close(adobeMediaName);
                
                
                });

                myPlayer.on('loadedmetadata', function() {
                    log("++loadedmetadata - " + myPlayer.mediainfo.name, prod);
                    if (myPlayer.mediainfo.name) {
                        isContentLoaded = true;
                        //Initiate Adobe Analytics Media Module tracking && Conviva Analytics
                        //ABDMediaOPEN();
                        //integration = new NewConvivaIntegration(myPlayer,convivaConfigs,metadata);
                    }
                });

                function getSafe(fn, defaultVal) {
                    try {
                        return fn();
                    } catch (e) {
                        return defaultVal;
                    }
                }
                function getHostName() {
                   var hostname = window.location.hostname.replace(/^(www\.|m\.)/, '');
                    if (/^aflw/i.test(location.pathname.split('/')[1])) hostname = 'womens.afl'; //add old womens playername 
                    return hostname;
                }   
                function getPlayerName() {
                    var hostname = window.location.hostname.replace(/^(www\.|m\.)/, '');
                        if (/^aflw/i.test(location.pathname.split('/')[1])) hostname = 'womens.afl'; //add old womens playername 

                    aflSitesArray = new Object();
                    aflSitesArray['afl.com.au'] = 'AFL Network';
                    aflSitesArray['fantasy.afl.com.au'] = 'AFL Fantasy';
                    aflSitesArray['tipping.afl.com.au'] = 'AFL Tipping';
                    aflSitesArray['afc.com.au'] = 'Adelaide Crows';
                    aflSitesArray['lions.com.au'] = 'Brisbane Lions';
                    aflSitesArray['carltonfc.com.au'] = 'Carlton Blues';
                    aflSitesArray['collingwoodfc.com.au'] = 'Collingwood Magpies';
                    aflSitesArray['essendonfc.com.au'] = 'Essendon Bombers';
                    aflSitesArray['fremantlefc.com.au'] = 'Fremantle';
                    aflSitesArray['geelongcats.com.au'] = 'Geelong Cats';
                    aflSitesArray['goldcoastfc.com.au'] = 'Gold Coast';
                    aflSitesArray['gwsgiants.com.au'] = 'GWS';
                    aflSitesArray['hawthornfc.com.au'] = 'Hawthorn Hawks';
                    aflSitesArray['melbournefc.com.au'] = 'Melbourne Demons';
                    aflSitesArray['nmfc.com.au'] = 'Kangaroos';
                    aflSitesArray['portadelaidefc.com.au'] = 'Port Adelaide';
                    aflSitesArray['richmondfc.com.au'] = 'Richmond Tigers';
                    aflSitesArray['saints.com.au'] = 'St.Kilda Saints';
                    aflSitesArray['sydneyswans.com.au'] = 'Sydney Swans';
                    aflSitesArray['westcoasteagles.com.au'] = 'West Coast Eagles';
                    aflSitesArray['westernbulldogs.com.au'] = 'Western Bulldogs';
                    aflSitesArray['womens.afl'] = 'AFLW Network';

                    return aflSitesArray[hostname] || "AFL test";
                }

            });
