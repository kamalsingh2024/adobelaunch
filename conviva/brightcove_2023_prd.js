/*! (C) 2025 Conviva, Inc. All rights reserved. Confidential and proprietary. */
!function(t,e){"function"==typeof define&&define.amd?define(e):("object"==typeof exports||"object"==typeof module&&module.exports)&&(module.exports=e()),void 0===t||!t||t.Conviva||t.ConvivaLoading||(t.ConvivaLoading=!0,t.Conviva=e(),delete t.ConvivaLoading)}(this,(function(){var t={};return function(){"use strict";var e,n,i,o,a,r,s,l,u,c,h,f,d,E,v,g,p,A,T,S,C,R,P,y,N,_,m,O,I,D,M,L,w,b,U,F,V,k,K,Y,H,B,G,W,x,q,j,J,X,Q,$,Z,z,tt,et,nt,it,ot,at,rt,st,lt,ut={};function ct(){var t,e="";for("-"===n&&r(e="-");n>="0"&&n<="9";)e+=n,r();if("."===n)for(e+=".";r()&&n>="0"&&n<="9";)e+=n;if("e"===n||"E"===n)for(e+=n,r(),"-"!==n&&"+"!==n||(e+=n,r());n>="0"&&n<="9";)e+=n,r();if(t=+e,!isNaN(t))return t;a("Bad number")}function ht(t){return t<10?"0"+t:t}function ft(t){return L.lastIndex=0,L.test(t)?'"'+t.replace(L,(function(t){var e=U[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+t+'"'}c=t.Constants={version:"4.7.13",CUSTOMER_KEY:"customerKey",GATEWAY_URL:"gatewayUrl",LOG_LEVEL:"logLevel",ASSET_NAME:"Conviva.assetName",PLAYER_NAME:"Conviva.applicationName",APPLICATION_VERSION:"c3.app.version",IS_LIVE:"Conviva.streamType",ENCODED_FRAMERATE:"Conviva.encodedFrameRate",DEFAULT_RESOURCE:"Conviva.defaultResource",STREAM_URL:"Conviva.streamUrl",VIEWER_ID:"Conviva.viewerId",DURATION:"Conviva.duration",UTM_TRACKING_URL:"c3.cm.utmTrackingUrl",POD_INDEX:"podIndex",POD_POSITION:"podPosition",POD_DURATION:"podDuration",AD_TYPE:"adType",MODULE_NAME:"Conviva.moduleName",MODULE_VERSION:"Conviva.moduleVersion",FRAMEWORK_NAME:"Conviva.frameworkName",FRAMEWORK_VERSION:"Conviva.frameworkVersion",i:"Constants not yet configured",o:"Invalid : Did you report playback ended?",u:"Invalid : Did you report ad playback ended?",h:"Player cannot be null",l:"PlaybackAnlytics already built",v:"PlaybackAnlytics not yet built",Playback:{BITRATE:"BITRATE",AVG_BITRATE:"AVG_BITRATE",PLAY_HEAD_TIME:"PLAY_HEAD_TIME",RESOLUTION:"RESOLUTION",BUFFER_LENGTH:"BUFFER_LENGTH",PLAYER_STATE:"PLAYER_STATE",RENDERED_FRAMERATE:"RENDERED_FRAMERATE",SEEK_STARTED:"SEEK_STARTED",SEEK_ENDED:"SEEK_ENDED",CDN_IP:"CDN_IP",DROPPED_FRAMES_TOTAL:"DROPPED_FRAMES_TOTAL",DROPPED_FRAMES_COUNT:"DROPPED_FRAMES_COUNT",AUDIO_LANGUAGE:"AUDIO_LANGUAGE",SUBTITLES_LANGUAGE:"SUBTITLES_LANGUAGE",CLOSED_CAPTIONS_LANGUAGE:"CLOSED_CAPTIONS_LANGUAGE"},Network:{SIGNAL_STRENGTH:"SIGNAL_STRENGTH",LINK_ENCRYPTION:"LINK_ENCRYPTION",CONNECTION_TYPE:"CONNECTION_TYPE"},ErrorSeverity:{FATAL:1,WARNING:0},NO_SESSION_KEY:-2,AdPosition:{PREROLL:"Pre-roll",MIDROLL:"Mid-roll",POSTROLL:"Post-roll"},AdPlayer:{CONTENT:"CONTENT",SEPARATE:"SEPARATE"},DeviceType:{DESKTOP:"DESKTOP",CONSOLE:"Console",SETTOP:"Settop",MOBILE:"Mobile",TABLET:"Tablet",SMARTTV:"SmartTV",VEHICLE:"Vehicle",OTHER:"Other"},AdType:{CLIENT_SIDE:"Client Side",SERVER_SIDE:"Server Side"},AdSlates:{BLACKOUT_SLATE:"Blackout slate",TECHNICAL_DIFFICULTIES_SLATE:"Technical Difficulties slate",COMMERCIAL_SLATE:"Commercial Break slate",OTHER_SLATE:"Other slate",VPAID:"VPAID",REGULAR:"Regular Ad"},AdServingType:{INLINE:"Inline",WRAPPER:"Wrapper"},DeviceCategory:{ANDROID_DEVICE:"AND",APPLE_DEVICE:"APL",CHROMECAST:"CHR",DESKTOP_APP:"DSKAPP",DEVICE_SIMULATOR:"SIMULATOR",LG_TV:"LGTV",NINTENDO:"NINTENDO",PLAYSTATION:"PS",ROKU:"RK",SAMSUNG_TV:"SAMSUNGTV",SMART_TV:"TV",SET_TOP_BOX:"STB",TIVO:"TIVO",WEB:"WEB",WINDOWS_DEVICE:"WIN",XBOX:"XB",KAIOS_DEVICE:"KAIOS",LINUX:"LNX"},LogLevel:{DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},PlayerState:{STOPPED:"STOPPED",PLAYING:"PLAYING",BUFFERING:"BUFFERING",PAUSED:"PAUSED",UNKNOWN:"UNKNOWN",NOT_MONITORED:"NOT_MONITORED"},Events:{USER_WAIT_STARTED:"Conviva.UserWaitStarted",USER_WAIT_ENDED:"Conviva.UserWaitEnded",BUMPER_VIDEO_STARTED:"Conviva.BumperVideoStarted",BUMPER_VIDEO_ENDED:"Conviva.BumperVideoEnded",AD_REQUESTED:"Conviva.AdRequested",AD_RESPONSE:"Conviva.AdResponse",AD_SLOT_STARTED:"Conviva.SlotStarted",AD_ATTEMPTED:"Conviva.AdAttempted",AD_SLOT_ENDED:"Conviva.SlotEnded",AD_IMPRESSION_START:"Conviva.AdImpression",AD_START:"Conviva.AdStart",AD_FIRST_QUARTILE:"Conviva.AdFirstQuartile",AD_MID_QUARTILE:"Conviva.AdMidQuartile",AD_THIRD_QUARTILE:"Conviva.AdThirdQuartile",AD_COMPLETE:"Conviva.AdComplete",AD_END:"Conviva.AdEnd",AD_IMPRESSION_END:"Conviva.AdImpressionEnd",AD_SKIPPED:"Conviva.AdSkipped",AD_ERROR:"Conviva.AdError",AD_PROGRESS:"Conviva.AdProgress",AD_CLOSE:"Conviva.AdClose",CONTENT_PAUSED:"Conviva.PauseContent",CONTENT_RESUMED:"Conviva.ResumeContent",POD_START:"Conviva.PodStart",POD_END:"Conviva.PodEnd"},ErrorType:{ERROR_UNKNOWN:"ERROR_UNKNOWN",ERROR_IO:"ERROR_IO",ERROR_TIMEOUT:"ERROR_TIMEOUT",ERROR_NULL_ASSET:"ERROR_NULL_ASSET",ERROR_MISSING_PARAMETER:"ERROR_MISSING_PARAMETER",ERROR_NO_AD_AVAILABLE:"ERROR_NO_AD_AVAILABLE",ERROR_PARSE:"ERROR_PARSE",ERROR_INVALID_VALUE:"ERROR_INVALID_VALUE",ERROR_INVALID_SLOT:"ERROR_INVALID_SLOT",ERROR_3P_COMPONENT:"ERROR_3P_COMPONENT",ERROR_UNSUPPORTED_3P_FEATURE:"ERROR_UNSUPPORTED_3P_FEATURE",ERROR_DEVICE_LIMIT:"ERROR_DEVICE_LIMIT",ERROR_UNMATCHED_SLOT_SIZE:"ERROR_UNMATCHED_SLOT_SIZE"},StreamType:{UNKNOWN:"UNKNOWN",LIVE:"LIVE",VOD:"VOD"},CallbackFunctions:{CONSOLE_LOG:"consoleLog",MAKE_REQUEST:"makeRequest",SAVE_DATA:"saveData",LOAD_DATA:"loadData",GET_EPOCH_TIME_IN_MS:"getEpochTimeInMs",CREATE_TIMER:"createTimer",GENERATE_HASH:"generateHash",BASE64_ENCODE:"base64Encode"},DeviceMetadata:{BRAND:"DeviceBrand",MANUFACTURER:"DeviceManufacturer",MODEL:"DeviceModel",TYPE:"DeviceType",VERSION:"DeviceVersion",OS_NAME:"OperatingSystemName",OS_VERSION:"OperatingSystemVersion",CATEGORY:"DeviceCategory",SCREEN_RESOLUTION_WIDTH:"ScreenWidth",SCREEN_RESOLUTION_HEIGHT:"ScreenHeight",SCREEN_RESOLUTION_SCALE_FACTOR:"ScaleFactor"},AD_PRELOAD_FEATURE:"adPreloading",AD_TAG_URL:"adTagUrl",IMASDK_CONTENT_PLAYER:"imaMainContentPlayer",CONVIVA_AD_MODULE:"convivaAdModule",CONVIVA_MODULE:"convivaModule",MEDIA_ELEMENT:"mediaElement",APP_TRACKER_EVENT:{TYPE:"convivaVideoEvent",INIT:"c3.sdk.init",VIDEO_ATTEMPT:"c3.video.attempt",VIDEO_END:"c3.video.end",VIDEO_PLAY:"c3.video.play",VIDEO_PAUSE:"c3.video.pause",VIDEO_BUFFERING:"c3.video.buffering",VIDEO_ERROR:"c3.video.error",SDK_CUSTOM_EVENT:"c3.sdk.custom_event",VIDEO_CUSTOM_EVENT:"c3.video.custom_event",AD_BREAK_START:"c3.ad.ad_break_start",AD_BREAK_END:"c3.ad.ad_break_end",VIDEO_METADATA_CHANGE:"c3.video.set_content_info",VIDEO_BITRATE_SWITCH:"c3.video.bitrate_switch"}},(h=t.Client=function(){var t=this;this._=null,this.R=!1,this.version=h.version,this.p=null,this.A=null,this.T=null,this.S=-1,this.O=null,this.N=null,this.g=null,this.I=null,this.C=-1,this.m=!1,this.D={},this.P=function(){t.p},this.L={},this.M=null,this.U=null,this.V=null,this.k=function(){this.g.F("Client.makeIPV4IPV6GlobalSessions",(function(){var e;t.I&&null!==(e=t.I.get(J.B))&&e!==H.H&&t.A&&((e=new d).custom["c3.IPV4IPV6GlobalSession"]="T",e.custom["c3.domain"]=t.O.G.indexOf(f.j)>-1?f.j:f.K,t.W=t.A.Y(e,null),(e=new d).custom["c3.IPV4IPV6GlobalSession"]="T",e.custom["c3.domain"]=t.O.q.indexOf(f.X)>-1?f.X:f.J,t.Z=t.A.Y(e,null))}))},this.$=function(e){t.g.F("Client.updateConnectionType",(function(){if(t.M=e,t.A){var n,i=t.A.tt();for(n in i)i[n].nt(e)}}))},this.it=function(e){t.g.F("Client.updateLinkEncryption",(function(){if(t.U=e,t.A){var n,i=t.A.tt();for(n in i)i[n].et(e)}}))},this.ot=function(e){t.g.F("Client.updateSignalStrength",(function(){t.V=e}))},function(e,n,i,o){if(!(e instanceof f))throw new Error("clientSettings parameter should be an instance of ClientSettings.");if(!(n instanceof R))throw new Error("systemFactory parameter should be an instance of SystemFactory.");e.gatewayUrl!==f.rt+f.ut&&e.gatewayUrl!==f.ht+f.ut||(this.R=!0),o&&(this.version=o),this.O=e.ct(),this.T=n,this.T.lt("SDK",this.O,this.version),this.g=this.T.dt(this.version),this.g.F("Client.init",(function(){if(t.I=t.T.vt(),t.I.Et(),t.C=t.I.get(J._t),-1!==t.C&&void 0!==t.C&&null!==t.C||(t.C=et.Rt()),t.A=t.T.At(t,t.O,t.I),i)for(var e in i)switch(e){case c.Network.CONNECTION_TYPE:t.$(i[e]);break;case c.Network.LINK_ENCRYPTION:t.it(i[e]);break;case c.Network.SIGNAL_STRENGTH:t.ot(i[e])}t.k()}),(function(t){throw new Error("Client constructor failed: "+t.message)}))}.apply(this,arguments),this.release=function(){this.m||this.g.F("Client.release",(function(){t.p,t.A.Tt(),t.A=null,t.S=-1,t.C=-1,t.g=null,t.O=null,t.N=null,t.T=null,t.m=!0}))},this.createSession=function(e,n,i){var o=h.NO_SESSION_KEY;return this.m||(!e||e instanceof d)&&this.g.F("Client.createSession",(function(){o=t.A.St(e,W.Nt.Ot,n,(i?c:t).version)})),o},this.createAdSession=function(e,n,i,o,a){var r=h.NO_SESSION_KEY;return this.m||(!n||n instanceof d)&&this.g.F("Client.createAdSession",(function(){var s,l;n||(n=new d),Z.gt(e)&&e!==h.NO_SESSION_KEY&&(s=t.A.It(e))&&(l=n.custom[c.APPLICATION_VERSION],s.wt&&s.wt.Ct&&(!n.viewerId&&s.wt.Ct.viewerId&&(n.viewerId=s.wt.Ct.viewerId),!n.applicationName&&s.wt.Ct.applicationName&&(n.applicationName=s.wt.Ct.applicationName),n.streamType===c.StreamType.UNKNOWN&&s.wt.Ct.streamType!==c.StreamType.UNKNOWN&&(n.streamType=s.wt.Ct.streamType),void 0!==l&&l||void 0!==(l=s.wt.Ct.custom[c.APPLICATION_VERSION])&&l&&(n.custom[c.APPLICATION_VERSION]=l)),n.custom["c3.csid"]=Z.yt(s.C)),r=t.A.St(n,W.Nt.Dt,i,(o?c:t).version,a)})),r},this.reportError=function(e,n,i){this.m||!Z.Pt(n)||i!==h.ErrorSeverity.FATAL&&i!==h.ErrorSeverity.WARNING||this.g.F("Client.reportError",(function(){var o=t.A.It(e);o&&o.bt(n,i)}))},this.updateContentMetadata=function(e,n){this.m||n instanceof d&&this.g.F("Client.updateContentMetadata",(function(){var i,o=t.A.It(e);o&&(i=n.ct(),o.Lt(i))}))},this.detachPlayer=function(e){this.m||this.g.F("Client.detachPlayer",(function(){var n=t.A.It(e);n&&n.Mt()}))},this.Ut=function(e){this.m||this.g.F("Client.offFocus",(function(){var n=t.A.It(e);n&&n.Ut()}))},this.attachPlayer=function(e,n){this.m||n instanceof E&&this.g.F("Client.attachPlayer",(function(){var i=t.A.It(e);i&&i.Vt(n)}))},this.kt=function(e){this.m||this.g.F("Client.onFocus",(function(){var n=t.A.It(e);n&&n.kt()}))},this.contentPreload=function(e){this.m||this.g.F("Client.contentPreload",(function(){var n=t.A.It(e);n&&n.Ft()}))},this.contentStart=function(e){this.m||this.g.F("Client.contentStart",(function(){var n=t.A.It(e);n&&n.Bt()}))},this.sendCustomEvent=function(e,n,i){this.m||Z.Pt(n)&&(Z.Ht(i),this.g.F("Client.sendCustomEvent",(function(){e===h.NO_SESSION_KEY&&(t.S<0&&(o=new d,t.S=t.A.Y(o,null)),e=t.S);var o=Z.Gt(i),a=t.A.jt(e);a&&a.Kt(n,o)})))},this.adStart=function(e,n,i,o){this.m||n!==h.AdStream.CONTENT&&n!==h.AdStream.SEPARATE||i!==h.AdPlayer.CONTENT&&i!==h.AdPlayer.SEPARATE||(o!==h.AdPosition.PREROLL&&o!==h.AdPosition.MIDROLL&&h.AdPosition.POSTROLL,this.g.F("Client.adStart",(function(){var a=t.A.It(e);a&&a.Wt(n,i,o)})))},this.adEnd=function(e){this.m||this.g.F("Client.adEnd",(function(){var n=t.A.It(e);n&&n.Yt()}))},this.cleanupSession=function(e){this.m||e!==h.NO_SESSION_KEY&&this.g.F("Client.cleanupSession",(function(){t.A.It(e)&&t.A.xt(e)}))},this.getAttachedPlayer=function(e){var n=null;return this.m||e!==h.NO_SESSION_KEY&&this.g.F("Client.getAttachedPlayer",(function(){var i=t.A.It(e);i&&(n=i.qt())})),n},this.isPlayerAttached=function(t){return!this.m&&null!==this.getAttachedPlayer(t)},this.getPlayerStateManager=function(e){if(this.m)throw new Error("This instance of Conviva.Client has been released.");return new E(this.T,(e?c:t).version)},this.releasePlayerStateManager=function(t){if(this.m)throw new Error("This instance of Conviva.Client has been released.");this.g.F("Client.releasePlayerStateManager",(function(){t instanceof E&&t.release()}))},this.Xt=function(){return this.O},this.getId=function(){return this.C},this.getSessionId=function(e){var n;return this.m?c.NO_SESSION_KEY:(n=null,this.g.F("Client.getSessionId",(function(){var i=t.A.It(e);i&&(n=i.Jt())})),n)},this.getClientId=function(e){var n;return this.m?null:(n=null,this.g.F("Client.getClientId",(function(){var i=t.A.It(e);i&&(n=i.Qt())})),n)},this.Zt=function(e,n,i){this.m||this.g.F("Client.updateCustomMetric",(function(){var o=t.A.It(e);o&&o.Zt(n,i)}))},this.setUniqueIdentifier=function(t,e){if(this.m)throw new Error("This instance of Conviva.Client has been released.");if(!t||void 0===t||"{}"===JSON.stringify(t))throw new Error("Identifiers are not set. No action taken !!");for(var n in t)this.D[n]=t[n];e&&(this.P=e)},this.setUserPreferenceForDataCollection=function(t,e){if(this.m)throw new Error("This instance of Conviva.Client has been released.");if(!t||void 0===t||"{}"===JSON.stringify(t))throw new Error("Identifiers are not set. No action taken !!");for(var n in t)"false"===t[n]?this.L[n]=e?J.$t.zt:J.$t.tn:this.L[n]=J.$t.nn},this.setUserPreferenceForDataDeletion=function(t){if(this.m)throw new Error("This instance of Conviva.Client has been released.");if(!t||void 0===t||"{}"===JSON.stringify(t))throw new Error("Identifiers are not set. No action taken !!");for(var e in t)"true"===t[e]?this.L[e]=J.$t.en:this.L[e]=J.$t.nn},this.getConfig=function(){if(this.m)throw new Error("This instance of Conviva.Client has been released.");return this.I}}).version="4.7.13L",h.NO_SESSION_KEY=c.NO_SESSION_KEY,h.AdPosition={PREROLL:c.AdPosition.PREROLL,MIDROLL:c.AdPosition.MIDROLL,POSTROLL:c.AdPosition.POSTROLL},h.AdStream={CONTENT:c.AdPlayer.CONTENT,SEPARATE:c.AdPlayer.SEPARATE},h.AdPlayer={CONTENT:c.AdPlayer.CONTENT,SEPARATE:c.AdPlayer.SEPARATE},h.ErrorSeverity={FATAL:c.ErrorSeverity.FATAL,WARNING:c.ErrorSeverity.WARNING},h.DeviceType={DESKTOP:c.DeviceType.DESKTOP,CONSOLE:c.DeviceType.CONSOLE,SETTOP:c.DeviceType.SETTOP,MOBILE:c.DeviceType.MOBILE,TABLET:c.DeviceType.TABLET,SMARTTV:c.DeviceType.SMARTTV,VEHICLE:c.DeviceType.VEHICLE,OTHER:c.DeviceType.OTHER},h.AdTechnology={CLIENT_SIDE:c.AdType.CLIENT_SIDE,SERVER_SIDE:c.AdType.SERVER_SIDE},h.AdType={BLACKOUT_SLATE:c.AdSlates.BLACKOUT_SLATE,TECHNICAL_DIFFICULTIES_SLATE:c.AdSlates.TECHNICAL_DIFFICULTIES_SLATE,COMMERCIAL_SLATE:c.AdSlates.COMMERCIAL_SLATE,OTHER_SLATE:c.AdSlates.OTHER_SLATE,VPAID:c.AdSlates.VPAID,REGULAR:c.AdSlates.REGULAR},h.AdServingType={INLINE:c.AdServingType.INLINE,WRAPPER:c.AdServingType.WRAPPER},h.DeviceCategory={ANDROID_DEVICE:c.DeviceCategory.ANDROID_DEVICE,APPLE_DEVICE:c.DeviceCategory.APPLE_DEVICE,CHROMECAST:c.DeviceCategory.CHROMECAST,DESKTOP_APP:c.DeviceCategory.DESKTOP_APP,DEVICE_SIMULATOR:c.DeviceCategory.DEVICE_SIMULATOR,LG_TV:c.DeviceCategory.LG_TV,NINTENDO:c.DeviceCategory.NINTENDO,PLAYSTATION:c.DeviceCategory.PLAYSTATION,ROKU:c.DeviceCategory.ROKU,SAMSUNG_TV:c.DeviceCategory.SAMSUNG_TV,SMART_TV:c.DeviceCategory.SMART_TV,SET_TOP_BOX:c.DeviceCategory.SET_TOP_BOX,TIVO:c.DeviceCategory.TIVO,WEB:c.DeviceCategory.WEB,WINDOWS_DEVICE:c.DeviceCategory.WINDOWS_DEVICE,XBOX:c.DeviceCategory.XBOX,KAIOS_DEVICE:c.DeviceCategory.KAIOS_DEVICE,LINUX:c.DeviceCategory.LINUX},(f=t.ClientSettings=function(){var t=this;this.on=null,Z.rn(this,"customerKey",(function(){return this.on})),Z.un(this,"customerKey",(function(t){Z.Pt(t)&&(this.on=t)})),this.hn=f.fn,Z.rn(this,"heartbeatInterval",(function(){return this.hn})),Z.un(this,"heartbeatInterval",(function(t){var e;"number"==typeof t&&(e=Z.cn(t))===t&&(this.hn=e)})),this.ln=null,this.G=null,this.q=null,Z.rn(this,"gatewayUrl",(function(){return this.ln})),Z.un(this,"gatewayUrl",(function(t){var e;!Z.Pt(t)||"https"!==(e=t.split("://"))[0]&&"http"!==e[0]||-1===t.indexOf(".com",t.length-4)||(this.ln=t)})),function(t){if(!Z.Pt(t))throw new Error("customerKey must be valid");this.customerKey=t}.apply(this,arguments),this.equals=function(t){return this.customerKey===t.customerKey&&this.gatewayUrl===t.gatewayUrl&&this.heartbeatInterval===t.heartbeatInterval},this.ct=function(){var e=new f(this.customerKey);return e.gatewayUrl=function(e){if(Z.Pt(e)){var n,i=e.split("://");if("https"===i[0]||"http"===i[0])return i[1]!==f.ut&&-1!==i[1].indexOf(f.ut)?(n=i[1].split(f.ut),t.G="https://"+n[0]+f.j,t.q="https://"+n[0]+f.X):(t.G="https://ipv4."+i[1],t.q="https://ipv6."+i[1]),e}return t.G="https://"+t.customerKey+"."+f.j,t.q="https://"+t.customerKey+"."+f.X,"https://"+t.customerKey+"."+f.ut}(this.gatewayUrl),e.heartbeatInterval=this.heartbeatInterval,e.G=this.G,e.q=this.q,e}}).sn="https://conviva.testonly.conviva.com",f.dn="https://cws.conviva.com",f.ut="cws.conviva.com",f.j="ipv4.cws.conviva.com",f.X="ipv6.cws.conviva.com",f.vn="conviva.testonly.conviva.com",f.K="ipv4.testonly.conviva.com",f.J="ipv6.testonly.conviva.com",f.rt="https://",f.ht="http://",f.En=5,f.fn=20,(d=t.ContentMetadata=function(){this._n=null,Z.rn(this,"assetName",(function(){return this._n})),Z.un(this,"assetName",(function(t){"string"==typeof t&&(this._n=t)})),this.Rn={},Z.rn(this,"custom",(function(){return this.Rn})),Z.un(this,"custom",(function(t){"object"==typeof t&&(this.Rn=Z.Gt(t))})),this.An=null,Z.rn(this,"defaultResource",(function(){return this.An})),Z.un(this,"defaultResource",(function(t){"string"==typeof t&&(this.An=t)})),this.Tn=null,Z.rn(this,"viewerId",(function(){return this.Tn})),Z.un(this,"viewerId",(function(t){"string"==typeof t&&(this.Tn=t)})),this.Sn=null,Z.rn(this,"applicationName",(function(){return this.Sn})),Z.un(this,"applicationName",(function(t){"string"==typeof t&&(this.Sn=t)})),this.On=null,Z.rn(this,"streamUrl",(function(){return this.On})),Z.un(this,"streamUrl",(function(t){"string"==typeof t&&(this.On=t)})),this.Nn=d.StreamType.UNKNOWN,Z.rn(this,"streamType",(function(){return this.Nn})),Z.un(this,"streamType",(function(t){t!==d.StreamType.UNKNOWN&&t!==d.StreamType.VOD&&t!==d.StreamType.LIVE||(this.Nn=t)})),this.gn=-1,Z.rn(this,"duration",(function(){return this.gn})),Z.un(this,"duration",(function(t){this.gn=nt.In(t)})),this.wn=-1,Z.rn(this,"encodedFrameRate",(function(){return this.wn})),Z.un(this,"encodedFrameRate",(function(t){this.wn=nt.In(t)})),function(){}.apply(this,arguments),this.ct=function(){var t,e=new d;for(t in e.assetName=this.assetName,e.applicationName=this.applicationName,e.streamUrl=this.streamUrl,e.viewerId=this.viewerId,e.defaultResource=this.defaultResource,e.streamType=this.streamType,e.duration=this.duration,e.encodedFrameRate=this.encodedFrameRate,this.custom)e.custom[t]=this.custom[t];return e}}).StreamType={UNKNOWN:c.StreamType.UNKNOWN,LIVE:c.StreamType.LIVE,VOD:c.StreamType.VOD},t.ErrorType={ERROR_UNKNOWN:c.ErrorType.ERROR_UNKNOWN,ERROR_IO:c.ErrorType.ERROR_IO,ERROR_TIMEOUT:c.ErrorType.ERROR_TIMEOUT,ERROR_NULL_ASSET:c.ErrorType.ERROR_NULL_ASSET,ERROR_MISSING_PARAMETER:c.ErrorType.ERROR_MISSING_PARAMETER,ERROR_NO_AD_AVAILABLE:c.ErrorType.ERROR_NO_AD_AVAILABLE,ERROR_PARSE:c.ErrorType.ERROR_PARSE,ERROR_INVALID_VALUE:c.ErrorType.ERROR_INVALID_VALUE,ERROR_INVALID_SLOT:c.ErrorType.ERROR_INVALID_SLOT,ERROR_3P_COMPONENT:c.ErrorType.ERROR_3P_COMPONENT,ERROR_UNSUPPORTED_3P_FEATURE:c.ErrorType.ERROR_UNSUPPORTED_3P_FEATURE,ERROR_DEVICE_LIMIT:c.ErrorType.ERROR_DEVICE_LIMIT,ERROR_UNMATCHED_SLOT_SIZE:c.ErrorType.ERROR_UNMATCHED_SLOT_SIZE},t.Events={AD_REQUESTED:c.Events.AD_REQUESTED,AD_RESPONSE:c.Events.AD_RESPONSE,AD_SLOT_STARTED:c.Events.AD_SLOT_STARTED,AD_ATTEMPTED:c.Events.AD_ATTEMPTED,AD_SLOT_ENDED:c.Events.AD_SLOT_ENDED,AD_IMPRESSION_START:c.Events.AD_IMPRESSION_START,AD_START:c.Events.AD_START,AD_FIRST_QUARTILE:c.Events.AD_FIRST_QUARTILE,AD_MID_QUARTILE:c.Events.AD_MID_QUARTILE,AD_THIRD_QUARTILE:c.Events.AD_THIRD_QUARTILE,AD_COMPLETE:c.Events.AD_COMPLETE,AD_END:c.Events.AD_END,AD_IMPRESSION_END:c.Events.AD_IMPRESSION_END,AD_SKIPPED:c.Events.AD_SKIPPED,AD_ERROR:c.Events.AD_ERROR,AD_PROGRESS:c.Events.AD_PROGRESS,AD_CLOSE:c.Events.AD_CLOSE,CONTENT_PAUSED:c.Events.CONTENT_PAUSED,CONTENT_RESUMED:c.Events.CONTENT_RESUMED,POD_START:c.Events.POD_START,POD_END:c.Events.POD_END},(E=t.PlayerStateManager=function(){var e=this;e.Cn=null,e.yn=-2,e.Dn=-2,e.Pn=E.PlayerState.UNKNOWN,e.bn={},e.Ln=-2,e.wn=-2,e.gn=-2,e.Mn=null,e.Un=null,e.On=null,e.Vn=null,e.kn=null,e.Fn=-1,e.Bn=-1,e.M=null,e.U=null,e.Hn=null,e.Gn=[],e.m=!1,e.jn=null,e.Kn=null,e.Wn=null,this.release=function(){e.m||e.g.F("PlayerStateManager.release",(function(){e.Cn&&e.Cn.Yn(),e.xn(),e.T=null,e.g=null,e.m=!0}))},this.setPlayheadTime=function(){},this.setBufferLength=function(){},this.setRenderedFrameRate=function(){},this.getEncodedFrameRate=function(){return e.wn},this.setEncodedFrameRate=function(t){e.m||e.g.F("PlayerStateManager.setEncodedFrameRate",(function(){var n=nt.In(t);n>=-1&&(e.wn=n,e.Cn)&&e.Cn.qn(e.wn)}))},this.getDuration=function(){return e.gn},this.setClientMeasureInterface=function(e){Z.Xn(e,new t.ClientMeasureInterface,"ClientMeasureInterface"),this.Jn=e},this.getPHT=function(){return this.Jn&&"function"==typeof this.Jn.getPHT?this.Jn.getPHT():E.DEFAULT_PHT},this.getBufferLength=function(){return this.Jn&&"function"==typeof this.Jn.getBufferLength?this.Jn.getBufferLength():E.DEFAULT_BUFFER_LENGTH},this.getSignalStrength=function(){return this.Jn&&"function"==typeof this.Jn.getSignalStrength?this.Jn.getSignalStrength():E.DEFAULT_SIGNAL_STRENGTH},this.getRenderedFrameRate=function(){return this.Jn&&"function"==typeof this.Jn.getRenderedFrameRate?this.Jn.getRenderedFrameRate():E.DEFAULT_RENDERED_FRAME_RATE},this.setDuration=function(t){e.m||e.g.F("PlayerStateManager.setDuration",(function(){var n=nt.In(t);n>=-1&&(e.gn=n,e.Cn)&&e.Cn.Qn(e.gn)}))},this.getStreamUrl=function(){return e.On},this.setStreamUrl=function(t){e.m||e.g.F("PlayerStateManager.setStreamUrl",(function(){t&&(e.On=t,e.Cn)&&e.Cn.Zn(e.On)}))},this.zn=function(){return e.Vn},this.$n=function(){return e.kn},this.setModuleNameAndVersion=function(t,n){e.Vn=t,e.kn=n},this.ti=function(){return e.Un},this.setPlayerType=function(t){e.m||e.g.F("PlayerStateManager.setPlayerType",(function(){e.Un=t,e.Cn&&e.Cn.ni(e.Un)}))},this.ii=function(){return e.Mn},this.setPlayerVersion=function(t){e.m||e.g.F("PlayerStateManager.setPlayerVersion",(function(){e.Mn=t,e.Cn&&e.Cn.ei(e.Mn)}))},this.si=function(){return e.jn},this.setAudioLang=function(t){e.m||e.g.F("PlayerStateManager.setAudioLang",(function(){e.jn=t,e.Cn&&e.Cn.oi(e.jn)}))},this.ri=function(){return e.Kn},this.setSubtitleLang=function(t){e.m||e.g.F("PlayerStateManager.setSubtitleLang",(function(){e.Kn=t,e.Cn&&e.Cn.ui(e.Kn)}))},this.hi=function(){return e.Wn},this.setCcLang=function(t){e.m||e.g.F("PlayerStateManager.setCCLang",(function(){e.Wn=t,e.Cn&&e.Cn.ai(e.Wn)}))},this.setMonitoringNotifier=function(t){return!e.m&&!e.Cn&&(e.Cn=t,e.p,!0)},this.xn=function(){e.m||(e.Cn=null,e.p)},this.fi=function(){e.setPlayerState(e.getPlayerState()),e.setBitrateKbps(e.ci()),e.setAvgBitrateKbps(e.li()),e.setDuration(e.getDuration()),e.setEncodedFrameRate(e.getEncodedFrameRate()),e.setStreamUrl(e.getStreamUrl()),e.setPlayerType(e.ti()),e.setPlayerVersion(e.ii()),e.setAudioLang(e.si()),e.setSubtitleLang(e.ri()),e.setCcLang(e.hi());for(var t=0;t<e.Gn.length;t++){var n=e.Gn[t];e.di(n)}e.Gn=[]},this.getPlayerState=function(){return e.Pn},this.setPlayerState=function(t){e.m||e.g.F("PlayerStateManager.setPlayerState",(function(){E.vi(t)&&(e.Pn=t,e.Cn)&&e.Cn.Ei(e.Pn)}))},this.ci=function(){return e.yn},this.setBitrateKbps=function(t){e.m||e.g.F("PlayerStateManager.setBitrateKbps",(function(){var n=nt.In(t);n>=-1&&(e.yn=n,e.Cn)&&e.Cn._i(e.yn)}))},this.li=function(){return e.Dn},this.setAvgBitrateKbps=function(t){e.m||e.g.F("PlayerStateManager.setAvgBitrateKbps",(function(){var n=nt.In(t);n>=-1&&(e.Dn=n,e.Cn)&&e.Cn.Ri(e.Dn)}))},this.setPlayerSeekStart=function(t){e.m||e.g.F("PlayerStateManager.setPlayerSeekStart()",(function(){e.Cn&&e.Cn.pi(E.SEEK_ACTIONS_TYPE.SEEK_START,t)}))},this.setPlayerSeekEnd=function(){e.m||e.g.F("PlayerStateManager.setPlayerSeekEnd()",(function(){e.Cn&&e.Cn.pi(E.SEEK_ACTIONS_TYPE.SEEK_END,-1)}))},this.setUserSeekButtonUp=function(){e.m||e.g.F("PlayerStateManager.setUserSeekButtonUp()",(function(){e.Cn&&e.Cn.pi(E.SEEK_ACTIONS_TYPE.BUTTON_UP,-1)}))},this.setUserSeekButtonDown=function(){e.m||e.g.F("PlayerStateManager.setUserSeekButtonDown()",(function(){e.Cn&&e.Cn.pi(E.SEEK_ACTIONS_TYPE.BUTTON_DOWN,-1)}))},this.setVideoResolutionWidth=function(t){e.m||e.g.F("PlayerStateManager.setVideoResolutionWidth()",(function(){var n=nt.In(t);n>0&&(e.Fn=n),e.Cn&&e.Cn.Ai(e.Fn)}))},this.setVideoResolutionHeight=function(t){e.m||e.g.F("PlayerStateManager.setVideoResolutionHeight()",(function(){var n=nt.In(t);n>0&&(e.Bn=n),e.Cn&&e.Cn.Ti(e.Bn)}))},this.setConnectionType=function(t){e.m||e.g.F("PlayerStateManager.setConnectionType()",(function(){e.M=t,e.Cn&&e.Cn.nt(e.M)}))},this.setLinkEncryption=function(t){e.m||e.g.F("PlayerStateManager.setLinkEncryption()",(function(){e.U=t,e.Cn&&e.Cn.et(e.U)}))},this.setSignalStrength=function(){},this.di=function(t){var n,i;e.Hn=t,e.Cn?(n=t.errorCode,i=t.severity,e.Cn.Si(n,i)):e.Gn.push(t)},this.sendError=function(t,n){e.m||e.g.F("PlayerStateManager.sendError",(function(){var i=new it(t,n);e.di(i)}))},this.reset=function(){e.m||e.g.F("PlayerStateManager.reset",(function(){e.yn=-2,e.Dn=-2,e.Pn=E.PlayerState.UNKNOWN,e.bn={},e.Ln=-1,e.wn=-1,e.gn=-1,e.Mn=null,e.Un=null,e.On=null,e.Hn=null,e.Gn=[]}))},this.setCDNServerIP=function(t){e.m||e.g.F("PlayerStateManager.setCDNServerIP",(function(){e.Cn&&e.Cn.Oi(t)}))},this.Ni=function(){return e.gi},this.setDroppedFramesTotal=function(t){e.m||e.g.F("PlayerStateManager.setDroppedFramesTotal",(function(){e.Cn&&e.Cn.Ii(t)}))},this.setDroppedFramesCount=function(t){e.m||e.g.F("PlayerStateManager.setDroppedFramesCount",(function(){e.Cn&&e.Cn.wi(t)}))},this.Ci=function(){return e.Hn},function(t,n){e.T=t,e.g=e.T.dt(n)}.apply(e,arguments)}).PlayerState={STOPPED:c.PlayerState.STOPPED,PLAYING:c.PlayerState.PLAYING,BUFFERING:c.PlayerState.BUFFERING,PAUSED:c.PlayerState.PAUSED,UNKNOWN:c.PlayerState.UNKNOWN,NOT_MONITORED:c.PlayerState.NOT_MONITORED},E.vi=function(t){return t===E.PlayerState.STOPPED||t===E.PlayerState.PLAYING||t===E.PlayerState.BUFFERING||t===E.PlayerState.PAUSED||t===E.PlayerState.UNKNOWN||t===E.PlayerState.NOT_MONITORED},E.SEEK_ACTIONS_TYPE={SEEK_START:"pss",SEEK_END:"pse",BUTTON_UP:"bu",BUTTON_DOWN:"bd"},E.DEFAULT_SIGNAL_STRENGTH=1e3,E.DEFAULT_RENDERED_FRAME_RATE=-1,E.DEFAULT_BUFFER_LENGTH=-1,E.DEFAULT_PHT=-1,t.ClientMeasureInterface=function(){this.getPHT=function(){},this.getBufferLength=function(){},this.getSignalStrength=function(){},this.getRenderedFrameRate=function(){}},v=t.HttpInterface=function(){this.makeRequest=function(){},this.release=function(){}},g=t.LoggingInterface=function(){this.consoleLog=function(){},this.release=function(){}},p=t.MetadataInterface=function(){this.getBrowserName=function(){},this.getBrowserVersion=function(){},this.getDeviceBrand=function(){},this.getDeviceManufacturer=function(){},this.getDeviceModel=function(){},this.getDeviceType=function(){},this.getDeviceVersion=function(){},this.getFrameworkName=function(){},this.getFrameworkVersion=function(){},this.getOperatingSystemName=function(){},this.getOperatingSystemVersion=function(){},this.getDeviceCategory=function(){},this.getScreenWidth=function(){},this.getScreenHeight=function(){},this.getScaleFactor=function(){},this.release=function(){}},A=t.StorageInterface=function(){this.saveData=function(){},this.loadData=function(){},this.release=function(){}},T=t.SystemInterface=function(){(function(t,e,n,i,o,a){Z.Xn(t,new S,"TimeInterface"),Z.Xn(e,new C,"TimerInterface"),Z.Xn(n,new v,"HttpInterface"),Z.Xn(i,new A,"StorageInterface"),Z.Xn(o,new p,"MetadataInterface"),Z.Xn(a,new g,"LoggingInterface"),this.yi=t,this.mi=e,this.Di=n,this.Pi=i,this.bi=o,this.Li=a}).apply(this,arguments),this.release=function(){this.yi&&(this.yi.release(),this.yi=null),this.mi&&(this.mi.release(),this.mi=null),this.Di&&(this.Di.release(),this.Di=null),this.Pi&&(this.Pi.release(),this.Pi=null),this.bi&&(this.bi.release(),this.bi=null),this.Li&&(this.Li.release(),this.Li=null)}},S=t.TimeInterface=function(){this.getEpochTimeMs=function(){},this.release=function(){}},C=t.TimerInterface=function(){this.createTimer=function(){},this.release=function(){}},R=t.SystemFactory=function(){var t=this;(function(t,e){if(!(t instanceof T))throw new Error("systemInterface parameter should be an instance of SystemInterface.");this.Mi=t,this.yi=this.Mi.yi,this.mi=this.Mi.mi,this.Di=this.Mi.Di,this.Pi=this.Mi.Pi,this.bi=this.Mi.bi,this.Li=this.Mi.Li,this.O=e instanceof P?e.ct():new P}).apply(this,arguments),this.lt=function(t,e,n){this.Ui=t,this.Vi=e,this.ki=n},this.release=function(){this.Mi.release(),this.Mi=null,this.Ui=null,this.O=null,this.Fi=null};this.buildLogger=function(){return new at(t.Li,t.yi,t.Xt(),t.Fi,t.Ui)},this.At=function(t,e,n){return new q(t,e,n,this)},this.Bi=function(t){return new tt(this.buildLogger(),this.Hi(),this.Vi,t)},this.Gi=function(){return new j(this.buildTimer(t.ki))},this.ji=function(){var t=new lt(this.buildLogger(),this.mi,new Q(this.buildLogger(),null,this.Xt()));return new j(t)},this.Hi=function(){return new ot(this.buildLogger(),this.Di,this.ji(),this.Xt())},this.dt=function(t){return new Q(this.buildLogger(),this.Bi(t),this.Xt())},this.buildTime=function(){return new st(this.yi,this.buildLogger())},this.buildTimer=function(t){return new lt(this.buildLogger(),this.mi,this.dt(t))},this.Ki=function(){return new ut.Storage(this.buildLogger(),this.Pi,this.Gi(),this.Xt())},this.vt=function(){return new J(this.buildLogger(),this.Ki(),this.Wi())},this.Yi=function(t){return new rt(this.buildLogger(),this.bi,this.dt(t))},this.xi=function(){return new H},this.qi=function(t,e){return new $(t,this.buildLogger(),this.Hi(),this.Wi(),e)},this.Xi=function(t,e,n,i,o){var a=this.qi(e,i.custom["c3.domain"]);return new W(this.Ji(),t,e,this.buildLogger(),this.dt(o),this.buildTimer(o),a,this.xi(),this.buildTime(),this.Qi(),n,i,o)},this.Zi=function(t,e,n,i,o,a,r){return t=this.Xi(t,e.ct(),n,a,r),new x(i,o,n,this.Yi(r),t,this.dt(r),this.buildLogger())},this.Ji=function(){return new X},this.Wi=function(){return new B},this.Qi=function(){return this.Fi},this.Xt=function(){return this.O},this.Fi=new z},(P=t.SystemSettings=function(){this.zi=P.$i,Z.rn(this,"logLevel",(function(){return this.zi})),Z.un(this,"logLevel",(function(t){var e;"number"==typeof t&&(e=Z.cn(t))===t&&e>=P.LogLevel.DEBUG&&e<=P.LogLevel.ERROR&&(this.zi=e)})),this.te=P.ne,Z.rn(this,"allowUncaughtExceptions",(function(){return this.te})),Z.un(this,"allowUncaughtExceptions",(function(t){Z.ie(t)&&(this.te=t)})),this.ee=P.se,Z.rn(this,"storageTimeout",(function(){return this.ee})),Z.un(this,"storageTimeout",(function(t){var e;"number"==typeof t&&(e=Z.cn(t))===t&&(this.ee=e)})),this.oe=P.re,Z.rn(this,"httpTimeout",(function(){return this.oe})),Z.un(this,"httpTimeout",(function(t){var e;"number"==typeof t&&(e=Z.cn(t))===t&&(this.oe=e)})),function(){}.apply(this,arguments),this.equals=function(t){return this.logLevel===t.logLevel&&this.allowUncaughtExceptions===t.allowUncaughtExceptions&&this.storageTimeout===t.storageTimeout&&this.httpTimeout===t.httpTimeout},this.ct=function(){var t=new P;return t.logLevel=this.logLevel,t.allowUncaughtExceptions=this.allowUncaughtExceptions,t.storageTimeout=this.storageTimeout,t.httpTimeout=this.httpTimeout,t}}).LogLevel={DEBUG:c.LogLevel.DEBUG,INFO:c.LogLevel.INFO,WARNING:c.LogLevel.WARNING,ERROR:c.LogLevel.ERROR,NONE:c.LogLevel.NONE},P.ue=P.LogLevel.DEBUG,P.$i=P.LogLevel.NONE,P.he=!0,P.ne=!1,P.se=10,P.re=10,y=ut.AdAnalytics=function(){var e=this;function n(t){e.ae?(Z.Ht(t)>0&&e.setAdInfo(t),e.ae.fe()||(e.ae.ce(e.le),e.ae.de(!0),e.getAdType()===c.AdType.SERVER_SIDE&&e.reportAdMetric(c.Playback.BITRATE,e.le.ve()))):e.p}e.Ee=null,e.T=null,e._e=null,e.le=null,e.ae=null,e.Re=null,e.pe=null,e.Ae=null,function(t,n,i){e.Ee=t,e.Ae=i,e.T=n,i&&(e.le=i.Te()),e._e=n.buildTimer(c.version),e.ae=new N(e.Ee,e._e),m.call(this)}.apply(this,arguments),this.setAdInfo=function(t){Z.Ht(t)<=0?e.p:(e.p,e.ae&&e.ae.Se(t))},this.setAdPlayerInfo=function(t){Z.Ht(t)<=0?e.p:(e.p,e.ae&&e.ae.Se(t))},this.reportAdMetric=function(){0===arguments.length?e.p:1===arguments.length?e.Oe(arguments[0]):2===arguments.length?e.Oe(arguments[0],arguments[1]):3===arguments.length?e.Oe(arguments[0],arguments[1],arguments[2]):4===arguments.length&&e.Oe(arguments[0],arguments[1],arguments[2],arguments[3])},this.setCallback=function(t){e.ae&&e.ae.Ne(t)},this.reportAdFailed=function(t,n){e.ae?(Z.Ht(n)>0&&e.setAdInfo(n),e.ae.fe()?(e.p,e.reportAdError(t,h.ErrorSeverity.FATAL),e.reportAdEnded()):(e.ae.ce(e.le),e.p,n=new it(t,h.ErrorSeverity.FATAL),e.ae.de(!0,n))):e.p},this.reportAdLoaded=function(t){e.p,n(t)},this.reportAdStarted=function(t){e.p,n(t)},this.reportAdEnded=function(){e.ae?(e.p,e.ae.fe()&&(e.ae.ce(null),e.ae.de(!1))):e.p},this.reportAdError=function(t,n){e.ae?(e.p,t=new it(t,n),e.ae.di(t)):e.p},this.reportAdPlayerEvent=function(t,n){if(Z.Pt(t))if(e.p,e.ae)switch(t){case c.Events.USER_WAIT_STARTED:case c.Events.BUMPER_VIDEO_STARTED:e.ae.Mt();break;case c.Events.USER_WAIT_ENDED:case c.Events.BUMPER_VIDEO_ENDED:e.ae.Vt();break;default:e.ae.ge(t,n)}else e.p;else e.p},this.reportAdSkipped=function(){e.ae?(e.p,e.reportAdPlayerEvent(c.Events.AD_SKIPPED),e.reportAdEnded()):e.p},this.release=function(){e.p,e.ae&&(e.ae.fe()&&(e.ae.ce(null),e.ae.de(!1)),e.ae.Ne(null),e.ae.Ie(),e.ae=null),void 0!==t.AdProxyMonitor&&e.pe&&(t.AdProxyMonitor.release(e.pe),e.pe=null)},this.setAdListener=function(n,i){n&&(void 0!==i&&void 0!==i.convivaModule?t.AdProxyMonitor=i.convivaModule.AdProxyMonitor:"undefined"!=typeof ConvivaModule&&(t.AdProxyMonitor=ConvivaModule.AdProxyMonitor),void 0!==t.AdProxyMonitor)&&(!n&&e.pe?(t.AdProxyMonitor.release(e.pe),e.pe=null):n&&e.pe?(t.AdProxyMonitor.release(e.pe),e.p,e.pe=t.AdProxyMonitor.initConvivaDropIn(n,i,this,t,e.T)):n&&!e.pe&&(e.p,e.pe=t.AdProxyMonitor.initConvivaDropIn(n,i,this,t,e.T)))},this.reportAdBreakStarted=function(t,n,i){e.le&&(e.p,e.we=t,e.Re=n,e.le.Ce(t,n,i))},this.reportAdBreakEnded=function(){e.le&&(e.p,e.we=null,e.Re=null,e.le.ye())},this.getSessionId=function(){return e.le?(e.p,e.ae.Jt()):c.NO_SESSION_KEY},this.getClientId=function(){return e.le?(e.p,e.ae.Qt()):null},this.getPlayerMonitor=function(){return e.le},this.getAdPlayerMonitor=function(){return e.ae},this.getVideoAnalytics=function(){return e.Ae},this.getAdType=function(){return e.le?e.le.we:null},this.me=function(){return e.le?e.le.Re:null},y.prototype=Object.create(m.prototype),y.prototype.constructor=y},N=ut.AdPlayerMonitorImpl=function(){var t=this;t.De=null,t.Pe=null,function(t,e){D.call(this,t,e)}.apply(this,arguments),this.ce=function(e){this.be()!==e&&(this.Le(),t.Pe=e||null)},this.be=function(){return t.Pe},this.Me=function(e){var n,i=this.be(),o={};o.error=e,t.De&&(t.Ue=t.De.getPlayerStateManager(!0),t.Ve(),t.Ue.setClientMeasureInterface(this),n=null,i&&(n=i.ke()),t.Fe=t.De.createAdSession(n,t.Ct,t.Ue,!0,o),void 0!==e)&&(t.Be(),t.Ie())},N.prototype=Object.create(D.prototype),N.prototype.constructor=N},_=t.Analytics={init:function(){if(this.Ee,arguments.length<=0)throw new Error("customerKey must be valid");var e=null,n=null,i=null;if("string"==typeof arguments[0]&&!Z.Pt(e=arguments[0]))throw new Error("customerKey must be valid");arguments.length>=2&&"object"==typeof arguments[1]&&(n=arguments[1]),arguments.length>=3&&"object"==typeof arguments[2]&&(i=arguments[2]);e=new f(e);var o=new P,a=(i=(Z.Ht(i)>0&&(i[c.GATEWAY_URL]&&(e.gatewayUrl=i[c.GATEWAY_URL]),i[c.LOG_LEVEL]>=0)&&(o.logLevel=i[c.LOG_LEVEL]),new t.Impl.Html5Logging),new t.Impl.Html5Storage),r=new t.Impl.Html5Http,s=new t.Impl.Html5Timer,l=new t.Impl.Html5Time;this.bi||(this.bi=new t.Impl.Html5Metadata),n&&(n[c.CallbackFunctions.CONSOLE_LOG]&&(i.consoleLog=n[c.CallbackFunctions.CONSOLE_LOG]),n[c.CallbackFunctions.MAKE_REQUEST]&&(r.makeRequest=n[c.CallbackFunctions.MAKE_REQUEST]),n[c.CallbackFunctions.SAVE_DATA]&&(a.saveData=n[c.CallbackFunctions.SAVE_DATA]),n[c.CallbackFunctions.LOAD_DATA]&&(a.loadData=n[c.CallbackFunctions.LOAD_DATA]),n[c.CallbackFunctions.GET_EPOCH_TIME_IN_MS]&&(l.getEpochTimeMs=n[c.CallbackFunctions.GET_EPOCH_TIME_IN_MS]),n[c.CallbackFunctions.CREATE_TIMER])&&(s.createTimer=n[c.CallbackFunctions.CREATE_TIMER]),this.Mi=new T(l,s,r,a,this.bi,i),this.T=new R(this.Mi,o),this.T.lt("Analytics",e),this.Ee=new h(e,this.T,this.He,_.version),this.Ee._=new O(this.Ee,this),this.Ee._&&this.Ee._.Ge()},release:function(){var t=0;if(this.je){for(t=0;t<this.je.length;t++){var e=this.je[t];e&&(e.release(),e.p=null,e._e=null,this.je.splice(t,1),t--)}this.je=null}if(this.Ke){for(t=0;t<this.Ke.length;t++){var n=this.Ke[t];n&&(n.release(),n.p=null,n._e=null,this.Ke.splice(t,1),t--)}this.Ke=null}this.T&&(this.T.release(),this.T=null),this.Ee&&(this.Ee.release(),this.Ee=null),this.Ee=null,this.p=null,this.Mi=null,this.bi=null,this.He=null},setUniqueIdentifier:function(t,e){if(!this.Ee)throw new Error(c.i);this.Ee.setUniqueIdentifier(t,e)},setUserPreferenceForDataCollection:function(t,e){if(!this.Ee)throw new Error(c.i);this.Ee.setUserPreferenceForDataCollection(t,e)},setUserPreferenceForDataDeletion:function(t){if(!this.Ee)throw new Error(c.i);this.Ee.setUserPreferenceForDataDeletion(t)},reportAppEvent:function(t,e){if(!this.Ee)throw new Error(c.i);this.Ee.sendCustomEvent(h.NO_SESSION_KEY,t,e)},reportAppBackgrounded:function(){if(!this.Ee)throw new Error(c.i);this.Ee.sendCustomEvent(h.NO_SESSION_KEY,"App.Backgrounded",null)},reportAppForegrounded:function(){if(!this.Ee)throw new Error(c.i);this.Ee.sendCustomEvent(h.NO_SESSION_KEY,"App.Foregrounded",null)},configureExistingClient:function(t){if(!(t instanceof h))throw new Error(c.i);this.Ee=t,this.T=this.Ee.T},buildVideoAnalytics:function(){var t;if(this.Ee)return t=new M(this.Ee,this.T),this.Ke||(this.Ke=[]),this.Ke.push(t),t;throw new Error(c.i)},buildAdAnalytics:function(t){if(this.Ee)return t=new y(this.Ee,this.T,t||null),this.je||(this.je=[]),this.je.push(t),t;throw new Error(c.i)},setDeviceMetadata:function(e){var n,i,o;arguments.length<=0||0===Z.Ht(e)||(this.bi||(this.bi=new t.Impl.Html5Metadata),e[c.DeviceMetadata.BRAND]&&(this.bi.getDeviceBrand=function(){return e[c.DeviceMetadata.BRAND]}),e[c.DeviceMetadata.MANUFACTURER]&&(this.bi.getDeviceManufacturer=function(){return e[c.DeviceMetadata.MANUFACTURER]}),e[c.DeviceMetadata.MODEL]&&(this.bi.getDeviceModel=function(){return e[c.DeviceMetadata.MODEL]}),e[c.DeviceMetadata.TYPE]&&(this.bi.getDeviceType=function(){return e[c.DeviceMetadata.TYPE]}),e[c.DeviceMetadata.VERSION]&&(this.bi.getDeviceVersion=function(){return e[c.DeviceMetadata.VERSION]}),e[c.DeviceMetadata.OS_NAME]&&(this.bi.getOperatingSystemName=function(){return e[c.DeviceMetadata.OS_NAME]}),e[c.DeviceMetadata.OS_VERSION]&&(this.bi.getOperatingSystemVersion=function(){return e[c.DeviceMetadata.OS_VERSION]}),e[c.DeviceMetadata.CATEGORY]&&(this.bi.getDeviceCategory=function(){return e[c.DeviceMetadata.CATEGORY]}),n=e[c.DeviceMetadata.SCREEN_RESOLUTION_WIDTH],Z.gt(n)&&(this.bi.getScreenWidth=function(){return n.toString()}),i=e[c.DeviceMetadata.SCREEN_RESOLUTION_HEIGHT],Z.gt(i)&&(this.bi.getScreenHeight=function(){return i.toString()}),o=e[c.DeviceMetadata.SCREEN_RESOLUTION_SCALE_FACTOR],Z.gt(o)&&(this.bi.getScaleFactor=function(){return o.toString()}))},reportDeviceMetric:function(t,e){switch(this.He||(this.He={}),t){case c.Network.CONNECTION_TYPE:Z.Pt(e)&&(this.He[t]=e,this.Ee)&&this.Ee.$(this.He[c.Network.CONNECTION_TYPE]);break;case c.Network.LINK_ENCRYPTION:Z.Pt(e)&&(this.He[t]=e,this.Ee)&&this.Ee.it(this.He[c.Network.LINK_ENCRYPTION]);break;case c.Network.SIGNAL_STRENGTH:var n=parseInt(e,10);Z.gt(n)&&E.DEFAULT_SIGNAL_STRENGTH!==n&&(this.He[t]=n,this.Ee)&&this.Ee.ot(n)}},version:"4.7.13"},m=ut.AnalyticsImpl=function(){var t=this;function e(){var e=!!t.ae,n=t.getAdType(),i=t.me();return n===c.AdType.SERVER_SIDE&&i===c.AdPlayer.CONTENT?m.Ye.We:n!==c.AdType.SERVER_SIDE||i!==c.AdPlayer.SEPARATE?n===c.AdType.CLIENT_SIDE&&i===c.AdPlayer.CONTENT||(n===c.AdType.CLIENT_SIDE&&c.AdPlayer.SEPARATE,e)?m.Ye.xe:m.Ye.qe:void 0}function n(e,n,i){e=parseInt(e,10),n=parseInt(n,10),isNaN(e)&&isNaN(n)||(isNaN(e),isNaN(n),!t.ae||i!==m.Ye.xe&&i!==m.Ye.We||t.ae.Xe(e,n),!t.le)||i!==m.Ye.qe&&i!==m.Ye.We||t.le.Xe(e,n)}function i(e,n){E.vi(e)&&(!t.ae||n!==m.Ye.xe&&n!==m.Ye.We||t.ae.Je(e),t.le&&n===m.Ye.qe||n===m.Ye.We)&&t.le.Je(e)}function o(e,n){e=parseInt(e,10),isNaN(e)||(!t.ae||n!==m.Ye.xe&&n!==m.Ye.We||t.ae.Qe(e),!t.le)||n!==m.Ye.qe&&n!==m.Ye.We||t.le.Qe(e)}function a(e,n){e=parseInt(e,10),isNaN(e)||(!t.ae||n!==m.Ye.xe&&n!==m.Ye.We||t.ae.Ze(e),!t.le)||n!==m.Ye.qe&&n!==m.Ye.We||t.le.Ze(e)}function r(e,n){e=parseInt(e,10),!t.ae||n!==m.Ye.xe&&n!==m.Ye.We||t.ae.ze(!0,e),!t.le||n!==m.Ye.qe&&n!==m.Ye.We||t.le.ze(!0,e)}function s(e){!t.ae||e!==m.Ye.xe&&e!==m.Ye.We||t.ae.ze(!1,-1),!t.le||e!==m.Ye.qe&&e!==m.Ye.We||t.le.ze(!1,-1)}function l(e,n){e=parseInt(e,10),isNaN(e)||(!t.ae||n!==m.Ye.xe&&n!==m.Ye.We||t.ae.$e(e),!t.le)||n!==m.Ye.qe&&n!==m.Ye.We||t.le.$e(e)}function u(e,n){e=parseInt(e,10),isNaN(e)||(!t.ae||n!==m.Ye.xe&&n!==m.Ye.We||t.ae.ts(e),!t.le)||n!==m.Ye.qe&&n!==m.Ye.We||t.le.ts(e)}function h(e,n){e=parseInt(e,10),isNaN(e)||(!t.ae||n!==m.Ye.xe&&n!==m.Ye.We||t.ae.ns(e),!t.le)||n!==m.Ye.qe&&n!==m.Ye.We||t.le.ns(e)}function f(e,n){var i;Z.Pt(e)&&(i=t.le.hi(),Z.Pt(i)&&"off"!==i&&"off"!==e&&d("off",n),!t.ae||n!==m.Ye.xe&&n!==m.Ye.We||t.ae.es(e),!t.le||n!==m.Ye.qe&&n!==m.Ye.We||t.le.es(e))}function d(e,n){var i;Z.Pt(e)&&(i=t.le.ri(),Z.Pt(i)&&"off"!==i&&"off"!==e&&f("off",n),!t.ae||n!==m.Ye.xe&&n!==m.Ye.We||t.ae.ss(e),!t.le||n!==m.Ye.qe&&n!==m.Ye.We||t.le.ss(e))}(function(){}).apply(this,arguments),this.Oe=function(E,v,g,p){switch(E){case c.Playback.BITRATE:p===m.Ye.xe?l(v,m.Ye.xe):l(v,e());break;case c.Playback.AVG_BITRATE:p===m.Ye.xe?u(v,m.Ye.xe):u(v,e());break;case c.Playback.PLAY_HEAD_TIME:p===m.Ye.xe?o(v,m.Ye.xe):o(v,e());break;case c.Playback.RESOLUTION:p===m.Ye.xe?n(v,g,m.Ye.xe):n(v,g,e());break;case c.Playback.BUFFER_LENGTH:p===m.Ye.xe?a(v,m.Ye.xe):a(v,e());break;case c.Playback.PLAYER_STATE:p===m.Ye.xe?i(v,m.Ye.xe):i(v,e());break;case c.Playback.RENDERED_FRAMERATE:p===m.Ye.xe?h(v,m.Ye.xe):h(v,e());break;case c.Playback.SEEK_STARTED:arguments.length>=2&&"CONVIVA"!==v?r(v,e()):g===m.Ye.xe?r(-1,m.Ye.xe):r(-1,e());break;case c.Playback.SEEK_ENDED:g===m.Ye.xe?s(m.Ye.xe):s(e());break;case c.Playback.CDN_IP:P=v,y=e(),Z.Pt(P)&&(!t.ae||y!==m.Ye.xe&&y!==m.Ye.We||t.ae.os(P),!t.le||y!==m.Ye.qe&&y!==m.Ye.We||t.le.os(P));break;case c.Playback.DROPPED_FRAMES_TOTAL:y=v,P=e(),y=parseInt(y,10),isNaN(y)||(!t.ae||P!==m.Ye.xe&&P!==m.Ye.We||t.ae.rs(y),!t.le)||P!==m.Ye.qe&&P!==m.Ye.We||t.le.rs(y);break;case c.Playback.DROPPED_FRAMES_COUNT:var A=v,T=e();A=parseInt(A,10),isNaN(A)||(!t.ae||T!==m.Ye.xe&&T!==m.Ye.We||t.ae.us(A),!t.le)||T!==m.Ye.qe&&T!==m.Ye.We||t.le.us(A);break;case c.Playback.AUDIO_LANGUAGE:T=v,A=e(),Z.Pt(T)&&(!t.ae||A!==m.Ye.xe&&A!==m.Ye.We||t.ae.hs(T),!t.le||A!==m.Ye.qe&&A!==m.Ye.We||t.le.hs(T));break;case c.Playback.SUBTITLES_LANGUAGE:f(v,e());break;case c.Playback.CLOSED_CAPTIONS_LANGUAGE:d(v,e());break;default:S=E,C=v,R=e(),Z.Pt(S)&&C&&(!t.ae||R!==m.Ye.xe&&R!==m.Ye.We||t.ae.Zt(S,C),!t.le||R!==m.Ye.qe&&R!==m.Ye.We||t.le.Zt(S,C))}var S,C,R,P,y}},ut.AnalyticsImpl.Ye={xe:1,qe:2,We:3},O=ut.AppAnalyticsHandler=function(){var t=this;t.Ee=null,t.fs=null,t.cs=null,t.ls=null,t.wt=null,function(e,n){t.Ee=e,t.fs=n,"undefined"!=typeof document&&document&&(t.cs=document.createEvent("HTMLEvents"),t.cs.initEvent(c.APP_TRACKER_EVENT.TYPE,!0,!0))}.apply(this,arguments),this.Ge=function(){t.ds(c.APP_TRACKER_EVENT.INIT)},this.vs=function(){t.ds(c.APP_TRACKER_EVENT.VIDEO_ATTEMPT)},this.Es=function(){t.ds(c.APP_TRACKER_EVENT.VIDEO_END),t.wt=null},this._s=function(e){t.ds(c.APP_TRACKER_EVENT.VIDEO_PLAY,e)},this.Rs=function(e){t.ds(c.APP_TRACKER_EVENT.VIDEO_PAUSE,e)},this.ps=function(e){t.ds(c.APP_TRACKER_EVENT.VIDEO_ERROR,e)},this.As=function(e){t.ds(c.APP_TRACKER_EVENT.VIDEO_BUFFERING,e)},this.Ts=function(e){t.ds(c.APP_TRACKER_EVENT.VIDEO_BITRATE_SWITCH,e)},this.Ss=function(e){t.ds(c.APP_TRACKER_EVENT.VIDEO_METADATA_CHANGE,e)},this.Os=function(e){e={cen:e.name,ced:e.data},t.ds(c.APP_TRACKER_EVENT.VIDEO_CUSTOM_EVENT,e)},this.Ns=function(e){e={cen:e.name,ced:e.data},t.ds(c.APP_TRACKER_EVENT.SDK_CUSTOM_EVENT,e)},this.gs=function(e){t.ds(c.APP_TRACKER_EVENT.AD_BREAK_START,{cen:"PodStart",ced:e})},this.Is=function(e){t.ds(c.APP_TRACKER_EVENT.AD_BREAK_END,{cen:"PodEnd",ced:e})},this.ds=function(e,n){try{if(t.cs){if(t.ws(),t.cs.name=t.ls.name=e,t.cs.iid=t.ls.iid=t.Ee.getConfig().getIid(),t.cs.clid=t.ls.clid=t.Ee.getConfig().getClientId(),t.wt){var i,o=t.wt;if(o.Cs()?(i=n?n[H.ys]:void 0,t.cs.sid=t.ls.sid=o.Ds.Jt(),t.cs.sst=t.ls.sst=o.Ps,t.cs.url=t.ls.url=i&&i.url?i.url:o.On,t.cs.st=t.ls.st=o.bs(),t.cs.an=t.ls.an=i&&i.an?i.an:o._n,t.cs.pn=t.ls.pn=i&&i.pn?i.pn:o.Ls,t.cs.tags=t.ls.tags=JSON.stringify(o.Ct.Rn),t.cs.vid=t.ls.vid=i&&i.vid?i.vid:o.Tn,o.Ms>=0&&(t.cs.cl=t.ls.cl=i&&i.cl?i.cl:o.Ms),t.cs.lv=t.ls.lv=i&&i.lv?i.lv:o.Us,t.cs.fw=t.ls.fw=o.Vs(),t.cs.fwv=t.ls.fwv=o.ks(),o.Ue&&(t.cs.mn=t.ls.mn=o.Ue.zn(),t.cs.mv=t.ls.mv=o.Ue.$n()),(o.yn>=0||i&&i.br>=0)&&e===c.APP_TRACKER_EVENT.VIDEO_BITRATE_SWITCH&&(t.cs.br=t.ls.br=i&&i.br?i.br:o.yn),(o.Dn>=0||i&&i.avgbr>=0)&&e===c.APP_TRACKER_EVENT.VIDEO_BITRATE_SWITCH&&(t.cs.avgbr=t.ls.avgbr=i&&i.avgbr?i.avgbr:o.Dn)):o.Fs()&&(t.cs.sid=t.ls.sid=o.Ds.Jt(),t.cs.sst=t.ls.sst=o.Ps,t.cs.st=t.ls.st=o.bs(),t.cs.mn=t.ls.mn=o.Vn,t.cs.mv=t.ls.mv=o.kn),n&&(e===c.APP_TRACKER_EVENT.VIDEO_BITRATE_SWITCH||e===c.APP_TRACKER_EVENT.VIDEO_ERROR||e===c.APP_TRACKER_EVENT.VIDEO_METADATA_CHANGE||e===c.APP_TRACKER_EVENT.VIDEO_CUSTOM_EVENT||e===c.APP_TRACKER_EVENT.SDK_CUSTOM_EVENT||e===c.APP_TRACKER_EVENT.AD_BREAK_START||e===c.APP_TRACKER_EVENT.AD_BREAK_END))for(var a=Object.keys(n),r=0;r<a.length;r++)"object"==typeof n[a[r]]?t.cs[a[r]]=t.ls[a[r]]=JSON.stringify(n[a[r]]):t.cs[a[r]]=t.ls[a[r]]=n[a[r]]}"undefined"!=typeof document&&document&&document.dispatchEvent(t.cs)}}catch(e){}},this.ws=function(){if(null!==t.ls)for(var e=Object.keys(t.ls),n=0;n<e.length;n++)delete t.cs[e[n]];t.ls={}},this.Bs=function(e,n,i){try{(t.wt=i).Cs()?e===H.Hs?n[H.ys][H.Gs]?n[H.ys][H.Gs]===H.js?t._s(n):n[H.ys][H.Gs]===H.Ks?t.As(n):n[H.ys][H.Gs]===H.Ws&&t.Rs(n):n[H.ys][H.Ys]||n[H.ys][H.xs]?t.Ts(n):t.Ss(n):e===H.qs?t.ps({err:n[H.Xs],ft:n[H.Js]}):e===H.Qs?t.Es():e===c.APP_TRACKER_EVENT.VIDEO_ATTEMPT?t.vs():e===H.Zs&&(n[H.zs]===c.Events.POD_START?t.gs(n[H.$s]):n[H.zs]===c.Events.POD_END?t.Is(n[H.$s]):t.Os({name:n[H.zs],data:n[H.$s]})):i.Fs()&&e===H.Zs&&t.Ns({name:n[H.zs],data:n[H.$s]})}catch(e){}}},I=ut.PlayerMonitor=function(){var t=this;this.no=null,this.io=null,this.Ct=null,this.eo=null,this.Pn=E.PlayerState.UNKNOWN,this.so=-1,this.oo=-1,this.Gn=[],this.ro=null,this.uo=null,this.ho=-2,this.ao=-2,this.Ln=-1,this.V=E.DEFAULT_SIGNAL_STRENGTH,this.fo=null,this.gi=null,this.U=null,this.M=null,this._e=null,this.co=null,this.lo=null,this.do=null,this.vo=null,this.we=null,this.Re=null,this.jn=null,this.Kn=null,this.Wn=null,function(e){t._e=e}.apply(this,arguments),this.Eo=function(){return t.Pn},this.Je=function(e){t.Pn!==e&&(t.Le(),t.Pn=e,t._o())},this.Ro=function(){return t.po},this.Ao=function(){return t.To},this.ze=function(e,n){t.Le(),t.po=e,t.To=n,t.So()},this.Oo=function(){return t.so},this.Qe=function(e){t.so=e},this.No=function(){return t.oo},this.Ze=function(e){t.oo=e},this.ve=function(){return t.ho},this.$e=function(e){t.ho!==e&&(t.ho=e,t._o())},this.Io=function(){return t.ao},this.ts=function(e){t.ao!==e&&(t.ao=e,t._o())},this.wo=function(){return t.Ln},this.ns=function(e){t.Ln=e},this.Co=function(){return t.fo},this.os=function(e){t.fo=e,t._o()},this.Ni=function(){return t.gi},this.rs=function(e){t.gi=e,t._o()},this.us=function(e){t.yo(e)},this.mo=function(){return t.V},this.si=function(){return t.jn},this.ri=function(){return t.Kn},this.hi=function(){return t.Wn},this.hs=function(e){t.jn!==e&&(t.jn=e,t._o())},this.es=function(e){t.Kn!==e&&(t.Kn=e,t._o())},this.ss=function(e){t.Wn!==e&&(t.Wn=e,t._o())},this.Do=function(){return t.Po},this.bo=function(){return t.Lo},this.Xe=function(e,n){n<0&&(n=0),t.Po===(e=e<0?0:e)&&t.Lo===n||(t.Po=e,t.Lo=n,t._o())},this.Mo=function(){return t.io},this.Uo=function(){t.Mo()&&(t.Ct=new d,t.eo={},t.lo={},t.Vo())},this.ko=function(e){(t.io||e)&&(this.Le(),t.io&&(t.io=null,t.Uo()),e)&&(t.io=Z.Fo(t.io,e),t.Uo())},this.Se=function(e){if(e)if(t.Ct){var n,i=!1;for(n in e)if(t.Ct[n]!==e[n]){i=!0;break}i&&(t.Le(),t.io=Z.Fo(e),t.Vo())}else t.ko(e)},this.Ne=function(e){e?t.do!==e&&(t.do=e,t.Bo()):(t.do=null,t.Be())},this.Le=function(){t.Ho||t.do&&(t.Ho=!0,t.do(),t.Ho=!1)},this.fe=function(){return t.no},this.de=function(e,n){t.no!==e&&(t.Le(),t.no&&(t.Go(),t.Be(),t.Ie()),t.no=e,t.no)&&t.Me(n)},this.jo=function(){return t.ro},this.Ko=function(){return t.uo||null},this.Wo=function(){return t.Gn},this.Yo=function(){t.Gn=[]},this.di=function(e){this.Le(),t.Gn.push(e),t.Si()},this.ge=function(e,n){t.Le(),t.ro=e,t.uo=n,t.xo()},this.qo=function(){t.Le()},this.Bo=function(){t.Be(),t.co=t._e.create(t.qo,1e3,"PlayerMonitor.update")},this.Be=function(){t.co&&(t.co(),t.co=null)},this.Ce=function(e,n,i){t.vo=i,t.we=e,t.Xo(),t.Re=n,t.we&&c.AdType.CLIENT_SIDE===t.we&&(t.Pn=c.PlayerState.UNKNOWN,t.Jo(t.we,n,i?i[c.POD_POSITION]:null))},this.ye=function(){t.we&&c.AdType.CLIENT_SIDE===t.we&&(t.Qo(),t.Pn=c.PlayerState.UNKNOWN),t.Zo(),t.we=null,t.Re=null},this.zo=function(){return t.vo},this.$o=function(){return t.we},this.getContentMetadata=function(){return this.Ct},this.Ie=function(){this.no=null,this.io=null,this.Ct=null,this.eo=null,this.Pn=E.PlayerState.UNKNOWN,this.so=-1,this.oo=-1,this.Gn=[],this.ro=null,this.uo=null,this.ho=-2,this.ao=-2,this.Ln=-1,this.V=E.DEFAULT_SIGNAL_STRENGTH,this.fo=null,this.gi=null,this.U=null,this.M=null,this._e=null,this.co=null,this.lo=null,this.do=null,this.vo=null,this.we=null,this.Re=null,this.jn=null,this.Kn=null,this.Wn=null,t.Ue=null,t.Fe=h.NO_SESSION_KEY}},D=ut.PlayerMonitorImpl=function(){var t=this;t.De=null,t.Ue=null,t.Fe=h.NO_SESSION_KEY,function(e,n){I.call(this,n),t.De=e}.apply(this,arguments),this.getPHT=function(){return t.Oo()},this.getBufferLength=function(){return t.No()},this.getRenderedFrameRate=function(){return t.wo()},this.getSignalStrength=function(){return t.mo()},this.So=function(){t.Ue&&t._ContentSessionKey!==h.NO_SESSION_KEY&&(t.Ro()?t.Ue.setPlayerSeekStart(t.Ao()):t.Ue.setPlayerSeekEnd())},this._o=function(){t.Ue&&(t.Ue.setPlayerState(t.Eo()),t.ve()>0&&t.Ue.setBitrateKbps(t.ve()),t.Io()>0&&t.Ue.setAvgBitrateKbps(t.Io()),t.Do()>0&&t.Ue.setVideoResolutionWidth(t.Do()),t.bo()>0&&t.Ue.setVideoResolutionHeight(t.bo()),t.Co()&&t.Ue.setCDNServerIP(t.Co()),Z.gt(t.Ni())&&t.Ue.setDroppedFramesTotal(t.Ni()),Z.Pt(t.si())&&t.Ue.setAudioLang(t.si()),Z.Pt(t.ri())&&t.Ue.setSubtitleLang(t.ri()),Z.Pt(t.hi()))&&t.Ue.setCcLang(t.hi())},this.Lt=function(){t.Fe!==h.NO_SESSION_KEY&&t.De&&t.De.updateContentMetadata(t.Fe,t.Ct)},this.Ve=function(){if(t.Ue){t.lo&&Z.Ht(t.lo)>0&&(t.lo[c.MODULE_NAME]&&t.lo[c.MODULE_VERSION]&&(e=t.lo[c.MODULE_NAME],n=t.lo[c.MODULE_VERSION],Z.Pt(e))&&Z.Pt(n)&&t.Ue.setModuleNameAndVersion(e,n),t.lo[c.FRAMEWORK_NAME]&&(e=t.lo[c.FRAMEWORK_NAME],Z.Pt(e))&&t.Ue.setPlayerType(e),t.lo[c.FRAMEWORK_VERSION])&&(n=t.lo[c.FRAMEWORK_VERSION],Z.Pt(n))&&t.Ue.setPlayerVersion(n);var e,n,i=t.Wo();t.Yo();for(var o=0;o<i.length;o++){var a=i[o];t.Ue.di(a)}}},this.Qo=function(){t.Ue&&t.Fe!==h.NO_SESSION_KEY&&(t._o(),this.tr())},this.Vt=function(){t.Ue&&t.Fe!==h.NO_SESSION_KEY&&(t._o(),t.De.kt(t.Fe))},this.tr=function(){t.De&&t.Fe!==c.NO_SESSION_KEY&&t.De.adEnd(t.Fe)},this.Jo=function(e,n,i){var o;t.Ue&&t.Fe!==c.NO_SESSION_KEY&&(o=null,c.AdType.CLIENT_SIDE===e?o=h.AdStream.SEPARATE:c.AdType.SERVER_SIDE===e&&(o=h.AdStream.CONTENT),t.nr(o,n,i))},this.Mt=function(){t.Ue&&t.Fe!==c.NO_SESSION_KEY&&t.De.Ut(t.Fe)},this.nr=function(e,n,i){t.De&&t.Fe!==c.NO_SESSION_KEY&&t.De.adStart(t.Fe,e,n,i)},this.Me=function(){if(t.De){t.Ue=t.De.getPlayerStateManager(!0),t.Ve(),t.Ue.setClientMeasureInterface(this);try{var e;t.Ct&&t.Ct.custom&&!t.Ct.custom[c.UTM_TRACKING_URL]&&(Array.prototype.filter||(Array.prototype.filter=function(t){if(null==this)throw new TypeError;var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var i,o=[],a=arguments.length>=2?arguments[1]:void 0,r=0;r<n;r++)r in e&&(i=e[r],t.call(a,i,r,e))&&o.push(i);return o}),""!==(e=Z.ir().split("?").join("").split("&").filter((function(t){return 2===t.split("=").length&&t.split("=")[0].toLowerCase().indexOf("utm_")>=0})).join("&")))&&(t.Ct.custom[c.UTM_TRACKING_URL]=e)}catch(e){t.p.error("PlayerMonitorImpl _createSession : "+e)}t.Fe=t.De.createSession(t.Ct,t.Ue,!0)}},this.Go=function(){t.De&&(t.Ue&&(t.Ue.setPlayerState(c.PlayerState.STOPPED),t.Ue=null),t.Fe!==c.NO_SESSION_KEY)&&(t.De.cleanupSession(t.Fe),t.Fe=c.NO_SESSION_KEY)},this.Si=function(){if(t.De&&t.Fe!==h.NO_SESSION_KEY){var e=t.Wo();t.Yo();for(var n=0;n<e.length;n++){var i=e[n];t.De.reportError(t.Fe,i.er(),i.sr())}}},this.xo=function(){t.Fe!==h.NO_SESSION_KEY&&t.De&&t.De.sendCustomEvent(t.Fe,t.jo(),t.Ko())},this.Vo=function(){var e,n=t.Mo(),i=!1,o=!1;for(e in n){var a=n[e];if(Z.Pt(e)&&null!=a)switch(e){case c.STREAM_URL:o=!0,t.Ct.streamUrl=a;break;case c.ASSET_NAME:o=!0,t.Ct.assetName=a;break;case c.DEFAULT_RESOURCE:o=!0,t.Ct.defaultResource=a;break;case c.VIEWER_ID:o=!0,t.Ct.viewerId=a;break;case c.PLAYER_NAME:o=!0,t.Ct.applicationName=a;break;case c.DURATION:o=!0,t.Ct.duration=a;break;case c.IS_LIVE:o=!0,t.Ct.streamType=a;break;case c.ENCODED_FRAMERATE:o=!0,t.Ct.encodedFrameRate=a;break;case c.MODULE_NAME:case c.MODULE_VERSION:case c.FRAMEWORK_NAME:case c.FRAMEWORK_VERSION:i=!0,t.lo[e]=a;break;default:o=!0,t.Ct.custom[e]=a}}i&&this.Ve(),o&&this.Lt()},this.Xo=function(){this.rr(c.Events.POD_START)},this.Zo=function(){this.rr(c.Events.POD_END)},this.rr=function(e){var n,i,o;t.De&&t.Fe!==c.NO_SESSION_KEY&&(n={},(o=this.zo())&&((i=o[c.POD_POSITION])&&(n[c.POD_POSITION]=i),(i=o[c.POD_INDEX])&&(n[c.POD_INDEX]=i+""),e===c.Events.POD_START)&&(i=o[c.POD_DURATION])&&(n[c.POD_DURATION]=i+""),(o=this.$o())&&(n[c.AD_TYPE]=o),t.De.sendCustomEvent(t.Fe,e,n))},this.yo=function(e){t.Ue.setDroppedFramesCount(e)},this.ur=function(t){this.Fe===c.NO_SESSION_KEY&&t!==c.NO_SESSION_KEY&&(this.Fe=t)},this.ke=function(){return this.Fe},this.Jt=function(){return t.De.getSessionId(this.Fe)},this.Qt=function(){return t.De.getClientId(this.Fe)},this.Zt=function(e,n){t.De.Zt(this.Fe,e,n)},D.prototype=Object.create(I.prototype),D.prototype.constructor=D},t.Impl=t.Impl||{},t.Impl.Html5Http=function(){(function(){}).apply(this,arguments),this.makeRequest=function(){return this.makeRequestStandard.apply(this,arguments)},this.makeRequestStandard=function(t,e,n,i,o,a){var r=new XMLHttpRequest;return r.open(t,e,!0),i&&r.overrideMimeType&&(r.overrideMimeType=i),i&&r.setRequestHeader&&r.setRequestHeader("Content-Type",i),o>0&&(r.timeout=o,r.ontimeout=function(){r.ontimeout=r.onreadystatechange=null,a&&a(!1,"timeout after "+o+" ms")}),r.onreadystatechange=function(){4===r.readyState&&(r.ontimeout=r.onreadystatechange=null,200===r.status?a&&a(!0,r.responseText):a&&a(!1,"http status "+r.status))},r.send(n),null},this.release=function(){}},t.Impl=t.Impl||{},t.Impl.Html5Logging=function(){(function(){}).apply(this,arguments),this.consoleLog=function(t,e){"undefined"!=typeof console&&(console.log&&e===P.LogLevel.DEBUG||e===P.LogLevel.INFO?console.log(t):console.warn&&e===P.LogLevel.WARNING?console.warn(t):console.error&&e===P.LogLevel.ERROR&&console.error(t))},this.release=function(){}},t.Impl=t.Impl||{},t.Impl.Html5Metadata=function(){(function(){}).apply(this,arguments),this.getBrowserName=function(){return null},this.getBrowserVersion=function(){return null},this.getDeviceBrand=function(){return null},this.getDeviceManufacturer=function(){return null},this.getDeviceModel=function(){return null},this.getDeviceType=function(){return null},this.getDeviceVersion=function(){return null},this.getFrameworkName=function(){return null},this.getFrameworkVersion=function(){return null},this.getOperatingSystemName=function(){return null},this.getOperatingSystemVersion=function(){return null},this.getDeviceCategory=function(){return null},this.getScreenWidth=function(){return"undefined"!=typeof window&&window&&window.screen&&window.screen.width?window.screen.width.toString():null},this.getScreenHeight=function(){return"undefined"!=typeof window&&window&&window.screen&&window.screen.height?window.screen.height.toString():null},this.getScaleFactor=function(){return"undefined"!=typeof window&&window&&window.devicePixelRatio?window.devicePixelRatio.toString():null},this.release=function(){}},t.Impl=t.Impl||{},t.Impl.Html5Storage=function(){(function(){}).apply(this,arguments),this.saveData=function(t,e,n,i){t=t+"."+e;try{localStorage.setItem(t,n),i(!0,null)}catch(t){i(!1,t.toString())}},this.loadData=function(t,e,n){t=t+"."+e;try{n(!0,localStorage.getItem(t))}catch(t){n(!1,t.toString())}},this.release=function(){}},t.Impl=t.Impl||{},t.Impl.Html5Time=function(){(function(){}).apply(this,arguments),this.getEpochTimeMs=function(){return(new Date).getTime()},this.release=function(){}},t.Impl=t.Impl||{},t.Impl.Html5Timer=function(){(function(){}).apply(this,arguments),this.createTimer=function(t,e){var n=setInterval(t,e);return function(){-1!==n&&(clearInterval(n),n=-1)}},this.release=function(){}},M=ut.VideoAnalytics=function(){var e=this;e.Ee=null,e.T=null,e._e=null,e.le=null,e.pe=null,this.release=function(){e.p,e.le&&e.le.fe()&&e.le.de(!1),void 0!==t.ProxyMonitor&&e.pe&&(t.ProxyMonitor.release(e.pe),e.pe=null),e.le&&(e.le.Ne(null),e.le.Ie(),e.le=null),e._e=null},function(t,n){e.Ee=t,e.T=n,e._e=n.buildTimer(c.version),e.le=new D(e.Ee,e._e),m.call(this)}.apply(this,arguments),this.reportPlaybackRequested=function(t){e.p,e.le&&(Z.Ht(t)>0&&e.setContentInfo(t),e.le.fe()||e.le.de(!0))},this.reportPlaybackEnded=function(){e.p,e.le&&e.le.fe()&&(e.le.de(!1),void 0!==t.ProxyMonitor&&e.pe&&(t.ProxyMonitor.release(e.pe),e.pe=null),e.le.Ne(null))},this.reportPlaybackFailed=function(t,n){e.le&&(Z.Ht(n)>0&&e.setContentInfo(n),e.le.fe()||e.le.de(!0),e.p,e.reportPlaybackError(t,h.ErrorSeverity.FATAL),e.reportPlaybackEnded())},this.setContentInfo=function(t){Z.Ht(t)<=0||e.le&&(e.p,e.le.Se(t))},this.setPlayerInfo=function(t){Z.Ht(t)<=0||e.le&&(e.p,e.le.Se(t))},this.reportPlaybackMetric=function(){0!==arguments.length&&(1===arguments.length?e.Oe(arguments[0]):2===arguments.length?e.Oe(arguments[0],arguments[1]):3===arguments.length?e.Oe(arguments[0],arguments[1],arguments[2]):4===arguments.length&&e.Oe(arguments[0],arguments[1],arguments[2],arguments[3]))},this.reportPlaybackError=function(t,n){e.le&&Z.Pt(t)&&(e.p,t=new it(t,n),e.le.di(t))},this.reportPlaybackEvent=function(t,n){if(Z.Pt(t)&&e.le&&(e.p,e.le))switch(t){case c.Events.USER_WAIT_STARTED:case c.Events.BUMPER_VIDEO_STARTED:e.le.Mt();break;case c.Events.USER_WAIT_ENDED:case c.Events.BUMPER_VIDEO_ENDED:e.le.Vt();break;default:e.le.ge(t,n)}},this.setCallback=function(t){e.p,e.le&&e.le.Ne(t)},this.reportAdBreakStarted=function(t,n,i){e.le&&(e.p,e.le.Ce(t,n,i))},this.reportAdBreakEnded=function(){e.le&&(e.p,e.le.ye())},this.setPlayer=function(n,i){var o,a;void 0!==n&&(i&&(o=i[c.CONVIVA_MODULE],a=i[c.MEDIA_ELEMENT]),void 0!==o?t.ProxyMonitor=o.ProxyMonitor:"undefined"!=typeof ConvivaModule&&(t.ProxyMonitor=ConvivaModule.ProxyMonitor),void 0!==t.ProxyMonitor)&&(e.p,!n&&e.pe?(t.ProxyMonitor.release(e.pe),e.pe=null):n?(e.pe&&t.ProxyMonitor.release(e.pe),e.p,e.pe=void 0!==a?t.ProxyMonitor.initConvivaDropIn(n,a,e.T,this,t):t.ProxyMonitor.initConvivaDropIn(n,e.T,this,t)):void 0!==a&&(e.pe=t.ProxyMonitor.initConvivaDropIn(n,a,e.T,this,t)))},this.setAdAnalytics=function(t){t?e.getAdType()&&(e.getAdType()===c.AdType.SERVER_SIDE?e.ae=t.getAdPlayerMonitor():e.getAdType()===c.AdType.CLIENT_SIDE&&e.p):e.ae=null},this.configureExistingSession=function(t){t!==c.NO_SESSION_KEY&&e.le&&(e.p,e.le.ur(t))},this.getSessionId=function(){return e.le?(e.p,e.le.Jt()):c.NO_SESSION_KEY},this.getClientId=function(){return e.le?(e.p,e.le.Qt()):null},this.Te=function(){return e.p,this.le},this.getAdType=function(){return e.le?e.le.we:null},this.me=function(){return e.le?e.le.Re:null},M.prototype=Object.create(m.prototype),M.prototype.constructor=M},ut.JsonParse=(o={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},a=function(t){throw{name:"SyntaxError",message:t,at:e,text:i}},r=function(t){return t&&t!==n&&a("Expected '"+t+"' instead of '"+n+"'"),n=i.charAt(e),e+=1,n},s=function(){var t,e,i,s="";if('"'===n)for(;r();){if('"'===n)return r(),s;if("\\"===n)if(r(),"u"===n){for(e=i=0;e<4&&(t=parseInt(r(),16),isFinite(t));e+=1)i=16*i+t;s+=String.fromCharCode(i)}else{if("string"!=typeof o[n])break;s+=o[n]}else s+=n}a("Bad string")},l=function(){for(;n&&n<=" ";)r()},u=function(){switch(l(),n){case"{":var t,e={};if("{"===n){if(r("{"),l(),"}"===n)return r("}"),e;for(;n;){if(t=s(),l(),r(":"),Object.hasOwnProperty.call(e,t)&&a('Duplicate key "'+t+'"'),e[t]=u(),l(),"}"===n)return r("}"),e;r(","),l()}}return void a("Bad object");case"[":var i=[];if("["===n){if(r("["),l(),"]"===n)return r("]"),i;for(;n;){if(i.push(u()),l(),"]"===n)return r("]"),i;r(","),l()}}return void a("Bad array");case'"':return s();case"-":return ct();default:return(n>="0"&&n<="9"?ct:function(){switch(n){case"t":return r("t"),r("r"),r("u"),r("e"),!0;case"f":return r("f"),r("a"),r("l"),r("s"),r("e"),!1;case"n":return r("n"),r("u"),r("l"),r("l"),null}a("Unexpected '"+n+"'")})()}},function(t,o){return i=t,e=0,n=" ",t=u(),l(),n&&a("Syntax error"),"function"==typeof o?function t(e,n){var i,a,r=e[n];if(r&&"object"==typeof r)for(i in r)Object.hasOwnProperty.call(r,i)&&(void 0!==(a=t(r,i))?r[i]=a:delete r[i]);return o.call(e,n,r)}({"":t},""):t}),V=ut.JSON2={},"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+ht(this.getUTCMonth()+1)+"-"+ht(this.getUTCDate())+"T"+ht(this.getUTCHours())+":"+ht(this.getUTCMinutes())+":"+ht(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}),"function"!=typeof V.stringify&&(L=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,U={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},V.stringify=function(t,e,n){var i;if(b=w="","number"==typeof n)for(i=0;i<n;i+=1)b+=" ";else"string"==typeof n&&(b=n);if(!(F=e)||"function"==typeof e||"object"==typeof e&&"number"==typeof e.length)return function t(e,n){var i,o,a,r,s,l=w,u=n[e];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(e)),typeof(u="function"==typeof F?F.call(n,e,u):u)){case"string":return ft(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(w+=b,s=[],Object.prototype.toString.apply(u)===Object.prototype.toString.apply([])){for(r=u.length,i=0;i<r;i+=1)s[i]=t(i,u)||"null";a=0===s.length?"[]":w?"[\n"+w+s.join(",\n"+w)+"\n"+l+"]":"["+s.join(",")+"]"}else{if(F&&"object"==typeof F)for(r=F.length,i=0;i<r;i+=1)"string"==typeof F[i]&&(a=t(o=F[i],u))&&s.push(ft(o)+(w?": ":":")+a);else for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(a=t(o,u))&&s.push(ft(o)+(w?": ":":")+a);a=0===s.length?"{}":w?"{\n"+w+s.join(",\n"+w)+"\n"+l+"}":"{"+s.join(",")+"}"}return w=l,a}}("",{"":t});throw new Error("JSON2.stringify")}),Y=ut.hr={ar:"0123456789abcdef",cr:function(t){for(var e="",n=7;n>=0;n--)e+=Y.ar.charAt(t>>4*n&15);return e},lr:function(t){for(var e=1+(t.length+8>>6),n=new Array(16*e),i=0;i<16*e;i++)n[i]=0;for(i=0;i<t.length;i++)n[i>>2]|=t.charCodeAt(i)<<24-i%4*8;return n[i>>2]|=128<<24-i%4*8,n[16*e-1]=8*t.length,n},dr:function(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n},vr:function(t,e){return t<<e|t>>>32-e},Er:function(t,e,n,i){return t<20?e&n|~e&i:!(t<40)&&t<60?e&n|e&i|n&i:e^n^i},_r:function(t){return t<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514},Rr:function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return Y.pr(e)},pr:function(t){if(""===t)return"";for(var e,n=Y.lr(t),i=new Array(80),o=1732584193,a=-271733879,r=-1732584194,s=271733878,l=-1009589776,u=0;u<n.length;u+=16){for(var c=o,h=a,f=r,d=s,E=l,v=0;v<80;v++)i[v]=v<16?n[u+v]:Y.vr(i[v-3]^i[v-8]^i[v-14]^i[v-16],1),e=Y.dr(Y.dr(Y.vr(o,5),Y.Er(v,a,r,s)),Y.dr(Y.dr(l,i[v]),Y._r(v))),l=s,s=r,r=Y.vr(a,30),a=o,o=e;o=Y.dr(o,c),a=Y.dr(a,h),r=Y.dr(r,f),s=Y.dr(s,d),l=Y.dr(l,E)}return Y.cr(o)+Y.cr(a)+Y.cr(r)+Y.cr(s)+Y.cr(l)}},(H=ut.CwsProtocol=function(){this.Ar=function(t,e,n,i){return i.seq=t,i.st=e,i.t=n,i},this.Tr=function(t,e){var n=H.Qs;return this.Ar(t,e,n,{})}}).version="2.6",H.Sr="/0/wsg",H.H="0",H.Or=-1,H.Nr=!1,H.gr=2,H.Ir=-1,H.wr=-1,H.Cr=1e3,H.yr="sdk.js.1",H.Hs="CwsStateChangeEvent",H.qs="CwsErrorEvent",H.Qs="CwsSessionEndEvent",H.Zs="CwsCustomEvent",H.mr="CwsSeekEvent",H.Dr="CwsDataSamplesEvent",H.Pr="ok",H.Lr="err",H.Mr="clid",H.Ur="cfg",H.Vr="evs",H.kr="maxhbinfos",H.Fr="slg",H.Br="hbi",H.Hr="gw",H.Gr="fp",H.jr="csi_en",H.Kr="CwsSessionHb",H.Wr="t",H.Yr="st",H.qr="sst",H.Xr="lv",H.Jr="seq",H.Qr="cid",H.Zr="clid",H.zr="clv",H.$r="pver",H.tu="iid",H.nu="sid",H.iu="vid",H.eu="an",H.su="pn",H.ou="tags",H.ru="sf",H.uu="evs",H.hu="lg",H.au="hbinfos",H.fu="sdk",H.cu="pj",H.Gs="ps",H.Ys="br",H.xs="avgbr",H.lu="cl",H.du="efps",H.vu="afps",H.Eu="rfpstot",H._u="rfpscnt",H.Ru="rs",H.pu="pht",H.Au="bl",H.Tu="url",H.Su="caps",H.Ou="pm",H.Nu="w",H.gu="h",H.Iu="ct",H.wu="le",H.Cu="dftot",H.yu="dfcnt",H.mu="al",H.Du="sl",H.Pu="cal",H.bu="ss",H.Lu="csi_n",H.Mu="csi_t",H.Uu="csi_l",H.Vu="csi_v",H.ku="csi_c",H.Fu="sch",H.Bu="br",H.Hu="brv",H.Gu="dvb",H.ju="dvma",H.Ku="dvm",H.Wu="dvt",H.Yu="dvv",H.xu="sw",H.qu="sh",H.Xu="scf",H.Ju="fw",H.Qu="fwv",H.Zu="cc",H.zu="mn",H.$u="mv",H.th="os",H.nh="osv",H.ih="cat",H.eh="caps",H.sh="t",H.oh="seq",H.rh="st",H.uh="act",H.hh="skto",H.Xs="err",H.Js="ft",H.ys="new",H.ah="old",H.zs="name",H.$s="attr",H.fh="seq",H.lh="err",H.dh="rtt",H.Eh="ad",H._h="csi",H.Rh=function(t){switch(t){case E.PlayerState.STOPPED:return H.ph;case E.PlayerState.PLAYING:return H.js;case E.PlayerState.BUFFERING:return H.Ks;case E.PlayerState.PAUSED:return H.Ws;case E.PlayerState.NOT_MONITORED:return H.Ah;default:return H.Th}},H.ph=1,H.js=3,H.Ks=6,H.Ws=12,H.Ah=98,H.Th=100,H.Sh={Oh:0,Ot:1,Nh:2,gh:4},H.Ih={wh:0},B=ut.LibJSONInterface=function(){this.Ch=function(t){var e=null;try{e=V.stringify(t)}catch(t){}return e},this.yh=function(t){var e=null;try{e=ut.JsonParse(t)}catch(t){return e}return Z.mh(e)?e:null}},G=ut.CwsHeartbeat=function(){this.Dh={},function(){}.apply(this,arguments),this.get=function(){return this.Dh},this.Ph=function(t,e){this.Dh[t]=e},this.bh=function(t,e,n){this.Dh[t]||(this.Dh[t]={}),this.Dh[t][e]=n},this.Lh=function(t){this.Ph(H.Wr,t)},this.Mh=function(t){this.Ph(H.Yr,t)},this.Uh=function(t){this.Ph(H.qr,t)},this.Vh=function(t){this.Ph(H.Xr,t)},this.kh=function(t){this.Ph(H.Jr,t)},this.Fh=function(t){this.Ph(H.Qr,t)},this.Bh=function(t){this.Ph(H.Zr,t)},this.Hh=function(t){this.Ph(H.zr,t)},this.Gh=function(t){this.Ph(H.$r,t)},this.jh=function(t){this.Ph(H.eh,t)},this.Kh=function(t){this.Ph(H.nu,t)},this.Wh=function(t){this.Ph(H.tu,t)},this.Yh=function(t){this.Ph(H.iu,t)},this.xh=function(t){this.Ph(H.eu,t)},this.qh=function(t){this.Ph(H.su,t)},this.Xh=function(t){this.Ph(H.ou,t)},this.Jh=function(t){this.Ph(H.ru,t)},this.Qh=function(t){this.Ph(H.Su,t)},this.Zh=function(t){this.Ph(H.uu,t)},this.zh=function(t){this.Ph(H.fu,t)},this.$h=function(t){this.Ph(H.hu,t)},this.ta=function(t){this.Ph(H.au,t)},this.Je=function(t){this.Ph(H.Gs,t)},this.na=function(t){this.Ph(H.cu,t)},this.ia=function(t){this.Ph(H.lu,t)},this.ea=function(t){this.Ph(H.Ys,t)},this.sa=function(t){this.Ph(H.xs,t)},this.oa=function(t){this.Ph(H.Ru,t)},this.ra=function(t){this.Ph(H.du,t)},this.ua=function(t){this.Ph(H.vu,t)},this.ha=function(t){this.Ph(H._u,t)},this.aa=function(t){this.Ph(H.Eu,t)},this.fa=function(t){this.bh(H.Ou,H.Fu,t)},this.ca=function(t){this.bh(H.Ou,H.Bu,t)},this.la=function(t){this.bh(H.Ou,H.Hu,t)},this.da=function(t){this.bh(H.Ou,H.Gu,t)},this.va=function(t){this.bh(H.Ou,H.ju,t)},this.Ea=function(t){this.bh(H.Ou,H.Ku,t)},this._a=function(t){this.bh(H.Ou,H.Wu,t)},this.Ra=function(t){this.bh(H.Ou,H.Yu,t)},this.pa=function(t){this.bh(H.Ou,H.Ju,t),this.Ph(H.Ju,t)},this.Aa=function(t){this.bh(H.Ou,H.Qu,t),this.Ph(H.Qu,t)},this.Ta=function(t){this.bh(H.Ou,H.th,t.toUpperCase())},this.Sa=function(t){this.bh(H.Ou,H.nh,t)},this.Oa=function(t){this.bh(H.Ou,H.ih,t)},this.Na=function(t){this.bh(H.Ou,H.xu,t)},this.ga=function(t){this.bh(H.Ou,H.qu,t)},this.Ia=function(t){this.bh(H.Ou,H.Xu,t)},this.wa=function(t){this.Ph(H.Cu,t)},this.yo=function(t){this.Ph(H.yu,t)},this.Ca=function(t){this.Ph(H.pu,t)},this.ya=function(t){this.Ph(H.Au,t)},this.ma=function(t){this.Ph(H.Tu,t)},this.Da=function(t){this.Ph(H.Nu,t)},this.Pa=function(t){this.Ph(H.gu,t)},this.ba=function(t){this.Ph(H.Iu,t)},this.La=function(t){this.Ph(H.wu,t)},this.Ma=function(){this.Ph(H.Eh,!0)},this.Ua=function(t){this.Ph(H.bu,t)},this.setModuleName=function(t){this.bh(H.Zu,H.zu,t)},this.Va=function(t){this.bh(H.Zu,H.$u,t)},this.ka=function(t){this.Ph(H._h,t)},this.Fa=function(t){t&&this.Ph(H.Lu,t)},this.Ba=function(t){t&&this.Ph(H.Mu,t)},this.Ha=function(t){t&&this.Ph(H.Uu,t)},this.Ga=function(t){t&&this.Ph(H.Vu,t)},this.ja=function(t){t&&this.Ph(H.ku,t)},this.Ka=function(t){this.Ph(H.mu,t)},this.Wa=function(t){this.Ph(H.Du,t)},this.Ya=function(t){this.Ph(H.Pu,t)}},(W=ut.CwsSession=function(){var t=this;t.qa=null,t.Xa=200,t.Ja=5e3,t.Ct=null,t.Ps=0,t.Qa=0,t.Za=H.Sh.Oh,t.za=H.Ih.wh,t.$a=[],t.tf=-1,t.yn=-2,t.Dn=-2,t.gi=-1,t.nf=-1,t.if=null,t.Pn=E.PlayerState.UNKNOWN,t.wn=-1,t.Ms=-1,t.On=null,t.Fn=-1,t.Bn=-1,t.Ue=null,t._n=null,t.Tn=null,t.Ls=null,t.Us=null,t.ef={},t.sf=null,t.rf=null,t.uf=null,t.hf=null,t.af=null,t.ff=null,t.cf=null,t.lf=null,t.df=null,t.vf=null,t.Ef=null,t._f=null,t.Rf=null,t.pf=null,t.Af=null,t.Vn=null,t.kn=null,t.M=null,t.U=null,t.fo=null,t.Tf=null,t.Sf=!1,t.Of=!1,t.Nf=!1,t.gf=!1,t.If=!1,t.wf=null,t.Cf=1e3,t.yf=0,t.mf=0,t.Df={},t.D={},t.Pf=!1,t.bf=null,t.Lf=null,t.Mf=null,t.Uf=null,t.Vf=null,t.kf=null,t.Ff=12e4,t.Bf=H.Nr,t.Hf=!1,t.Gf=null,t.ki=null,t.jn=null,t.Kn=null,t.Wn=null,function(e,n,i,o,a,r,s,l,u,c,h,f,d){this.jf=e,this.Ee=n,this.Vi=i,this.p=o,this.p.setModuleName("CwsSession"),this.g=a,this._e=r,this.Kf=s,this.Wf=l,this.Yf=u,this.Fi=c,this.xf=h,this.Ct=f,this.Ct&&(t.wn=this.Ct.encodedFrameRate,t.On=this.Ct.streamUrl,t.Ms=this.Ct.duration),this.xf&&(t.Gf=t.xf.get(J.B)),t.ki=d}.apply(this,arguments),this.Tt=function(){this.xf=null,this.Fi=null,this.N=null,this.Yf=null,this.Wf=null,this.Kf=null,this._e=null,this.g=null,this.p=null,this.Vi=null,this.Ee=null,this.jf.qf(),this.jf=null,this.Tf=null,this.Nf=!0},this.Xf=function(e){this.Ds=e,this.Jf=this.Ds.Jf,this.p.Kh(this.Ds.C),this.Ps=this.Yf.current(),this.Cs()||this.Qf()?(this.Za+=W.xa,t.p.info("start(): assetName="+t.Ct.assetName)):t.p.info("start()"+t.Zf())},this.zf=function(){this.gf=!0},this.$f=function(){this.p.debug("initialize()"),(this.Cs()||this.Qf()||this.Fs())&&(this.Ee&&this.Ee._&&this.Ee._.Bs(c.APP_TRACKER_EVENT.VIDEO_ATTEMPT,{},this),t.tc(),t.nc(),t.ic(),this.Cs()||this.Qf())&&t.ec()},this.sc=function(){this.p.debug("end(): schedule the last hb before session cleanup"+t.Zf()),this.oc(),this.rc(),this.uc(),this.hc()},this.ac=function(){this.gf||(this.hc(),this.fc())},this.ca=function(e){var n=t.sf;n!==e&&e&&(t.p.debug("Change browserName from "+n+" to "+e),t.sf=e)},this.la=function(e){var n=t.rf;n!==e&&e&&(t.p.debug("Change browserVersion from "+n+" to "+e),t.rf=e)},this.da=function(e){var n=t.uf;n!==e&&e&&(t.p.debug("Change deviceBrand from "+n+" to "+e),t.uf=e)},this.va=function(e){var n=t.hf;n!==e&&e&&(t.p.debug("Change deviceManufacturer from "+n+" to "+e),t.hf=e)},this.Ea=function(e){var n=t.af;n!==e&&e&&(t.p.debug("Change deviceModel from "+n+" to "+e),t.af=e)},this._a=function(e){var n=t.ff;n!==e&&e&&(t.p.debug("Change deviceType from "+n+" to "+e),t.ff=e)},this.Ra=function(e){var n=t.cf;n!==e&&e&&(t.p.debug("Change deviceVersion from "+n+" to "+e),t.cf=e)},this.Ta=function(e){var n=t.vf;n!==e&&e&&(t.p.debug("Change operatingSystemName from "+n+" to "+e),t.vf=e)},this.Sa=function(e){var n=t.Ef;n!==e&&e&&(t.p.debug("Change operatingSystemVersion from "+n+" to "+e),t.Ef=e)},this.Oa=function(e){var n=t._f;n!==e&&e&&(t.p.debug("Change deviceCategory from "+n+" to "+e),t._f=e)},this.Na=function(e){var n=t.Rf;n!==e&&e&&(t.p.debug("Change screenWidth from "+n+" to "+e),t.Rf=e)},this.ga=function(e){var n=t.pf;n!==e&&e&&(t.p.debug("Change screenHeight from "+n+" to "+e),t.pf=e)},this.Ia=function(e){var n=t._f;n!==e&&e&&(t.p.debug("Change scaleFactor from "+n+" to "+e),t.Af=e)},this.Vs=function(){return t.lf},this.pa=function(e){var n=t.lf;n!==e&&e&&(t.p.debug("Change frameworkName from "+n+" to "+e),t.lf=e)},this.ks=function(){return t.df},this.Aa=function(e){var n=t.df;n!==e&&e&&(t.p.debug("Change frameworkVersion from "+n+" to "+e),t.df=e)},this.ma=function(e){var n;t.Ct.streamUrl||(n=t.On)!==e&&e&&(t.p.debug("Change stream url from "+n+" to "+e),t.On=e)},this.cc=function(){t.rc(),t.Hf||(t.lc(),t.kf=t._e.create(t.lc,t.Ff,"CwsSession.startCdnTimer"),t.p.debug("fetching cdn ip timer started"))},this.rc=function(){t.kf&&(t.kf(),t.dc(null,null,null,null,null),t.kf=null)},this.lc=function(){t.p.debug("detectCDNServerIp(): For "+t.On),t.Bf?t.vc():t.rc()},this.vc=function(){try{var e;"function"==typeof XMLHttpRequest||"object"==typeof XMLHttpRequest?((e=new XMLHttpRequest).open("HEAD",t.On,!0),e.setRequestHeader("Pragma","akamai-x-cache-on"),e.onreadystatechange=function(){4===this.readyState&&(200===this.status&&(this.getAllResponseHeaders().indexOf("x-cache")>=0||this.getAllResponseHeaders().indexOf("X-Cache")>=0)?t.dc("Akamai","header","X-Cache",""+this.getResponseHeader("X-Cache"),""+this.status):t.dc("null","header","null","null",""+this.status))},e.send()):t.p.info("xmlhttpreq is not available here to fetch CDN Server Ip")}catch(e){t.p.info("Exception caught in makeAkamaiHeadRequest")}},this.dc=function(e,n,i,o,a){var r={},s={};t.bf!==e&&(null!==t.bf&&(s[H.Lu]=t.bf),t.bf=e,null===t.bf?r[H.Lu]="null":r[H.Lu]=t.bf),t.Lf!==n&&(null!==t.Lf&&(s[H.Mu]=t.Lf),t.Lf=n,null===t.Lf?r[H.Mu]="null":r[H.Mu]=t.Lf),t.Mf!==i&&(null!==t.Mf&&(s[H.Uu]=t.Mf),t.Mf=i,null===t.Mf?r[H.Uu]="null":r[H.Uu]=t.Mf),t.Uf!==o&&(null!==t.Uf&&(s[H.Vu]=t.Uf),t.Uf=o,null===t.Uf?r[H.Vu]="null":r[H.Vu]=t.Uf),t.Vf!==a&&(null!==t.Vf&&(s[H.ku]=t.Vf),t.Vf=a,null===t.Vf?r[H.ku]="null":r[H.ku]=t.Vf),"{}"!==JSON.stringify(r)&&t.Ec(r,s)},this._c=function(e){var n=t.yn;n!==e&&e>0&&(t.p.info("Change bitrate from "+n+" to "+e),t.Rc(n,e),t.yn=e)},this.Ac=function(e){var n=t.Dn;n!==e&&e>0&&(t.p.info("Change Avg bitrate from "+n+" to "+e),t.Tc(n,e),t.Dn=e)},this.wa=function(e){var n=t.gi;n!==e&&e>=0&&(t.p.info("Change dropped frames total from "+n+" to "+e),t.Sc(n,e),t.gi=e)},this.yo=function(e){var n=t.nf,i=e+(-1===t.nf?0:t.nf);n!==e&&i>=0&&(t.p.info("Change dropped frames count from "+n+" to "+i),t.Oc(n,i),t.nf=i)},this.oa=function(e){var n=t.if;n!==e&&e&&(t.p.info("Change resource from "+n+" to "+e),t.if=e)},this.xh=function(e){t._n!==e&&e&&(t.p.info("Change assetName from "+t._n+" to "+e),t._n=e)},this.Vh=function(e){var n=t.Us;n!==e&&Z.ie(e)&&(t.p.info("Change isLive from "+n+" to "+e),t.Us=e)},this.Yh=function(e){var n=t.Tn;n!==e&&e&&(t.p.info("Change viewerId from "+n+" to "+e),t.Tn=e)},this.qh=function(e){var n=t.Ls;n!==e&&e&&(t.p.info("Change playerName from "+n+" to "+e),t.Ls=e)},this.Xh=function(e){var n=t.ef;!Z.Nc(n,e)&&e&&(t.p.info("Change tags from "+Z.gc(n)+" to "+Z.gc(e)),t.ef=e)},this.ra=function(e){t.Ct.encodedFrameRate>0||(t.p.debug("setEncodedFrameRate(): "+e),t.wn=e)},this.ia=function(e){t.Ct.duration>0||(t.p.debug("setContentLength(): "+e),t.Ms=e)},this.Je=function(e){var n,i=!1;t.Of||e!==E.PlayerState.PLAYING||(t.Of=!0,t.Cs()&&(i=!0),Z.Pt(t.Ct.viewerId)||t.p.error("Missing viewerId. viewerId should be updated before first frame is rendered."),Z.Pt(t.Ct.streamType)&&d.StreamType.UNKNOWN!==t.Ct.streamType||t.p.error("Missing streamType - Live or VOD. streamType should be updated before first frame is rendered."),Z.Pt(t.Ct.applicationName))||t.p.error("Missing applicationName. applicationName should be updated before first frame is rendered."),t.Pn!==e&&(n=t.Pn,t.p.info("setPlayerState(): changing player state from "+n+" to "+e),t.Ic(n,e),t.Pn=e,i)&&(t.p.info("SetPlayerState(): to playing state triggered urgent HB"),t.wc())},this.Cc=function(e){var n=t.Fn;n!==e&&e>0&&(t.p.debug("Change stream resolution width from "+n+" to "+e),t.yc(n,e),t.Fn=e)},this.mc=function(e){var n=t.Bn;n!==e&&e>0&&(t.p.debug("Change stream resolution height from "+n+" to "+e),t.Dc(n,e),t.Bn=e)},this.ba=function(e){var n=t.M;n!==e&&e&&(t.p.debug("Change network connection type from "+n+" to "+e),t.Pc(n,e),t.M=e)},this.La=function(e){var n=t.U;n!==e&&e&&(t.p.debug("Change network link encryption from "+n+" to "+e),t.bc(n,e),t.U=e)},this.ka=function(e){t.Hf=!0,t.rc();var n=t.fo;n!==e&&Z.Pt(e)&&(t.p.debug("Change CDN Server IP from "+n+" to "+e),t.Lc(n,e),t.fo=e)},this.Ka=function(e){var n=t.jn;n!==e&&Z.Pt(e)&&!t.Ds.Mc&&(t.p.info("Change Audio Lang from "+n+" to "+e),t.Uc(n,e),t.jn=e)},this.Wa=function(e){var n=t.Kn;n!==e&&Z.Pt(e)&&!t.Ds.Vc&&(t.p.info("Change Subtitle Lang from "+n+" to "+e),t.kc(n,e),t.Kn=e)},this.Ya=function(e){var n=t.Wn;n!==e&&Z.Pt(e)&&!t.Ds.Fc&&(t.p.info("Change Closed Caption Lang from "+n+" to "+e),t.Bc(n,e),t.Wn=e)},this.Hc=function(e){var n;t.p.debug("togglePauseJoin()"),t.Sf===e?t.p.debug("togglePauseJoin(): same value, ignoring"):(e=t.Sf,n=!t.Sf,t.Gc(e,n),t.Sf=!t.Sf)},this.jc=function(e,n){t.Kc(e,n),t.p.info("sendError(): triggered urgent HB"),n&&t.wc()},this.Wc=function(t,e){var n,i;e[H.sh]=t,e[H.rh]=this.bs(),e[H.oh]=this.jf.Yc(),this.Ue&&(n=nt.xc(this.Ue.getPHT(),0,null,-1),i=nt.xc(this.Ue.getBufferLength(),0,null,-1),n>=0&&(e[H.pu]=n),i>0)&&(e[H.Au]=i),this.jf.qc(e),this.Ee._&&this.Ee._.Bs(t,e,this)},this.Xc=function(e){t.Ue=e,t.Ue?t.Jc():t.Qc()},this.oc=function(){var t=this.Wf.Tr(this.Zc(),this.bs());this.Ee._&&this.Ee._.Bs(H.Qs,{},this),this.jf.qc(t)},this.Kc=function(t,e){var n={};n[H.Xs]=t,n[H.Js]=e,this.Wc(H.qs,n)},this.Rc=function(t,e){var n={},i={};t>0&&(i[H.Ys]=t),n[H.Ys]=e,this.Ec(n,i)},this.Tc=function(t,e){var n={},i={};t>0&&(i[H.xs]=t),n[H.xs]=e,this.Ec(n,i)},this.zc=function(t,e){var n={};n[H.uh]=t,e>=0&&(n[H.hh]=e),this.Wc(H.mr,n)},this.yc=function(t,e){var n={},i={};-1!==t&&(i[H.Nu]=t),n[H.Nu]=e,this.Ec(n,i)},this.Dc=function(t,e){var n={},i={};-1!==t&&(i[H.gu]=t),n[H.gu]=e,this.Ec(n,i)},this.Pc=function(t,e){var n={},i={};null!==t&&(i[H.Iu]=t),n[H.Iu]=e,this.Ec(n,i)},this.bc=function(t,e){var n={},i={};null!==t&&(i[H.wu]=t),n[H.wu]=e,this.Ec(n,i)},this.Lc=function(t,e){var n={},i={};Z.Pt(t)&&(i[H._h]=t),n[H._h]=e,this.Ec(n,i)},this.Sc=function(t,e){var n={},i={};t>=0&&(i[H.Cu]=t),n[H.Cu]=e,this.Ec(n,i)},this.Oc=function(t,e){var n={},i={};t>=0&&(i[H.yu]=t),n[H.yu]=e,this.Ec(n,i)},this.Uc=function(t,e){var n={},i={};t!==e&&("string"==typeof t&&(i[H.mu]=t),n[H.mu]=e),this.Ec(n,i)},this.kc=function(t,e){var n={},i={};t!==e&&("string"==typeof t&&(i[H.Du]=t),n[H.Du]=e),this.Ec(n,i)},this.Bc=function(t,e){var n={},i={};t!==e&&("string"==typeof t&&(i[H.Pu]=t),n[H.Pu]=e),this.Ec(n,i)},this.Gc=function(t,e){var n={},i={};i[H.cu]=t,n[H.cu]=e,this.Ec(n,i)},this.Ic=function(t,e){var n={},i={};n[H.Gs]=H.Rh(e),i[H.Gs]=H.Rh(t),this.Ec(n,i)},this.Ec=function(t,e){var n={};n[H.ys]=t,e&&Z.Ht(e)>0&&(n[H.ah]=e),this.Wc(H.Hs,n)},this.$c=function(t,e){var n={};n[H.zs]=t,Z.Ht(e)>0&&(n[H.$s]=e),this.Wc(H.Zs,n)},this.uc=function(){t.qa&&(t.qa(),t.qa=null)},this.fc=function(){t.uc();var e=1e3*t.Vi.heartbeatInterval;t.qa=t._e.create(t.hc,e,"Session.sendHeartbeat:"+this.Jf)},this.Qc=function(){t.wf&&(t.wf(),t.wf=null)},this.Jc=function(){t.Qc(),t.wf=t._e.create(t.tl,t.Cf,"Session.startRfpsTimer")},this.nl=function(){var e={err:"pending"};e.seq=t.Qa-1,e.sentAt=t.bs(),e.rtt=-1,t.$a.push(e);for(var n=0;n<t.$a.length;n++)"ok"===(e=t.$a[n]).err&&(t.$a.splice(n,1),n--)},this.il=function(e,n){for(var i=0;i<t.$a.length;i++){var o=t.$a[i];o.seq===e&&(o.rtt=t.bs()-o.sentAt,o.err=n)}},this.el=function(e){for(var n=0;n<t.$a.length;n++){var i=t.$a[n];i.seq===e&&(i.rtt=t.bs()-i.sentAt,i.err="ok")}},this.sl=function(){for(var e,n,i=t.xf.get(J.ol),o=[],a=-1,r=0;r<t.$a.length;r++)if("ok"===(n=t.$a[r]).err){a=n.seq;break}for(var s=0;s<t.$a.length;s++)((e=(n=t.$a[s]).seq)<t.Qa-i||e<a)&&o.push(s);for(var l=[],u=0;u<t.$a.length;u++)e=(n=t.$a[u]).seq,o.indexOf(u)<0&&l.push(t.$a[u]);t.$a=l},this.rl=function(){t.sl();for(var e=[],n=0;n<t.$a.length;n++){var i=t.$a[n],o={};o[H.fh]=i.seq,o[H.dh]=i.rtt,o[H.lh]=i.err,e.push(o)}return e},this.ul=function(){var e,n=-1,i=-1,o=t.jf.qf();if(t.Fs()&&0===o.length)return null;var a=new G,r=(a.Lh(H.Kr),a.Fh(t.Vi.customerKey),a.Bh(t.xf.get(J.B)),a.Kh(t.Ds.C),a.kh(t.Qa),a.Gh(H.version),c.version);if(t.ki&&(r=t.ki),a.Hh(r),a.Wh(t.Ee.C),a.jh(0),t.Ee.M?a.ba(t.Ee.M):t.M&&a.ba(t.M),t.Ee.U?a.La(t.Ee.U):t.U&&a.La(t.U),Z.Pt(t.fo)&&a.ka(t.fo),a.fa(H.yr),t.sf&&a.ca(t.sf),t.rf&&a.la(t.rf),t.uf&&a.da(t.uf),t.hf&&a.va(t.hf),t.af&&a.Ea(t.af),t.ff&&a._a(t.ff),t.cf&&a.Ra(t.cf),t.vf&&a.Ta(t.vf),t.Ef&&a.Sa(t.Ef),t._f&&a.Oa(t._f),t.lf&&a.pa(t.lf),t.df&&a.Aa(t.df),t.Rf&&!isNaN(t.Rf)&&a.Na(parseInt(t.Rf,10)),t.pf&&!isNaN(t.pf)&&a.ga(parseInt(t.pf,10)),t.Af&&!isNaN(t.Af)?a.Ia(parseFloat(t.Af)):(t.Rf&&!isNaN(t.Rf)||t.pf&&!isNaN(t.pf))&&a.Ia(1),t.Ue&&(t.Vn=t.Ue.zn(),t.Vn&&a.setModuleName(t.Vn),t.kn=t.Ue.$n(),t.kn&&a.Va(t.kn),t.Ue.ti()&&(t.lf=t.Ue.ti(),a.pa(t.lf)),t.Ue.ii())&&(t.df=t.Ue.ii(),a.Aa(t.df)),t.Tn&&a.Yh(t.Tn),Z.Ht(t.ef)>0&&a.Xh(t.ef),t.Cs()||t.Qf()){if(t.Qf()&&a.Ma(),t._n&&a.xh(t._n),a.Jh(t.Za),r=H.Rh(t.Pn),a.Je(r),a.na(t.Sf),t.Ls&&a.qh(t.Ls),Z.ie(t.Us)&&a.Vh(t.Us),t.Ms>0&&a.ia(t.Ms),t.yn>0&&a.ea(t.yn),t.Dn>0&&a.sa(t.Dn),null!==t.if&&a.oa(t.if),t.wn>0&&a.ra(t.wn),t.Ue&&(n=nt.xc(t.Ue.getPHT(),0,null,-1),i=nt.xc(t.Ue.getBufferLength(),0,null,-1)),Z.gt(t.Ee.V)?e=t.Ee.V:t.Ue&&(e=t.Ue.getSignalStrength()),n>=0&&a.Ca(n),i>0&&a.ya(i),(r=t.hl())>0&&a.ua(r),t.mf>0&&a.aa(nt.xc(t.mf,0,null,-1)),t.yf>0&&a.ha(nt.xc(t.yf,0,null,-1)),e!==E.DEFAULT_SIGNAL_STRENGTH&&a.Ua(e),t.On&&a.ma(t.On),t.Fn>0&&a.Da(t.Fn),t.Bn>0&&a.Pa(t.Bn),t.gi>-1&&a.wa(t.gi),t.nf>-1&&(a.yo(t.nf),t.nf>0)&&(t.Oc(t.nf,0),t.nf=0),t.jn&&a.Ka(t.jn),t.Kn&&a.Wa(t.Kn),t.Wn&&a.Ya(t.Wn),void 0!==t.Tf)for(var s in t.Tf)a.Ph(s,t.Tf[s])}else a.Jh(H.Sh.Oh);return o.length>0&&a.Zh(o),a.Qh(t.za),a.zh(!0),t.xf.get(J.al)&&a.$h(t.Fi.qf()),t.xf.get(J.ol)>0&&(n=t.rl()).length>0&&a.ta(n),0===t.Qa&&(a=t.fl(a)),(a=0!==t.Qa?t.ll(a):a).Uh(t.Ps),a.Mh(t.bs()),t.Bf&&(a.Fa(t.bf),a.Ba(t.Lf),a.Ha(t.Mf),a.Ga(t.Uf),a.ja(t.Vf)),t.Qa++,a.get()},this.ll=function(e){var n,i=t.D,o={};for(n in e.Dh.tags)Object.prototype.hasOwnProperty.call(i,n)||(o[n]=e.Dh.tags[n]);e.Dh.tags=o,t.D={};for(var a=0;a<t.Df.length;a++)Object.prototype.hasOwnProperty.call(t.Ee.D,t.Df[a])?Object.prototype.hasOwnProperty.call(t.Ee.L,t.Df[a])?t.Ee.L[t.Df[a]]===J.$t.tn?(t.D[J.dl+""+t.Df[a]]=J.$t.tn,t.Ee.P("End-user chose to opt-out of personal data collection")):t.Ee.L[t.Df[a]]===J.$t.en?(t.D[J.dl+""+t.Df[a]]=J.$t.en,t.Ee.P("End-user chose to opt-out of personal data collection")):t.Ee.L[t.Df[a]]===J.$t.zt?(t.D[J.dl+""+t.Df[a]]=J.$t.zt,t.Ee.P("End-user used privacy settings and chose to opt-out of personal data collection")):(t.D[J.dl+""+t.Df[a]]=t.Ee.D[t.Df[a]],t.Ee.P("Data collection successful")):(t.D[J.dl+""+t.Df[a]]=t.Ee.D[t.Df[a]],t.Ee.P("Data collection successful")):t.D[J.dl+""+t.Df[a]]=J.$t.vl;var r,s={};for(r in i){var l=r.split(".");"{}"!==JSON.stringify(t.Df)&&-1!==t.Df.indexOf(""+l[2])||i[J.dl+""+l[2]]===J.$t.El||(t.Ee.P("Data collection restricted from Conviva back-end"),t.D[J.dl+""+l[2]]=J.$t.El,s[J.dl+""+l[2]]=J.$t.El)}if("{}"!==JSON.stringify(t.D)){var u,c=Z._l(t.D);for(u in e.Dh.tags)c[u]=e.Dh.tags[u];if(e.Dh.tags=c,!Z.Nc(i,t.D)){var h={};if("{}"!==JSON.stringify(s)&&(h[H.ou]=s),"{}"!==JSON.stringify(i)){for(var f in i)t.D[f]&&i[f]!==t.D[f]&&(h[H.ou]||(h[H.ou]={}),h[H.ou][f]=t.D[f]);for(var d in t.D)Object.prototype.hasOwnProperty.call(i,d)&&i[d]===t.D[d]||(h[H.ou]||(h[H.ou]={}),h[H.ou][d]=t.D[d])}"{}"===JSON.stringify(i)&&(h[H.ou]=t.D);var E,v,g={};g[H.ys]=h,g[H.sh]=H.Hs,g[H.rh]=t.bs(),g[H.oh]=t.jf.Yc(),t.Ue&&(E=nt.xc(t.Ue.getPHT(),0,null,-1),v=nt.xc(t.Ue.getBufferLength(),0,null,-1),E>=0&&(g[H.pu]=E),v>0)&&(g[H.Au]=v),e.Dh.evs||(e.Dh.evs=[]),e.Dh.evs.push(g)}}return e},this.fl=function(e){var n=t.Rl();if("{}"!==JSON.stringify(n)){var i,o=Z._l(n);for(i in e.Dh.tags)o[i]=e.Dh.tags[i];e.Dh.tags=o;var a,r={};(n=(r[H.ou]=n,{}))[H.ys]=r,n[H.sh]=H.Hs,n[H.rh]=t.bs(),n[H.oh]=t.jf.Yc(),t.Ue&&(r=nt.xc(t.Ue.getPHT(),0,null,-1),a=nt.xc(t.Ue.getBufferLength(),0,null,-1),r>=0&&(n[H.pu]=r),a>0)&&(n[H.Au]=a),e.Dh.evs||(e.Dh.evs=[]),e.Dh.evs.push(n)}return e},this.Rl=function(){var e={};if("undefined"!=typeof navigator&&navigator){if(e["c3.fp.cookie"]=void 0!==navigator.cookieEnabled&&navigator.cookieEnabled?""+navigator.cookieEnabled:"",e["c3.fp.memory"]=void 0!==navigator.deviceMemory&&navigator.deviceMemory?""+navigator.deviceMemory:"",e["c3.fp.hwConc"]=void 0!==navigator.hardwareConcurrency&&navigator.hardwareConcurrency?""+navigator.hardwareConcurrency:"",e["c3.fp.java"]=""+("function"!=typeof navigator.javaEnabled)?"false":navigator.javaEnabled(),e["c3.fp.lang"]=void 0!==navigator.language&&navigator.language?""+navigator.language:"",e["c3.fp.langs"]=void 0!==navigator.languages&&navigator.languages&&navigator.languages.length>0?""+navigator.languages.toString():"",e["c3.fp.maxTp"]=void 0!==navigator.maxTouchPoints&&navigator.maxTouchPoints?""+navigator.maxTouchPoints:"",e["c3.fp.plugins"]="",void 0!==navigator.plugins&&navigator.plugins&&navigator.plugins.length>0)for(var n=0;n<navigator.plugins.length;n++)e["c3.fp.plugins"]+=navigator.plugins[n].name+",";if(e["c3.fp.mime"]="",void 0!==navigator.mimeTypes&&navigator.mimeTypes&&navigator.mimeTypes.length>0)for(var i=0;i<navigator.mimeTypes.length;i++)e["c3.fp.mime"]+=navigator.mimeTypes[i].type+",";e["c3.fp.sysLang"]=void 0!==navigator.systemLanguage&&navigator.systemLanguage?""+navigator.systemLanguage:"",e["c3.fp.platform"]=void 0!==navigator.platform&&navigator.platform?""+navigator.platform:"",e["c3.fp.product"]=void 0!==navigator.product&&navigator.product?""+navigator.product:"",e["c3.fp.productSub"]=void 0!==navigator.productSub&&navigator.productSub?""+navigator.productSub:"",e["c3.fp.vendor"]=void 0!==navigator.vendor&&navigator.vendor?""+navigator.vendor:"",e["c3.fp.vendorSub"]=void 0!==navigator.vendorSub&&navigator.vendorSub?""+navigator.vendorSub:"";var o=t.pl();""!==o&&(e["c3.fp.canvFp"]=o)}return"undefined"!=typeof window&&window&&(void 0!==window.screen&&window.screen&&(e["c3.fp.availHeight"]=void 0!==window.screen.availHeight&&window.screen.availHeight?""+window.screen.availHeight:"",e["c3.fp.availWidth"]=void 0!==window.screen.availWidth&&window.screen.availWidth?""+window.screen.availWidth:"",e["c3.fp.height"]=void 0!==window.screen.height&&window.screen.height?""+window.screen.height:"",e["c3.fp.width"]=void 0!==window.screen.width&&window.screen.width?""+window.screen.width:"",e["c3.fp.colorDepth"]=void 0!==window.screen.colorDepth&&window.screen.colorDepth?""+window.screen.colorDepth:"",e["c3.fp.deviceXDPI"]=void 0!==window.screen.deviceXDPI&&window.screen.deviceXDPI?""+window.screen.deviceXDPI:"",e["c3.fp.deviceYDPI"]=void 0!==window.screen.deviceYDPI&&window.screen.deviceYDPI?""+window.screen.deviceYDPI:""),e["c3.fp.dpi"]=void 0!==window.devicePixelRatio&&window.devicePixelRatio?""+window.devicePixelRatio:"",e["c3.fp.secure"]="boolean"==typeof window.isSecureContext?""+window.isSecureContext:""),e},this.pl=function(){try{if("undefined"!=typeof document&&document){var t,e,n=document.createElement("CANVAS");if(void 0!==n&&n&&"function"==typeof n.getContext)return t=n.getContext("2d"),e="conviva",t.textBaseline="top",t.font="14px Arial",t.textBaseline="alphabetic",t.fillStyle="#f40",t.fillRect(void 0!==navigator.plugins&&navigator.plugins?navigator.plugins.length:0,void 0!==navigator.mimeTypes&&navigator.mimeTypes?navigator.mimeTypes.length:0,void 0!==navigator.product&&navigator.product?navigator.product.length:0,void 0!==navigator.vendor&&navigator.vendor?navigator.vendor.length:0),t.fillStyle="#069",t.fillText(e,void 0!==navigator.maxTouchPoints&&navigator.maxTouchPoints>=0?navigator.maxTouchPoints:0,void 0!==navigator.product&&navigator.product?navigator.product.length:0),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText(e,void 0!==navigator.deviceMemory&&navigator.deviceMemory?navigator.deviceMemory:0,void 0!==navigator.hardwareConcurrency&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:0),Y.pr(n.toDataURL())}return""}catch(t){return""}},this.hc=function(){var e;t.Nf||(e=t.ul())&&t.Al(e)},this.tl=function(){var e;t.Pn===E.PlayerState.PLAYING&&t.Ue&&(e=t.Ue.getRenderedFrameRate())>0&&(t.mf+=e,t.yf++)},this.hl=function(){return t.mf>0&&t.yf>0||(this.tl(),t.mf>0&&t.yf>0)?Z.Tl.Cast(+t.mf/t.yf):E.DEFAULT_RENDERED_FRAME_RATE},this.Al=function(e){t.nl();var n=t.Qa-1;t.p.info("postHeartbeat(): Send HB["+n+"]"+t.Zf()),t.Kf.Sl(e,(function(e,i){t.Ol(e,i,n)}))},this.Ol=function(e,n,i){t.Nf||t.g.F("onHeartbeatResponse",(function(){var o,a;e?n?(t.p.debug("onHeartbeatResponse(): received valid response for HB["+i+"]"),t.el(i),(o=n[H.Mr])&&o!==(a=t.xf.get(J.B))&&(t.p.debug("onHeartbeatResponse(): setting the client id to "+o+" (from gateway)"),t.xf.set(J.B,o),t.xf.Nl(),a===H.H)&&o!==H.H&&(t.Ee.k(),t.If)&&(t.p.debug("Send enqueued urgent hb as client id is available"),t.wc()),(a=n[H.Lr])&&a!==H.Pr&&t.p.error("onHeartbeatResponse(): error from gateway: "+a),"object"==typeof(o=n[H.Ur])&&((a=o[H.kr])>=0&&t.xf.get(J.ol)!==a&&(t.p.debug("onHeartbeatResponse(): setting Maximum Heartbeat Infos to "+a+" (from gateway)"),t.xf.set(J.ol,a)),a=o[H.Fr],(a=!!Z.ie(a)&&a)!==t.xf.get(J.al)&&(t.p.debug("onHeartbeatResponse(): turning "+(a?"on":"off")+" sending of logs"),t.xf.set(J.al,a)),a=o[H.Br],Z.gt(a)&&(a=Z.Tl.Cast(a))!==t.Vi.heartbeatInterval&&(t.p.debug("onHeartbeatResponse(): received hbIntervalMs from gateway: "+a),t.Vi.heartbeatInterval=a,t.qa)&&t.fc(),(a=o[H.Hr])&&a!==t.Vi.gatewayUrl&&(t.p.debug("onHeartbeatResponse(): received gatewayUrl from gateway: "+a),t.Vi.gatewayUrl=a),t.gl()||(t.Df={},(a=o[H.Gr])&&(t.Pf||(t.Pf=!0),t.p.debug("onHeartbeatResponse(): received fp from gateway: "+a),t.Df=a.split(",")),t.Bf=o[H.jr],Z.ie(t.Bf)&&(t.Bf?(t.p.debug("onHeartbeatResponse(): enabling the CDN Server IP collection"),t.kf||t.cc()):t.rc())))):t.p.warning("onHeartbeatResponse(): decoded heartbeat response is null."):(Z.Pt(a=n)?Z.Il(a,"HTTP timeout")?t.p.warning("onHeartbeatResponse(): "+a):t.p.error("onHeartbeatResponse(): failed to send heartbeat: "+a):(a=x.wl,t.p.error("onHeartbeatResponse(): "+a)),t.il(i,a))}))},this.bs=function(){return Z.Tl.Cast(t.Yf.current()-t.Ps)},this.Zc=function(){return this.jf.Yc()},this.Zf=function(){return this.Fs()?" (global session)":""},this.Fs=function(){return this.Jf===W.Nt.Oh},this.gl=function(){return this.Jf===W.Nt.Oh&&"T"===this.ef["c3.IPV4IPV6GlobalSession"]},this.Cs=function(){return this.Jf===W.Nt.Ot},this.Qf=function(){return this.Jf===W.Nt.Dt},this.Lt=function(e){t.Cl(e),t.tc()},this.Cl=function(e){var n={},i={};if(Z.Pt(e.assetName)&&!t.Ds.yl&&(t.Ct.assetName!==e.assetName?(t.Ct.assetName&&(n[H.eu]=t.Ct.assetName),i[H.eu]=e.assetName,t.Ct.assetName=e.assetName):t.p.warning("mergeContentMetadata(): assetName was not changed.")),Z.Pt(e.applicationName)&&(t.Ct.applicationName!==e.applicationName?(t.Ct.applicationName&&(n[H.su]=t.Ct.applicationName),i[H.su]=e.applicationName,t.Ct.applicationName=e.applicationName):t.p.warning("mergeContentMetadata(): applicationName was not changed.")),Z.Pt(e.streamUrl)&&!t.Ds.ml&&(t.Ct.streamUrl!==e.streamUrl?(t.Ct.streamUrl&&(n[H.Tu]=t.Ct.streamUrl),i[H.Tu]=e.streamUrl,t.Ct.streamUrl=e.streamUrl,t.On=t.Ct.streamUrl):t.p.warning("mergeContentMetadata(): streamUrl was not changed.")),Z.Pt(e.viewerId)&&(t.Ct.viewerId!==e.viewerId?(t.Ct.viewerId&&(n[H.iu]=t.Ct.viewerId),i[H.iu]=e.viewerId,t.Ct.viewerId=e.viewerId):t.p.warning("mergeContentMetadata(): viewerId was not changed.")),Z.Pt(e.defaultResource)&&!t.Ds.Dl&&(t.Ct.defaultResource!==e.defaultResource?(t.Ct.defaultResource&&(n[H.Ru]=t.Ct.defaultResource),i[H.Ru]=e.defaultResource,t.Ct.defaultResource=e.defaultResource):t.p.warning("mergeContentMetadata(): defaultResource was not changed.")),Z.gt(e.duration)&&e.duration>0&&!t.Ds.Pl&&(t.Ct.duration!==e.duration?(t.Ms>0&&(n[H.lu]=t.Ms),i[H.lu]=e.duration,t.Ct.duration=e.duration,t.Ms=t.Ct.duration):t.p.warning("mergeContentMetadata(): duration was not changed.")),Z.gt(e.encodedFrameRate)&&e.encodedFrameRate>0&&!t.Ds.bl&&(t.Ct.encodedFrameRate!==e.encodedFrameRate?(t.Ct.encodedFrameRate>-1&&(n[H.du]=t.Ct.encodedFrameRate),i[H.du]=e.encodedFrameRate,t.Ct.encodedFrameRate=e.encodedFrameRate,t.wn=t.Ct.encodedFrameRate):t.p.warning("mergeContentMetadata(): encodedFrameRate was not changed.")),e.streamType!==d.StreamType.UNKNOWN&&(t.Ct.streamType!==e.streamType?(t.Ct.streamType!==d.StreamType.UNKNOWN&&(t.Ct.streamType===d.StreamType.LIVE?n[H.Xr]=!0:n[H.Xr]=!1),e.streamType===d.StreamType.LIVE?i[H.Xr]=!0:i[H.Xr]=!1,t.Ct.streamType=e.streamType):t.p.warning("mergeContentMetadata(): streamType was not changed.")),Z.Ht(e.custom)>0){var o,a={},r={};for(o in e.custom)t.Ct.custom[o]!==e.custom[o]?(a[o]=e.custom[o],t.Ct.custom[o]&&(r[o]=t.Ct.custom[o]),t.Ct.custom[o]=e.custom[o]):t.p.info("mergeContentMetadata(): custom."+o+" was not changed.");Z.Ht(a)>0?(Z.Ht(r)>0&&(n[H.ou]=r),i[H.ou]=a):t.p.warning("mergeContentMetadata(): custom was not changed.")}Z.Ht(i)>0&&this.Ec(i,n)},this.tc=function(){var e;t.p.debug("setStatesFromContentMetadata()"),t.Ct.defaultResource&&this.oa(t.Ct.defaultResource),t.Ct.streamUrl&&this.ma(t.Ct.streamUrl),t.Ct.duration>0&&this.ia(t.Ct.duration),t.Ct.encodedFrameRate>0&&this.ra(t.Ct.encodedFrameRate),t.Ct.streamType!==d.StreamType.UNKNOWN&&(e=t.Ct.streamType===d.StreamType.LIVE,this.Vh(e)),t.Ct.assetName&&this.xh(t.Ct.assetName),t.Ct.viewerId&&this.Yh(t.Ct.viewerId),(t.Ct.applicationName||t.Ct.playerName)&&this.qh(t.Ct.applicationName||t.Ct.playerName),Z.Ht(t.Ct.custom)>0&&this.Xh(t.Ct.custom)},this.nc=function(){var e={};if(this.Fs()||(t.Ct.assetName?e[H.eu]=t.Ct.assetName:t.p.warning("enqueueEventForContentMetadata(): assetName was not set."),t.Ct.applicationName?e[H.su]=t.Ct.applicationName:t.p.warning("enqueueEventForContentMetadata(): applicationName was not set."),t.Ct.streamUrl?e[H.Tu]=t.Ct.streamUrl:t.p.warning("enqueueEventForContentMetadata(): streamUrl was not set."),t.Ct.viewerId?e[H.iu]=t.Ct.viewerId:t.p.warning("enqueueEventForContentMetadata(): viewerId was not set."),t.Ct.defaultResource?e[H.Ru]=t.Ct.defaultResource:t.p.warning("enqueueEventForContentMetadata(): defaultResource was not set."),t.Ct.duration>-1?e[H.lu]=t.Ct.duration:t.p.warning("enqueueEventForContentMetadata(): duration was not set."),t.Ct.encodedFrameRate>-1?e[H.du]=t.Ct.encodedFrameRate:t.p.warning("enqueueEventForContentMetadata(): encodedFrameRate was not set."),t.Ct.streamType!==d.StreamType.UNKNOWN?t.Ct.streamType===d.StreamType.LIVE?e[H.Xr]=!0:e[H.Xr]=!1:t.p.warning("enqueueEventForContentMetadata(): streamType was not set.")),Z.Ht(t.Ct.custom)>0)for(var n in e[H.ou]={},t.Ct.custom)e[H.ou][n]=t.Ct.custom[n];else this.Fs()||t.p.warning("enqueueEventForContentMetadata(): custom tags were not set.");Z.Ht(e)>0&&this.Ec(e,null)},this.ec=function(){t.Ct&&Z.Pt(t.Ct.assetName)||t.p.warning("Missing assetName during session creation"),t.Ct&&Z.Pt(t.Ct.defaultResource)||t.p.warning("Missing resource during session creation"),t.Ct&&Z.Pt(t.Ct.streamUrl)||t.p.warning("Missing streamUrl during session creation"),(!t.Ct||t.Ct.encodedFrameRate<=0)&&t.p.warning("Missing encodedFrameRate during session creation"),t.Ct&&Z.Pt(t.Ct.viewerId)||t.p.warning("Missing viewerId during session creation"),t.Ct&&t.Ct.streamType&&d.StreamType.UNKNOWN!==t.Ct.streamType||t.p.warning("Missing streamType during session creation"),t.Ct&&Z.Pt(t.Ct.applicationName)||t.p.warning("Missing applicationName during session creation"),(!t.Ct||t.Ct.duration<=0)&&t.p.warning("Missing duration during session creation")},this.Zt=function(e,n){t.Tf||(t.Tf={}),t.Tf[e]=n},this.ic=function(){var e={};t.Ee&&t.Ee.M&&(e[H.Iu]=t.Ee.M,t.M=t.Ee.M),t.Ee&&t.Ee.U&&(e[H.wu]=t.Ee.U,t.U=t.Ee.U),Z.Ht(e)>0&&this.Ec(e,null)},this.wc=function(){var e;t.gf||((e=t.xf.get(J.B))&&e!==H.H&&""!==e&&"null"!==e?(t.If=!1,e=et.Ll(t.Xa,t.Ja),t.fc(),setTimeout((function(){try{t&&(t.hc(),t.fc())}catch(t){}}),e)):(t.p.debug("Delay sending of urgent hb due to missing client id"),t.If=!0))}}).xa=H.Sh.Ot+H.Sh.Nh+H.Sh.gh,W.Nt={Ot:"Video",Oh:"Global",Dt:"Ad"},(x=ut.Session=function(){var t=this;t.Ue=null,t.C=0,t.Jf=W.Nt.Ot,t.Ml=!1,t.Nf=!1,t.Ul=!1,t.Vl=null,t.Re=null,t.kl=null,t.Fl=!1,t.Bl=E.PlayerState.NOT_MONITORED,t.Hl=!1,t.Gl=!1,t.jl=!1,t.bl=!1,t.Kl=!1,t.Vc=!1,t.Fc=!1,t.Mc=!1,t.yl=!1,t.ml=!1,t.Wl=!1,t.Pl=!1,t.Dl=!1,t.Yl=!1,function(t,e,n,i,o,a,r){this.C=t,this.Jf=e,this.xf=n,this.xl=i,this.wt=o,this.g=a,this.p=r}.apply(t,arguments),this.Xf=function(e,n){t.wt.Xf(this),e&&t.Vt(e),t.xf.ql()?t.Xl(n):t.xf.Jl((function(){t.Xl(n)}))},this.cleanup=function(){t.Ml=!0,t.wt.zf(),t.xf.ql()?t.Ql():t.xf.Jl((function(){t.Ql()}))},this.Zl=function(){(t.Cs()||t.Qf())&&t.Ue&&t.zl(),t.g=null,t.Ee=null,t.xf=null,t.xl=null,t.wt.Tt(),t.wt=null,t.Nf=!0},this.Ql=function(){t.wt.sc(),t.Zl()},this.Xl=function(e){t.wt.$f(),t.$l(),e?(t.bt(e.er(),e.sr()),t.wt.Je(E.PlayerState.STOPPED),t.wt.sc(),t.Zl()):t.wt.ac()},this.$l=function(){var e,n=t.xl.get();(e=((e=((e=((e=((e=((e=((e=((e=((e=((e=((e=((e=((e=((e=((e=n[rt.BROWSER_NAME])&&t.wt.ca(e),n[rt.BROWSER_VERSION]))&&t.wt.la(e),n[rt.DEVICE_BRAND]))&&t.wt.da(e),n[rt.DEVICE_MANUFACTURER]))&&t.wt.va(e),n[rt.DEVICE_MODEL]))&&t.wt.Ea(e),n[rt.DEVICE_TYPE]))&&t.wt._a(e),n[rt.DEVICE_VERSION]))&&t.wt.Ra(e),n[rt.FRAMEWORK_NAME]))&&t.wt.pa(e),n[rt.FRAMEWORK_VERSION]))&&t.wt.Aa(e),n[rt.OPERATING_SYSTEM_NAME]))&&t.wt.Ta(e),n[rt.OPERATING_SYSTEM_VERSION]))&&t.wt.Sa(e),n[rt.DEVICE_CATEGORY]))&&t.wt.Oa(e),n[rt.SCREEN_WIDTH]))&&t.wt.Na(e),n[rt.SCREEN_HEIGHT]))&&t.wt.ga(e),n[rt.SCALE_FACTOR]))&&t.wt.Ia(e)},this.Ei=function(e){t.wt.Pn===e||(t.wt.Pn===E.PlayerState.NOT_MONITORED&&e!==E.PlayerState.NOT_MONITORED&&(t.Bl=e),t.Fl)||t.wt.Je(e)},this._i=function(e){t.Hl||t.wt._c(e)},this.Ri=function(e){t.Hl||t.wt.Ac(e)},this.Ii=function(e){t.Gl||t.wt.wa(e)},this.wi=function(e){t.Gl||t.wt.yo(e)},this.pi=function(e,n){!Z.gt(n)&&t.Yl&&(n=-1),t.wt.zc(e,n)},this.qn=function(e){e>0&&(t.bl||t.wt.ra(e))},this.Qn=function(e){e>0&&(t.Pl||t.wt.ia(e))},this.Zn=function(e){t.wt.ma(e)},this.Ai=function(e){t.wt.Cc(e)},this.Ti=function(e){t.wt.mc(e)},this.nt=function(e){t.wt.ba(e)},this.et=function(e){t.wt.La(e)},this.ni=function(e){t.wt.Vs()||t.wt.pa(e)},this.ei=function(e){t.wt.ks()||t.wt.Aa(e)},this.Oi=function(e){t.wt.ka(e)},this.oi=function(e){t.wt.Ka(e)},this.ui=function(e){t.wt.Wa(e)},this.ai=function(e){t.wt.Ya(e)},this.Si=function(e,n){t.bt(e,n)},this.Yn=function(){t.zl()},this.Wt=function(e,n,i){t.Ul||(t.Ul=!0,t.Vl=e,t.Re=n,t.kl=i,t.wt.Hc(!0),t.Vl===h.AdStream.CONTENT||t.Re===h.AdPlayer.SEPARATE?(t.wt.Pn!==E.PlayerState.NOT_MONITORED&&(t.Bl=t.wt.Pn),t.wt.Je(E.PlayerState.NOT_MONITORED),t.Fl=!0):t.Vl===h.AdStream.SEPARATE&&t.Re===h.AdPlayer.CONTENT&&(t.wt.Pn!==E.PlayerState.NOT_MONITORED&&(t.Bl=t.wt.Pn),t.wt.Je(E.PlayerState.NOT_MONITORED),t.Fl=!0,t.Hl=!0,t.Gl=!0,t.bl=!0,t.jl=!0,t.Vc=!0,t.Fc=!0,t.Mc=!0,t.yl=!0,t.ml=!0,t.Wl=!0,t.Pl=!0,t.Dl=!0,t.Yl=!0))},this.Yt=function(){t.Ul&&(t.wt.Hc(!1),t.Vl===h.AdStream.CONTENT||t.Re===h.AdPlayer.SEPARATE?t.td||(t.Fl=!1,t.wt.Je(t.Bl)):t.Vl===h.AdStream.SEPARATE&&t.Re===h.AdPlayer.CONTENT&&(t.Hl=!1,t.Gl=!1,t.bl=!1,t.jl=!1,t.Kl=!1,t.td||(t.Fl=!1,t.wt.Je(t.Bl)),t.Vc=!1,t.Fc=!1,t.Mc=!1,t.yl=!1,t.ml=!1,t.Wl=!1,t.Pl=!1,t.Dl=!1,t.Yl=!1),t.Ul=!1,t.Vl=t.Re=t.kl=null)},this.Mt=function(){t.Ue&&t.Ue&&(t.g.F("Session.detachPlayer",(function(){t.Ue.xn()})),t.Ue=null,t.wt.Xc(null),t.wt.Je(E.PlayerState.NOT_MONITORED))},this.zl=function(){t.Ue&&(t.g.F("Session.releasePlayerStateManager",(function(){t.Ue.xn()})),t.Ue=null,t.wt.Xc(null),t.wt.Je(E.PlayerState.NOT_MONITORED))},this.Ut=function(){t.wt.Hc(!0),t.wt.Pn!==E.PlayerState.NOT_MONITORED&&(t.Bl=t.wt.Pn),t.wt.Je(E.PlayerState.NOT_MONITORED),t.Fl=!0},this.Vt=function(e){t.Ue||e instanceof E&&t.g.F("Session.attachPlayer()",(function(){e.setMonitoringNotifier(t,t.C)&&(e.fi(),t.Ue=e,t.wt.Xc(t.Ue))}))},this.kt=function(){t.wt.Hc(!1),t.Hl=!1,t.Gl=!1,t.nd=!1,t.jl=!1,t.Kl=!1,t.Vc=!1,t.Fc=!1,t.Mc=!1,t.yl=!1,t.ml=!1,t.Wl=!1,t.Pl=!1,t.Dl=!1,t.Yl=!1,t.td||(t.Fl=!1,t.Bl!==E.PlayerState.NOT_MONITORED&&t.wt.Je(t.Bl))},this.qt=function(){return t.Ue},this.Ft=function(){t.td||(t.td=!0,t.Fl=!0)},this.Bt=function(){t.td&&(t.td=!1,t.Ul||(t.Fl=!1,t.Bl!==E.PlayerState.NOT_MONITORED&&t.wt.Je(t.Bl)))},this.bt=function(e,n){!Z.Pt(e)||n!==h.ErrorSeverity.FATAL&&n!==h.ErrorSeverity.WARNING||t.Kl||(n=n===h.ErrorSeverity.FATAL,t.wt.jc(e,n))},this.Lt=function(e){t.g.F("Session.updateContentMetadata",(function(){t.wt.Lt(e)}))},this.Kt=function(e,n){t.wt.$c(e,n)},this.Fs=function(){return t.Jf===W.Nt.Oh},this.Cs=function(){return t.Jf===W.Nt.Ot},this.Qf=function(){return t.Jf===W.Nt.Dt},this.Zf=function(){return t.Fs()?" (global session)":""},this.Jt=function(){return this.C},this.Qt=function(){var e=null;return t.xf.ql()?t.xf.get(J.B):e},this.Zt=function(e,n){t.wt.Zt(e,n)}}).wl="received no response (or a bad response) to heartbeat POST request",q=ut.SessionFactory=function(){var t=this;t.Fi=null,t.ed=0,t.sd=null,function(e,n,i,o){t.Ee=e,t.Vi=n,t.xf=i,t.T=o,t.ed=0,t.sd={}}.apply(t,arguments),this.Tt=function(){for(var e in t.Fi=null,t.sd)t.sd[e].cleanup();t.sd=null,t.ed=0},this.od=function(){var e=t.ed;return t.ed++,e},this.St=function(e,n,i,o,a){return e||(e=new d),t.rd(e,n,i,o,a)},this.Y=function(e){return t.rd(e,W.Nt.Oh,void 0,c.version)},this.ud=function(){return et.hd()},this.rd=function(e,n,i,o,a){return n=t.T.Zi(t.Ee,t.Vi,t.xf,t.ud(),n,e.ct(),o),e=t.od(),void 0!==a&&void 0!==a.error?n.Xf(i,a.error):(t.ad(e,n),n.Xf(i)),e},this.jt=function(e){return e=t.sd[e]},this.It=function(t){return!(t=this.jt(t))||t.Cs()||t.Qf()?t:null},this.ad=function(e,n){t.sd[e]=n},this.fd=function(e){delete t.sd[e]},this.xt=function(e){var n=t.jt(e);t.fd(e),n.cleanup()},this.tt=function(){return t.sd}},j=ut.ld=function(t){this._e=t,this.dd=function(t,e,n){var i=!1;return this._e.createOnce((function(){i||t(!(i=!0),n+" ("+e+" ms)")}),e,"CallbackWithTimeout.wrap"),function(e,n){i||(i=!0,t(e,n))}}},(J=ut.Config=function(t,e,n){var i=this;this.Ed=e,this._d=n,this.Rd={clientId:H.H,iid:H.Or,sendLogs:!1,maxHbInfos:H.gr},this.I=Z._l(this.Rd),this.pd=!1,this.Ad=!1,this.Td=[],this.ql=function(){return this.pd},this.Et=function(){this.Ed.Et(J.vd,(function(t,e){t&&i.Sd(e),i.pd=!0,i.Od()}))},this.Sd=function(t){var e;(t=this._d.yh(t))?t&&(e=t[J.Nd],t=t[J._t],e&&e!==H.H&&""!==e&&"null"!==e?this.I[J.B]=e:(this.I[J.B]=this.gd(),this.Nl()),t!==H.Or)&&""!==t&&"null"!==t&&(this.I[J._t]=t):(this.I[J.B]=this.gd(),this.Nl(),this.Ad=!0)},this.Id=function(){var t={};return t[J.Nd]=this.I.clientId,this._d.Ch(t)},this.Nl=function(){this.Ed.Nl(J.vd,this.Id(),(function(t,e){}))},this.Jl=function(t){this.ql()?t():this.Td.push(t)},this.get=function(t){return this.pd?this.I[t]:null},this.set=function(t,e){this.pd&&(this.I[t]=e)},this.Od=function(){for(var t;void 0!==(t=this.Td.shift());)t()},this.getClientId=function(){return this.I.clientId},this.gd=function(){try{var t=2147483647;return Math.floor(Math.random()*t).toString()+"."+Math.floor(Math.random()*t).toString()+"."+Math.floor(Math.random()*t).toString()+"."+Math.floor(Math.random()*t).toString()}catch(t){this.p.debug("error caught in _generateClid()")}return"0"},this.getIid=function(){return this.I.iid}}).vd="sdkConfig",J.Nd="clId",J._t="iid",J.B="clientId",J.al="sendLogs",J.ol="maxHbInfos",J.dl="c3.fp.",J.$t={vl:"0",wd:"1",tn:"2",zt:"3",El:"4",en:"5",nn:"6"},X=ut.EventQueue=function(){this.Cd=[],this.yd=0,this.qc=function(t){this.Cd.push(t)},this.Yc=function(){var t=this.yd;return this.yd++,t},this.qf=function(){var t=this.Cd;return this.Cd=[],t}},Q=ut.ExceptionCatcher=function(t,e,n){this.md=e,this.N=n,this.F=function(t,e,n){try{e()}catch(e){if(n)n(e);else{if(this.N.allowUncaughtExceptions)throw e;this.Dd(t,e)}}},this.Dd=function(t,e){if(t="Uncaught exception: "+t+": "+e.toString(),this.md)try{this.md.Sl(t)}catch(t){}}},$=ut.GatewayControl=function(t,e,n,i,o){var a=this;this.Vi=t,this.Pd=n,this._d=i,this.bd=o,this.Sl=function(t,e){var n=(this.bd?this.bd.indexOf("ipv4")>-1?this.Vi.G:this.Vi.q:this.Vi.gatewayUrl)+H.Sr;this.Pd.Ld("POST",n,this._d.Ch(t),"application/json",(function(t,n){var i;t?(i=a._d.yh(n),e(t,i)):e(t,n)}))}},Z=ut.Lang={Md:function(t){return Z.Pt(t)&&t&&"undefined"!==t&&"null"!==t},Gt:function(t){var e,n,i={};for(e in t)Z.Md(e)&&(n=t[e],Z.Md(n))&&(i[e]=n);return i},Xn:function(t,e,n){if(!t)throw new Error("Expected "+n+" implementation is null.");for(var i in e)if("function"!=typeof t[i])throw new Error("Expected method "+i+" in "+n+" implementation.")},Ht:function(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n},yt:function(t){return""+t},Ud:function(t){return Math.floor(t)},cn:function(t){return Math.abs(Z.Ud(t))},Vd:function(t){return Boolean(t)},Pt:function(t){return"string"==typeof t&&""!==t},Il:function(t,e){return"string"==typeof t&&"string"==typeof e&&"function"==typeof t.indexOf&&0===t.indexOf(e)},ie:function(t){return"boolean"==typeof t},kd:function(t){return escape(t)},mh:function(t){return"object"==typeof t},gc:function(t){var e,n="";for(e in t)n+=e+"="+t[e];return"Object{"+n+"}"},Fd:function(t){var e,n=Z._l(t);for(e in n)n[e]||delete n[e];return n},_l:function(t){var e,n={};for(e in t)n[e]=t[e];return n},Nc:function(t,e){if(typeof t!=typeof e)return!1;if(t instanceof Object&&e instanceof Object){if(Z.Ht(t)!==Z.Ht(e))return!1;for(var n in t)if(t[n]!==e[n])return!1;return!0}return t===e},Fo:function(){for(var t={},e=0;e<arguments.length;e++)for(var n in arguments[e])arguments[e][n]&&(t[n]=arguments[e][n]);return t},gt:function(t){return"number"==typeof t&&Math.round(t)===t},Bd:function(t){return"[object Array]"===Object.prototype.toString.call(t)},Hd:function(t,e){if(t!==e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(Z.Bd(t[n])&&Z.Bd(e[n])){if(!Z.Hd(t[n],e[n]))return!1}else if(t[n]!==e[n])return!1}return!0},Gd:function(){return void 0!==Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(t){return!1}}()},rn:function(t,e,n){if(Z.Gd())Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:n});else{if(void 0===t.__defineGetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineGetter__");t.__defineGetter__(e,n)}},un:function(t,e,n){if(Z.Gd())Object.defineProperty(t,e,{configurable:!0,set:n});else{if(void 0===t.__defineSetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineSetter__");t.__defineSetter__(e,n)}}},(k={two32:4294967296}).jd=k.two32-1,k.Kd=0,Z.Wd=k,Z.Wd.Cast=function(t){return(t=parseInt(t,10))>k.jd?t%=k.two32:t<k.Kd&&(t=k.two32-(t=-t%k.two32)),t},Z.Wd.Yd=function(t){return(t=parseInt(t,10))<=k.jd&&t>=k.Kd},K={jd:2147483647,Kd:-2147483648},Z.Tl=K,Z.Tl.Cast=function(t){return(t=parseInt(t,10))>K.jd?t%=K.jd:t<K.Kd&&(t=K.jd-(t=-t%K.jd)),t},Z.Tl.Yd=function(t){return(t=parseInt(t,10))<=K.jd&&t>=K.Kd},Z.ir=function(){return"undefined"!=typeof window&&window&&window.location&&window.location.search?window.location.search:""},Z.xd=function(){return document&&document.referrer?document.referrer:""},z=ut.LogBuffer=function(){this.qd=[],this.dr=function(t){this.qd.length>=32&&this.qd.shift(),this.qd.push(t)},this.qf=function(){var t=this.qd;return this.qd=[],t}},(tt=ut.Ping=function(t,e,n,i){this.Jd=!1,this.Qd=null,this.p=t,this.p.setModuleName("Ping"),this.Pd=e,this.Vi=n,this.ki=i,this.Sl=function(t){this.Jd||(this.Jd=!0,t=this.Zd()+"&d="+Z.kd(t.toString()),this.p.error("send(): "+t),this.Pd.Ld("GET",t,null,null,null),this.Jd=!1)},this.Zd=function(){if(!this.Qd){var t=tt.zd+"?comp="+tt.Xd+"&clv="+(this.ki||h.version);if(this.Vi&&(t+="&cid="+this.Vi.customerKey),t+="&sch="+H.yr,!this.Vi)return t;this.Qd=t}return this.Qd}}).Xd="sdkjs",tt.zd="https://pings.conviva.com/ping.ping",et=ut.$d={tv:4294967295,nv:2147483647,iv:-2147483648,hd:function(){return Math.floor(Math.random()*et.tv)+et.iv},Rt:function(){return Math.floor(Math.random()*et.tv)},Ll:function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}},nt=ut.ev={xc:function(t,e,n,i){return isNaN(t)||"number"!=typeof t||t===i?i:(i=Z.Ud(t),nt.sv(i,e,n))},sv:function(t,e,n){return Z.gt(n)&&t>n?t=n:Z.gt(e)&&t<e&&(t=e),t},In:function(t){return-1!==t&&-2!==t?nt.xc(t,0,null,-1):t}},it=ut.StreamerError=function(){var t=this;t.errorCode=null,t.severity=h.ErrorSeverity.FATAL,function(e,n){t.errorCode=e,t.severity=n}.apply(t,arguments),this.er=function(){return t.errorCode},this.sr=function(){return t.severity}},ot=ut.HttpClient=function(t,e,n,i){this.Di=e,this.ov=n,this.N=i,this.Ld=function(t,e,n,i,o){var a=1e3*this.N.httpTimeout,r=null;o&&(r=this.ov.dd(o,a,"HTTP timeout")),this.Di.makeRequest(t,e,n,i,a,r)}},(at=ut.Logger=function(t,e,n,i,o){this.Li=t,this.yi=e,this.O=n,this.Fi=i,this.Ui=o,this.debug=function(t){this.log(t,P.LogLevel.DEBUG)},this.info=function(t){this.log(t,P.LogLevel.INFO)},this.warning=function(t){this.log(t,P.LogLevel.WARNING)},this.error=function(t){this.log(t,P.LogLevel.ERROR)},this.log=function(t,e){t=this.uv(t,e),this.Fi.dr(t),this.O.logLevel<=e&&this.Li.consoleLog(t,e)},this.hv=function(t){return"["+this.Vn+"] "+t},this.av=function(t){return"["+this.Ui+"] "+t},this.fv=function(t){return"[Conviva] "+t},this.cv=function(t){return"["+(this.yi.getEpochTimeMs()/1e3).toFixed(3).toString()+"] "+t},this.dv=function(t,e){return"["+at.rv(e)+"] "+t},this.vv=function(t){return this.Ev?"sid="+this.Ev+" "+t:t},this.Kh=function(t){this.Ev=t},this.setModuleName=function(t){this.Vn=t},this.uv=function(t,e){return this.fv(this.cv(this.dv(this.av(this.hv(this.vv(t))),e)))}}).rv=function(t){var e;switch(t){case P.LogLevel.ERROR:e="ERROR";break;case P.LogLevel.WARNING:e="WARNING";break;case P.LogLevel.INFO:e="INFO";break;case P.LogLevel.DEBUG:e="DEBUG"}return e},ut.Storage=function(t,e,n,i){this.Pi=e,this.ov=n,this.N=i,this.Et=function(t,e){e=this.ov.dd(e,1e3*this.N.storageTimeout,"storage load timeout"),this.Pi.loadData(ut.Storage._v,t,e)},this.Nl=function(t,e,n){n=this.ov.dd(n,1e3*this.N.storageTimeout,"storage save timeout"),this.Pi.saveData(ut.Storage._v,t,e,n)}},ut.Storage._v="Conviva",(rt=ut.SystemMetadata=function(t,e,n){this.bi=e,this.g=n,this.Rv=null,this.get=function(){return this.Rv||this.retrieve(),this.Rv},this.retrieve=function(){var t,e={},n=(e[rt.BROWSER_NAME]=this.bi.getBrowserName,e[rt.BROWSER_VERSION]=this.bi.getBrowserVersion,e[rt.DEVICE_BRAND]=this.bi.getDeviceBrand,e[rt.DEVICE_MANUFACTURER]=this.bi.getDeviceManufacturer,e[rt.DEVICE_MODEL]=this.bi.getDeviceModel,e[rt.DEVICE_TYPE]=this.bi.getDeviceType,e[rt.DEVICE_VERSION]=this.bi.getDeviceVersion,e[rt.FRAMEWORK_NAME]=this.bi.getFrameworkName,e[rt.FRAMEWORK_VERSION]=this.bi.getFrameworkVersion,e[rt.OPERATING_SYSTEM_NAME]=this.bi.getOperatingSystemName,e[rt.OPERATING_SYSTEM_VERSION]=this.bi.getOperatingSystemVersion,e[rt.DEVICE_CATEGORY]=this.bi.getDeviceCategory,e[rt.SCREEN_WIDTH]=this.bi.getScreenWidth,e[rt.SCREEN_HEIGHT]=this.bi.getScreenHeight,e[rt.SCALE_FACTOR]=this.bi.getScaleFactor,this);for(t in e)!function(t,e){n.g.F("Session.getSystemMetadataSchema(): "+t,(function(){var i=e[t];e[t]=i.call(n.bi)}))}(t,e),Z.Pt(e[t])||delete e[t];var i=!1;if(void 0!==e[rt.DEVICE_TYPE]){for(var o in h.DeviceType)if(e[rt.DEVICE_TYPE]===h.DeviceType[o]){i=!0;break}i||delete e[rt.DEVICE_TYPE]}if(i=!1,void 0!==e[rt.DEVICE_CATEGORY]){for(var a in h.DeviceCategory)if(e[rt.DEVICE_CATEGORY]===h.DeviceCategory[a]){i=!0;break}i||delete e[rt.DEVICE_CATEGORY]}this.Rv=Z.Fd(e)}}).BROWSER_NAME="browserName",rt.BROWSER_VERSION="browserVersion",rt.DEVICE_BRAND="deviceBrand",rt.DEVICE_MANUFACTURER="deviceManufacturer",rt.DEVICE_MODEL="deviceModel",rt.DEVICE_TYPE="deviceType",rt.DEVICE_VERSION="deviceVersion",rt.FRAMEWORK_NAME="frameworkName",rt.FRAMEWORK_VERSION="frameworkVersion",rt.OPERATING_SYSTEM_NAME="operatingSystemName",rt.OPERATING_SYSTEM_VERSION="operatingSystemVersion",rt.DEVICE_CATEGORY="deviceCategory",rt.SCREEN_WIDTH="screenWidth",rt.SCREEN_HEIGHT="screenHeight",rt.SCALE_FACTOR="scaleFactor",st=ut.Time=function(t,e){this.yi=t,this.p=e,this.current=function(){var t=this.yi.getEpochTimeMs();return Z.gt(t),t}},lt=ut.Timer=function(t,e,n){var i=this;this.mi=e,this.g=n,this.create=function(t,e,n){return this.createTimer((function(){i.g.F(n,(function(){t()}))}),e,n)},this.createOnce=function(t,e,n){var o={cancel:null};return o.cancel=this.createTimer((function(){i.g.F(n,(function(){o&&"function"==typeof o.cancel&&(o.cancel(),o.cancel=null,o=null),t()}))}),e,n),o.cancel},this.createTimer=function(t,e,n){return this.mi.createTimer(t,e,n)}}}(),t}));var ConvivaIma3Integration=function(t,e,n){var i=null==window.localStorage.getItem("sdsat_debug")||"false"==window.localStorage.getItem("sdsat_debug");function o(t,e){e||console.log(t)}o("<<++ConvivaIma3Integration - "+t.mediainfo.name,i),null!=window.convivaVideoAnalytics&&(o("<<++ConvivaIma3Integration - Ending any previous Conviva Sessions "+t.mediainfo.name,i),this.onEnded());var a=this;window.convivaIntegration=this,this.videoPlayer=t,this.contentMetadata=n,this.videoPlayerContainer=t.el(),this.isAdBreakEnabled=!0;var r=null,l=null;this.initConvivaClient=function(){o("<<++initConvivaClient - "+t.mediainfo.name,i),Conviva.Analytics.init(e[Conviva.Constants.CUSTOMER_KEY],this.getConvivaCallbackFunctions(),e),Conviva.Analytics.setDeviceMetadata(this.getDeviceMetadata()),this.checkTabWinClose(this)},this.checkTabWinClose=function(e){o("<<++checkTabWinClose - "+t.mediainfo.name,i),window.addEventListener("unload",(function(){o("<<++unload ********- ",i),l&&(o("<<++reportAdEnded - ",i),l.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),l.reportAdEnded(),l.release()),r&&(o("<<++reportPlaybackEnded - ",i),r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),r.reportPlaybackEnded(),r.release())}))},this.getDeviceMetadataReal=function(){o("<<++getDeviceMetadataReal - "+t.mediainfo.name,i);const e=navigator.userAgent.toLowerCase();let n="Unknown",a="Unknown";if(e.includes("iphone"))n="Apple",a="iPhone";else if(e.includes("ipad"))n="Apple",a="iPad";else if(e.includes("macintosh")||e.includes("mac os"))n="Apple",a="Mac";else if(e.includes("android")){n="Android";const t=e.match(/android [\d.]+; (.*?);/);t&&t[1]&&(a=t[1])}else if(e.includes("windows")){n="Windows";const t=e.match(/windows nt [\d.]+; (.*?);/);t&&t[1]&&(a=t[1])}else if(e.includes("linux")){n="Linux";const t=e.match(/\((.*?)\)/);t&&t[1]&&(a=t[1])}return{BRAND:n,MANUFACTURER:n,MODEL:a,OS_NAME:navigator.platform,OS_VERSION:navigator.appVersion}},this.getDeviceMetadata=function(){o("<<++getDeviceMetadata - "+t.mediainfo.name,i);var e=this.getDeviceMetadataReal(),n=this.getDeviceMetadataReal();return n[Conviva.Constants.DeviceMetadata.BRAND]=e.BRAND,n[Conviva.Constants.DeviceMetadata.MANUFACTURER]=e.MANUFACTURER,n[Conviva.Constants.DeviceMetadata.MODEL]=e.MODEL,n[Conviva.Constants.DeviceMetadata.TYPE]=Conviva.Constants.DeviceType.DESKTOP,n[Conviva.Constants.DeviceMetadata.OS_NAME]=e.OS_NAME,n[Conviva.Constants.DeviceMetadata.OS_VERSION]=e.OS_VERSION,n[Conviva.Constants.DeviceMetadata.CATEGORY]=Conviva.Constants.DeviceCategory.WEB,n},this.getConvivaCallbackFunctions=function(){var t={};return t[Conviva.Constants.CallbackFunctions.CONSOLE_LOG]=function(t,e){"undefined"!=typeof console&&(console.log&&e===Conviva.SystemSettings.LogLevel.DEBUG||e===Conviva.SystemSettings.LogLevel.INFO?console.log(t):console.warn&&e===Conviva.SystemSettings.LogLevel.WARNING?console.warn(t):console.error&&e===Conviva.SystemSettings.LogLevel.ERROR&&console.error(t))},t[Conviva.Constants.CallbackFunctions.MAKE_REQUEST]=function(t,e,n,i,o,a){var r=new XMLHttpRequest;r.open(t,e,!0),i&&r.overrideMimeType&&(r.overrideMimeType=i),i&&r.setRequestHeader&&r.setRequestHeader("Content-Type",i),o>0&&(r.timeout=o,r.ontimeout=function(){r.ontimeout=r.onreadystatechange=null,a&&a(!1,"timeout after "+o+" ms")}),r.onreadystatechange=function(){4===r.readyState&&(r.ontimeout=r.onreadystatechange=null,200==r.status?a&&a(!0,r.responseText):a&&a(!1,"http status "+r.status))},r.send(n)},t[Conviva.Constants.CallbackFunctions.SAVE_DATA]=function(t,e,n,i){var o=t+"."+e;try{localStorage.setItem(o,n),i(!0,null)}catch(t){i(!1,t.toString())}},t[Conviva.Constants.CallbackFunctions.LOAD_DATA]=function(t,e,n){var i=t+"."+e;try{n(!0,localStorage.getItem(i))}catch(t){n(!1,t.toString())}},t[Conviva.Constants.CallbackFunctions.GET_EPOCH_TIME_IN_MS]=function(){return(new Date).getTime()},t[Conviva.Constants.CallbackFunctions.CREATE_TIMER]=function(t,e){var n=setInterval(t,e);return function(){-1!==n&&(clearInterval(n),n=-1)}},t},this.registerPlayerListeners=function(){o("<<++registerPlayerListeners - "+t.mediainfo.name,i),this.videoPlayer.on("pause",this.onPause.bind(this)),this.videoPlayer.on("playing",this.onPlaying.bind(this)),this.videoPlayer.on("play",this.onPlay.bind(this)),this.videoPlayer.on("loop",this.monitoringSessionInit.bind(this)),this.videoPlayer.on("waiting",this.onWaiting.bind(this)),this.videoPlayer.on("timeupdate",this.onTimeUpdate.bind(this)),this.videoPlayer.on("error",this.onError.bind(this)),this.videoPlayer.on("loadedmetadata",this.onLoadedMetadata.bind(this)),this.videoPlayer.on("seeking",this.onSeeking.bind(this)),this.videoPlayer.on("seeked",this.onSeeked.bind(this)),this.videoPlayer.on("ended",this.onEnded.bind(this)),this.videoPlayer.on("abort",this.onEnded.bind(this)),this.videoPlayer.on("dispose",this.onDispose.bind(this)),this.videoPlayer.on("stopcompleted",this.onEnded.bind(this)),this.videoPlayer.on("ima3-ads-manager-loaded",this.adsManagerLoaded.bind(this)),this.videoPlayer.on("ima3-ad-error",this.onAdsLoaderError.bind(this))},this.destroy=function(){o("<<++*******************destroy - "+t.mediainfo.name,i),r&&r.release(),l&&l.release(),this.adsManager&&this.adsManager.destroy(),this.videoPlayer.off("pause",this.onPause),this.videoPlayer.off("playing",this.onPlaying),this.videoPlayer.off("play",this.onPlay),this.videoPlayer.off("loop",this.monitoringSessionInit),this.videoPlayer.off("waiting",this.onWaiting),this.videoPlayer.off("timeupdate",this.onTimeUpdate),this.videoPlayer.off("error",this.onError),this.videoPlayer.off("loadedmetadata",this.onLoadedMetadata),this.videoPlayer.off("seeking",this.onSeeking),this.videoPlayer.off("seeked",this.onSeeked),this.videoPlayer.off("ended",this.onEnded),this.videoPlayer.off("stopcompleted",this.onEnded),this.videoPlayer.off("dispose",this.onDispose.bind(this)),this.videoPlayer.off("ima3-ads-manager-loaded",this.adsManagerLoaded),this.videoPlayer.off("ima3-ad-error",this.onAdsLoaderError),this.currentPodIndex=0},this.ConvivaAdsAnalyticsInit=function(){o("<<++ConvivaAdsAnalyticsInit - "+t.mediainfo.name,i),l=Conviva.Analytics.buildAdAnalytics(r);var e={};e[Conviva.Constants.FRAMEWORK_NAME]="Google IMA SDK",e[Conviva.Constants.FRAMEWORK_VERSION]=""+google.ima.VERSION,l.setAdPlayerInfo(e)},this.registerAdsManagerListeners=function(){o("<<++registerAdsManagerListeners - "+t.mediainfo.name,i),this.adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdsManagerError,!1,this);var e=[google.ima.AdEvent.Type.AD_BREAK_READY,google.ima.AdEvent.Type.AD_CAN_PLAY,google.ima.AdEvent.Type.AD_METADATA,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,google.ima.AdEvent.Type.CLICK,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,google.ima.AdEvent.Type.DURATION_CHANGE,google.ima.AdEvent.Type.EXPANDED_CHANGED,google.ima.AdEvent.Type.FIRST_QUARTILE,google.ima.AdEvent.Type.IMPRESSION,google.ima.AdEvent.Type.INTERACTION,google.ima.AdEvent.Type.LINEAR_CHANGED,google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.LOG,google.ima.AdEvent.Type.MIDPOINT,google.ima.AdEvent.Type.PAUSED,google.ima.AdEvent.Type.RESUMED,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,google.ima.AdEvent.Type.SKIPPED,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.THIRD_QUARTILE,google.ima.AdEvent.Type.USER_CLOSE,google.ima.AdEvent.Type.VIEWABLE_IMPRESSION,google.ima.AdEvent.Type.VOLUME_CHANGED,google.ima.AdEvent.Type.VOLUME_MUTED,google.ima.AdError.Type.AD_LOAD,google.ima.AdError.Type.AD_PLAY,google.ima.AdEvent.Type.AD_BUFFERING,google.ima.AdEvent.Type.AD_PROGRESS];for(var n in e)this.adsManager.addEventListener(e[n],this.onAdEvent,!1,this)},this.onLoadedMetadata=function(){if(o("<<++onLoadedMetadata - "+t.mediainfo.name,i),null!=r){var e=this.videoPlayer.mediainfo.duration;if(!isNaN(e)&&e!=1/0){var n={};n[Conviva.Constants.DURATION]=parseInt(e,10),r.setContentInfo(n)}var a=this.videoPlayer.tech(!0).vhs.playlists.media().attributes;r.reportPlaybackMetric(Conviva.Constants.Playback.RESOLUTION,a.RESOLUTION.width,a.RESOLUTION.height),r.reportPlaybackMetric(Conviva.Constants.Playback.BITRATE,a.BANDWIDTH/1024),r.reportPlaybackMetric(Conviva.Constants.Playback.RENDERED_FRAMERATE,a["FRAME-RATE"])}},this.monitoringSessionInit=function(){if(o("<<++monitoringSessionInit - "+t.mediainfo.name,i),null==r){var e={};e[Conviva.Constants.ASSET_NAME]="["+this.contentMetadata.assetID+"] "+this.contentMetadata.title,e[Conviva.Constants.STREAM_URL]=this.contentMetadata.url,e[Conviva.Constants.IS_LIVE]="true"==this.contentMetadata.live?Conviva.Constants.StreamType.LIVE:Conviva.Constants.StreamType.VOD,e[Conviva.Constants.PLAYER_NAME]=this.contentMetadata.playerName,e[Conviva.Constants.VIEWER_ID]=this.contentMetadata.adobeViewerID,e[Conviva.Constants.DURATION]=this.contentMetadata.durationSec,e[Conviva.Constants.DEFAULT_RESOURCE]="Akamai",e[Conviva.Constants.APPLICATION_VERSION]=_satellite.getVar("publish_ver")||"Launch PublishDate:2999-12-31 | sCode version:2.1.0",Object.assign(e,this.contentMetadata),r=Conviva.Analytics.buildVideoAnalytics(),window.convivaVideoAnalytics=r;var n={};n[Conviva.Constants.FRAMEWORK_NAME]="Brightcove Media Player",n[Conviva.Constants.FRAMEWORK_VERSION]=bc.VERSION,r.setPlayerInfo(n),r.reportPlaybackRequested(e),r.setCallback((function(){null!=r&&a.videoPlayer&&(r.reportPlaybackMetric(Conviva.Constants.Playback.PLAY_HEAD_TIME,a.videoPlayer.currentTime()/1e3),r.reportPlaybackMetric(Conviva.Constants.Playback.BUFFER_LENGTH,a.videoPlayer.buffered().length))})),this.contentPlaybackEnded=!1}},this.onPlay=function(){o("<<++onPlay - "+t.mediainfo.name,i),this.monitoringSessionInit(),this.contentPlaybackEnded&&(this.podIndex=1,this.podPosition=null,r&&r.release(),l&&l.release(),this.adsManager&&this.adsManager.destroy(),this.currentPodIndex=0)},this.onPlaying=function(){o("<<++onPlaying - "+t.mediainfo.name,i),null!=r&&r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PLAYING)},this.onPause=function(){o("<<++onPause - "+t.mediainfo.name,i),null!=r&&r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PAUSED)},this.onEmptied=function(){o("<<++onEmptied - "+t.mediainfo.name,i),null!=r&&r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.BUFFERING)},this.onWaiting=function(){o("<<++onWaiting - "+t.mediainfo.name,i),null!=r&&r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.BUFFERING)},this.onTimeUpdate=function(){if(t.currentTime()%5<=.25&&o("<<++onTimeUpdate - "+t.currentTime(),i),null!=r){var e=this.videoPlayer.tech(!0).vhs.playlists.media().attributes;r.reportPlaybackMetric(Conviva.Constants.Playback.RESOLUTION,e.RESOLUTION.width,e.RESOLUTION.height),r.reportPlaybackMetric(Conviva.Constants.Playback.BITRATE,e.BANDWIDTH/1024)}},this.onSeeking=function(){o("<<++onSeeking - "+t.mediainfo.name,i),null!=r&&r.reportPlaybackMetric(Conviva.Constants.Playback.SEEK_STARTED)},this.onSeeked=function(){o("<<++onSeeked - "+t.mediainfo.name,i),null!=r&&r.reportPlaybackMetric(Conviva.Constants.Playback.SEEK_ENDED)},this.onError=function(){o("<<++onError - "+t.mediainfo.name,i),null!=r?r.reportPlaybackFailed("Fatal error occured"):(r=Conviva.Analytics.buildVideoAnalytics()).reportPlaybackFailed("Fatal error occured"),r.release(),r=null,Conviva.Analytics.release(),this.contentPlaybackEnded=!0},this.onEnded=function(){o("<<++onEnded - "+t.mediainfo.name,i);try{null!=r&&(r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),r.reportPlaybackEnded(),r.release(),r=null,Conviva.Analytics.release(),this.destroy()),this.contentPlaybackEnded=!0}catch(t){o("<<++onEnded1 - "+t,i)}try{null!=r&&(r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),r.reportPlaybackEnded(),r.release(),r=null,Conviva.Analytics.release(),this.destroy()),this.contentPlaybackEnded=!0}catch(t){o("<<++onEnded2 - "+t,i)}},this.onDispose=function(){o("<<++onDispose - "+t.mediainfo.name,i);try{null!=r&&(r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),r.reportPlaybackEnded(),r.release(),r=null,Conviva.Analytics.release(),this.destroy()),this.contentPlaybackEnded=!0}catch(t){o("<<++onDispose - "+t,i)}try{null!=r&&(r.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),r.reportPlaybackEnded(),r.release(),r=null,Conviva.Analytics.release(),this.destroy()),this.contentPlaybackEnded=!0}catch(t){o("<<++onDispose - "+t,i)}},this.adsManagerLoaded=function(e){o("<<++adsManagerLoaded - "+t.mediainfo.name,i),this.adsManager=e.originalEvent.getAdsManager(),this.registerAdsManagerListeners()},this.onContentPauseRequested=function(e){if(o("<<++onContentPauseRequested - "+t.mediainfo.name,i),this.allAdsCompleted=!1,this.contentPauseRequested=!0,null!=r)if(this.currentPodIndex=e.getAd().getAdPodInfo().getPodIndex(),this.isAdBreakEnabled){this.podDuration=e.getAd().getDuration();var n=e.ad.getAdPodInfo().getPodIndex(),a=e.getAd().getAdPodInfo().getTotalAds();o("********Mid-roll = "+n+"  ***********adsPodTotal = "+a,i),0===this.currentPodIndex?this.podPosition="Pre-roll":-1===this.currentPodIndex?this.podPosition="Post-roll":(this.podPosition="Mid-roll "+n,this.podDuration=e.getAd().getDuration()*a);var s={};s[Conviva.Constants.POD_POSITION]=this.podPosition,s[Conviva.Constants.POD_DURATION]=this.podDuration,s[Conviva.Constants.POD_INDEX]=this.podIndex,r.reportAdBreakStarted(Conviva.Constants.AdType.CLIENT_SIDE,Conviva.Constants.AdPlayer.CONTENT,s)}else r.reportAdBreakStarted(Conviva.Constants.AdType.CLIENT_SIDE,Conviva.Constants.AdPlayer.CONTENT)},this.onContentResumeRequested=function(e){o("<<++onContentResumeRequested - "+t.mediainfo.name,i),this.allAdsCompleted=!1,null!=r&&(this.contentPauseRequested&&(this.isAdBreakEnabled?(r.reportAdBreakEnded(),this.podIndex++,this.podPosition=null):r.reportAdBreakEnded()),-1==this.currentPodIndex&&(r.reportPlaybackEnded(),r.release(),r=null,Conviva.Analytics.release(),this.contentPlaybackEnded=!0)),this.contentPauseRequested=!1},this.onAdEvent=function(e){o("<<++onAdEvent - "+t.mediainfo.name,i),o("Conviva captured event ---- +++ **** "+e.type,i),e.type==google.ima.AdEvent.Type.STARTED&&!0===e.getAd().isLinear()?this.onAdStart(e):e.type==google.ima.AdEvent.Type.RESUMED&&!0===e.getAd().isLinear()?null!=l&&l.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PLAYING):e.type==google.ima.AdEvent.Type.PAUSED&&!0===e.getAd().isLinear()?null!=l&&l.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PAUSED):e.type==google.ima.AdEvent.Type.COMPLETE&&!0===e.getAd().isLinear()?null!=l&&(l.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),l.reportAdEnded(),l.release(),l=null):e.type==google.ima.AdEvent.Type.SKIPPED&&!0===e.getAd().isLinear()?null!=l&&(l.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),l.reportAdSkipped(),l.release(),l=null):e.type==google.ima.AdEvent.Type.ALL_ADS_COMPLETED?(this.allAdsCompleted=!0,this.contentPlaybackEnded&&null!=r&&(r.reportPlaybackEnded(),r.release(),r=null,Conviva.Analytics.release())):e.type==google.ima.AdEvent.Type.LOG?this.onAdLogError(e):e.type==google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED?this.onContentPauseRequested(e):e.type==google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED?this.onContentResumeRequested(e):e.type==google.ima.AdEvent.Type.AD_BUFFERING?null!=l&&l.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.BUFFERING):e.type==google.ima.AdEvent.Type.AD_PROGRESS&&null!=l&&l.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PLAYING)},this.onAdStart=function(e){if(o("<<++onAdStart - "+t.mediainfo.name,i),null==l&&null!=r){l=Conviva.Analytics.buildAdAnalytics(r);var n={};n[Conviva.Constants.FRAMEWORK_NAME]="Google IMA SDK",n[Conviva.Constants.FRAMEWORK_VERSION]=""+google.ima.VERSION,l.setAdPlayerInfo(n)}if(null!=l){var a=this.getConvivaAdMetadata(e.getAd());l.reportAdStarted(a);var s=this.videoPlayer.tech(!0).vhs.playlists.media().attributes;l.reportAdMetric(Conviva.Constants.Playback.RESOLUTION,s.RESOLUTION.width,s.RESOLUTION.height),l.reportAdMetric(Conviva.Constants.Playback.BITRATE,s.BANDWIDTH/1024),l.reportAdMetric(Conviva.Constants.Playback.RENDERED_FRAMERATE,s["FRAME-RATE"])}},this.onAdsLoaderError=function(e){o("<<++onAdsLoaderError - "+t.mediainfo.name,i),this.reportAdFailed(e,"Ads Loader Error")},this.onAdsManagerError=function(e){o("<<++onAdsManagerError - "+t.mediainfo.name,i),o("Conviva captured Error ---- +++ **** "+e.type,i);var n=e.getError();this.handleAdError(n)},this.onAdLogError=function(e){o("<<++onAdLogError - "+t.mediainfo.name,i);var n=e.getAdData().adError;o("Conviva captured Error Type ---- +++ **** "+n.getType(),i),o("Conviva captured Error Code ---- +++ **** "+n.getErrorCode(),i),o("Conviva captured Error Message ---- +++ **** "+n.getMessage(),i)},this.getConvivaAdMetadata=function(e){o("<<++getConvivaAdMetadata - "+t.mediainfo.name,i);var a,r,l,u,c={};if(c[Conviva.Constants.ASSET_NAME]=e.getTitle(),c[Conviva.Constants.STREAM_URL]=e.getMediaUrl(),c[Conviva.Constants.PLAYER_NAME]=n.playerName,c[Conviva.Constants.VIEWER_ID]=n.adobeViewerID,c[Conviva.Constants.DURATION]=e.getDuration(),c[Conviva.Constants.IS_LIVE]=Conviva.Constants.StreamType.VOD,c[Conviva.Constants.ENCODED_FRAMERATE]=30,c[Conviva.Constants.DEFAULT_RESOURCE]="Akamai",c.adBitRate=""+e.getVastMediaBitrate(),e.getWrapperAdIds()&&0!==e.getWrapperAdIds().length){var h=e.getWrapperAdIds().length;a=e.getWrapperAdSystems()[h-1],r=e.getWrapperAdIds()[h-1],l=e.getWrapperCreativeIds()[h-1]}else a=e.getAdSystem(),r=e.getAdId(),l=e.getCreativeId();var f=e.getAdPodInfo().getPodIndex(),d=e.getAdPodInfo().getAdPosition();return o("********Mid-roll = "+f+"  ***********AdPosition = "+e.getAdPodInfo().getAdPosition(),i),0===f?u="Pre-roll":-1===f?u="Post-roll":(u="Mid-roll "+f,"undefined"!=typeof s&&(o("midrolll ********  M"+f+"S"+d,i),s.contextData.tmAdReq="",s.contextData.tmAdPlay="",s.contextData.tmAFLW="",s.contextData.tmIsCC="",s.contextData.tmMidroll="M"+f+"S"+d,s.Media.track(this.contentMetadata.live?t.mediainfo.name:"Live:"+t.mediainfo.name,t.currentTime()),s.Media.play(this.contentMetadata.live?t.mediainfo.name:"Live:"+t.mediainfo.name,t.currentTime()))),c["c3.ad.id"]=""+e.getAdId(),c["c3.ad.creativeId"]=""+e.getCreativeId(),c["c3.ad.technology"]="Client Side",c["c3.ad.system"]=""+e.getAdSystem(),c.adSequence=""+e.getAdPodInfo().getAdPosition(),c["c3.ad.mediaFileApiFramework"]=""+e.getApiFramework()==null?"NA":e.getApiFramework(),c["c3.ad.advertiser"]=""+e.getAdvertiserName(),c["c3.ad.position"]=u,c["c3.ad.adManagerName"]="Google IMA SDK",c["c3.ad.adManagerVersion"]=""+google.ima.VERSION,c["c3.ad.firstAdSystem"]=""+a,c["c3.ad.firstAdId"]=""+r,c["c3.ad.firstCreativeId"]=""+l,c},this.handleAdError=function(e){if(o("<<++handleAdError - "+t.mediainfo.name,i),e)switch(e.getType()){case google.ima.AdError.Type.AD_PLAY:this.handleAdPlayError(e);break;case google.ima.AdError.Type.AD_LOAD:this.handleAdLoadError(e)}},this.handleAdPlayError=function(e){o("<<++handleAdPlayError - "+t.mediainfo.name,i),this.reportAdFailed(e,"Ad Play Error")},this.handleAdLoadError=function(e){o("<<++handleAdLoadError - "+t.mediainfo.name,i),this.reportAdFailed(e,"Ad Load Error")},this.reportAdFailed=function(e,n){o("<<++reportAdFailed - "+t.mediainfo.name,i),e.getError&&"function"==typeof e.getError&&(e.getError().getType&&"function"==typeof e.getError().getType&&e.getError().getType()&&(errorMessage="Type: "+e.getError().getType()),e.getError().getType&&"function"==typeof e.getError().getErrorCode&&e.getError().getErrorCode()&&(null==errorMessage?errorMessage="Code: "+e.getError().getErrorCode():errorMessage+=", Code: "+e.getError().getErrorCode()),e.getError().getType&&"function"==typeof e.getError().getMessage&&e.getError().getMessage()&&(null==errorMessage?errorMessage="Message: "+e.getError().getMessage():errorMessage+=", Message: "+e.getError().getMessage())),null==errorMessage&&(errorMessage="Ad Request Failed");var a={};if(a[Conviva.Constants.ASSET_NAME]=n,a[Conviva.Constants.IS_LIVE]=Conviva.Constants.StreamType.VOD,a.applicationName=this.contentMetadata.applicationName,a[Conviva.Constants.PLAYER_NAME]=this.contentMetadata.playerName,a.viewerId=this.contentMetadata.adobeViewerID,a["c3.ad.technology"]="Client Side",a["c3.ad.adManagerName"]="Google IMA SDK",a["c3.ad.adManagerVersion"]=""+google.ima.VERSION,null==l){l=Conviva.Analytics.buildAdAnalytics(r);var s={};s[Conviva.Constants.FRAMEWORK_NAME]="Google IMA SDK",s[Conviva.Constants.FRAMEWORK_VERSION]=""+google.ima.VERSION,l.setAdPlayerInfo(s)}l.reportAdFailed(errorMessage,a),null!=l&&(l.release(),l=null)},this.adsManager=null,this.podIndex=1,this.podPosition=null,this.initConvivaClient(),this.registerPlayerListeners(),this.currentPodIndex=0};

           //plugin
           videojs.registerPlugin('AdobeConviva', function(options) {
            function log(m, p) {
                if (!p) {
                    console.log(m)
                }
            }
     
            var prod = true; 
            var adobe = true; 
            if (!options) {
                console.log("Options has not been added, please add the options on video cloud")
            } else {
                prod = (window.localStorage.getItem("sdsat_debug") == null || window.localStorage.getItem("sdsat_debug") == 'false');
                adobe = options["adobe"];
            }

            var myPlayer = this;
            var isContentLoaded = false;
            var videoDuration;
            var mediaName;
            var adobeMediaName;            
            var mediaPlayerName = getHostName();
            var currentTime;
            var isPlaying = false;
            var videoEnd = false;
            var bitRate = 0;
            var isLive = false;

            var metadata = {};
            var firstPlay = false;
            var tmAdReq = false;
            var tmAdPlay = false;
            var tmAdBeacon = false;
            var tmCC = false;
            var tmAFLW = false;
            
            var integration, convivaIntegration;
            //Setting Up Conviva Configs default as test

            var TEST_CUSTOMER_KEY = options.testing.customerKey; //'69b93c2f8bf26c0edf513501a13f4da18556fb68';
            var TOUCHSTONE_SERVICE_URL = options.testing.gatewayUrl; //'https://telstra-afl.testonly.conviva.com';

            var convivaConfigs = {};
            convivaConfigs[Conviva.Constants.GATEWAY_URL] = TOUCHSTONE_SERVICE_URL;
            convivaConfigs[Conviva.Constants.LOG_LEVEL] = Conviva.Constants.LogLevel.ERROR;
            convivaConfigs[Conviva.Constants.CUSTOMER_KEY] = TEST_CUSTOMER_KEY;
            
            switch (prod)
            {
                case true:
                    
                    convivaConfigs[Conviva.Constants.GATEWAY_URL] = options.production.gatewayUrl;
                    convivaConfigs[Conviva.Constants.LOG_LEVEL] = Conviva.Constants.LogLevel.ERROR;
                    convivaConfigs[Conviva.Constants.CUSTOMER_KEY] = options.production.customerKey;
                break;    
                case false:
                    convivaConfigs[Conviva.Constants.GATEWAY_URL] = options.testing.gatewayUrl;
                    convivaConfigs[Conviva.Constants.LOG_LEVEL] = Conviva.Constants.LogLevel.DEBUG;
                    convivaConfigs[Conviva.Constants.CUSTOMER_KEY] = options.testing.customerKey;
       
                break;    
            }
            
            var viewerID = "random:" + Math.random() * 1e9;

            if (adobe) {
                viewerID = s.visitor.getMarketingCloudVisitorID();
            }

            function ABDMediaOPEN() {
                log("++ IN ABDMediaOPEN TOP ++", prod);

                //Check the metadata is loaded
                if (isContentLoaded) {
                    log("++ IN ABDMediaOPEN content loaded ++", prod);
                    //Get all required metadata
                    currentTime = myPlayer.currentTime();
                    mediaName = myPlayer.mediainfo.name;
                    videoDuration = myPlayer.mediainfo.duration;

                    buildMetadata();

                    //Open adobe Analytics Media Module	

                    adobe && s.Media.open(adobeMediaName, videoDuration, mediaPlayerName);

                    //Check if video is playing
                    //if (isPlaying) {
                    //    log("++IN ABDMediaOPEN video is playing " + mediaName + " | " + videoDuration, prod);
                    //Play Adobe Analytics Media module from beginning.
                    //    adobe && s.Media.play(adobeMediaName, currentTime);
                    // }
                }
            }

                        
            //Used to reset the variables as when the next videos play, the play event is called before loadstart ...
            function resetVariables() {
                isContentLoaded = false;
                videoDuration = currentTime = "";
                videoEnd = true;
                bitRate = 0;
                tmAdBeacon=false;
                tmCC = false;
                isLive=false;
                adobeMediaName="";
                tmAFLW=false;
            }
            //Used to build metadata 
            function buildMetadata() {
                     metadata = {};
            
                    metadata["id"] = myPlayer.mediainfo.id;
                    metadata["title"] = myPlayer.mediainfo.name;;
                    metadata["url"] = myPlayer.mediainfo.sources[0].src;
                    metadata["live"] = myPlayer.mediainfo.duration == 0 ? "true" : "false";
                    metadata["durationSec"] = ""+myPlayer.mediainfo.duration;
                    metadata["streamType"] = myPlayer.mediainfo.sources[0].type;
                    metadata["applicationName"] = getPlayerName();
                    isLive = myPlayer.mediainfo.duration == 0 ? true : false;
                    adobeMediaName = isLive ? "Live:"+myPlayer.mediainfo.name : myPlayer.mediainfo.name;
                    tmAFLW = /^aflw/i.test(myPlayer.mediainfo.custom_fields.competition); //check is aflw or afl    
            
                    //when live streaming append the matchname from the datalayer // may need to be fixed up
                    if (getSafe(()=>dataLayer.filter(function(obj) {
                        return obj.event === 'matchView'
                    })[0].matchName, false)) {
                        metadata["title"] = mediaName + " - " + dataLayer.filter(function(obj) {
                            return obj.event === 'matchView'
                        })[0].matchName;
                    }
            
                    //when unily grab the page title as well
                    var top_url = top_url = (window.location != window.parent.location) ? document.referrer != "" ? document.referrer : document.location.href : document.location.href;
                    var t_test = new URL(top_url);
            
                    if (/telstra\.unily\.com/.test(top_url) && t_test.pathname.length > 0) {
                        metadata["title"] = mediaName + " [" + t_test.pathname + "]";
                    }
            
                    //custom 
                    metadata["assetID"] = myPlayer.mediainfo.id;
                    metadata["channel"] = getHostName();
                    metadata["playerName"] = getPlayerName();
            
                    metadata["adobeViewerID"] = viewerID;
            
                    //createConvivaSession
                    userData = {}
                    userData["viewerID"] = viewerID;
                    userData["hostname"] = getHostName();
            
                    //add all custom fields 
                    Object.assign(metadata, myPlayer.mediainfo.customFields);
                    Object.assign(metadata, userData);
            
                    log(JSON.stringify(metadata), prod)
            }


           myPlayer.on('ima3-ads-manager-loaded', function(event) {
              log("++ima3-ads-manager-loaded", prod); 
              //myPlayer.ima3.toggleLogger(!prod);
                           
            });
                        
            myPlayer.on('loadstart', function() {
                log("++loadstart * update *  " + myPlayer.mediainfo.name, prod);
                //if(!prod)myPlayer.ima3.settings.serverUrl = 'https://pubads.g.doubleclick.net/gampad/ads?iu=/21775744923/external/vmap_ad_samples&sz=640x480&cust_params=sample_ar%3Dpremidpostoptimizedpod&ciu_szs=300x250&gdfp_req=1&ad_rule=1&output=vmap&unviewed_position_start=1&env=vp&impl=s&cmsid=496&vid=short_onecue&correlator=';        
                //if(!prod)myPlayer.ima3.settings.serverUrl = 'https://pubads.g.doubleclick.net/gampad/ads?iu=/7414/TEL.AFL/cx-on-stream&sz=640x480&vid_d=600&allcues=60000,90000,110000&cust_params=po%3D0000501303&keyword%3DxAFLTestingx&ciu_szs=300x250&gdfp_req=1&ad_rule=1&output=vmap&unviewed_position_start=1&env=vp&impl=s&cmsid=496&vid=short_onecue&correlator=';        
                //if(!prod)myPlayer.ima3.settings.serverUrl = 'https://kamalsingh2024.github.io/adobelaunch/Pre-roll.xml?sz=640x480&iu=/7414/TEL.AFL/cx-on-stream&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&description_url=[description_url]&correlator=[timestamp]&ad_rule=1&cmsid=2513968&vid=[mediainfo.id]';
                buildMetadata();

                //kill all old sessions                
                if (integration) {
                   //integration.ConvivaIma3Integration(myPlayer,convivaConfigs,metadata);
                integration = null;
                }
                //start new sessions
                   integration = new ConvivaIma3Integration(myPlayer,convivaConfigs,metadata );
                            
                firstPlay = true;
                //Check that metadata is loaded
                if (myPlayer.mediainfo.name) {
                    isContentLoaded = true;
                    //Initiate Adobe Analytics Media Module tracking && Conviva Analytics
                }
            });

            myPlayer.on('ads-request', function() {
                log("++ads-ad-request - " + myPlayer.mediainfo.name, prod);
                tmAdReq = true;
            });

            myPlayer.on('ads-ad-ended', function() {
                log("++ads-ad-ended - " + myPlayer.mediainfo.name, prod);
                tmAdPlay = true;
            });

            myPlayer.on('play', function() {
                log("++play - " + myPlayer.mediainfo.name, prod);
                isPlaying = true;
                if (firstPlay) {
                    log("++ First Play via played - *****Video Start**** - " + myPlayer.mediainfo.name, prod);
                    firstPlay = false;
                    isContentLoaded = true;
                    ABDMediaOPEN();
                    //integration = new NewConvivaIntegration(myPlayer, convivaConfigs, metadata);
                    //convivaHelper.createConvivaSession(userData, metadata);
                    //convivaHelper.attachPlayerToSession();


                }

                if (videoEnd) {
                    //user has restarted video from end 
                    videoEnd = false;
                    isContentLoaded = false;
                    ABDMediaOPEN();
                    
                }

                //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                if (isContentLoaded) {
                    currentTime = myPlayer.currentTime();
                    //Play Adobe Analytics Media module from the current head.
                    if (adobe && currentTime != 0 ) { //resume from pause
                        s.eVar63 = adobeMediaName;
                        s.Media.play(adobeMediaName, currentTime);

                    }

                }
            });

            myPlayer.on("playing", function() {
                log("++ In Playing ++", prod)

                //convivaHelper.setPlayerWidthAndHeight(myPlayer.videoWidth(), myPlayer.videoHeight());
                //convivaHelper.updatePlayerState("playing");
                            
            });

            myPlayer.on('pause', function() {
                isPlaying = false;
                log("++paused - " + myPlayer.mediainfo.name, prod);
                //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                if (isContentLoaded) {
                    currentTime = myPlayer.currentTime();
                    //Play Adobe Analytics Media module from the current head.
                    adobe && s.Media.stop(adobeMediaName, currentTime);
                    //convivaHelper.updatePlayerState("pause");
                }
            });

            myPlayer.on('progress', function() {
                log("progressed - " + myPlayer.mediainfo.name, prod);

            });

            myPlayer.on('resize', function() {
                log("resized - " + myPlayer.mediainfo.name, prod);
            });

            myPlayer.on('seeked', function() {
                log("++seeked - " + myPlayer.mediainfo.name, prod);
                //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                if (isContentLoaded) {
                    currentTime = myPlayer.currentTime();
                    //Play Adobe Analytics Media module from the current head.
                    adobe && s.Media.play(adobeMediaName, currentTime);
                    //convivaHelper.contentSeeked();
                }
            });

            myPlayer.on('seeking', function() {
                log("++seeking - " + myPlayer.mediainfo.name, prod);
                //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                if (isContentLoaded) {
                    currentTime = myPlayer.currentTime();
                    //Play Adobe Analytics Media module from the current head.
                    adobe && s.Media.stop(adobeMediaName, currentTime);
                }
            });

            myPlayer.on('stalled', function() {
                log("++stalled - " + myPlayer.mediainfo.name, prod);
                //Check if metadata loaded - needed to make sure correct video media module instance is tracked.

            });

            myPlayer.on('timeupdate', function() {
                
                currentTime = myPlayer.currentTime();
                if(myPlayer.currentTime() % 5 <= 0.25)log("++timeupdate - " + currentTime, prod);

                // adobe keep alive if video is live
                if(adobe && isLive && currentTime != 0 &&  currentTime % 300 <= 0.25 ){
                   log("++timeupdate - keep alive beacon " + currentTime, prod);
                        s.Media.track(adobeMediaName, currentTime);
                        s.Media.play(adobeMediaName, currentTime);

                    }

                if (adobe && isPlaying && !tmAdBeacon && currentTime > 0) {

                    //s.Media.trackVars+= ",contextData.tmAdReq,contextData.tmAdPlay"
                    tmAdReq ? s.contextData['tmAdReq'] = "yes" : s.contextData['tmAdReq'] = "no";
                    tmAdPlay ? s.contextData['tmAdPlay'] = "yes" : s.contextData['tmAdPlay'] = "no";
                    tmAFLW ? s.contextData['tmAFLW'] = "yes" : s.contextData['tmAFLW'] = "no"; 
                    s.contextData['tmIsCC'] = "";

                    //s.tl();
                    tmAdBeacon = true;
                    log("++ In timeupdate and adreq adplay update ++ " + mediaName + " | " + videoDuration, prod);
                    //Play Adobe Analytics Media module from beginning.
                    s.Media.play(adobeMediaName, currentTime);
                }

                if(adobe && isPlaying && !tmCC && currentTime > 0 ) {

                 var tracks = myPlayer.textTracks();
            
                 for (var i = 0; i < tracks.length; i++) {
                 var track = tracks[i];
            
                 // Find the English captions track and mark it as "showing".
                 if (track.kind === 'captions' && track.mode === 'showing') {
                     //track.mode = 'showing';
                     s.contextData['tmAdReq'] = "";
                     s.contextData['tmAdPlay'] = "";
                     s.contextData['tmAFLW'] = "";
                     s.contextData['tmMidroll']= "";
                                 
                     s.contextData['tmIsCC'] = "yes";
                     log("++ In timeupdate and CC turned on by user ++ " + mediaName + " | " + videoDuration, prod);
                     tmCC = true;
                      //send info to adobe 
                      s.Media.track(adobeMediaName, currentTime);
                      s.Media.play(adobeMediaName, currentTime);
                   }
                  }
                }

            });

            myPlayer.on('volumechange', function() {
                log("++volumechange - " + myPlayer.mediainfo.name, prod);
            });

            myPlayer.on('waiting', function() {
                log("++waiting - " + myPlayer.mediainfo.name, prod);
                if (isContentLoaded) {//convivaHelper.updatePlayerState("waiting");
                }
            });

            myPlayer.on('durationchange', function() {
                log("++durationchange - " + myPlayer.mediainfo.name, prod);
                 myPlayer.mediainfo.duration > myPlayer.duration() ? myPlayer.mediainfo.duration = myPlayer.mediainfo.duration : myPlayer.mediainfo.duration = myPlayer.duration()
            });

            myPlayer.on('ended', function() {
                log("++ended - " + myPlayer.mediainfo.name, prod);
                //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                if (isContentLoaded) {
                    currentTime = myPlayer.currentTime();
                    //Play Adobe Analytics Media module from the current head.
                    adobe && s.Media.stop(adobeMediaName, currentTime);
                    adobe && s.Media.close(adobeMediaName);
                    //convivaHelper.updatePlayerState("ended");
                    //convivaHelper.cleanupConvivaSession();
                    resetVariables();
                }
            });
                        
            myPlayer.on('abort', function() {
                log("++abort - " + myPlayer.mediainfo.name, prod);
                //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    currentTime = myPlayer.currentTime();
                    //Play Adobe Analytics Media module from the current head.
                    adobe && s.Media.stop(adobeMediaName, currentTime);
                    adobe && s.Media.close(adobeMediaName);
                    //convivaHelper.updatePlayerState("ended");
                    //convivaHelper.cleanupConvivaSession();
                    resetVariables();
            });                            

            myPlayer.on("bc-catalog-error", function() {
                log("++ In Catalog Error ++", prod);
                var error = myPlayer.error_;
                var code = error.code;
                var message = error.message;
                var type = error.type;
                //convivaHelper.contentReportError(code + ": " + message + " " + type, Conviva.Client.ErrorSeverity.FATAL);
                //convivaHelper.cleanupConvivaSession();
            });

            myPlayer.on("error", function() {
                log("++ In Error ++", prod);
                var error = myPlayer.error_;
                var code = error.code;
                var message = error.message;
                var type = error.type;
                //convivaHelper.contentReportError(code + ": " + message + " " + type, Conviva.Client.ErrorSeverity.FATAL);
                //convivaHelper.cleanupConvivaSession();
            });

            myPlayer.on('fullscreenchange', function() {
                log("++fullscreenchange - " + myPlayer.mediainfo.name, prod);
            });

            myPlayer.on('loadedalldata', function() {
                log("++loadedalldata - " + myPlayer.mediainfo.name, prod);

            });

            myPlayer.on('loadeddata', function() {
                log("++loadeddata ++ " + myPlayer.mediainfo.name, prod);

                //integration.collectContentMetdata();
                //    adobe && s.Media.stop(adobeMediaName, currentTime);
                //    adobe && s.Media.close(adobeMediaName);
            
            
            });

            myPlayer.on('loadedmetadata', function() {
                log("++loadedmetadata - " + myPlayer.mediainfo.name, prod);
                if (myPlayer.mediainfo.name) {
                    isContentLoaded = true;
                    //Initiate Adobe Analytics Media Module tracking && Conviva Analytics
                    //ABDMediaOPEN();
                    //integration = new NewConvivaIntegration(myPlayer,convivaConfigs,metadata);
                }
            });

            function getSafe(fn, defaultVal) {
                try {
                    return fn();
                } catch (e) {
                    return defaultVal;
                }
            }
            function getHostName() {
               var hostname = window.location.hostname.replace(/^(www\.|m\.)/, '');
                if (/^aflw/i.test(location.pathname.split('/')[1])) hostname = 'womens.afl'; //add old womens playername 
                return hostname;
            }   
            function getPlayerName() {
                var hostname = window.location.hostname.replace(/^(www\.|m\.)/, '');
                    if (/^aflw/i.test(location.pathname.split('/')[1])) hostname = 'womens.afl'; //add old womens playername 

                aflSitesArray = new Object();
                aflSitesArray['afl.com.au'] = 'AFL Network';
                aflSitesArray['fantasy.afl.com.au'] = 'AFL Fantasy';
                aflSitesArray['tipping.afl.com.au'] = 'AFL Tipping';
                aflSitesArray['afc.com.au'] = 'Adelaide Crows';
                aflSitesArray['lions.com.au'] = 'Brisbane Lions';
                aflSitesArray['carltonfc.com.au'] = 'Carlton Blues';
                aflSitesArray['collingwoodfc.com.au'] = 'Collingwood Magpies';
                aflSitesArray['essendonfc.com.au'] = 'Essendon Bombers';
                aflSitesArray['fremantlefc.com.au'] = 'Fremantle';
                aflSitesArray['geelongcats.com.au'] = 'Geelong Cats';
                aflSitesArray['goldcoastfc.com.au'] = 'Gold Coast';
                aflSitesArray['gwsgiants.com.au'] = 'GWS';
                aflSitesArray['hawthornfc.com.au'] = 'Hawthorn Hawks';
                aflSitesArray['melbournefc.com.au'] = 'Melbourne Demons';
                aflSitesArray['nmfc.com.au'] = 'Kangaroos';
                aflSitesArray['portadelaidefc.com.au'] = 'Port Adelaide';
                aflSitesArray['richmondfc.com.au'] = 'Richmond Tigers';
                aflSitesArray['saints.com.au'] = 'St.Kilda Saints';
                aflSitesArray['sydneyswans.com.au'] = 'Sydney Swans';
                aflSitesArray['westcoasteagles.com.au'] = 'West Coast Eagles';
                aflSitesArray['westernbulldogs.com.au'] = 'Western Bulldogs';
                aflSitesArray['womens.afl'] = 'AFLW Network';

                return aflSitesArray[hostname] || "AFL test";
            }

        });
