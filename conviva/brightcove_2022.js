/*! (C) 2022 Conviva, Inc. All rights reserved. Confidential and proprietary. */ !function(a,b){"function"==typeof define&&define.amd?define(b):("object"==typeof exports||"object"==typeof module&&module.exports)&&(module.exports=b()),void 0!==a&&a&&(a.Conviva||a.ConvivaLoading||(a.ConvivaLoading=!0,a.Conviva=b(),delete a.ConvivaLoading))}(this,function(){var a,b={};return a={},function(){var c=b.Constants={};c.version="4.5.8",c.CUSTOMER_KEY="customerKey",c.GATEWAY_URL="gatewayUrl",c.LOG_LEVEL="logLevel",c.ASSET_NAME="Conviva.assetName",c.PLAYER_NAME="Conviva.applicationName",c.APPLICATION_VERSION="c3.app.version",c.IS_LIVE="Conviva.streamType",c.ENCODED_FRAMERATE="Conviva.encodedFrameRate",c.DEFAULT_RESOURCE="Conviva.defaultResource",c.STREAM_URL="Conviva.streamUrl",c.VIEWER_ID="Conviva.viewerId",c.DURATION="Conviva.duration",c.UTM_TRACKING_URL="c3.cm.utmTrackingUrl",c.POD_INDEX="podIndex",c.POD_POSITION="podPosition",c.POD_DURATION="podDuration",c.AD_TYPE="adType",c.MODULE_NAME="Conviva.moduleName",c.MODULE_VERSION="Conviva.moduleVersion",c.FRAMEWORK_NAME="Conviva.frameworkName",c.FRAMEWORK_VERSION="Conviva.frameworkVersion",c.i="Constants not yet configured",c.e="Invalid : Did you report playback ended?",c.s="Invalid : Did you report ad playback ended?",c.o="Player cannot be null",c.u="PlaybackAnlytics already built",c.h="PlaybackAnlytics not yet built",c.Playback={BITRATE:"BITRATE",PLAY_HEAD_TIME:"PLAY_HEAD_TIME",RESOLUTION:"RESOLUTION",BUFFER_LENGTH:"BUFFER_LENGTH",PLAYER_STATE:"PLAYER_STATE",RENDERED_FRAMERATE:"RENDERED_FRAMERATE",SEEK_STARTED:"SEEK_STARTED",SEEK_ENDED:"SEEK_ENDED",CDN_IP:"CDN_IP",DROPPED_FRAMES_TOTAL:"DROPPED_FRAMES_TOTAL",DROPPED_FRAMES_COUNT:"DROPPED_FRAMES_COUNT"},c.Network={SIGNAL_STRENGTH:"SIGNAL_STRENGTH",LINK_ENCRYPTION:"LINK_ENCRYPTION",CONNECTION_TYPE:"CONNECTION_TYPE"},c.ErrorSeverity={FATAL:1,WARNING:0},c.NO_SESSION_KEY=-2,c.AdPosition={PREROLL:"Pre-roll",MIDROLL:"Mid-roll",POSTROLL:"Post-roll"},c.AdPlayer={CONTENT:"CONTENT",SEPARATE:"SEPARATE"},c.DeviceType={DESKTOP:"DESKTOP",CONSOLE:"Console",SETTOP:"Settop",MOBILE:"Mobile",TABLET:"Tablet",SMARTTV:"SmartTV"},c.AdType={CLIENT_SIDE:"Client Side",SERVER_SIDE:"Server Side"},c.AdSlates={BLACKOUT_SLATE:"Blackout slate",TECHNICAL_DIFFICULTIES_SLATE:"Technical Difficulties slate",COMMERCIAL_SLATE:"Commercial Break slate",OTHER_SLATE:"Other slate",VPAID:"VPAID",REGULAR:"Regular Ad"},c.AdServingType={INLINE:"Inline",WRAPPER:"Wrapper"},c.DeviceCategory={ANDROID_DEVICE:"AND",APPLE_DEVICE:"APL",CHROMECAST:"CHR",DESKTOP_APP:"DSKAPP",DEVICE_SIMULATOR:"SIMULATOR",LG_TV:"LGTV",NINTENDO:"NINTENDO",PLAYSTATION:"PS",ROKU:"RK",SAMSUNG_TV:"SAMSUNGTV",SMART_TV:"TV",SET_TOP_BOX:"STB",TIVO:"TIVO",WEB:"WEB",WINDOWS_DEVICE:"WIN",XBOX:"XB",KAIOS_DEVICE:"KAIOS"},c.LogLevel={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},c.PlayerState={STOPPED:"STOPPED",PLAYING:"PLAYING",BUFFERING:"BUFFERING",PAUSED:"PAUSED",UNKNOWN:"UNKNOWN",NOT_MONITORED:"NOT_MONITORED"},c.Events={USER_WAIT_STARTED:"Conviva.UserWaitStarted",USER_WAIT_ENDED:"Conviva.UserWaitEnded",BUMPER_VIDEO_STARTED:"Conviva.BumperVideoStarted",BUMPER_VIDEO_ENDED:"Conviva.BumperVideoEnded",AD_REQUESTED:"Conviva.AdRequested",AD_RESPONSE:"Conviva.AdResponse",AD_SLOT_STARTED:"Conviva.SlotStarted",AD_ATTEMPTED:"Conviva.AdAttempted",AD_SLOT_ENDED:"Conviva.SlotEnded",AD_IMPRESSION_START:"Conviva.AdImpression",AD_START:"Conviva.AdStart",AD_FIRST_QUARTILE:"Conviva.AdFirstQuartile",AD_MID_QUARTILE:"Conviva.AdMidQuartile",AD_THIRD_QUARTILE:"Conviva.AdThirdQuartile",AD_COMPLETE:"Conviva.AdComplete",AD_END:"Conviva.AdEnd",AD_IMPRESSION_END:"Conviva.AdImpressionEnd",AD_SKIPPED:"Conviva.AdSkipped",AD_ERROR:"Conviva.AdError",AD_PROGRESS:"Conviva.AdProgress",AD_CLOSE:"Conviva.AdClose",CONTENT_PAUSED:"Conviva.PauseContent",CONTENT_RESUMED:"Conviva.ResumeContent",POD_START:"Conviva.PodStart",POD_END:"Conviva.PodEnd"},c.ErrorType={ERROR_UNKNOWN:"ERROR_UNKNOWN",ERROR_IO:"ERROR_IO",ERROR_TIMEOUT:"ERROR_TIMEOUT",ERROR_NULL_ASSET:"ERROR_NULL_ASSET",ERROR_MISSING_PARAMETER:"ERROR_MISSING_PARAMETER",ERROR_NO_AD_AVAILABLE:"ERROR_NO_AD_AVAILABLE",ERROR_PARSE:"ERROR_PARSE",ERROR_INVALID_VALUE:"ERROR_INVALID_VALUE",ERROR_INVALID_SLOT:"ERROR_INVALID_SLOT",ERROR_3P_COMPONENT:"ERROR_3P_COMPONENT",ERROR_UNSUPPORTED_3P_FEATURE:"ERROR_UNSUPPORTED_3P_FEATURE",ERROR_DEVICE_LIMIT:"ERROR_DEVICE_LIMIT",ERROR_UNMATCHED_SLOT_SIZE:"ERROR_UNMATCHED_SLOT_SIZE"},c.StreamType={UNKNOWN:"UNKNOWN",LIVE:"LIVE",VOD:"VOD"},c.CallbackFunctions={CONSOLE_LOG:"consoleLog",MAKE_REQUEST:"makeRequest",SAVE_DATA:"saveData",LOAD_DATA:"loadData",GET_EPOCH_TIME_IN_MS:"getEpochTimeInMs",CREATE_TIMER:"createTimer",GENERATE_HASH:"generateHash",BASE64_ENCODE:"base64Encode"},c.DeviceMetadata={BRAND:"DeviceBrand",MANUFACTURER:"DeviceManufacturer",MODEL:"DeviceModel",TYPE:"DeviceType",VERSION:"DeviceVersion",OS_NAME:"OperatingSystemName",OS_VERSION:"OperatingSystemVersion",CATEGORY:"DeviceCategory",SCREEN_RESOLUTION_WIDTH:"ScreenWidth",SCREEN_RESOLUTION_HEIGHT:"ScreenHeight",SCREEN_RESOLUTION_SCALE_FACTOR:"ScaleFactor"},c.AD_PRELOAD_FEATURE="adPreloading",c.AD_TAG_URL="adTagUrl",c.IMASDK_CONTENT_PLAYER="imaMainContentPlayer",c.CONVIVA_AD_MODULE="convivaAdModule",c.CONVIVA_MODULE="convivaModule",c.MEDIA_ELEMENT="mediaElement";var h=b.Client=function(){var a=this;this.a=!1,this.version=h.version,this.c=null,this.l=null,this.v=null,this.d=-1,this.p=null,this.R=null,this.w=null,this.T=null,this.S=-1,this.g=!1,this.N={},this.O=function(){a.c},this._={},this.A=null,this.C=null,this.I=null,this.y=function(){this.w.m("Client.makeIPV4IPV6GlobalSessions",function(){var b;!a.T||null!==(b=a.T.get(k.D))&&b!==d.P&&a.l&&((b=new s).custom["c3.IPV4IPV6GlobalSession"]="T",b.custom["c3.domain"]=a.p.M.indexOf(g.L)> -1?g.L:g.U,a.V=a.l.k(b,null),(b=new s).custom["c3.IPV4IPV6GlobalSession"]="T",b.custom["c3.domain"]=a.p.F.indexOf(g.H)> -1?g.H:g.B,a.G=a.l.k(b,null))})},this.j=function(b){a.w.m("Client.updateConnectionType",function(){if(a.A=b,a.l){var c,d=a.l.K();for(c in d)d[c].W(b)}})},this.q=function(b){a.w.m("Client.updateLinkEncryption",function(){if(a.C=b,a.l){var c,d=a.l.K();for(c in d)d[c].Y(b)}})},this.J=function(b){a.w.m("Client.updateSignalStrength",function(){a.I=b})},(function(b,d,f,e){if(!(b instanceof g))throw new Error("clientSettings parameter should be an instance of ClientSettings.");if(!(d instanceof G))throw new Error("systemFactory parameter should be an instance of SystemFactory.");b.gatewayUrl!==g.X+g.Q&&b.gatewayUrl!==g.Z+g.Q||(this.a=!0),e&&(this.version=e),this.p=b.z(),this.v=d,this.v.$("SDK",this.p,this.version),this.w=this.v.tt(this.version),this.w.m("Client.init",function(){if(a.T=a.v.nt(),a.T.it(),a.S=a.T.get(k.et),-1!==a.S&& void 0!==a.S&&null!==a.S||(a.S=m.ot()),a.l=a.v.rt(a,a.p,a.T),f)for(var b in f)switch(b){case c.Network.CONNECTION_TYPE:a.j(f[b]);break;case c.Network.LINK_ENCRYPTION:a.q(f[b]);break;case c.Network.SIGNAL_STRENGTH:a.J(f[b])}a.y()},function(a){throw new Error("Client constructor failed: "+a.message)})}).apply(this,arguments),this.release=function(){this.g||this.w.m("Client.release",function(){a.c,a.l.ut(),a.l=null,a.d=-1,a.S=-1,a.w=null,a.p=null,a.R=null,a.v=null,a.g=!0})},this.createSession=function(b,e,f){var d=h.NO_SESSION_KEY;return this.g||(!b||b instanceof s)&&this.w.m("Client.createSession",function(){d=a.l.ht(b,q.ct.ft,e,(f?c:a).version)}),d},this.createAdSession=function(f,b,g,i,j){var d=h.NO_SESSION_KEY;return this.g||(!b||b instanceof s)&&this.w.m("Client.createAdSession",function(){var k,l;b||(b=new s),!e.lt(f)||f===h.NO_SESSION_KEY||(k=a.l.vt(f))&&(l=b.custom[c.APPLICATION_VERSION],b.applicationName&&b.viewerId&& void 0!==l&&l||k.dt&&k.dt.Et&&(!b.viewerId&&k.dt.Et.viewerId&&(b.viewerId=k.dt.Et.viewerId),!b.applicationName&&k.dt.Et.applicationName&&(b.applicationName=k.dt.Et.applicationName),void 0!==l&&l|| void 0!==(l=k.dt.Et.custom[c.APPLICATION_VERSION])&&l&&(b.custom[c.APPLICATION_VERSION]=l)),b.custom["c3.csid"]=e.pt(k.S)),d=a.l.ht(b,q.ct.Rt,g,(i?c:a).version,j)}),d},this.reportError=function(d,c,b){this.g||e.wt(c)&&(b!==h.ErrorSeverity.FATAL&&b!==h.ErrorSeverity.WARNING||this.w.m("Client.reportError",function(){var e=a.l.vt(d);e&&e.Tt(c,b)}))},this.updateContentMetadata=function(c,b){this.g||b instanceof s&&this.w.m("Client.updateContentMetadata",function(){var d,e=a.l.vt(c);e&&(d=b.z(),e.St(d))})},this.detachPlayer=function(b){this.g||this.w.m("Client.detachPlayer",function(){var c=a.l.vt(b);c&&c.gt()})},this.Nt=function(b){this.g||this.w.m("Client.offFocus",function(){var c=a.l.vt(b);c&&c.Nt()})},this.attachPlayer=function(c,b){this.g||b instanceof l&&this.w.m("Client.attachPlayer",function(){var d=a.l.vt(c);d&&d.Ot(b)})},this._t=function(b){this.g||this.w.m("Client.onFocus",function(){var c=a.l.vt(b);c&&c._t()})},this.contentPreload=function(b){this.g||this.w.m("Client.contentPreload",function(){var c=a.l.vt(b);c&&c.At()})},this.contentStart=function(b){this.g||this.w.m("Client.contentStart",function(){var c=a.l.vt(b);c&&c.Ct()})},this.sendCustomEvent=function(d,b,c){this.g||e.wt(b)&&(e.It(c),this.w.m("Client.sendCustomEvent",function(){d===h.NO_SESSION_KEY&&(a.d<0&&(f=new s,a.d=a.l.k(f,null)),d=a.d);var g=e.yt(c),f=a.l.mt(d);f&&f.Dt(b,g)}))},this.adStart=function(e,b,c,d){this.g||b!==h.AdStream.CONTENT&&b!==h.AdStream.SEPARATE||c!==h.AdPlayer.CONTENT&&c!==h.AdPlayer.SEPARATE||(d!==h.AdPosition.PREROLL&&d!==h.AdPosition.MIDROLL&&h.AdPosition.POSTROLL,this.w.m("Client.adStart",function(){var f=a.l.vt(e);f&&f.bt(b,c,d)}))},this.adEnd=function(b){this.g||this.w.m("Client.adEnd",function(){var c=a.l.vt(b);c&&c.Pt()})},this.cleanupSession=function(b){this.g||b!==h.NO_SESSION_KEY&&this.w.m("Client.cleanupSession",function(){a.l.vt(b)&&a.l.Mt(b)})},this.getAttachedPlayer=function(b){var c=null;return this.g||b===h.NO_SESSION_KEY||this.w.m("Client.getAttachedPlayer",function(){var d=a.l.vt(b);d&&(c=d.Lt())}),c},this.isPlayerAttached=function(a){return!this.g&&null!==this.getAttachedPlayer(a)},this.getPlayerStateManager=function(b){if(this.g)throw new Error("This instance of Conviva.Client has been released.");return new l(this.v,(b?c:a).version)},this.releasePlayerStateManager=function(a){if(this.g)throw new Error("This instance of Conviva.Client has been released.");this.w.m("Client.releasePlayerStateManager",function(){a instanceof l&&a.release()})},this.Ut=function(){return this.p},this.getId=function(){return this.S},this.getSessionId=function(d){if(this.g)return c.NO_SESSION_KEY;var b=null;return this.w.m("Client.getSessionId",function(){var c=a.l.vt(d);c&&(b=c.Vt())}),b},this.getClientId=function(c){if(this.g)return null;var b=null;return this.w.m("Client.getClientId",function(){var d=a.l.vt(c);d&&(b=d.kt())}),b},this.Ft=function(b,c,d){this.g||this.w.m("Client.updateCustomMetric",function(){var e=a.l.vt(b);e&&e.Ft(c,d)})},this.setUniqueIdentifier=function(a,b){if(this.g)throw new Error("This instance of Conviva.Client has been released.");if(!a|| void 0===a||"{}"===JSON.stringify(a))throw new Error("Identifiers are not set. No action taken !!");for(var c in a)this.N[c]=a[c];b&&(this.O=b)},this.setUserPreferenceForDataCollection=function(a,c){if(this.g)throw new Error("This instance of Conviva.Client has been released.");if(!a|| void 0===a||"{}"===JSON.stringify(a))throw new Error("Identifiers are not set. No action taken !!");for(var b in a)"false"===a[b]?this._[b]=c?k.Bt.Ht:k.Bt.Gt:this._[b]=k.Bt.jt},this.setUserPreferenceForDataDeletion=function(a){if(this.g)throw new Error("This instance of Conviva.Client has been released.");if(!a|| void 0===a||"{}"===JSON.stringify(a))throw new Error("Identifiers are not set. No action taken !!");for(var b in a)"true"===a[b]?this._[b]=k.Bt.Kt:this._[b]=k.Bt.jt}};h.version="4.5.8L",h.NO_SESSION_KEY=c.NO_SESSION_KEY,h.AdPosition={PREROLL:c.AdPosition.PREROLL,MIDROLL:c.AdPosition.MIDROLL,POSTROLL:c.AdPosition.POSTROLL},h.AdStream={CONTENT:c.AdPlayer.CONTENT,SEPARATE:c.AdPlayer.SEPARATE},h.AdPlayer={CONTENT:c.AdPlayer.CONTENT,SEPARATE:c.AdPlayer.SEPARATE},h.ErrorSeverity={FATAL:c.ErrorSeverity.FATAL,WARNING:c.ErrorSeverity.WARNING},h.DeviceType={DESKTOP:c.DeviceType.DESKTOP,CONSOLE:c.DeviceType.CONSOLE,SETTOP:c.DeviceType.SETTOP,MOBILE:c.DeviceType.MOBILE,TABLET:c.DeviceType.TABLET,SMARTTV:c.DeviceType.SMARTTV},h.AdTechnology={CLIENT_SIDE:c.AdType.CLIENT_SIDE,SERVER_SIDE:c.AdType.SERVER_SIDE},h.AdType={BLACKOUT_SLATE:c.AdSlates.BLACKOUT_SLATE,TECHNICAL_DIFFICULTIES_SLATE:c.AdSlates.TECHNICAL_DIFFICULTIES_SLATE,COMMERCIAL_SLATE:c.AdSlates.COMMERCIAL_SLATE,OTHER_SLATE:c.AdSlates.OTHER_SLATE,VPAID:c.AdSlates.VPAID,REGULAR:c.AdSlates.REGULAR},h.AdServingType={INLINE:c.AdServingType.INLINE,WRAPPER:c.AdServingType.WRAPPER},h.DeviceCategory={ANDROID_DEVICE:c.DeviceCategory.ANDROID_DEVICE,APPLE_DEVICE:c.DeviceCategory.APPLE_DEVICE,CHROMECAST:c.DeviceCategory.CHROMECAST,DESKTOP_APP:c.DeviceCategory.DESKTOP_APP,DEVICE_SIMULATOR:c.DeviceCategory.DEVICE_SIMULATOR,LG_TV:c.DeviceCategory.LG_TV,NINTENDO:c.DeviceCategory.NINTENDO,PLAYSTATION:c.DeviceCategory.PLAYSTATION,ROKU:c.DeviceCategory.ROKU,SAMSUNG_TV:c.DeviceCategory.SAMSUNG_TV,SMART_TV:c.DeviceCategory.SMART_TV,SET_TOP_BOX:c.DeviceCategory.SET_TOP_BOX,TIVO:c.DeviceCategory.TIVO,WEB:c.DeviceCategory.WEB,WINDOWS_DEVICE:c.DeviceCategory.WINDOWS_DEVICE,XBOX:c.DeviceCategory.XBOX,KAIOS_DEVICE:c.DeviceCategory.KAIOS_DEVICE};var g=b.ClientSettings=function(){var a=this;this.Wt=null,e.xt(this,"customerKey",function(){return this.Wt}),e.qt(this,"customerKey",function(a){e.wt(a)&&(this.Wt=a)}),this.Yt=g.Jt,e.xt(this,"heartbeatInterval",function(){return this.Yt}),e.qt(this,"heartbeatInterval",function(a){var b;"number"!=typeof a||(b=e.Xt(a))===a&&(this.Yt=b)}),this.Qt=null,this.M=null,this.F=null,e.xt(this,"gatewayUrl",function(){return this.Qt}),e.qt(this,"gatewayUrl",function(a){var b;e.wt(a)&&("https"!==(b=a.split("://"))[0]&&"http"!==b[0]|| -1!==a.indexOf(".com",a.length-4)&&(this.Qt=a))}),(function(a){if(!e.wt(a))throw new Error("customerKey must be valid");this.customerKey=a}).apply(this,arguments),this.equals=function(a){return this.customerKey===a.customerKey&&this.gatewayUrl===a.gatewayUrl&&this.heartbeatInterval===a.heartbeatInterval},this.z=function(){var b=new g(this.customerKey);return b.gatewayUrl=function(b){if(e.wt(b)){var c=b.split("://");if(-1===c[1].indexOf("cws.conviva.com")&&("https"===c[0]||"http"===c[0]))return a.M="https://"+a.customerKey+"."+g.U,a.F="https://"+a.customerKey+"."+g.B,b}return a.M="https://"+a.customerKey+"."+g.L,a.F="https://"+a.customerKey+"."+g.H,"https://"+a.customerKey+"."+g.Q}(this.gatewayUrl),b.heartbeatInterval=this.heartbeatInterval,b.M=this.M,b.F=this.F,b}};g.Zt="https://conviva.testonly.conviva.com",g.zt="https://cws.conviva.com",g.Q="cws.conviva.com",g.L="ipv4.cws.conviva.com",g.H="ipv6.cws.conviva.com",g.$t="conviva.testonly.conviva.com",g.U="ipv4.testonly.conviva.com",g.B="ipv6.testonly.conviva.com",g.X="https://",g.Z="http://",g.tn=5,g.Jt=20;var s=b.ContentMetadata=function(){this.nn=null,e.xt(this,"assetName",function(){return this.nn}),e.qt(this,"assetName",function(a){"string"==typeof a&&(this.nn=a)}),this.in={},e.xt(this,"custom",function(){return this.in}),e.qt(this,"custom",function(a){"object"==typeof a&&(this.in=e.yt(a))}),this.en=null,e.xt(this,"defaultResource",function(){return this.en}),e.qt(this,"defaultResource",function(a){"string"==typeof a&&(this.en=a)}),this.sn=null,e.xt(this,"viewerId",function(){return this.sn}),e.qt(this,"viewerId",function(a){"string"==typeof a&&(this.sn=a)}),this.on=null,e.xt(this,"applicationName",function(){return this.on}),e.qt(this,"applicationName",function(a){"string"==typeof a&&(this.on=a)}),this.rn=null,e.xt(this,"streamUrl",function(){return this.rn}),e.qt(this,"streamUrl",function(a){"string"==typeof a&&(this.rn=a)}),this.un=s.StreamType.UNKNOWN,e.xt(this,"streamType",function(){return this.un}),e.qt(this,"streamType",function(a){a!==s.StreamType.UNKNOWN&&a!==s.StreamType.VOD&&a!==s.StreamType.LIVE||(this.un=a)}),this.hn=-1,e.xt(this,"duration",function(){return this.hn}),e.qt(this,"duration",function(a){this.hn=o.an(a)}),this.fn=-1,e.xt(this,"encodedFrameRate",function(){return this.fn}),e.qt(this,"encodedFrameRate",function(a){this.fn=o.an(a)}),(function(){}).apply(this,arguments),this.z=function(){var b,a=new s;for(b in a.assetName=this.assetName,a.applicationName=this.applicationName,a.streamUrl=this.streamUrl,a.viewerId=this.viewerId,a.defaultResource=this.defaultResource,a.streamType=this.streamType,a.duration=this.duration,a.encodedFrameRate=this.encodedFrameRate,this.custom)a.custom[b]=this.custom[b];return a}};s.StreamType={UNKNOWN:c.StreamType.UNKNOWN,LIVE:c.StreamType.LIVE,VOD:c.StreamType.VOD},b.ErrorType={ERROR_UNKNOWN:c.ErrorType.ERROR_UNKNOWN,ERROR_IO:c.ErrorType.ERROR_IO,ERROR_TIMEOUT:c.ErrorType.ERROR_TIMEOUT,ERROR_NULL_ASSET:c.ErrorType.ERROR_NULL_ASSET,ERROR_MISSING_PARAMETER:c.ErrorType.ERROR_MISSING_PARAMETER,ERROR_NO_AD_AVAILABLE:c.ErrorType.ERROR_NO_AD_AVAILABLE,ERROR_PARSE:c.ErrorType.ERROR_PARSE,ERROR_INVALID_VALUE:c.ErrorType.ERROR_INVALID_VALUE,ERROR_INVALID_SLOT:c.ErrorType.ERROR_INVALID_SLOT,ERROR_3P_COMPONENT:c.ErrorType.ERROR_3P_COMPONENT,ERROR_UNSUPPORTED_3P_FEATURE:c.ErrorType.ERROR_UNSUPPORTED_3P_FEATURE,ERROR_DEVICE_LIMIT:c.ErrorType.ERROR_DEVICE_LIMIT,ERROR_UNMATCHED_SLOT_SIZE:c.ErrorType.ERROR_UNMATCHED_SLOT_SIZE},b.Events={AD_REQUESTED:c.Events.AD_REQUESTED,AD_RESPONSE:c.Events.AD_RESPONSE,AD_SLOT_STARTED:c.Events.AD_SLOT_STARTED,AD_ATTEMPTED:c.Events.AD_ATTEMPTED,AD_SLOT_ENDED:c.Events.AD_SLOT_ENDED,AD_IMPRESSION_START:c.Events.AD_IMPRESSION_START,AD_START:c.Events.AD_START,AD_FIRST_QUARTILE:c.Events.AD_FIRST_QUARTILE,AD_MID_QUARTILE:c.Events.AD_MID_QUARTILE,AD_THIRD_QUARTILE:c.Events.AD_THIRD_QUARTILE,AD_COMPLETE:c.Events.AD_COMPLETE,AD_END:c.Events.AD_END,AD_IMPRESSION_END:c.Events.AD_IMPRESSION_END,AD_SKIPPED:c.Events.AD_SKIPPED,AD_ERROR:c.Events.AD_ERROR,AD_PROGRESS:c.Events.AD_PROGRESS,AD_CLOSE:c.Events.AD_CLOSE,CONTENT_PAUSED:c.Events.CONTENT_PAUSED,CONTENT_RESUMED:c.Events.CONTENT_RESUMED,POD_START:c.Events.POD_START,POD_END:c.Events.POD_END};var l=b.PlayerStateManager=function(){var a=this;a.cn=null,a.ln=-2,a.vn=l.PlayerState.UNKNOWN,a.dn={},a.En=-2,a.fn=-2,a.hn=-2,a.pn=null,a.Rn=null,a.rn=null,a.wn=null,a.Tn=null,a.Sn=-1,a.gn=-1,a.A=null,a.C=null,a.Nn=null,a.On=[],a.g=!1,this.release=function(){a.g||a.w.m("PlayerStateManager.release",function(){a.cn&&a.cn._n(),a.An(),a.v=null,a.w=null,a.g=!0})},this.setPlayheadTime=function(){},this.setBufferLength=function(){},this.setRenderedFrameRate=function(){},this.getEncodedFrameRate=function(){return a.fn},this.setEncodedFrameRate=function(b){a.g||a.w.m("PlayerStateManager.setEncodedFrameRate",function(){var c=o.an(b);c>= -1&&(a.fn=c,a.cn&&a.cn.Cn(a.fn))})},this.getDuration=function(){return a.hn},this.setClientMeasureInterface=function(a){e.In(a,new b.ClientMeasureInterface,"ClientMeasureInterface"),this.yn=a},this.getPHT=function(){return this.yn&&"function"==typeof this.yn.getPHT?this.yn.getPHT():l.DEFAULT_PHT},this.getBufferLength=function(){return this.yn&&"function"==typeof this.yn.getBufferLength?this.yn.getBufferLength():l.DEFAULT_BUFFER_LENGTH},this.getSignalStrength=function(){return this.yn&&"function"==typeof this.yn.getSignalStrength?this.yn.getSignalStrength():l.DEFAULT_SIGNAL_STRENGTH},this.getRenderedFrameRate=function(){return this.yn&&"function"==typeof this.yn.getRenderedFrameRate?this.yn.getRenderedFrameRate():l.DEFAULT_RENDERED_FRAME_RATE},this.setDuration=function(b){a.g||a.w.m("PlayerStateManager.setDuration",function(){var c=o.an(b);c>= -1&&(a.hn=c,a.cn&&a.cn.mn(a.hn))})},this.getStreamUrl=function(){return a.rn},this.setStreamUrl=function(b){a.g||a.w.m("PlayerStateManager.setStreamUrl",function(){b&&(a.rn=b,a.cn&&a.cn.Dn(a.rn))})},this.bn=function(){return a.wn},this.Pn=function(){return a.Tn},this.setModuleNameAndVersion=function(b,c){a.wn=b,a.Tn=c},this.Mn=function(){return a.Rn},this.setPlayerType=function(b){a.g||a.w.m("PlayerStateManager.setPlayerType",function(){a.Rn=b,a.cn&&a.cn.Ln(a.Rn)})},this.Un=function(){return a.pn},this.setPlayerVersion=function(b){a.g||a.w.m("PlayerStateManager.setPlayerVersion",function(){a.pn=b,a.cn&&a.cn.Vn(a.pn)})},this.setMonitoringNotifier=function(b){return!a.g&& !a.cn&&(a.cn=b,a.c,!0)},this.An=function(){a.g||(a.cn=null,a.c)},this.kn=function(){a.setPlayerState(a.getPlayerState()),a.setBitrateKbps(a.Fn()),a.setDuration(a.getDuration()),a.setEncodedFrameRate(a.getEncodedFrameRate()),a.setStreamUrl(a.getStreamUrl()),a.setPlayerType(a.Mn()),a.setPlayerVersion(a.Un());for(var b=0;b<a.On.length;b++){var c=a.On[b];a.Hn(c)}a.On=[]},this.getPlayerState=function(){return a.vn},this.setPlayerState=function(b){a.g||a.w.m("PlayerStateManager.setPlayerState",function(){l.Bn(b)&&(a.vn=b,a.cn&&a.cn.Gn(a.vn))})},this.Fn=function(){return a.ln},this.setBitrateKbps=function(b){a.g||a.w.m("PlayerStateManager.setBitrateKbps",function(){var c=o.an(b);c>= -1&&(a.ln=c,a.cn&&a.cn.jn(a.ln))})},this.setPlayerSeekStart=function(b){a.g||a.w.m("PlayerStateManager.setPlayerSeekStart()",function(){a.cn&&a.cn.Kn(l.SEEK_ACTIONS_TYPE.SEEK_START,b)})},this.setPlayerSeekEnd=function(){a.g||a.w.m("PlayerStateManager.setPlayerSeekEnd()",function(){a.cn&&a.cn.Kn(l.SEEK_ACTIONS_TYPE.SEEK_END,-1)})},this.setUserSeekButtonUp=function(){a.g||a.w.m("PlayerStateManager.setUserSeekButtonUp()",function(){a.cn&&a.cn.Kn(l.SEEK_ACTIONS_TYPE.BUTTON_UP,-1)})},this.setUserSeekButtonDown=function(){a.g||a.w.m("PlayerStateManager.setUserSeekButtonDown()",function(){a.cn&&a.cn.Kn(l.SEEK_ACTIONS_TYPE.BUTTON_DOWN,-1)})},this.setVideoResolutionWidth=function(b){a.g||a.w.m("PlayerStateManager.setVideoResolutionWidth()",function(){var c=o.an(b);c>0&&(a.Sn=c),a.cn&&a.cn.Wn(a.Sn)})},this.setVideoResolutionHeight=function(b){a.g||a.w.m("PlayerStateManager.setVideoResolutionHeight()",function(){var c=o.an(b);c>0&&(a.gn=c),a.cn&&a.cn.xn(a.gn)})},this.setConnectionType=function(b){a.g||a.w.m("PlayerStateManager.setConnectionType()",function(){a.A=b,a.cn&&a.cn.W(a.A)})},this.setLinkEncryption=function(b){a.g||a.w.m("PlayerStateManager.setLinkEncryption()",function(){a.C=b,a.cn&&a.cn.Y(a.C)})},this.setSignalStrength=function(){},this.Hn=function(b){var c,d;a.Nn=b,a.cn?(c=b.errorCode,d=b.severity,a.cn.qn(c,d)):a.On.push(b)},this.sendError=function(b,c){a.g||a.w.m("PlayerStateManager.sendError",function(){var d=new ai(b,c);a.Hn(d)})},this.reset=function(){a.g||a.w.m("PlayerStateManager.reset",function(){a.ln=-2,a.vn=l.PlayerState.UNKNOWN,a.dn={},a.En=-1,a.fn=-1,a.hn=-1,a.pn=null,a.Rn=null,a.rn=null,a.Nn=null,a.On=[]})},this.setCDNServerIP=function(b){a.g||a.w.m("PlayerStateManager.setCDNServerIP",function(){a.cn&&a.cn.Yn(b)})},this.Jn=function(){return a.Xn},this.setDroppedFramesTotal=function(b){a.g||a.w.m("PlayerStateManager.setDroppedFramesTotal",function(){a.cn&&a.cn.Qn(b)})},this.setDroppedFramesCount=function(b){a.g||a.w.m("PlayerStateManager.setDroppedFramesCount",function(){a.cn&&a.cn.Zn(b)})},this.zn=function(){return a.Nn},(function(b,c){a.v=b,a.w=a.v.tt(c)}).apply(a,arguments)};l.PlayerState={STOPPED:c.PlayerState.STOPPED,PLAYING:c.PlayerState.PLAYING,BUFFERING:c.PlayerState.BUFFERING,PAUSED:c.PlayerState.PAUSED,UNKNOWN:c.PlayerState.UNKNOWN,NOT_MONITORED:c.PlayerState.NOT_MONITORED},l.Bn=function(a){return a===l.PlayerState.STOPPED||a===l.PlayerState.PLAYING||a===l.PlayerState.BUFFERING||a===l.PlayerState.PAUSED||a===l.PlayerState.UNKNOWN||a===l.PlayerState.NOT_MONITORED},l.SEEK_ACTIONS_TYPE={SEEK_START:"pss",SEEK_END:"pse",BUTTON_UP:"bu",BUTTON_DOWN:"bd"},l.DEFAULT_SIGNAL_STRENGTH=1e3,l.DEFAULT_RENDERED_FRAME_RATE=-1,l.DEFAULT_BUFFER_LENGTH=-1,l.DEFAULT_PHT=-1,b.ClientMeasureInterface=function(){this.getPHT=function(){},this.getBufferLength=function(){},this.getSignalStrength=function(){},this.getRenderedFrameRate=function(){}};var z=b.HttpInterface=function(){this.makeRequest=function(){},this.release=function(){}},A=b.LoggingInterface=function(){this.consoleLog=function(){},this.release=function(){}},B=b.MetadataInterface=function(){this.getBrowserName=function(){},this.getBrowserVersion=function(){},this.getDeviceBrand=function(){},this.getDeviceManufacturer=function(){},this.getDeviceModel=function(){},this.getDeviceType=function(){},this.getDeviceVersion=function(){},this.getFrameworkName=function(){},this.getFrameworkVersion=function(){},this.getOperatingSystemName=function(){},this.getOperatingSystemVersion=function(){},this.getDeviceCategory=function(){},this.getScreenWidth=function(){},this.getScreenHeight=function(){},this.getScaleFactor=function(){},this.release=function(){}},C=b.StorageInterface=function(){this.saveData=function(){},this.loadData=function(){},this.release=function(){}},D=b.SystemInterface=function(){(function(a,b,c,d,f,g){e.In(a,new E,"TimeInterface"),e.In(b,new F,"TimerInterface"),e.In(c,new z,"HttpInterface"),e.In(d,new C,"StorageInterface"),e.In(f,new B,"MetadataInterface"),e.In(g,new A,"LoggingInterface"),this.$n=a,this.ti=b,this.ni=c,this.ii=d,this.ei=f,this.si=g}).apply(this,arguments),this.release=function(){this.$n&&(this.$n.release(),this.$n=null),this.ti&&(this.ti.release(),this.ti=null),this.ni&&(this.ni.release(),this.ni=null),this.ii&&(this.ii.release(),this.ii=null),this.ei&&(this.ei.release(),this.ei=null),this.si&&(this.si.release(),this.si=null)}},E=b.TimeInterface=function(){this.getEpochTimeMs=function(){},this.release=function(){}},F=b.TimerInterface=function(){this.createTimer=function(){},this.release=function(){}},G=b.SystemFactory=function(){var b=this;(function(a,b){if(!(a instanceof D))throw new Error("systemInterface parameter should be an instance of SystemInterface.");this.oi=a,this.$n=this.oi.$n,this.ti=this.oi.ti,this.ni=this.oi.ni,this.ii=this.oi.ii,this.ei=this.oi.ei,this.si=this.oi.si,this.p=b instanceof i?b.z():new i}).apply(this,arguments),this.$=function(a,b,c){this.ri=a,this.ui=b,this.hi=c},this.release=function(){this.oi.release(),this.oi=null,this.ri=null,this.p=null,this.ai=null},this.buildLogger=function(){return new y(b.si,b.$n,b.Ut(),b.ai,b.ri)},this.rt=function(a,b,c){return new ac(a,b,c,this)},this.fi=function(a){return new $(this.buildLogger(),this.ci(),this.ui,a)},this.li=function(){return new ad(this.buildTimer(b.hi))},this.vi=function(){var a=new al(this.buildLogger(),this.ti,new af(this.buildLogger(),null,this.Ut()));return new ad(a)},this.ci=function(){return new aj(this.buildLogger(),this.ni,this.vi(),this.Ut())},this.tt=function(a){return new af(this.buildLogger(),this.fi(a),this.Ut())},this.buildTime=function(){return new ak(this.$n,this.buildLogger())},this.buildTimer=function(a){return new al(this.buildLogger(),this.ti,this.tt(a))},this.di=function(){return new a.Storage(this.buildLogger(),this.ii,this.li(),this.Ut())},this.nt=function(){return new k(this.buildLogger(),this.di(),this.Ei())},this.pi=function(a){return new f(this.buildLogger(),this.ei,this.tt(a))},this.Ri=function(){return new d},this.wi=function(a,b){return new ag(a,this.buildLogger(),this.ci(),this.Ei(),b)},this.Ti=function(d,b,e,c,a){var f=this.wi(b,c.custom["c3.domain"]);return new q(this.Si(),d,b,this.buildLogger(),this.tt(a),this.buildTimer(a),f,this.Ri(),this.buildTime(),this.gi(),e,c,a)},this.Ni=function(d,e,c,f,g,a,b){return a=this.Ti(d,e.z(),c,a,b),new x(f,g,c,this.pi(b),a,this.tt(b),this.buildLogger())},this.Si=function(){return new ae},this.Ei=function(){return new aa},this.gi=function(){return this.ai},this.Ut=function(){return this.p},this.ai=new ah},i=b.SystemSettings=function(){this.Oi=i._i,e.xt(this,"logLevel",function(){return this.Oi}),e.qt(this,"logLevel",function(b){var a;"number"!=typeof b||(a=e.Xt(b))===b&&a>=i.LogLevel.DEBUG&&a<=i.LogLevel.ERROR&&(this.Oi=a)}),this.Ai=i.Ci,e.xt(this,"allowUncaughtExceptions",function(){return this.Ai}),e.qt(this,"allowUncaughtExceptions",function(a){e.Ii(a)&&(this.Ai=a)}),this.yi=i.mi,e.xt(this,"storageTimeout",function(){return this.yi}),e.qt(this,"storageTimeout",function(a){var b;"number"!=typeof a||(b=e.Xt(a))===a&&(this.yi=b)}),this.Di=i.bi,e.xt(this,"httpTimeout",function(){return this.Di}),e.qt(this,"httpTimeout",function(a){var b;"number"!=typeof a||(b=e.Xt(a))===a&&(this.Di=b)}),(function(){}).apply(this,arguments),this.equals=function(a){return this.logLevel===a.logLevel&&this.allowUncaughtExceptions===a.allowUncaughtExceptions&&this.storageTimeout===a.storageTimeout&&this.httpTimeout===a.httpTimeout},this.z=function(){var a=new i;return a.logLevel=this.logLevel,a.allowUncaughtExceptions=this.allowUncaughtExceptions,a.storageTimeout=this.storageTimeout,a.httpTimeout=this.httpTimeout,a}};i.LogLevel={DEBUG:c.LogLevel.DEBUG,INFO:c.LogLevel.INFO,WARNING:c.LogLevel.WARNING,ERROR:c.LogLevel.ERROR,NONE:c.LogLevel.NONE},i.Pi=i.LogLevel.DEBUG,i._i=i.LogLevel.NONE,i.Mi=!0,i.Ci=!1,i.mi=10,i.bi=10;var H=a.AdAnalytics=function(){var a=this;function d(b){a.Li?(e.It(b)>0&&a.setAdInfo(b),a.Li.Ui()||(a.Li.Vi(a.ki),a.Li.Fi(!0))):a.c}a.Hi=null,a.v=null,a.Bi=null,a.ki=null,a.Li=null,a.Gi=null,a.ji=null,a.Ki=null,(function(e,d,b){a.Hi=e,a.Ki=b,a.v=d,b&&(a.ki=b.Wi()),a.Bi=d.buildTimer(c.version),a.Li=new I(a.Hi,a.Bi),J.call(this)}).apply(this,arguments),this.setAdInfo=function(b){0>=e.It(b)?a.c:(a.c,a.Li&&a.Li.xi(b))},this.setAdPlayerInfo=function(b){0>=e.It(b)?a.c:(a.c,a.Li&&a.Li.xi(b))},this.reportAdMetric=function(){0!==arguments.length?1===arguments.length?a.qi(arguments[0]):2===arguments.length?a.qi(arguments[0],arguments[1]):3===arguments.length?a.qi(arguments[0],arguments[1],arguments[2]):4===arguments.length&&a.qi(arguments[0],arguments[1],arguments[2],arguments[3]):a.c},this.setCallback=function(b){a.Li&&a.Li.Yi(b)},this.reportAdFailed=function(b,c){a.Li?(e.It(c)>0&&a.setAdInfo(c),a.Li.Ui()?(a.c,a.reportAdError(b,h.ErrorSeverity.FATAL),a.reportAdEnded()):(a.Li.Vi(a.ki),a.c,b=new ai(b,h.ErrorSeverity.FATAL),a.Li.Fi(!0,b))):a.c},this.reportAdLoaded=function(b){a.c,d(b)},this.reportAdStarted=function(b){a.c,d(b)},this.reportAdEnded=function(){a.Li?(a.c,a.Li.Ui()&&(a.Li.Vi(null),a.Li.Fi(!1))):a.c},this.reportAdError=function(c,b){a.Li?(a.c,b=new ai(c,b),a.Li.Hn(b)):a.c},this.reportAdPlayerEvent=function(b,d){if(e.wt(b)){if(a.c,a.Li)switch(b){case c.Events.USER_WAIT_STARTED:case c.Events.BUMPER_VIDEO_STARTED:a.Li.gt();break;case c.Events.USER_WAIT_ENDED:case c.Events.BUMPER_VIDEO_ENDED:a.Li.Ot();break;default:a.Li.Ji(b,d)}else a.c}else a.c},this.reportAdSkipped=function(){a.Li?(a.c,a.reportAdPlayerEvent(c.Events.AD_SKIPPED),a.reportAdEnded()):a.c},this.release=function(){a.c,a.Li&&(a.Li.Ui()&&(a.Li.Vi(null),a.Li.Fi(!1)),a.Li.Yi(null),a.Li.Xi(),a.Li=null),void 0!==b.AdProxyMonitor&&a.ji&&(b.AdProxyMonitor.release(a.ji),a.ji=null)},this.setAdListener=function(c,d){c&&(void 0!==d&& void 0!==d.convivaModule?b.AdProxyMonitor=d.convivaModule.AdProxyMonitor:"undefined"!=typeof ConvivaModule&&(b.AdProxyMonitor=ConvivaModule.AdProxyMonitor),void 0!==b.AdProxyMonitor&&(!c&&a.ji?(b.AdProxyMonitor.release(a.ji),a.ji=null):c&&a.ji?(b.AdProxyMonitor.release(a.ji),a.c,a.ji=b.AdProxyMonitor.initConvivaDropIn(c,d,this,b,a.v)):c&&!a.ji&&(a.c,a.ji=b.AdProxyMonitor.initConvivaDropIn(c,d,this,b,a.v))))},this.reportAdBreakStarted=function(b,c,d){a.ki&&(a.c,a.Qi=b,a.Gi=c,a.ki.Zi(b,c,d))},this.reportAdBreakEnded=function(){a.ki&&(a.c,a.Qi=null,a.Gi=null,a.ki.zi())},this.getSessionId=function(){return a.ki?(a.c,a.Li.Vt()):c.NO_SESSION_KEY},this.getClientId=function(){return a.ki?(a.c,a.Li.kt()):null},this.getPlayerMonitor=function(){return a.ki},this.getAdPlayerMonitor=function(){return a.Li},this.getVideoAnalytics=function(){return a.Ki},this.getAdType=function(){return a.ki?a.ki.Qi:null},this.$i=function(){return a.ki?a.ki.Gi:null},H.prototype=Object.create(J.prototype),H.prototype.constructor=H},I=a.AdPlayerMonitorImpl=function(){var a=this;a.te=null,a.ne=null,(function(a,b){L.call(this,a,b)}).apply(this,arguments),this.Vi=function(b){this.ie()!==b&&(this.ee(),a.ne=b||null)},this.ie=function(){return a.ne},this.se=function(c){var b,d=this.ie(),e={};e.error=c,a.te&&(a.oe=a.te.getPlayerStateManager(!0),a.re(),a.oe.setClientMeasureInterface(this),b=null,d&&(b=d.ue()),a.he=a.te.createAdSession(b,a.Et,a.oe,!0,e),void 0!==c&&(a.ae(),a.Xi()))},I.prototype=Object.create(L.prototype),I.prototype.constructor=I},t=b.Analytics={init:function(k,f,l){if(this.Hi,arguments.length<=0)throw new Error("customerKey must be valid");var j=null,a=null,d=null;if("string"==typeof k&&(j=k,!e.wt(j)))throw new Error("customerKey must be valid");arguments.length>=2&&"object"==typeof f&&(a=f),arguments.length>=3&&"object"==typeof l&&(d=l);var m=new g(j),n=new i;e.It(d)>0&&(d[c.GATEWAY_URL]&&(m.gatewayUrl=d[c.GATEWAY_URL]),d[c.LOG_LEVEL]>=0&&(n.logLevel=d[c.LOG_LEVEL])),k=new b.Impl.Html5Logging,f=new b.Impl.Html5Storage,l=new b.Impl.Html5Http,j=new b.Impl.Html5Timer,d=new b.Impl.Html5Time,this.ei||(this.ei=new b.Impl.Html5Metadata),a&&(a[c.CallbackFunctions.CONSOLE_LOG]&&(k.consoleLog=a[c.CallbackFunctions.CONSOLE_LOG]),a[c.CallbackFunctions.MAKE_REQUEST]&&(l.makeRequest=a[c.CallbackFunctions.MAKE_REQUEST]),a[c.CallbackFunctions.SAVE_DATA]&&(f.saveData=a[c.CallbackFunctions.SAVE_DATA]),a[c.CallbackFunctions.LOAD_DATA]&&(f.loadData=a[c.CallbackFunctions.LOAD_DATA]),a[c.CallbackFunctions.GET_EPOCH_TIME_IN_MS]&&(d.getEpochTimeMs=a[c.CallbackFunctions.GET_EPOCH_TIME_IN_MS]),a[c.CallbackFunctions.CREATE_TIMER]&&(j.createTimer=a[c.CallbackFunctions.CREATE_TIMER])),this.oi=new D(d,j,l,f,this.ei,k),this.v=new G(this.oi,n),this.v.$("Analytics",m),this.Hi=new h(m,this.v,this.fe,t.version)},release:function(){var a=0;if(this.ce){for(a=0;a<this.ce.length;a++){var b=this.ce[a];b&&(b.release(),b.c=null,b.Bi=null,this.ce.splice(a,1),a--)}this.ce=null}if(this.le){for(a=0;a<this.le.length;a++){var c=this.le[a];c&&(c.release(),c.c=null,c.Bi=null,this.le.splice(a,1),a--)}this.le=null}this.v&&(this.v.release(),this.v=null),this.Hi&&(this.Hi.release(),this.Hi=null),this.Hi=null,this.c=null,this.oi=null,this.ei=null,this.fe=null},setUniqueIdentifier:function(a,b){if(!this.Hi)throw new Error(c.i);this.Hi.setUniqueIdentifier(a,b)},setUserPreferenceForDataCollection:function(a,b){if(!this.Hi)throw new Error(c.i);this.Hi.setUserPreferenceForDataCollection(a,b)},setUserPreferenceForDataDeletion:function(a){if(!this.Hi)throw new Error(c.i);this.Hi.setUserPreferenceForDataDeletion(a)},reportAppEvent:function(a,b){if(!this.Hi)throw new Error(c.i);this.Hi.sendCustomEvent(h.NO_SESSION_KEY,a,b)},reportAppBackgrounded:function(){if(!this.Hi)throw new Error(c.i);this.Hi.sendCustomEvent(h.NO_SESSION_KEY,"App.Backgrounded",null)},reportAppForegrounded:function(){if(!this.Hi)throw new Error(c.i);this.Hi.sendCustomEvent(h.NO_SESSION_KEY,"App.Foregrounded",null)},configureExistingClient:function(a){if(!(a instanceof h))throw new Error(c.i);this.Hi=a,this.v=this.Hi.v},buildVideoAnalytics:function(){if(!this.Hi)throw new Error(c.i);var a=new P(this.Hi,this.v);return this.le||(this.le=[]),this.le.push(a),a},buildAdAnalytics:function(a){if(!this.Hi)throw new Error(c.i);return a=new H(this.Hi,this.v,a||null),this.ce||(this.ce=[]),this.ce.push(a),a},setDeviceMetadata:function(a){var d,f,g;arguments.length<=0||0===e.It(a)||(this.ei||(this.ei=new b.Impl.Html5Metadata),a[c.DeviceMetadata.BRAND]&&(this.ei.getDeviceBrand=function(){return a[c.DeviceMetadata.BRAND]}),a[c.DeviceMetadata.MANUFACTURER]&&(this.ei.getDeviceManufacturer=function(){return a[c.DeviceMetadata.MANUFACTURER]}),a[c.DeviceMetadata.MODEL]&&(this.ei.getDeviceModel=function(){return a[c.DeviceMetadata.MODEL]}),a[c.DeviceMetadata.TYPE]&&(this.ei.getDeviceType=function(){return a[c.DeviceMetadata.TYPE]}),a[c.DeviceMetadata.VERSION]&&(this.ei.getDeviceVersion=function(){return a[c.DeviceMetadata.VERSION]}),a[c.DeviceMetadata.OS_NAME]&&(this.ei.getOperatingSystemName=function(){return a[c.DeviceMetadata.OS_NAME]}),a[c.DeviceMetadata.OS_VERSION]&&(this.ei.getOperatingSystemVersion=function(){return a[c.DeviceMetadata.OS_VERSION]}),a[c.DeviceMetadata.CATEGORY]&&(this.ei.getDeviceCategory=function(){return a[c.DeviceMetadata.CATEGORY]}),d=a[c.DeviceMetadata.SCREEN_RESOLUTION_WIDTH],e.lt(d)&&(this.ei.getScreenWidth=function(){return d.toString()}),f=a[c.DeviceMetadata.SCREEN_RESOLUTION_HEIGHT],e.lt(f)&&(this.ei.getScreenHeight=function(){return f.toString()}),g=a[c.DeviceMetadata.SCREEN_RESOLUTION_SCALE_FACTOR],e.lt(g)&&(this.ei.getScaleFactor=function(){return g.toString()}))},reportDeviceMetric:function(b,a){switch(this.fe||(this.fe={}),b){case c.Network.CONNECTION_TYPE:if(!e.wt(a))return;this.fe[b]=a,this.Hi&&this.Hi.j(this.fe[c.Network.CONNECTION_TYPE]);break;case c.Network.LINK_ENCRYPTION:if(!e.wt(a))return;this.fe[b]=a,this.Hi&&this.Hi.q(this.fe[c.Network.LINK_ENCRYPTION]);break;case c.Network.SIGNAL_STRENGTH:var d=parseInt(a,10);if(!e.lt(d)||l.DEFAULT_SIGNAL_STRENGTH===d)return;this.fe[b]=d,this.Hi&&this.Hi.J(d)}}};t.version="4.5.8";var J=a.AnalyticsImpl=function(){var a=this;function b(){var e=!!a.Li,b=a.getAdType(),d=a.$i();return b===c.AdType.SERVER_SIDE&&d===c.AdPlayer.CONTENT?J.de.ve:b!==c.AdType.SERVER_SIDE||d!==c.AdPlayer.SEPARATE?b===c.AdType.CLIENT_SIDE&&d===c.AdPlayer.CONTENT?J.de.Ee:(b===c.AdType.CLIENT_SIDE&&c.AdPlayer.SEPARATE,e?J.de.Ee:J.de.pe):void 0}function d(b,c,d){b=parseInt(b,10),c=parseInt(c,10),isNaN(b)&&isNaN(c)||(isNaN(b),isNaN(c),a.Li&&(d===J.de.Ee||d===J.de.ve)&&a.Li.Re(b,c),a.ki&&(d===J.de.pe||d===J.de.ve)&&a.ki.Re(b,c))}function f(c,b){l.Bn(c)&&(a.Li&&(b===J.de.Ee||b===J.de.ve)&&a.Li.we(c),(a.ki&&b===J.de.pe||b===J.de.ve)&&a.ki.we(c))}function g(b,c){b=parseInt(b,10),isNaN(b)||(a.Li&&(c===J.de.Ee||c===J.de.ve)&&a.Li.Te(b),a.ki&&(c===J.de.pe||c===J.de.ve)&&a.ki.Te(b))}function h(b,c){b=parseInt(b,10),isNaN(b)||(a.Li&&(c===J.de.Ee||c===J.de.ve)&&a.Li.Se(b),a.ki&&(c===J.de.pe||c===J.de.ve)&&a.ki.Se(b))}function i(b,c){b=parseInt(b,10),a.Li&&(c===J.de.Ee||c===J.de.ve)&&a.Li.ge(!0,b),a.ki&&(c===J.de.pe||c===J.de.ve)&&a.ki.ge(!0,b)}function j(b){a.Li&&(b===J.de.Ee||b===J.de.ve)&&a.Li.ge(!1,-1),a.ki&&(b===J.de.pe||b===J.de.ve)&&a.ki.ge(!1,-1)}function k(b,c){b=parseInt(b,10),isNaN(b)||(a.Li&&(c===J.de.Ee||c===J.de.ve)&&a.Li.Ne(b),a.ki&&(c===J.de.pe||c===J.de.ve)&&a.ki.Ne(b))}function m(b,c){b=parseInt(b,10),isNaN(b)||(a.Li&&(c===J.de.Ee||c===J.de.ve)&&a.Li.Oe(b),a.ki&&(c===J.de.pe||c===J.de.ve)&&a.ki.Oe(b))}(function(){}).apply(this,arguments),this.qi=function(u,l,t,r){var q,p,n,o,s;switch(u){case c.Playback.BITRATE:r===J.de.Ee?k(l,J.de.Ee):k(l,b());break;case c.Playback.PLAY_HEAD_TIME:r===J.de.Ee?g(l,J.de.Ee):g(l,b());break;case c.Playback.RESOLUTION:r===J.de.Ee?d(l,t,J.de.Ee):d(l,t,b());break;case c.Playback.BUFFER_LENGTH:r===J.de.Ee?h(l,J.de.Ee):h(l,b());break;case c.Playback.PLAYER_STATE:r===J.de.Ee?f(l,J.de.Ee):f(l,b());break;case c.Playback.RENDERED_FRAMERATE:r===J.de.Ee?m(l,J.de.Ee):m(l,b());break;case c.Playback.SEEK_STARTED:arguments.length>=2&&"CONVIVA"!==l?i(l,b()):t===J.de.Ee?i(-1,J.de.Ee):i(-1,b());break;case c.Playback.SEEK_ENDED:t===J.de.Ee?j(J.de.Ee):j(b());break;case c.Playback.CDN_IP:o=l,s=b(),e.wt(o)&&(a.Li&&(s===J.de.Ee||s===J.de.ve)&&a.Li._e(o),a.ki&&(s===J.de.pe||s===J.de.ve)&&a.ki._e(o));break;case c.Playback.DROPPED_FRAMES_TOTAL:n=l,o=b(),n=parseInt(n,10),isNaN(n)||(a.Li&&(o===J.de.Ee||o===J.de.ve)&&a.Li.Ae(n),a.ki&&(o===J.de.pe||o===J.de.ve)&&a.ki.Ae(n));break;case c.Playback.DROPPED_FRAMES_COUNT:q=l,p=b(),q=parseInt(q,10),isNaN(q)||(a.Li&&(p===J.de.Ee||p===J.de.ve)&&a.Li.Ce(q),a.ki&&(p===J.de.pe||p===J.de.ve)&&a.ki.Ce(q));break;default:n=u,p=l,q=b(),e.wt(n),a.Li,J.de.Ee,J.de.ve,a.Li.Ft(n,p),a.ki,J.de.pe,J.de.ve,a.ki.Ft(n,p)}}};a.AnalyticsImpl.de={Ee:1,pe:2,ve:3};var K=a.PlayerMonitor=function(){var a=this;this.Ie=null,this.ye=null,this.Et=null,this.me=null,this.vn=l.PlayerState.UNKNOWN,this.De=-1,this.be=-1,this.On=[],this.Pe=null,this.Me=null,this.Le=-2,this.En=-1,this.I=l.DEFAULT_SIGNAL_STRENGTH,this.Ue=null,this.Xn=null,this.C=null,this.A=null,this.Bi=null,this.Ve=null,this.ke=null,this.Fe=null,this.He=null,this.Qi=null,this.Gi=null,(function(b){a.Bi=b}).apply(this,arguments),this.Be=function(){return a.vn},this.we=function(b){a.vn!==b&&(a.ee(),a.vn=b,a.Ge())},this.je=function(){return a.Ke},this.We=function(){return a.xe},this.ge=function(b,c){a.ee(),a.Ke=b,a.xe=c,a.qe()},this.Ye=function(){return a.De},this.Te=function(b){a.De=b},this.Je=function(){return a.be},this.Se=function(b){a.be=b},this.Xe=function(){return a.Le},this.Ne=function(b){a.Le!==b&&(a.Le=b,a.Ge())},this.Qe=function(){return a.En},this.Oe=function(b){a.En=b},this.Ze=function(){return a.Ue},this._e=function(b){a.Ue=b,a.Ge()},this.Jn=function(){return a.Xn},this.Ae=function(b){a.Xn=b,a.Ge()},this.Ce=function(b){a.ze(b)},this.$e=function(){return a.I},this.ts=function(){return a.ns},this.es=function(){return a.ss},this.Re=function(b,c){b<0&&(b=0),c<0&&(c=0),a.ns===b&&a.ss===c||(a.ns=b,a.ss=c,a.Ge())},this.os=function(){return a.ye},this.rs=function(){a.os()&&(a.Et=new s,a.me={},a.ke={},a.us())},this.hs=function(b){(a.ye||b)&&(this.ee(),a.ye&&(a.ye=null,a.rs()),b&&(a.ye=e.as(a.ye,b),a.rs()))},this.xi=function(b){if(b){if(a.Et){var c,d=!1;for(c in b)if(a.Et[c]!==b[c]){d=!0;break}d&&(a.ee(),a.ye=e.as(b),a.us())}else a.hs(b)}},this.Yi=function(b){b?a.Fe!==b&&(a.Fe=b,a.fs()):(a.Fe=null,a.ae())},this.ee=function(){a.cs||a.Fe&&(a.cs=!0,a.Fe(),a.cs=!1)},this.Ui=function(){return a.Ie},this.Fi=function(b,c){a.Ie!==b&&(a.ee(),a.Ie&&(a.ls(),a.ae(),a.Xi()),a.Ie=b,a.Ie&&a.se(c))},this.vs=function(){return a.Pe},this.ds=function(){return a.Me||null},this.Es=function(){return a.On},this.ps=function(){a.On=[]},this.Hn=function(b){this.ee(),a.On.push(b),a.qn()},this.Ji=function(b,c){a.ee(),a.Pe=b,a.Me=c,a.Rs()},this.ws=function(){a.ee()},this.fs=function(){a.ae(),a.Ve=a.Bi.create(a.ws,1e3,"PlayerMonitor.update")},this.ae=function(){a.Ve&&(a.Ve(),a.Ve=null)},this.Zi=function(e,d,b){a.He=b,a.Qi=e,a.Ts(),a.Gi=d,a.Qi&&c.AdType.CLIENT_SIDE===a.Qi&&(a.vn=c.PlayerState.UNKNOWN,a.Ss(a.Qi,d,b?b[c.POD_POSITION]:null))},this.zi=function(){a.Qi&&c.AdType.CLIENT_SIDE===a.Qi&&(a.gs(),a.vn=c.PlayerState.UNKNOWN),a.Ns(),a.Qi=null,a.Gi=null},this.Os=function(){return a.He},this._s=function(){return a.Qi},this.getContentMetadata=function(){return this.Et},this.Xi=function(){this.Ie=null,this.ye=null,this.Et=null,this.me=null,this.vn=l.PlayerState.UNKNOWN,this.De=-1,this.be=-1,this.On=[],this.Pe=null,this.Me=null,this.Le=-2,this.En=-1,this.I=l.DEFAULT_SIGNAL_STRENGTH,this.Ue=null,this.Xn=null,this.C=null,this.A=null,this.Bi=null,this.Ve=null,this.ke=null,this.Fe=null,this.He=null,this.Qi=null,this.Gi=null,a.oe=null,a.he=h.NO_SESSION_KEY}},L=a.PlayerMonitorImpl=function(){var a=this;a.te=null,a.oe=null,a.he=h.NO_SESSION_KEY,(function(b,c){K.call(this,c),a.te=b}).apply(this,arguments),this.getPHT=function(){return a.Ye()},this.getBufferLength=function(){return a.Je()},this.getRenderedFrameRate=function(){return a.Qe()},this.getSignalStrength=function(){return a.$e()},this.qe=function(){a.oe&&a.As!==h.NO_SESSION_KEY&&(a.je()?a.oe.setPlayerSeekStart(a.We()):a.oe.setPlayerSeekEnd())},this.Ge=function(){a.oe&&(a.oe.setPlayerState(a.Be()),a.Xe()>0&&a.oe.setBitrateKbps(a.Xe()),a.ts()>0&&a.oe.setVideoResolutionWidth(a.ts()),a.es()>0&&a.oe.setVideoResolutionHeight(a.es()),a.Ze()&&a.oe.setCDNServerIP(a.Ze()),e.lt(a.Jn())&&a.oe.setDroppedFramesTotal(a.Jn()))},this.St=function(){a.he!==h.NO_SESSION_KEY&&a.te&&a.te.updateContentMetadata(a.he,a.Et)},this.re=function(){if(a.oe){a.ke&&e.It(a.ke)>0&&(a.ke[c.MODULE_NAME]&&a.ke[c.MODULE_VERSION]&&(g=a.ke[c.MODULE_NAME],h=a.ke[c.MODULE_VERSION],e.wt(g)&&e.wt(h)&&a.oe.setModuleNameAndVersion(g,h)),a.ke[c.FRAMEWORK_NAME]&&(i=a.ke[c.FRAMEWORK_NAME],e.wt(i)&&a.oe.setPlayerType(i)),a.ke[c.FRAMEWORK_VERSION]&&(i=a.ke[c.FRAMEWORK_VERSION],e.wt(i)&&a.oe.setPlayerVersion(i)));var g,h,i,d=a.Es();a.ps();for(var b=0;b<d.length;b++){var f=d[b];a.oe.Hn(f)}}},this.gs=function(){a.oe&&a.he!==h.NO_SESSION_KEY&&(a.Ge(),this.Cs())},this.Ot=function(){a.oe&&a.he!==h.NO_SESSION_KEY&&(a.Ge(),a.te._t(a.he))},this.Cs=function(){a.te&&a.he!==c.NO_SESSION_KEY&&a.te.adEnd(a.he)},this.Ss=function(d,e,f){var b;a.oe&&a.he!==c.NO_SESSION_KEY&&(b=null,c.AdType.CLIENT_SIDE===d?b=h.AdStream.SEPARATE:c.AdType.SERVER_SIDE===d&&(b=h.AdStream.CONTENT),a.Is(b,e,f))},this.gt=function(){a.oe&&a.he!==c.NO_SESSION_KEY&&a.te.Nt(a.he)},this.Is=function(b,d,e){a.te&&a.he!==c.NO_SESSION_KEY&&a.te.adStart(a.he,b,d,e)},this.se=function(){if(a.te){a.oe=a.te.getPlayerStateManager(!0),a.re(),a.oe.setClientMeasureInterface(this);try{var b;a.Et&&a.Et.custom&&!a.Et.custom[c.UTM_TRACKING_URL]&&(Array.prototype.filter||(Array.prototype.filter=function(d){if(void 0===this||null===this)throw new TypeError;var b=Object(this),f=b.length>>>0;if("function"!=typeof d)throw new TypeError;for(var c,e=[],g=arguments.length>=2?arguments[1]:void 0,a=0;a<f;a++)a in b&&(c=b[a],d.call(g,c,a,b)&&e.push(c));return e}),""!==(b=e.ys().split("?").join("").split("&").filter(function(a){return 2===a.split("=").length&&a.split("=")[0].toLowerCase().indexOf("utm_")>=0}).join("&"))&&(a.Et.custom[c.UTM_TRACKING_URL]=b))}catch(d){a.c.error("PlayerMonitorImpl _createSession : "+d)}a.he=a.te.createSession(a.Et,a.oe,!0)}},this.ls=function(){a.te&&(a.oe&&(a.oe.setPlayerState(c.PlayerState.STOPPED),a.oe=null),a.he!==c.NO_SESSION_KEY&&(a.te.cleanupSession(a.he),a.he=c.NO_SESSION_KEY))},this.qn=function(){if(a.te&&a.he!==h.NO_SESSION_KEY){var c=a.Es();a.ps();for(var b=0;b<c.length;b++){var d=c[b];a.te.reportError(a.he,d.ms(),d.Ds())}}},this.Rs=function(){a.he!==h.NO_SESSION_KEY&&a.te&&a.te.sendCustomEvent(a.he,a.vs(),a.ds())},this.us=function(){var f,g=a.os(),h=!1,d=!1;for(f in g){var b=g[f];if(e.wt(f)&&null!=b)switch(f){case c.STREAM_URL:d=!0,a.Et.streamUrl=b;break;case c.ASSET_NAME:d=!0,a.Et.assetName=b;break;case c.DEFAULT_RESOURCE:d=!0,a.Et.defaultResource=b;break;case c.VIEWER_ID:d=!0,a.Et.viewerId=b;break;case c.PLAYER_NAME:d=!0,a.Et.applicationName=b;break;case c.DURATION:d=!0,a.Et.duration=b;break;case c.IS_LIVE:d=!0,a.Et.streamType=b;break;case c.ENCODED_FRAMERATE:d=!0,a.Et.encodedFrameRate=b;break;case c.MODULE_NAME:case c.MODULE_VERSION:case c.FRAMEWORK_NAME:case c.FRAMEWORK_VERSION:h=!0,a.ke[f]=b;break;case c.APPLICATION_VERSION:default:d=!0,a.Et.custom[f]=b}}h&&this.re(),d&&this.St()},this.Ts=function(){this.bs(c.Events.POD_START)},this.Ns=function(){this.bs(c.Events.POD_END)},this.bs=function(g){var d,b,e,f;a.te&&a.he!==c.NO_SESSION_KEY&&(b={},(d=this.Os())&&((e=d[c.POD_POSITION])&&(b[c.POD_POSITION]=e),(e=d[c.POD_INDEX])&&(b[c.POD_INDEX]=e+""),g!==c.Events.POD_START||(f=d[c.POD_DURATION])&&(b[c.POD_DURATION]=f+"")),(f=this._s())&&(b[c.AD_TYPE]=f),a.te.sendCustomEvent(a.he,g,b))},this.ze=function(b){a.oe.setDroppedFramesCount(b)},this.Ps=function(a){this.he===c.NO_SESSION_KEY&&a!==c.NO_SESSION_KEY&&(this.he=a)},this.ue=function(){return this.he},this.Vt=function(){return a.te.getSessionId(this.he)},this.kt=function(){return a.te.getClientId(this.he)},this.Ft=function(b,c){a.te.Ft(this.he,b,c)},L.prototype=Object.create(K.prototype),L.prototype.constructor=L};b.Impl=b.Impl||{},b.Impl.Html5Http=function(){(function(){}).apply(this,arguments),this.makeRequest=function(){return this.makeRequestStandard.apply(this,arguments)},this.makeRequestStandard=function(d,e,f,b,c,g){var a=new XMLHttpRequest;return a.open(d,e,!0),b&&a.overrideMimeType&&(a.overrideMimeType=b),b&&a.setRequestHeader&&a.setRequestHeader("Content-Type",b),c>0&&(a.timeout=c,a.ontimeout=function(){a.ontimeout=a.onreadystatechange=null,g&&g(!1,"timeout after "+c+" ms")}),a.onreadystatechange=function(){4===a.readyState&&(a.ontimeout=a.onreadystatechange=null,200===a.status?g&&g(!0,a.responseText):g&&g(!1,"http status "+a.status))},a.send(f),null},this.release=function(){}},b.Impl=b.Impl||{},b.Impl.Html5Logging=function(){(function(){}).apply(this,arguments),this.consoleLog=function(b,a){"undefined"!=typeof console&&(console.log&&a===i.LogLevel.DEBUG||a===i.LogLevel.INFO?console.log(b):console.warn&&a===i.LogLevel.WARNING?console.warn(b):console.error&&a===i.LogLevel.ERROR&&console.error(b))},this.release=function(){}},b.Impl=b.Impl||{},b.Impl.Html5Metadata=function(){(function(){}).apply(this,arguments),this.getBrowserName=function(){return null},this.getBrowserVersion=function(){return null},this.getDeviceBrand=function(){return null},this.getDeviceManufacturer=function(){return null},this.getDeviceModel=function(){return null},this.getDeviceType=function(){return null},this.getDeviceVersion=function(){return null},this.getFrameworkName=function(){return null},this.getFrameworkVersion=function(){return null},this.getOperatingSystemName=function(){return null},this.getOperatingSystemVersion=function(){return null},this.getDeviceCategory=function(){return null},this.getScreenWidth=function(){return"undefined"!=typeof window&&window&&window.screen&&window.screen.width?window.screen.width.toString():null},this.getScreenHeight=function(){return"undefined"!=typeof window&&window&&window.screen&&window.screen.height?window.screen.height.toString():null},this.getScaleFactor=function(){return"undefined"!=typeof window&&window&&window.devicePixelRatio?window.devicePixelRatio.toString():null},this.release=function(){}},b.Impl=b.Impl||{},b.Impl.Html5Storage=function(){(function(){}).apply(this,arguments),this.saveData=function(b,c,d,a){try{localStorage.setItem(b+"."+c,d),a(!0,null)}catch(e){a(!1,e.toString())}},this.loadData=function(b,c,a){try{a(!0,localStorage.getItem(b+"."+c))}catch(d){a(!1,d.toString())}},this.release=function(){}},b.Impl=b.Impl||{},b.Impl.Html5Time=function(){(function(){}).apply(this,arguments),this.getEpochTimeMs=function(){return(new Date).getTime()},this.release=function(){}},b.Impl=b.Impl||{},b.Impl.Html5Timer=function(){(function(){}).apply(this,arguments),this.createTimer=function(a,b){var c=setInterval(a,b);return function(){-1!==c&&(clearInterval(c),c=-1)}},this.release=function(){}};var M,N,O,_,u,P=a.VideoAnalytics=function(){var a=this;a.Hi=null,a.v=null,a.Bi=null,a.ki=null,a.ji=null,this.release=function(){a.c,a.ki&&a.ki.Ui()&&a.ki.Fi(!1),void 0!==b.ProxyMonitor&&a.ji&&(b.ProxyMonitor.release(a.ji),a.ji=null),a.ki&&(a.ki.Yi(null),a.ki.Xi(),a.ki=null),a.Bi=null},(function(d,b){a.Hi=d,a.v=b,a.Bi=b.buildTimer(c.version),a.ki=new L(a.Hi,a.Bi),J.call(this)}).apply(this,arguments),this.reportPlaybackRequested=function(b){a.c,a.ki&&(e.It(b)>0&&a.setContentInfo(b),a.ki.Ui()||a.ki.Fi(!0))},this.reportPlaybackEnded=function(){a.c,a.ki&&a.ki.Ui()&&(a.ki.Fi(!1),void 0!==b.ProxyMonitor&&a.ji&&(b.ProxyMonitor.release(a.ji),a.ji=null),a.ki.Yi(null))},this.reportPlaybackFailed=function(c,b){a.ki&&(e.It(b)>0&&a.setContentInfo(b),a.ki.Ui()||a.ki.Fi(!0),a.c,a.reportPlaybackError(c,h.ErrorSeverity.FATAL),a.reportPlaybackEnded())},this.setContentInfo=function(b){0>=e.It(b)||a.ki&&(a.c,a.ki.xi(b))},this.setPlayerInfo=function(b){0>=e.It(b)||a.ki&&(a.c,a.ki.xi(b))},this.reportPlaybackMetric=function(){0!==arguments.length&&(1===arguments.length?a.qi(arguments[0]):2===arguments.length?a.qi(arguments[0],arguments[1]):3===arguments.length?a.qi(arguments[0],arguments[1],arguments[2]):4===arguments.length&&a.qi(arguments[0],arguments[1],arguments[2],arguments[3]))},this.reportPlaybackError=function(c,b){a.ki&&e.wt(c)&&(a.c,b=new ai(c,b),a.ki.Hn(b))},this.reportPlaybackEvent=function(b,d){if(e.wt(b)&&a.ki&&(a.c,a.ki))switch(b){case c.Events.USER_WAIT_STARTED:case c.Events.BUMPER_VIDEO_STARTED:a.ki.gt();break;case c.Events.USER_WAIT_ENDED:case c.Events.BUMPER_VIDEO_ENDED:a.ki.Ot();break;default:a.ki.Ji(b,d)}},this.setCallback=function(b){a.c,a.ki&&a.ki.Yi(b)},this.reportAdBreakStarted=function(b,c,d){a.ki&&(a.c,a.ki.Zi(b,c,d))},this.reportAdBreakEnded=function(){a.ki&&(a.c,a.ki.zi())},this.setPlayer=function(d,f){var g,e;void 0!==d&&(f&&(g=f[c.CONVIVA_MODULE],e=f[c.MEDIA_ELEMENT]),void 0!==g?b.ProxyMonitor=g.ProxyMonitor:"undefined"!=typeof ConvivaModule&&(b.ProxyMonitor=ConvivaModule.ProxyMonitor),void 0!==b.ProxyMonitor&&(a.c,!d&&a.ji?(b.ProxyMonitor.release(a.ji),a.ji=null):d?(a.ji&&b.ProxyMonitor.release(a.ji),a.c,a.ji=void 0!==e?b.ProxyMonitor.initConvivaDropIn(d,e,a.v,this,b):b.ProxyMonitor.initConvivaDropIn(d,a.v,this,b)):d|| void 0===e||(a.ji=b.ProxyMonitor.initConvivaDropIn(d,e,a.v,this,b))))},this.setAdAnalytics=function(b){b?a.getAdType()&&(a.getAdType()===c.AdType.SERVER_SIDE?a.Li=b.getAdPlayerMonitor():a.getAdType()===c.AdType.CLIENT_SIDE&&a.c):a.Li=null},this.configureExistingSession=function(b){b!==c.NO_SESSION_KEY&&a.ki&&(a.c,a.ki.Ps(b))},this.getSessionId=function(){return a.ki?(a.c,a.ki.Vt()):c.NO_SESSION_KEY},this.getClientId=function(){return a.ki?(a.c,a.ki.kt()):null},this.Wi=function(){return a.c,this.ki},this.getAdType=function(){return a.ki?a.ki.Qi:null},this.$i=function(){return a.ki?a.ki.Gi:null},P.prototype=Object.create(J.prototype),P.prototype.constructor=P};function Q(a){throw{name:"SyntaxError",message:a,at:M,text:O}}function R(a){return a&&a!==N&&Q("Expected '"+a+"' instead of '"+N+"'"),N=O.charAt(M),M+=1,N}function S(){var b,a="";for("-"===N&&R(a="-");N>="0"&&N<="9";)a+=N,R();if("."===N)for(a+=".";R()&&N>="0"&&N<="9";)a+=N;if("e"===N||"E"===N)for(a+=N,R(),"-"!==N&&"+"!==N||(a+=N,R());N>="0"&&N<="9";)a+=N,R();if(!isNaN(b=+a))return b;Q("Bad number")}function T(){var c,d,a,b="";if('"'===N)for(;R();){if('"'===N)return R(),b;if("\\"===N){if(R(),"u"===N){for(d=a=0;d<4&&(c=parseInt(R(),16),isFinite(c));d+=1)a=16*a+c;b+=String.fromCharCode(a)}else{if("string"!=typeof _[N])break;b+=_[N]}}else b+=N}Q("Bad string")}function U(){for(;N&&N<=" ";)R()}a.JsonParse=(_={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},u=function(){switch(U(),N){case"{":return function(){var a,b={};if("{"===N){if(R("{"),U(),"}"===N)return R("}"),b;for(;N;){if(a=T(),U(),R(":"),Object.hasOwnProperty.call(b,a)&&Q('Duplicate key "'+a+'"'),b[a]=u(),U(),"}"===N)return R("}"),b;R(","),U()}}Q("Bad object")}();case"[":return function(){var a=[];if("["===N){if(R("["),U(),"]"===N)return R("]"),a;for(;N;){if(a.push(u()),U(),"]"===N)return R("]"),a;R(","),U()}}Q("Bad array")}();case'"':return T();case"-":return S();default:return(N>="0"&&N<="9"?S:function(){switch(N){case"t":return R("t"),R("r"),R("u"),R("e"),!0;case"f":return R("f"),R("a"),R("l"),R("s"),R("e"),!1;case"n":return R("n"),R("u"),R("l"),R("l"),null}Q("Unexpected '"+N+"'")})()}},function(a,b){return O=a,M=0,N=" ",a=u(),U(),N&&Q("Syntax error"),"function"==typeof b?function g(d,e){var c,f,a=d[e];if(a&&"object"==typeof a)for(c in a)Object.hasOwnProperty.call(a,c)&&(void 0!==(f=g(a,c))?a[c]=f:delete a[c]);return b.call(d,e,a)}({"":a},""):a});var v,V,W,w,X,p=a.JSON2={};function Y(a){return a<10?"0"+a:a}function Z(a){return v.lastIndex=0,v.test(a)?'"'+a.replace(v,function(a){var b=w[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+Y(this.getUTCMonth()+1)+"-"+Y(this.getUTCDate())+"T"+Y(this.getUTCHours())+":"+Y(this.getUTCMinutes())+":"+Y(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}),"function"!=typeof p.stringify&&(v=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,w={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},p.stringify=function(d,a,b){var c;if(W=V="","number"==typeof b)for(c=0;c<b;c+=1)W+=" ";else"string"==typeof b&&(W=b);if((X=a)&&"function"!=typeof a&&("object"!=typeof a||"number"!=typeof a.length))throw new Error("JSON2.stringify");return function h(i,j){var b,e,d,f,c,g=V,a=j[i];switch(a&&"object"==typeof a&&"function"==typeof a.toJSON&&(a=a.toJSON(i)),"function"==typeof X&&(a=X.call(j,i,a)),typeof a){case"string":return Z(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";if(V+=W,c=[],Object.prototype.toString.apply(a)===Object.prototype.toString.apply([])){for(f=a.length,b=0;b<f;b+=1)c[b]=h(b,a)||"null";return d=0===c.length?"[]":V?"[\n"+V+c.join(",\n"+V)+"\n"+g+"]":"["+c.join(",")+"]",V=g,d}if(X&&"object"==typeof X)for(f=X.length,b=0;b<f;b+=1)"string"==typeof X[b]&&(d=h(e=X[b],a))&&c.push(Z(e)+(V?": ":":")+d);else for(e in a)Object.prototype.hasOwnProperty.call(a,e)&&(d=h(e,a))&&c.push(Z(e)+(V?": ":":")+d);return d=0===c.length?"{}":V?"{\n"+V+c.join(",\n"+V)+"\n"+g+"}":"{"+c.join(",")+"}",V=g,d}}("",{"":d})});var j=a.Ms={};j.Ls="0123456789abcdef",j.Us=function(c){for(var b="",a=7;a>=0;a--)b+=j.Ls.charAt(c>>4*a&15);return b},j.Vs=function(c){for(var d=1+(c.length+8>>6),b=new Array(16*d),a=0;a<16*d;a++)b[a]=0;for(a=0;a<c.length;a++)b[a>>2]|=c.charCodeAt(a)<<24-a%4*8;return b[a>>2]|=128<<24-a%4*8,b[16*d-1]=8*c.length,b},j.ks=function(a,b){var c=(65535&a)+(65535&b);return(a>>16)+(b>>16)+(c>>16)<<16|65535&c},j.Fs=function(a,b){return a<<b|a>>>32-b},j.Hs=function(d,a,b,c){return d<20?a&b| ~a&c:!(d<40)&&d<60?a&b|a&c|b&c:a^b^c},j.Bs=function(a){return a<20?1518500249:a<40?1859775393:a<60?-1894007588:-899497514},j.Gs=function(b){for(var c="",a=0;a<b.length;a++)c+=String.fromCharCode(b[a]);return j.js(c)},j.js=function(i){if(""===i)return"";for(var k,l=j.Vs(i),f=new Array(80),b=1732584193,c=-271733879,d=-1732584194,e=271733878,g=-1009589776,h=0;h<l.length;h+=16){for(var m=b,n=c,o=d,p=e,q=g,a=0;a<80;a++)f[a]=a<16?l[h+a]:j.Fs(f[a-3]^f[a-8]^f[a-14]^f[a-16],1),k=j.ks(j.ks(j.Fs(b,5),j.Hs(a,c,d,e)),j.ks(j.ks(g,f[a]),j.Bs(a))),g=e,e=d,d=j.Fs(c,30),c=b,b=k;b=j.ks(b,m),c=j.ks(c,n),d=j.ks(d,o),e=j.ks(e,p),g=j.ks(g,q)}return j.Us(b)+j.Us(c)+j.Us(d)+j.Us(e)+j.Us(g)};var d=a.CwsProtocol=function(){this.Ks=function(b,c,d,a){return a.seq=b,a.st=c,a.t=d,a},this.Ws=function(a,b){var c=d.xs;return this.Ks(a,b,c,{})}};d.version="2.6",d.qs="/0/wsg",d.P="0",d.Ys=-1,d.Js=!1,d.Xs=2,d.Qs=-1,d.Zs=-1,d.zs=1e3,d.$s="sdk.js.1",d.no="CwsStateChangeEvent",d.io="CwsErrorEvent",d.xs="CwsSessionEndEvent",d.eo="CwsCustomEvent",d.so="CwsSeekEvent",d.oo="CwsDataSamplesEvent",d.ro="ok",d.uo="err",d.ho="clid",d.ao="cfg",d.fo="evs",d.co="maxhbinfos",d.lo="slg",d.vo="hbi",d.do="gw",d.Eo="fp",d.po="csi_en",d.Ro="CwsSessionHb",d.wo="t",d.To="st",d.So="sst",d.go="lv",d.No="seq",d.Oo="cid",d._o="clid",d.Ao="clv",d.Co="pver",d.Io="iid",d.yo="sid",d.mo="vid",d.Do="an",d.bo="pn",d.Po="tags",d.Mo="sf",d.Lo="evs",d.Uo="lg",d.Vo="hbinfos",d.ko="sdk",d.Fo="pj",d.Ho="ps",d.Bo="br",d.Go="cl",d.jo="efps",d.Ko="afps",d.Wo="rfpstot",d.xo="rfpscnt",d.qo="rs",d.Yo="pht",d.Jo="bl",d.Xo="url",d.Qo="caps",d.Zo="pm",d.zo="w",d.$o="h",d.tr="ct",d.nr="le",d.ir="dftot",d.er="dfcnt",d.sr="ss",d.or="csi_n",d.rr="csi_t",d.ur="csi_l",d.hr="csi_v",d.ar="csi_c",d.fr="sch",d.cr="br",d.lr="brv",d.vr="dvb",d.dr="dvma",d.Er="dvm",d.pr="dvt",d.Rr="dvv",d.wr="sw",d.Tr="sh",d.Sr="scf",d.gr="fw",d.Nr="fwv",d.Or="cc",d._r="mn",d.Ar="mv",d.Cr="os",d.Ir="osv",d.yr="cat",d.mr="caps",d.Dr="t",d.br="seq",d.Pr="st",d.Mr="act",d.Lr="skto",d.Ur="err",d.Vr="ft",d.kr="new",d.Fr="old",d.Hr="name",d.Br="attr",d.Gr="seq",d.jr="err",d.Kr="rtt",d.Wr="ad",d.xr="csi",d.qr=function(a){switch(a){case l.PlayerState.STOPPED:return d.Yr;case l.PlayerState.PLAYING:return d.Jr;case l.PlayerState.BUFFERING:return d.Xr;case l.PlayerState.PAUSED:return d.Qr;case l.PlayerState.NOT_MONITORED:return d.Zr;default:return d.zr}},d.Yr=1,d.Jr=3,d.Xr=6,d.Qr=12,d.Zr=98,d.zr=100,d.$r={tu:0,ft:1,nu:2,iu:4},d.eu={su:0};var aa=a.LibJSONInterface=function(){this.ou=function(b){var a=null;try{a=p.stringify(b)}catch(c){}return a},this.ru=function(c){var b=null;try{b=a.JsonParse(c)}catch(d){return b}return e.uu(b)||(b=null),b}},ab=a.CwsHeartbeat=function(){this.hu={},(function(){}).apply(this,arguments),this.get=function(){return this.hu},this.au=function(a,b){this.hu[a]=b},this.fu=function(a,b,c){this.hu[a]||(this.hu[a]={}),this.hu[a][b]=c},this.cu=function(a){this.au(d.wo,a)},this.lu=function(a){this.au(d.To,a)},this.vu=function(a){this.au(d.So,a)},this.du=function(a){this.au(d.go,a)},this.Eu=function(a){this.au(d.No,a)},this.pu=function(a){this.au(d.Oo,a)},this.Ru=function(a){this.au(d._o,a)},this.wu=function(a){this.au(d.Ao,a)},this.Tu=function(a){this.au(d.Co,a)},this.Su=function(a){this.au(d.mr,a)},this.gu=function(a){this.au(d.yo,a)},this.Nu=function(a){this.au(d.Io,a)},this.Ou=function(a){this.au(d.mo,a)},this._u=function(a){this.au(d.Do,a)},this.Au=function(a){this.au(d.bo,a)},this.Cu=function(a){this.au(d.Po,a)},this.Iu=function(a){this.au(d.Mo,a)},this.yu=function(a){this.au(d.Qo,a)},this.mu=function(a){this.au(d.Lo,a)},this.Du=function(a){this.au(d.ko,a)},this.bu=function(a){this.au(d.Uo,a)},this.Pu=function(a){this.au(d.Vo,a)},this.we=function(a){this.au(d.Ho,a)},this.Mu=function(a){this.au(d.Fo,a)},this.Lu=function(a){this.au(d.Go,a)},this.Uu=function(a){this.au(d.Bo,a)},this.Vu=function(a){this.au(d.qo,a)},this.ku=function(a){this.au(d.jo,a)},this.Fu=function(a){this.au(d.Ko,a)},this.Hu=function(a){this.au(d.xo,a)},this.Bu=function(a){this.au(d.Wo,a)},this.Gu=function(a){this.fu(d.Zo,d.fr,a)},this.ju=function(a){this.fu(d.Zo,d.cr,a)},this.Ku=function(a){this.fu(d.Zo,d.lr,a)},this.Wu=function(a){this.fu(d.Zo,d.vr,a)},this.xu=function(a){this.fu(d.Zo,d.dr,a)},this.qu=function(a){this.fu(d.Zo,d.Er,a)},this.Yu=function(a){this.fu(d.Zo,d.pr,a)},this.Ju=function(a){this.fu(d.Zo,d.Rr,a)},this.Xu=function(a){this.fu(d.Zo,d.gr,a),this.au(d.gr,a)},this.Qu=function(a){this.fu(d.Zo,d.Nr,a),this.au(d.Nr,a)},this.Zu=function(a){this.fu(d.Zo,d.Cr,a.toUpperCase())},this.zu=function(a){this.fu(d.Zo,d.Ir,a)},this.$u=function(a){this.fu(d.Zo,d.yr,a)},this.th=function(a){this.fu(d.Zo,d.wr,a)},this.nh=function(a){this.fu(d.Zo,d.Tr,a)},this.ih=function(a){this.fu(d.Zo,d.Sr,a)},this.eh=function(a){this.au(d.ir,a)},this.ze=function(a){this.au(d.er,a)},this.sh=function(a){this.au(d.Yo,a)},this.oh=function(a){this.au(d.Jo,a)},this.rh=function(a){this.au(d.Xo,a)},this.uh=function(a){this.au(d.zo,a)},this.hh=function(a){this.au(d.$o,a)},this.ah=function(a){this.au(d.tr,a)},this.fh=function(a){this.au(d.nr,a)},this.ch=function(){this.au(d.Wr,!0)},this.lh=function(a){this.au(d.sr,a)},this.setModuleName=function(a){this.fu(d.Or,d._r,a)},this.vh=function(a){this.fu(d.Or,d.Ar,a)},this.dh=function(a){this.au(d.xr,a)},this.Eh=function(a){a&&this.au(d.or,a)},this.ph=function(a){a&&this.au(d.rr,a)},this.Rh=function(a){a&&this.au(d.ur,a)},this.wh=function(a){a&&this.au(d.hr,a)},this.Th=function(a){a&&this.au(d.ar,a)}},q=a.CwsSession=function(){var a=this;a.Sh=null,a.Et=null,a.gh=0,a.Nh=0,a.Oh=d.$r.tu,a._h=d.eu.su,a.Ah=[],a.Ch=-1,a.ln=-2,a.Xn=-1,a.Ih=-1,a.yh=null,a.vn=l.PlayerState.UNKNOWN,a.fn=-1,a.mh=-1,a.rn=null,a.Sn=-1,a.gn=-1,a.oe=null,a.nn=null,a.sn=null,a.Dh=null,a.bh=null,a.Ph={},a.Mh=null,a.Lh=null,a.Uh=null,a.Vh=null,a.kh=null,a.Fh=null,a.Hh=null,a.Bh=null,a.Gh=null,a.jh=null,a.Kh=null,a.Wh=null,a.xh=null,a.qh=null,a.Yh=null,a.wn=null,a.Tn=null,a.A=null,a.C=null,a.Ue=null,a.Jh=null,a.Xh=!1,a.Qh=!1,a.Zh=!1,a.zh=!1,a.$h=null,a.ta=1e3,a.na=0,a.ia=0,a.ea={},a.N={},a.sa=!1,a.oa=null,a.ra=null,a.ua=null,a.ha=null,a.aa=null,a.fa=null,a.ca=12e4,a.la=d.Js,a.va=!1,a.da=null,a.hi=null,(function(b,c,d,e,f,g,h,i,j,l,m,n,o){this.Ea=b,this.Hi=c,this.ui=d,this.c=e,this.c.setModuleName("CwsSession"),this.w=f,this.Bi=g,this.pa=h,this.Ra=i,this.wa=j,this.ai=l,this.Ta=m,this.Et=n,this.Et&&(a.fn=this.Et.encodedFrameRate,a.rn=this.Et.streamUrl,a.mh=this.Et.duration),this.Ta&&(a.da=a.Ta.get(k.D)),a.hi=o}).apply(this,arguments),this.ut=function(){this.Ta=null,this.ai=null,this.R=null,this.wa=null,this.Ra=null,this.pa=null,this.Bi=null,this.w=null,this.c=null,this.ui=null,this.Hi=null,this.Ea.Sa(),this.Ea=null,this.Jh=null,this.Zh=!0},this.ga=function(b){this.Na=b,this.Oa=this.Na.Oa,this.c.gu(this.Na.S),this.gh=this.wa.current(),this._a()||this.Aa()?(this.Oh+=q.Ca,a.c.info("start(): assetName="+a.Et.assetName)):a.c.info("start()"+a.Ia())},this.ya=function(){this.zh=!0},this.ma=function(){this.c.debug("initialize()"),(this._a()||this.Aa()||this.Da())&&(a.ba(),a.Pa(),a.Ma(),(this._a()||this.Aa())&&a.La())},this.Ua=function(){this.c.debug("end(): schedule the last hb before session cleanup"+a.Ia()),this.Va(),this.ka(),this.Fa(),this.Ha()},this.Ba=function(){this.zh||(this.Ha(),this.Ga())},this.ju=function(b){var c=a.Mh;c!==b&&b&&(a.c.debug("Change browserName from "+c+" to "+b),a.Mh=b)},this.Ku=function(b){var c=a.Lh;c!==b&&b&&(a.c.debug("Change browserVersion from "+c+" to "+b),a.Lh=b)},this.Wu=function(b){var c=a.Uh;c!==b&&b&&(a.c.debug("Change deviceBrand from "+c+" to "+b),a.Uh=b)},this.xu=function(b){var c=a.Vh;c!==b&&b&&(a.c.debug("Change deviceManufacturer from "+c+" to "+b),a.Vh=b)},this.qu=function(b){var c=a.kh;c!==b&&b&&(a.c.debug("Change deviceModel from "+c+" to "+b),a.kh=b)},this.Yu=function(b){var c=a.Fh;c!==b&&b&&(a.c.debug("Change deviceType from "+c+" to "+b),a.Fh=b)},this.Ju=function(b){var c=a.Hh;c!==b&&b&&(a.c.debug("Change deviceVersion from "+c+" to "+b),a.Hh=b)},this.Zu=function(b){var c=a.jh;c!==b&&b&&(a.c.debug("Change operatingSystemName from "+c+" to "+b),a.jh=b)},this.zu=function(b){var c=a.Kh;c!==b&&b&&(a.c.debug("Change operatingSystemVersion from "+c+" to "+b),a.Kh=b)},this.$u=function(b){var c=a.Wh;c!==b&&b&&(a.c.debug("Change deviceCategory from "+c+" to "+b),a.Wh=b)},this.th=function(b){var c=a.xh;c!==b&&b&&(a.c.debug("Change screenWidth from "+c+" to "+b),a.xh=b)},this.nh=function(b){var c=a.qh;c!==b&&b&&(a.c.debug("Change screenHeight from "+c+" to "+b),a.qh=b)},this.ih=function(b){var c=a.Wh;c!==b&&b&&(a.c.debug("Change scaleFactor from "+c+" to "+b),a.Yh=b)},this.ja=function(){return a.Bh},this.Xu=function(b){var c=a.Bh;c!==b&&b&&(a.c.debug("Change frameworkName from "+c+" to "+b),a.Bh=b)},this.Ka=function(){return a.Gh},this.Qu=function(b){var c=a.Gh;c!==b&&b&&(a.c.debug("Change frameworkVersion from "+c+" to "+b),a.Gh=b)},this.rh=function(b){var c;a.Et.streamUrl||(c=a.rn)!==b&&b&&(a.c.debug("Change stream url from "+c+" to "+b),a.rn=b)},this.Wa=function(){a.ka(),a.va||(a.xa(),a.fa=a.Bi.create(a.xa,a.ca,"CwsSession.startCdnTimer"),a.c.debug("fetching cdn ip timer started"))},this.ka=function(){a.fa&&(a.fa(),a.qa(null,null,null,null,null),a.fa=null)},this.xa=function(){a.c.debug("detectCDNServerIp(): For "+a.rn),a.la?a.Ya():a.ka()},this.Ya=function(){try{var b;"function"==typeof XMLHttpRequest||"object"==typeof XMLHttpRequest?((b=new XMLHttpRequest).open("HEAD",a.rn,!0),b.setRequestHeader("Pragma","akamai-x-cache-on"),b.onreadystatechange=function(){4===this.readyState&&(200===this.status&&(this.getAllResponseHeaders().indexOf("x-cache")>=0||this.getAllResponseHeaders().indexOf("X-Cache")>=0)?a.qa("Akamai","header","X-Cache",""+this.getResponseHeader("X-Cache"),""+this.status):a.qa("null","header","null","null",""+this.status))},b.send()):a.c.info("xmlhttpreq is not available here to fetch CDN Server Ip")}catch(c){a.c.info("Exception caught in makeAkamaiHeadRequest")}},this.qa=function(e,f,g,h,i){var b={},c={};a.oa!==e&&(null!==a.oa&&(c[d.or]=a.oa),a.oa=e,null===a.oa?b[d.or]="null":b[d.or]=a.oa),a.ra!==f&&(null!==a.ra&&(c[d.rr]=a.ra),a.ra=f,null===a.ra?b[d.rr]="null":b[d.rr]=a.ra),a.ua!==g&&(null!==a.ua&&(c[d.ur]=a.ua),a.ua=g,null===a.ua?b[d.ur]="null":b[d.ur]=a.ua),a.ha!==h&&(null!==a.ha&&(c[d.hr]=a.ha),a.ha=h,null===a.ha?b[d.hr]="null":b[d.hr]=a.ha),a.aa!==i&&(null!==a.aa&&(c[d.ar]=a.aa),a.aa=i,null===a.aa?b[d.ar]="null":b[d.ar]=a.aa),"{}"!==JSON.stringify(b)&&a.Ja(b,c)},this.Xa=function(b){var c=a.ln;c!==b&&b>0&&(a.c.info("Change bitrate from "+c+" to "+b),a.Qa(c,b),a.ln=b)},this.eh=function(b){var c=a.Xn;c!==b&&b>=0&&(a.c.info("Change dropped frames total from "+c+" to "+b),a.Za(c,b),a.Xn=b)},this.ze=function(d){var c=a.Ih,b=d+(-1===a.Ih?0:a.Ih);c!==d&&b>=0&&(a.c.info("Change dropped frames count from "+c+" to "+b),a.za(c,b),a.Ih=b)},this.Vu=function(b){var c=a.yh;c!==b&&b&&(a.c.info("Change resource from "+c+" to "+b),a.yh=b)},this._u=function(b){a.nn!==b&&b&&(a.c.info("Change assetName from "+a.nn+" to "+b),a.nn=b)},this.du=function(b){var c=a.bh;c!==b&&e.Ii(b)&&(a.c.info("Change isLive from "+c+" to "+b),a.bh=b)},this.Ou=function(b){var c=a.sn;c!==b&&b&&(a.c.info("Change viewerId from "+c+" to "+b),a.sn=b)},this.Au=function(b){var c=a.Dh;c!==b&&b&&(a.c.info("Change playerName from "+c+" to "+b),a.Dh=b)},this.Cu=function(b){var c=a.Ph;!e.$a(c,b)&&b&&(a.c.info("Change tags from "+e.tf(c)+" to "+e.tf(b)),a.Ph=b)},this.ku=function(b){a.Et.encodedFrameRate>0||(a.c.debug("setEncodedFrameRate(): "+b),a.fn=b)},this.Lu=function(b){a.Et.duration>0||(a.c.debug("setContentLength(): "+b),a.mh=b)},this.we=function(b){var c;a.Qh||b!==l.PlayerState.PLAYING||(a.Qh=!0,e.wt(a.Et.viewerId)||a.c.error("Missing viewerId. viewerId should be updated before first frame is rendered."),e.wt(a.Et.streamType)&&s.StreamType.UNKNOWN!==a.Et.streamType||a.c.error("Missing streamType - Live or VOD. streamType should be updated before first frame is rendered."),e.wt(a.Et.applicationName)||a.c.error("Missing applicationName. applicationName should be updated before first frame is rendered.")),a.vn!==b&&(c=a.vn,a.c.info("setPlayerState(): changing player state from "+c+" to "+b),a.nf(c,b),a.vn=b)},this.if=function(b){var c=a.Sn;c!==b&&b>0&&(a.c.debug("Change stream resolution width from "+c+" to "+b),a.ef(c,b),a.Sn=b)},this.sf=function(b){var c=a.gn;c!==b&&b>0&&(a.c.debug("Change stream resolution height from "+c+" to "+b),a.rf(c,b),a.gn=b)},this.ah=function(b){var c=a.A;c!==b&&b&&(a.c.debug("Change network connection type from "+c+" to "+b),a.uf(c,b),a.A=b)},this.fh=function(b){var c=a.C;c!==b&&b&&(a.c.debug("Change network link encryption from "+c+" to "+b),a.hf(c,b),a.C=b)},this.dh=function(b){a.va=!0,a.ka();var c=a.Ue;c!==b&&e.wt(b)&&(a.c.debug("Change CDN Server IP from "+c+" to "+b),a.af(c,b),a.Ue=b)},this.ff=function(b){var c;a.c.debug("togglePauseJoin()"),a.Xh!==b?(c=a.Xh,b=!a.Xh,a.cf(c,b),a.Xh=!a.Xh):a.c.debug("togglePauseJoin(): same value, ignoring")},this.lf=function(b,c){a.vf(b,c)},this.df=function(b,a){var c;a[d.Dr]=b,a[d.Pr]=this.Ef(),a[d.br]=this.Ea.pf(),this.oe&&(c=o.Rf(this.oe.getPHT(),0,null,-1),b=o.Rf(this.oe.getBufferLength(),0,null,-1),c>=0&&(a[d.Yo]=c),b>0&&(a[d.Jo]=b)),this.Ea.wf(a)},this.Tf=function(b){a.oe=b,a.oe?a.Sf():a.gf()},this.Va=function(){var a=this.Ra.Ws(this.Nf(),this.Ef());this.Ea.wf(a)},this.vf=function(b,c){var a={};a[d.Ur]=b,a[d.Vr]=c,this.df(d.io,a)},this.Qa=function(a,e){var b={},c={};a>0&&(c[d.Bo]=a),b[d.Bo]=e,this.Ja(b,c)},this.Of=function(c,b){var a={};a[d.Mr]=c,b>=0&&(a[d.Lr]=b),this.df(d.so,a)},this.ef=function(a,e){var b={},c={};-1!==a&&(c[d.zo]=a),b[d.zo]=e,this.Ja(b,c)},this.rf=function(a,e){var b={},c={};-1!==a&&(c[d.$o]=a),b[d.$o]=e,this.Ja(b,c)},this.uf=function(a,e){var b={},c={};null!==a&&(c[d.tr]=a),b[d.tr]=e,this.Ja(b,c)},this.hf=function(a,e){var b={},c={};null!==a&&(c[d.nr]=a),b[d.nr]=e,this.Ja(b,c)},this.af=function(a,f){var b={},c={};e.wt(a)&&(c[d.xr]=a),b[d.xr]=f,this.Ja(b,c)},this.Za=function(a,e){var b={},c={};a>=0&&(c[d.ir]=a),b[d.ir]=e,this.Ja(b,c)},this.za=function(a,e){var b={},c={};a>=0&&(c[d.er]=a),b[d.er]=e,this.Ja(b,c)},this.cf=function(c,e){var a={},b={};b[d.Fo]=c,a[d.Fo]=e,this.Ja(a,b)},this.nf=function(c,e){var a={},b={};a[d.Ho]=d.qr(e),b[d.Ho]=d.qr(c),this.Ja(a,b)},this.Ja=function(c,a){var b={};b[d.kr]=c,a&&e.It(a)>0&&(b[d.Fr]=a),this.df(d.no,b)},this._f=function(c,b){var a={};a[d.Hr]=c,e.It(b)>0&&(a[d.Br]=b),this.df(d.eo,a)},this.Fa=function(){a.Sh&&(a.Sh(),a.Sh=null)},this.Ga=function(){a.Fa();var b=1e3*a.ui.heartbeatInterval;a.Sh=a.Bi.create(a.Ha,b,"Session.sendHeartbeat:"+this.Oa)},this.gf=function(){a.$h&&(a.$h(),a.$h=null)},this.Sf=function(){a.gf(),a.$h=a.Bi.create(a.Af,a.ta,"Session.startRfpsTimer")},this.Cf=function(){var b={err:"pending"};b.seq=a.Nh-1,b.sentAt=a.Ef(),b.rtt=-1,a.Ah.push(b);for(var c=0;c<a.Ah.length;c++)"ok"===(b=a.Ah[c]).err&&(a.Ah.splice(c,1),c--)},this.If=function(d,e){for(var c=0;c<a.Ah.length;c++){var b=a.Ah[c];b.seq===d&&(b.rtt=a.Ef()-b.sentAt,b.err=e)}},this.yf=function(d){for(var c=0;c<a.Ah.length;c++){var b=a.Ah[c];b.seq===d&&(b.rtt=a.Ef()-b.sentAt,b.err="ok")}},this.mf=function(){for(var e,c,j=a.Ta.get(k.Df),g=[],h=-1,f=0;f<a.Ah.length;f++)if("ok"===(c=a.Ah[f]).err){h=c.seq;break}for(var d=0;d<a.Ah.length;d++)((e=(c=a.Ah[d]).seq)<a.Nh-j||e<h)&&g.push(d);for(var i=[],b=0;b<a.Ah.length;b++)e=(c=a.Ah[b]).seq,0>g.indexOf(b)&&i.push(a.Ah[b]);a.Ah=i},this.bf=function(){a.mf();for(var f=[],c=0;c<a.Ah.length;c++){var e=a.Ah[c],b={};b[d.Gr]=e.seq,b[d.Kr]=e.rtt,b[d.jr]=e.err,f.push(b)}return f},this.Pf=function(){var h,j=-1,f=-1,g=a.Ea.Sa();if(a.Da()&&0===g.length)return null;var b=new ab;b.cu(d.Ro),b.pu(a.ui.customerKey),b.Ru(a.Ta.get(k.D)),b.gu(a.Na.S),b.Eu(a.Nh),b.Tu(d.version);var i=c.version;if(a.hi&&(i=a.hi),b.wu(i),b.Nu(a.Hi.S),b.Su(0),a.Hi.A?b.ah(a.Hi.A):a.A&&b.ah(a.A),a.Hi.C?b.fh(a.Hi.C):a.C&&b.fh(a.C),e.wt(a.Ue)&&b.dh(a.Ue),b.Gu(d.$s),a.Mh&&b.ju(a.Mh),a.Lh&&b.Ku(a.Lh),a.Uh&&b.Wu(a.Uh),a.Vh&&b.xu(a.Vh),a.kh&&b.qu(a.kh),a.Fh&&b.Yu(a.Fh),a.Hh&&b.Ju(a.Hh),a.jh&&b.Zu(a.jh),a.Kh&&b.zu(a.Kh),a.Wh&&b.$u(a.Wh),a.Bh&&b.Xu(a.Bh),a.Gh&&b.Qu(a.Gh),a.xh&&!isNaN(a.xh)&&b.th(parseInt(a.xh,10)),a.qh&&!isNaN(a.qh)&&b.nh(parseInt(a.qh,10)),a.Yh&&!isNaN(a.Yh)?b.ih(parseFloat(a.Yh)):(a.xh&&!isNaN(a.xh)||a.qh&&!isNaN(a.qh))&&b.ih(1),a.oe&&(a.wn=a.oe.bn(),a.wn&&b.setModuleName(a.wn),a.Tn=a.oe.Pn(),a.Tn&&b.vh(a.Tn),a.oe.Mn()&&(a.Bh=a.oe.Mn(),b.Xu(a.Bh)),a.oe.Un()&&(a.Gh=a.oe.Un(),b.Qu(a.Gh))),a.sn&&b.Ou(a.sn),e.It(a.Ph)>0&&b.Cu(a.Ph),a._a()||a.Aa()){if(a.Aa()&&b.ch(),a.nn&&b._u(a.nn),b.Iu(a.Oh),i=d.qr(a.vn),b.we(i),b.Mu(a.Xh),a.Dh&&b.Au(a.Dh),e.Ii(a.bh)&&b.du(a.bh),a.mh>0&&b.Lu(a.mh),a.ln>0&&b.Uu(a.ln),null!==a.yh&&b.Vu(a.yh),a.fn>0&&b.ku(a.fn),a.oe&&(j=o.Rf(a.oe.getPHT(),0,null,-1),f=o.Rf(a.oe.getBufferLength(),0,null,-1)),e.lt(a.Hi.I)?h=a.Hi.I:a.oe&&(h=a.oe.getSignalStrength()),j>=0&&b.sh(j),f>0&&b.oh(f),(f=a.Mf())>0&&b.Fu(f),a.ia>0&&b.Bu(o.Rf(a.ia,0,null,-1)),a.na>0&&b.Hu(o.Rf(a.na,0,null,-1)),h!==l.DEFAULT_SIGNAL_STRENGTH&&b.lh(h),a.rn&&b.rh(a.rn),a.Sn>0&&b.uh(a.Sn),a.gn>0&&b.hh(a.gn),a.Xn> -1&&b.eh(a.Xn),a.Ih> -1&&(b.ze(a.Ih),a.Ih>0&&(a.za(a.Ih,0),a.Ih=0)),void 0!==a.Jh)for(var m in a.Jh)b.au(m,a.Jh[m])}else b.Iu(d.$r.tu);return g.length>0&&b.mu(g),b.yu(a._h),b.Du(!0),a.Ta.get(k.Lf)&&b.bu(a.ai.Sa()),a.Ta.get(k.Df)>0&&(g=a.bf()).length>0&&b.Pu(g),0===a.Nh&&(b=a.Uf(b)),0!==a.Nh&&(b=a.Vf(b)),b.vu(a.gh),b.lu(a.Ef()),a.la&&(b.Eh(a.oa),b.ph(a.ra),b.Rh(a.ua),b.wh(a.ha),b.Th(a.aa)),a.Nh++,b.get()},this.Vf=function(c){var l,f=a.N,s={};for(l in c.hu.tags)Object.prototype.hasOwnProperty.call(f,l)||(s[l]=c.hu.tags[l]);c.hu.tags=s,a.N={};for(var b=0;b<a.ea.length;b++)Object.prototype.hasOwnProperty.call(a.Hi.N,a.ea[b])?Object.prototype.hasOwnProperty.call(a.Hi._,a.ea[b])?a.Hi._[a.ea[b]]===k.Bt.Gt?(a.N[k.kf+""+a.ea[b]]=k.Bt.Gt,a.Hi.O("End-user chose to opt-out of personal data collection")):a.Hi._[a.ea[b]]===k.Bt.Kt?(a.N[k.kf+""+a.ea[b]]=k.Bt.Kt,a.Hi.O("End-user chose to opt-out of personal data collection")):a.Hi._[a.ea[b]]===k.Bt.Ht?(a.N[k.kf+""+a.ea[b]]=k.Bt.Ht,a.Hi.O("End-user used privacy settings and chose to opt-out of personal data collection")):(a.N[k.kf+""+a.ea[b]]=a.Hi.N[a.ea[b]],a.Hi.O("Data collection successful")):(a.N[k.kf+""+a.ea[b]]=a.Hi.N[a.ea[b]],a.Hi.O("Data collection successful")):a.N[k.kf+""+a.ea[b]]=k.Bt.Ff;var t,n={};for(t in f){var m=t.split(".");"{}"!==JSON.stringify(a.ea)&& -1!==a.ea.indexOf(""+m[2])||f[k.kf+""+m[2]]===k.Bt.Hf||(a.Hi.O("Data collection restricted from Conviva back-end"),a.N[k.kf+""+m[2]]=k.Bt.Hf,n[k.kf+""+m[2]]=k.Bt.Hf)}if("{}"!==JSON.stringify(a.N)){var p,u=e.Bf(a.N);for(p in c.hu.tags)u[p]=c.hu.tags[p];if(c.hu.tags=u,!e.$a(f,a.N)){var g={};if("{}"!==JSON.stringify(n)&&(g[d.Po]=n),"{}"!==JSON.stringify(f)){for(var i in f)a.N[i]&&f[i]!==a.N[i]&&(g[d.Po]||(g[d.Po]={}),g[d.Po][i]=a.N[i]);for(var j in a.N)Object.prototype.hasOwnProperty.call(f,j)&&f[j]===a.N[j]||(g[d.Po]||(g[d.Po]={}),g[d.Po][j]=a.N[j])}"{}"===JSON.stringify(f)&&(g[d.Po]=a.N);var q,r,h={};h[d.kr]=g,h[d.Dr]=d.no,h[d.Pr]=a.Ef(),h[d.br]=a.Ea.pf(),a.oe&&(q=o.Rf(a.oe.getPHT(),0,null,-1),r=o.Rf(a.oe.getBufferLength(),0,null,-1),q>=0&&(h[d.Yo]=q),r>0&&(h[d.Jo]=r)),c.hu.evs||(c.hu.evs=[]),c.hu.evs.push(h)}}return c},this.Uf=function(b){var f=a.Gf();if("{}"===JSON.stringify(f))return b;var h,i=e.Bf(f);for(h in b.hu.tags)i[h]=b.hu.tags[h];b.hu.tags=i;var g={};g[d.Po]=f;var c={};return c[d.kr]=g,c[d.Dr]=d.no,c[d.Pr]=a.Ef(),c[d.br]=a.Ea.pf(),a.oe&&(f=o.Rf(a.oe.getPHT(),0,null,-1),g=o.Rf(a.oe.getBufferLength(),0,null,-1),f>=0&&(c[d.Yo]=f),g>0&&(c[d.Jo]=g)),b.hu.evs||(b.hu.evs=[]),b.hu.evs.push(c),b},this.Gf=function(){var b={};if("undefined"!=typeof navigator&&navigator){if(b["c3.fp.cookie"]=void 0!==navigator.cookieEnabled&&navigator.cookieEnabled?""+navigator.cookieEnabled:"",b["c3.fp.memory"]=void 0!==navigator.deviceMemory&&navigator.deviceMemory?""+navigator.deviceMemory:"",b["c3.fp.hwConc"]=void 0!==navigator.hardwareConcurrency&&navigator.hardwareConcurrency?""+navigator.hardwareConcurrency:"",b["c3.fp.java"]=""+("function"!=typeof navigator.javaEnabled)?"false":navigator.javaEnabled(),b["c3.fp.lang"]=void 0!==navigator.language&&navigator.language?""+navigator.language:"",b["c3.fp.langs"]=void 0!==navigator.languages&&navigator.languages&&navigator.languages.length>0?""+navigator.languages.toString():"",b["c3.fp.maxTp"]=void 0!==navigator.maxTouchPoints&&navigator.maxTouchPoints?""+navigator.maxTouchPoints:"",b["c3.fp.plugins"]="",void 0!==navigator.plugins&&navigator.plugins&&navigator.plugins.length>0)for(var c=0;c<navigator.plugins.length;c++)b["c3.fp.plugins"]+=navigator.plugins[c].name+",";if(b["c3.fp.mime"]="",void 0!==navigator.mimeTypes&&navigator.mimeTypes&&navigator.mimeTypes.length>0)for(var d=0;d<navigator.mimeTypes.length;d++)b["c3.fp.mime"]+=navigator.mimeTypes[d].type+",";b["c3.fp.sysLang"]=void 0!==navigator.systemLanguage&&navigator.systemLanguage?""+navigator.systemLanguage:"",b["c3.fp.platform"]=void 0!==navigator.platform&&navigator.platform?""+navigator.platform:"",b["c3.fp.product"]=void 0!==navigator.product&&navigator.product?""+navigator.product:"",b["c3.fp.productSub"]=void 0!==navigator.productSub&&navigator.productSub?""+navigator.productSub:"",b["c3.fp.vendor"]=void 0!==navigator.vendor&&navigator.vendor?""+navigator.vendor:"",b["c3.fp.vendorSub"]=void 0!==navigator.vendorSub&&navigator.vendorSub?""+navigator.vendorSub:"";var e=a.jf();""!==e&&(b["c3.fp.canvFp"]=e)}return"undefined"!=typeof window&&window&&(void 0!==window.screen&&window.screen&&(b["c3.fp.availHeight"]=void 0!==window.screen.availHeight&&window.screen.availHeight?""+window.screen.availHeight:"",b["c3.fp.availWidth"]=void 0!==window.screen.availWidth&&window.screen.availWidth?""+window.screen.availWidth:"",b["c3.fp.height"]=void 0!==window.screen.height&&window.screen.height?""+window.screen.height:"",b["c3.fp.width"]=void 0!==window.screen.width&&window.screen.width?""+window.screen.width:"",b["c3.fp.colorDepth"]=void 0!==window.screen.colorDepth&&window.screen.colorDepth?""+window.screen.colorDepth:"",b["c3.fp.deviceXDPI"]=void 0!==window.screen.deviceXDPI&&window.screen.deviceXDPI?""+window.screen.deviceXDPI:"",b["c3.fp.deviceYDPI"]=void 0!==window.screen.deviceYDPI&&window.screen.deviceYDPI?""+window.screen.deviceYDPI:""),b["c3.fp.dpi"]=void 0!==window.devicePixelRatio&&window.devicePixelRatio?""+window.devicePixelRatio:"",b["c3.fp.secure"]="boolean"==typeof window.isSecureContext?""+window.isSecureContext:""),b},this.jf=function(){try{if("undefined"!=typeof document&&document){var b=document.createElement("CANVAS");if(void 0!==b&&b&&"function"==typeof b.getContext){var a=b.getContext("2d"),c="conviva";return a.textBaseline="top",a.font="14px Arial",a.textBaseline="alphabetic",a.fillStyle="#f40",a.fillRect(void 0!==navigator.plugins&&navigator.plugins?navigator.plugins.length:0,void 0!==navigator.mimeTypes&&navigator.mimeTypes?navigator.mimeTypes.length:0,void 0!==navigator.product&&navigator.product?navigator.product.length:0,void 0!==navigator.vendor&&navigator.vendor?navigator.vendor.length:0),a.fillStyle="#069",a.fillText(c,void 0!==navigator.maxTouchPoints&&navigator.maxTouchPoints>=0?navigator.maxTouchPoints:0,void 0!==navigator.product&&navigator.product?navigator.product.length:0),a.fillStyle="rgba(102, 204, 0, 0.7)",a.fillText(c,void 0!==navigator.deviceMemory&&navigator.deviceMemory?navigator.deviceMemory:0,void 0!==navigator.hardwareConcurrency&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:0),j.js(b.toDataURL())}}return""}catch(d){return""}},this.Ha=function(){var b;a.Zh||(b=a.Pf())&&a.Kf(b)},this.Af=function(){var b;a.vn!==l.PlayerState.PLAYING||!a.oe||(b=a.oe.getRenderedFrameRate())>0&&(a.ia+=b,a.na++)},this.Mf=function(){return a.ia>0&&a.na>0?e.Wf.Cast(+a.ia/a.na):(this.Af(),a.ia>0&&a.na>0?e.Wf.Cast(+a.ia/a.na):l.DEFAULT_RENDERED_FRAME_RATE)},this.Kf=function(b){a.Cf();var c=a.Nh-1;a.c.info("postHeartbeat(): Send HB["+c+"]"+a.Ia()),a.pa.xf(b,function(b,d){a.qf(b,d,c)})},this.qf=function(b,c,f){a.Zh||a.w.m("onHeartbeatResponse",function(){var h,i,g;b?c?(a.c.debug("onHeartbeatResponse(): received valid response for HB["+f+"]"),a.yf(f),(g=c[d.ho])&&g!==(h=a.Ta.get(k.D))&&(a.c.debug("onHeartbeatResponse(): setting the client id to "+g+" (from gateway)"),a.Ta.set(k.D,g),a.Ta.Yf(),h===d.P&&g!==d.P&&a.Hi.y()),(h=c[d.uo])&&h!==d.ro&&a.c.error("onHeartbeatResponse(): error from gateway: "+h),"object"==typeof(g=c[d.ao])&&((h=g[d.co])>=0&&a.Ta.get(k.Df)!==h&&(a.c.debug("onHeartbeatResponse(): setting Maximum Heartbeat Infos to "+h+" (from gateway)"),a.Ta.set(k.Df,h)),h=g[d.lo],(h=!!e.Ii(h)&&h)!==a.Ta.get(k.Lf)&&(a.c.debug("onHeartbeatResponse(): turning "+(h?"on":"off")+" sending of logs"),a.Ta.set(k.Lf,h)),h=g[d.vo],!e.lt(h)||(i=e.Wf.Cast(h))!==a.ui.heartbeatInterval&&(a.c.debug("onHeartbeatResponse(): received hbIntervalMs from gateway: "+i),a.ui.heartbeatInterval=i,a.Sh&&a.Ga()),(i=g[d.do])&&i!==a.ui.gatewayUrl&&(a.c.debug("onHeartbeatResponse(): received gatewayUrl from gateway: "+i),a.ui.gatewayUrl=i),a.Jf()||(a.ea={},(i=g[d.Eo])&&(a.sa||(a.sa=!0),a.c.debug("onHeartbeatResponse(): received fp from gateway: "+i),a.ea=i.split(",")),a.la=g[d.po],e.Ii(a.la)&&(a.la?(a.c.debug("onHeartbeatResponse(): enabling the CDN Server IP collection"),a.fa||a.Wa()):a.ka())))):a.c.warning("onHeartbeatResponse(): decoded heartbeat response is null."):(g=c,e.wt(g)?e.Xf(g,"HTTP timeout")?a.c.warning("onHeartbeatResponse(): "+g):a.c.error("onHeartbeatResponse(): failed to send heartbeat: "+g):(g=x.Qf,a.c.error("onHeartbeatResponse(): "+g)),a.If(f,g))})},this.Ef=function(){return e.Wf.Cast(a.wa.current()-a.gh)},this.Nf=function(){return this.Ea.pf()},this.Ia=function(){return this.Da()?" (global session)":""},this.Da=function(){return this.Oa===q.ct.tu},this.Jf=function(){return this.Oa===q.ct.tu&&"T"===this.Ph["c3.IPV4IPV6GlobalSession"]},this._a=function(){return this.Oa===q.ct.ft},this.Aa=function(){return this.Oa===q.ct.Rt},this.St=function(b){a.Zf(b),a.ba()},this.Zf=function(b){var f={},c={};if(e.wt(b.assetName)&&(a.Et.assetName!==b.assetName?(a.Et.assetName&&(f[d.Do]=a.Et.assetName),c[d.Do]=b.assetName,a.Et.assetName=b.assetName):a.c.warning("mergeContentMetadata(): assetName was not changed.")),e.wt(b.applicationName)&&(a.Et.applicationName!==b.applicationName?(a.Et.applicationName&&(f[d.bo]=a.Et.applicationName),c[d.bo]=b.applicationName,a.Et.applicationName=b.applicationName):a.c.warning("mergeContentMetadata(): applicationName was not changed.")),e.wt(b.streamUrl)&&(a.Et.streamUrl!==b.streamUrl?(a.Et.streamUrl&&(f[d.Xo]=a.Et.streamUrl),c[d.Xo]=b.streamUrl,a.Et.streamUrl=b.streamUrl,a.rn=a.Et.streamUrl):a.c.warning("mergeContentMetadata(): streamUrl was not changed.")),e.wt(b.viewerId)&&(a.Et.viewerId!==b.viewerId?(a.Et.viewerId&&(f[d.mo]=a.Et.viewerId),c[d.mo]=b.viewerId,a.Et.viewerId=b.viewerId):a.c.warning("mergeContentMetadata(): viewerId was not changed.")),e.wt(b.defaultResource)&&(a.Et.defaultResource!==b.defaultResource?(a.Et.defaultResource&&(f[d.qo]=a.Et.defaultResource),c[d.qo]=b.defaultResource,a.Et.defaultResource=b.defaultResource):a.c.warning("mergeContentMetadata(): defaultResource was not changed.")),e.lt(b.duration)&&b.duration>0&&(a.Et.duration!==b.duration?(a.mh>0&&(f[d.Go]=a.mh),c[d.Go]=b.duration,a.Et.duration=b.duration,a.mh=a.Et.duration):a.c.warning("mergeContentMetadata(): duration was not changed.")),e.lt(b.encodedFrameRate)&&b.encodedFrameRate>0&&(a.Et.encodedFrameRate!==b.encodedFrameRate?(a.Et.encodedFrameRate> -1&&(f[d.jo]=a.Et.encodedFrameRate),c[d.jo]=b.encodedFrameRate,a.Et.encodedFrameRate=b.encodedFrameRate,a.fn=a.Et.encodedFrameRate):a.c.warning("mergeContentMetadata(): encodedFrameRate was not changed.")),b.streamType!==s.StreamType.UNKNOWN&&(a.Et.streamType!==b.streamType?(a.Et.streamType!==s.StreamType.UNKNOWN&&(a.Et.streamType===s.StreamType.LIVE?f[d.go]=!0:f[d.go]=!1),b.streamType===s.StreamType.LIVE?c[d.go]=!0:c[d.go]=!1,a.Et.streamType=b.streamType):a.c.warning("mergeContentMetadata(): streamType was not changed.")),e.It(b.custom)>0){var g,h={},i={};for(g in b.custom)a.Et.custom[g]!==b.custom[g]?(h[g]=b.custom[g],a.Et.custom[g]&&(i[g]=a.Et.custom[g]),a.Et.custom[g]=b.custom[g]):a.c.info("mergeContentMetadata(): custom."+g+" was not changed.");e.It(h)>0?(e.It(i)>0&&(f[d.Po]=i),c[d.Po]=h):a.c.warning("mergeContentMetadata(): custom was not changed.")}e.It(c)>0&&this.Ja(c,f)},this.ba=function(){var b;a.c.debug("setStatesFromContentMetadata()"),a.Et.defaultResource&&this.Vu(a.Et.defaultResource),a.Et.streamUrl&&this.rh(a.Et.streamUrl),a.Et.duration>0&&this.Lu(a.Et.duration),a.Et.encodedFrameRate>0&&this.ku(a.Et.encodedFrameRate),a.Et.streamType!==s.StreamType.UNKNOWN&&(b=a.Et.streamType===s.StreamType.LIVE,this.du(b)),a.Et.assetName&&this._u(a.Et.assetName),a.Et.viewerId&&this.Ou(a.Et.viewerId),(a.Et.applicationName||a.Et.playerName)&&this.Au(a.Et.applicationName||a.Et.playerName),e.It(a.Et.custom)>0&&this.Cu(a.Et.custom)},this.Pa=function(){var b={};if(this.Da()||(a.Et.assetName?b[d.Do]=a.Et.assetName:a.c.warning("enqueueEventForContentMetadata(): assetName was not set."),a.Et.applicationName?b[d.bo]=a.Et.applicationName:a.c.warning("enqueueEventForContentMetadata(): applicationName was not set."),a.Et.streamUrl?b[d.Xo]=a.Et.streamUrl:a.c.warning("enqueueEventForContentMetadata(): streamUrl was not set."),a.Et.viewerId?b[d.mo]=a.Et.viewerId:a.c.warning("enqueueEventForContentMetadata(): viewerId was not set."),a.Et.defaultResource?b[d.qo]=a.Et.defaultResource:a.c.warning("enqueueEventForContentMetadata(): defaultResource was not set."),a.Et.duration> -1?b[d.Go]=a.Et.duration:a.c.warning("enqueueEventForContentMetadata(): duration was not set."),a.Et.encodedFrameRate> -1?b[d.jo]=a.Et.encodedFrameRate:a.c.warning("enqueueEventForContentMetadata(): encodedFrameRate was not set."),a.Et.streamType!==s.StreamType.UNKNOWN?a.Et.streamType===s.StreamType.LIVE?b[d.go]=!0:b[d.go]=!1:a.c.warning("enqueueEventForContentMetadata(): streamType was not set.")),e.It(a.Et.custom)>0)for(var c in b[d.Po]={},a.Et.custom)b[d.Po][c]=a.Et.custom[c];else this.Da()||a.c.warning("enqueueEventForContentMetadata(): custom tags were not set.");e.It(b)>0&&this.Ja(b,null)},this.La=function(){a.Et&&e.wt(a.Et.assetName)||a.c.warning("Missing assetName during session creation"),a.Et&&e.wt(a.Et.defaultResource)||a.c.warning("Missing resource during session creation"),a.Et&&e.wt(a.Et.streamUrl)||a.c.warning("Missing streamUrl during session creation"),(!a.Et||a.Et.encodedFrameRate<=0)&&a.c.warning("Missing encodedFrameRate during session creation"),a.Et&&e.wt(a.Et.viewerId)||a.c.warning("Missing viewerId during session creation"),a.Et&&a.Et.streamType&&s.StreamType.UNKNOWN!==a.Et.streamType||a.c.warning("Missing streamType during session creation"),a.Et&&e.wt(a.Et.applicationName)||a.c.warning("Missing applicationName during session creation"),(!a.Et||a.Et.duration<=0)&&a.c.warning("Missing duration during session creation")},this.Ft=function(b,c){a.Jh||(a.Jh={}),a.Jh[b]=c},this.Ma=function(){var b={};a.Hi.A&&(b[d.tr]=a.Hi.A,a.A=a.Hi.A),a.Hi.C&&(b[d.nr]=a.Hi.C,a.C=a.Hi.C),e.It(b)>0&&this.Ja(b,null)}};q.Ca=d.$r.ft+d.$r.nu+d.$r.iu,q.ct={ft:"Video",tu:"Global",Rt:"Ad"};var x=a.Session=function(){var a=this;a.oe=null,a.S=0,a.Oa=q.ct.ft,a.zf=!1,a.Zh=!1,a.$f=!1,a.tc=null,a.Gi=null,a.nc=null,a.ic=!1,a.ec=l.PlayerState.NOT_MONITORED,a.sc=!1,a.oc=!1,a.rc=!1,a.uc=!1,a.hc=!1,(function(a,b,c,d,e,f,g){this.S=a,this.Oa=b,this.Ta=c,this.ac=d,this.dt=e,this.w=f,this.c=g}).apply(a,arguments),this.ga=function(b,c){a.dt.ga(this),b&&a.Ot(b),a.Ta.fc()?a.cc(c):a.Ta.lc(function(){a.cc(c)})},this.cleanup=function(){a.zf=!0,a.dt.ya(),a.Ta.fc()?a.vc():a.Ta.lc(function(){a.vc()})},this.dc=function(){(a._a()||a.Aa())&&a.oe&&a.Ec(),a.w=null,a.Hi=null,a.Ta=null,a.ac=null,a.dt.ut(),a.dt=null,a.Zh=!0},this.vc=function(){a.dt.Ua(),a.dc()},this.cc=function(b){a.dt.ma(),a.pc(),b?(a.Tt(b.ms(),b.Ds()),a.dt.we(l.PlayerState.STOPPED),a.dt.Ua(),a.dc()):a.dt.Ba()},this.pc=function(){var c=a.ac.get(),b=c[f.BROWSER_NAME];b&&a.dt.ju(b),(b=c[f.BROWSER_VERSION])&&a.dt.Ku(b),(b=c[f.DEVICE_BRAND])&&a.dt.Wu(b),(b=c[f.DEVICE_MANUFACTURER])&&a.dt.xu(b),(b=c[f.DEVICE_MODEL])&&a.dt.qu(b),(b=c[f.DEVICE_TYPE])&&a.dt.Yu(b),(b=c[f.DEVICE_VERSION])&&a.dt.Ju(b),(b=c[f.FRAMEWORK_NAME])&&a.dt.Xu(b),(b=c[f.FRAMEWORK_VERSION])&&a.dt.Qu(b),(b=c[f.OPERATING_SYSTEM_NAME])&&a.dt.Zu(b),(b=c[f.OPERATING_SYSTEM_VERSION])&&a.dt.zu(b),(b=c[f.DEVICE_CATEGORY])&&a.dt.$u(b),(b=c[f.SCREEN_WIDTH])&&a.dt.th(b),(b=c[f.SCREEN_HEIGHT])&&a.dt.nh(b),(c=c[f.SCALE_FACTOR])&&a.dt.ih(c)},this.Gn=function(b){a.dt.vn!==b&&(a.dt.vn===l.PlayerState.NOT_MONITORED&&b!==l.PlayerState.NOT_MONITORED&&(a.ec=b),a.ic||a.dt.we(b))},this.jn=function(b){a.sc||a.dt.Xa(b)},this.Qn=function(b){a.oc||a.dt.eh(b)},this.Zn=function(b){a.oc||a.dt.ze(b)},this.Kn=function(c,b){e.lt(b)||(b=-1),a.dt.Of(c,b)},this.Cn=function(b){b>0&&(a.uc||a.dt.ku(b))},this.mn=function(b){b>0&&(a.uc||a.dt.Lu(b))},this.Dn=function(b){a.dt.rh(b)},this.Wn=function(b){a.dt.if(b)},this.xn=function(b){a.dt.sf(b)},this.W=function(b){a.dt.ah(b)},this.Y=function(b){a.dt.fh(b)},this.Ln=function(b){a.dt.ja()||a.dt.Xu(b)},this.Vn=function(b){a.dt.Ka()||a.dt.Qu(b)},this.Yn=function(b){a.dt.dh(b)},this.qn=function(b,c){a.Tt(b,c)},this._n=function(){a.Ec()},this.bt=function(b,c,d){a.$f||(a.$f=!0,a.tc=b,a.Gi=c,a.nc=d,a.dt.ff(!0),a.tc===h.AdStream.CONTENT||a.Gi===h.AdPlayer.SEPARATE?(a.dt.vn!==l.PlayerState.NOT_MONITORED&&(a.ec=a.dt.vn),a.dt.we(l.PlayerState.NOT_MONITORED),a.ic=!0):a.tc===h.AdStream.SEPARATE&&a.Gi===h.AdPlayer.CONTENT&&(a.dt.vn!==l.PlayerState.NOT_MONITORED&&(a.ec=a.dt.vn),a.dt.we(l.PlayerState.NOT_MONITORED),a.ic=!0,a.sc=!0,a.oc=!0,a.uc=!0,a.rc=!0))},this.Pt=function(){a.$f&&(a.dt.ff(!1),a.tc===h.AdStream.CONTENT||a.Gi===h.AdPlayer.SEPARATE?a.Rc||(a.ic=!1,a.dt.we(a.ec)):a.tc===h.AdStream.SEPARATE&&a.Gi===h.AdPlayer.CONTENT&&(a.sc=!1,a.oc=!1,a.uc=!1,a.rc=!1,a.hc=!1,a.Rc||(a.ic=!1,a.dt.we(a.ec))),a.$f=!1,a.tc=a.Gi=a.nc=null)},this.gt=function(){a.oe&&a.oe&&(a.w.m("Session.detachPlayer",function(){a.oe.An()}),a.oe=null,a.dt.Tf(null),a.dt.we(l.PlayerState.NOT_MONITORED))},this.Ec=function(){a.oe&&(a.w.m("Session.releasePlayerStateManager",function(){a.oe.An()}),a.oe=null,a.dt.Tf(null),a.dt.we(l.PlayerState.NOT_MONITORED))},this.Nt=function(){a.dt.ff(!0),a.dt.vn!==l.PlayerState.NOT_MONITORED&&(a.ec=a.dt.vn),a.dt.we(l.PlayerState.NOT_MONITORED),a.ic=!0},this.Ot=function(b){a.oe||b instanceof l&&a.w.m("Session.attachPlayer()",function(){b.setMonitoringNotifier(a,a.S)&&(b.kn(),a.oe=b,a.dt.Tf(a.oe))})},this._t=function(){a.dt.ff(!1),a.sc=!1,a.oc=!1,a.uc=!1,a.rc=!1,a.hc=!1,a.Rc||(a.ic=!1,a.ec!==l.PlayerState.NOT_MONITORED&&a.dt.we(a.ec))},this.Lt=function(){return a.oe},this.At=function(){a.Rc||(a.Rc=!0,a.ic=!0)},this.Ct=function(){a.Rc&&(a.Rc=!1,a.$f||(a.ic=!1,a.ec!==l.PlayerState.NOT_MONITORED&&a.dt.we(a.ec)))},this.Tt=function(c,b){e.wt(c)&&(b!==h.ErrorSeverity.FATAL&&b!==h.ErrorSeverity.WARNING||a.hc||(b=b===h.ErrorSeverity.FATAL,a.dt.lf(c,b)))},this.St=function(b){a.w.m("Session.updateContentMetadata",function(){a.dt.St(b)})},this.Dt=function(b,c){a.dt._f(b,c)},this.Da=function(){return a.Oa===q.ct.tu},this._a=function(){return a.Oa===q.ct.ft},this.Aa=function(){return a.Oa===q.ct.Rt},this.Ia=function(){return a.Da()?" (global session)":""},this.Vt=function(){return this.S},this.kt=function(){var b=null;return a.Ta.fc()&&(b=a.Ta.get(k.D)),b},this.Ft=function(b,c){a.dt.Ft(b,c)}};x.Qf="received no response (or a bad response) to heartbeat POST request";var ac=a.SessionFactory=function(){var a=this;a.ai=null,a.wc=0,a.Tc=null,(function(b,c,d,e){a.Hi=b,a.ui=c,a.Ta=d,a.v=e,a.wc=0,a.Tc={}}).apply(a,arguments),this.ut=function(){for(var b in a.ai=null,a.Tc)a.Tc[b].cleanup();a.Tc=null,a.wc=0},this.Sc=function(){var b=a.wc;return a.wc++,b},this.ht=function(b,c,d,e,f){return b||(b=new s),a.gc(b,c,d,e,f)},this.k=function(b){return a.gc(b,q.ct.tu,void 0,c.version)},this.Nc=function(){return m.Oc()},this.gc=function(b,f,e,c,d){return b=a.v.Ni(a.Hi,a.ui,a.Ta,a.Nc(),f,b.z(),c),c=a.Sc(),void 0!==d&& void 0!==d.error?b.ga(e,d.error):(a._c(c,b),b.ga(e)),c},this.mt=function(b){return b=a.Tc[b]},this.vt=function(a){return(a=this.mt(a))&&(a._a()||a.Aa()||(a=null)),a},this._c=function(b,c){a.Tc[b]=c},this.Ac=function(b){delete a.Tc[b]},this.Mt=function(b){var c=a.mt(b);a.Ac(b),c.cleanup()},this.K=function(){return a.Tc}},ad=a.Cc=function(a){this.Bi=a,this.Ic=function(b,a,c){var d=!1;return this.Bi.createOnce(function(){d||b((d=!0,!1),c+" ("+a+" ms)")},a,"CallbackWithTimeout.wrap"),function(a,c){d||(d=!0,b(a,c))}}},k=a.Config=function(c,a,b){var f=this;this.yc=a,this.mc=b,this.Dc={clientId:d.P,iid:d.Ys,sendLogs:!1,maxHbInfos:d.Xs},this.T=e.Bf(this.Dc),this.bc=!1,this.Pc=!1,this.Mc=[],this.fc=function(){return this.bc},this.it=function(){this.yc.it(k.Lc,function(a,b){a&&f.Uc(b),f.bc=!0,f.Vc()})},this.Uc=function(b){var a=this.mc.ru(b);a?a&&(b=a[k.kc],a=a[k.et],b&&b!==d.P&&""!==b&&"null"!==b&&(this.T[k.D]=b),a!==d.Ys&&""!==a&&"null"!==a&&(this.T[k.et]=a)):this.Pc=!0},this.Fc=function(){var a={};return a[k.kc]=this.T.clientId,this.mc.ou(a)},this.Yf=function(){this.yc.Yf(k.Lc,this.Fc(),function(){})},this.lc=function(a){this.fc()?a():this.Mc.push(a)},this.get=function(a){return this.bc?this.T[a]:null},this.set=function(a,b){this.bc&&(this.T[a]=b)},this.Vc=function(){for(var a;void 0!==(a=this.Mc.shift());)a()}};k.Lc="sdkConfig",k.kc="clId",k.et="iid",k.D="clientId",k.Lf="sendLogs",k.Df="maxHbInfos",k.kf="c3.fp.",k.Bt={Ff:"0",Hc:"1",Gt:"2",Ht:"3",Hf:"4",Kt:"5",jt:"6"};var n,r,ae=a.EventQueue=function(){this.Bc=[],this.Gc=0,this.wf=function(a){this.Bc.push(a)},this.pf=function(){var a=this.Gc;return this.Gc++,a},this.Sa=function(){var a=this.Bc;return this.Bc=[],a}},af=a.ExceptionCatcher=function(c,a,b){this.jc=a,this.R=b,this.m=function(c,d,b){try{d()}catch(a){if(b)b(a);else{if(this.R.allowUncaughtExceptions)throw a;this.Kc(c,a)}}},this.Kc=function(a,b){var c="Uncaught exception: "+a+": "+b.toString();if(this.jc)try{this.jc.xf(c)}catch(d){}}},ag=a.GatewayControl=function(a,f,b,c,e){var g=this;this.ui=a,this.Wc=b,this.mc=c,this.xc=e,this.xf=function(a,c){var b=(this.xc?this.xc.indexOf("ipv4")> -1?this.ui.M:this.ui.F:this.ui.gatewayUrl)+d.qs;this.Wc.qc("POST",b,this.mc.ou(a),"application/json",function(a,b){a?c(a,g.mc.ru(b)):c(a,b)})}},e=a.Lang={};e.Yc=function(a){return e.wt(a)&&a&&"undefined"!==a&&"null"!==a},e.yt=function(c){var a,b,d={};for(a in c)e.Yc(a)&&(b=c[a],e.Yc(b)&&(d[a]=b));return d},e.In=function(a,d,b){if(!a)throw new Error("Expected "+b+" implementation is null.");for(var c in d)if("function"!=typeof a[c])throw new Error("Expected method "+c+" in "+b+" implementation.")},e.It=function(a){var b,c=0;for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c++;return c},e.pt=function(a){return""+a},e.Jc=function(a){return Math.floor(a)},e.Xt=function(a){return Math.abs(e.Jc(a))},e.Xc=function(a){return Boolean(a)},e.wt=function(a){return"string"==typeof a&&""!==a},e.Xf=function(a,b){return"string"==typeof a&&"string"==typeof b&&"function"==typeof a.indexOf&&0===a.indexOf(b)},e.Ii=function(a){return"boolean"==typeof a},e.Qc=function(a){return escape(a)},e.uu=function(a){return"object"==typeof a},e.tf=function(b){var a,c="";for(a in b)c+=a+"="+b[a];return"Object{"+c+"}"},e.Zc=function(c){var b,a=e.Bf(c);for(b in a)a[b]||delete a[b];return a},e.Bf=function(b){var a,c={};for(a in b)c[a]=b[a];return c},e.$a=function(a,b){if(typeof a!=typeof b)return!1;if(a instanceof Object&&b instanceof Object){if(e.It(a)!==e.It(b))return!1;for(var c in a)if(a[c]!==b[c])return!1;return!0}return a===b},e.as=function(){for(var c={},a=0;a<arguments.length;a++)for(var b in arguments[a])arguments[a][b]&&(c[b]=arguments[a][b]);return c},e.lt=function(a){return"number"==typeof a&&Math.round(a)===a},e.zc=function(a){return"[object Array]"===Object.prototype.toString.call(a)},e.$c=function(b,c){if(b===c)return!0;if(!b||!c||b.length!==c.length)return!1;for(var a=0;a<b.length;++a)if(e.zc(b[a])&&e.zc(c[a])){if(!e.$c(b[a],c[a]))return!1}else if(b[a]!==c[a])return!1;return!0},e.tl=function(){return void 0!==Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(a){return!1}}()},e.xt=function(a,b,c){if(e.tl())Object.defineProperty(a,b,{configurable:!0,enumerable:!0,get:c});else{if(void 0===a.__defineGetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineGetter__");a.__defineGetter__(b,c)}},e.qt=function(a,b,c){if(e.tl())Object.defineProperty(a,b,{configurable:!0,set:c});else{if(void 0===a.__defineSetter__)throw new Error("JavaScript runtime must support either Object.defineProperty or __defineSetter__");a.__defineSetter__(b,c)}},(n={two32:4294967296}).nl=n.two32-1,n.il=0,e.el=n,e.el.Cast=function(a){return(a=parseInt(a,10))>n.nl?a%=n.two32:a<n.il&&(a=-a%n.two32,a=n.two32-a),a},e.el.sl=function(a){return(a=parseInt(a,10))<=n.nl&&a>=n.il},r={nl:2147483647,il:-2147483648},e.Wf=r,e.Wf.Cast=function(a){return(a=parseInt(a,10))>r.nl?a%=r.nl:a<r.il&&(a=-a%r.nl,a=r.nl-a),a},e.Wf.sl=function(a){return(a=parseInt(a,10))<=r.nl&&a>=r.il},e.ys=function(){return window&&window.location&&window.location.search?window.location.search:""},e.ol=function(){return document&&document.referrer?document.referrer:""};var ah=a.LogBuffer=function(){this.rl=[],this.ks=function(a){this.rl.length>=32&&this.rl.shift(),this.rl.push(a)},this.Sa=function(){var a=this.rl;return this.rl=[],a}},$=a.Ping=function(a,b,c,f){this.ul=!1,this.hl=null,this.c=a,this.c.setModuleName("Ping"),this.Wc=b,this.ui=c,this.hi=f,this.xf=function(a){this.ul||(this.ul=!0,a=this.al()+"&d="+e.Qc(a.toString()),this.c.error("send(): "+a),this.Wc.qc("GET",a,null,null,null),this.ul=!1)},this.al=function(){if(!this.hl){var a=$.fl+"?comp="+$.cl+"&clv="+(this.hi||h.version);if(this.ui&&(a+="&cid="+this.ui.customerKey),a+="&sch="+d.$s,!this.ui)return a;this.hl=a}return this.hl}};$.cl="sdkjs",$.fl="https://pings.conviva.com/ping.ping";var m=a.ll={};m.vl=4294967295,m.dl=2147483647,m.El=-2147483648,m.Oc=function(){return Math.floor(Math.random()*m.vl)+m.El},m.ot=function(){return Math.floor(Math.random()*m.vl)};var o=a.pl={};o.Rf=function(a,c,d,b){return isNaN(a)||"number"!=typeof a||a===b?b:(a=e.Jc(a),o.Rl(a,c,d))},o.Rl=function(a,b,c){return e.lt(c)&&a>c?a=c:e.lt(b)&&a<b&&(a=b),a},o.an=function(a){return -1===a|| -2===a?a:a=o.Rf(a,0,null,-1)};var ai=a.StreamerError=function(){var a=this;a.errorCode=null,a.severity=h.ErrorSeverity.FATAL,(function(b,c){a.errorCode=b,a.severity=c}).apply(a,arguments),this.ms=function(){return a.errorCode},this.Ds=function(){return a.severity}},aj=a.HttpClient=function(d,a,b,c){this.ni=a,this.wl=b,this.R=c,this.qc=function(d,e,f,g,a){var b=1e3*this.R.httpTimeout,c=null;a&&(c=this.wl.Ic(a,b,"HTTP timeout")),this.ni.makeRequest(d,e,f,g,b,c)}},y=a.Logger=function(a,b,c,d,e){this.si=a,this.$n=b,this.p=c,this.ai=d,this.ri=e,this.debug=function(a){this.log(a,i.LogLevel.DEBUG)},this.info=function(a){this.log(a,i.LogLevel.INFO)},this.warning=function(a){this.log(a,i.LogLevel.WARNING)},this.error=function(a){this.log(a,i.LogLevel.ERROR)},this.log=function(a,b){a=this.Tl(a,b),this.ai.ks(a),this.p.logLevel<=b&&this.si.consoleLog(a,b)},this.Sl=function(a){return"["+this.wn+"] "+a},this.gl=function(a){return"["+this.ri+"] "+a},this.Nl=function(a){return"[Conviva] "+a},this.Ol=function(a){return"["+(this.$n.getEpochTimeMs()/1e3).toFixed(3).toString()+"] "+a},this._l=function(a,b){return"["+y.Al(b)+"] "+a},this.Cl=function(a){return this.Il&&(a="sid="+this.Il+" "+a),a},this.gu=function(a){this.Il=a},this.setModuleName=function(a){this.wn=a},this.Tl=function(a,b){return this.Nl(this.Ol(this._l(this.gl(this.Sl(this.Cl(a))),b)))}};y.Al=function(b){var a;switch(b){case i.LogLevel.ERROR:a="ERROR";break;case i.LogLevel.WARNING:a="WARNING";break;case i.LogLevel.INFO:a="INFO";break;case i.LogLevel.DEBUG:a="DEBUG"}return a},a.Storage=function(e,b,c,d){this.ii=b,this.wl=c,this.R=d,this.it=function(c,b){b=this.wl.Ic(b,1e3*this.R.storageTimeout,"storage load timeout"),this.ii.loadData(a.Storage.yl,c,b)},this.Yf=function(c,d,b){b=this.wl.Ic(b,1e3*this.R.storageTimeout,"storage save timeout"),this.ii.saveData(a.Storage.yl,c,d,b)}},a.Storage.yl="Conviva";var f=a.SystemMetadata=function(c,a,b){this.ei=a,this.w=b,this.ml=null,this.get=function(){return this.ml||this.retrieve(),this.ml},this.retrieve=function(){var a={};a[f.BROWSER_NAME]=this.ei.getBrowserName,a[f.BROWSER_VERSION]=this.ei.getBrowserVersion,a[f.DEVICE_BRAND]=this.ei.getDeviceBrand,a[f.DEVICE_MANUFACTURER]=this.ei.getDeviceManufacturer,a[f.DEVICE_MODEL]=this.ei.getDeviceModel,a[f.DEVICE_TYPE]=this.ei.getDeviceType,a[f.DEVICE_VERSION]=this.ei.getDeviceVersion,a[f.FRAMEWORK_NAME]=this.ei.getFrameworkName,a[f.FRAMEWORK_VERSION]=this.ei.getFrameworkVersion,a[f.OPERATING_SYSTEM_NAME]=this.ei.getOperatingSystemName,a[f.OPERATING_SYSTEM_VERSION]=this.ei.getOperatingSystemVersion,a[f.DEVICE_CATEGORY]=this.ei.getDeviceCategory,a[f.SCREEN_WIDTH]=this.ei.getScreenWidth,a[f.SCREEN_HEIGHT]=this.ei.getScreenHeight,a[f.SCALE_FACTOR]=this.ei.getScaleFactor;var c,i=this;for(c in a)(function(a,b){i.w.m("Session.getSystemMetadataSchema(): "+a,function(){var c=b[a];b[a]=c.call(i.ei)})})(c,a),e.wt(a[c])||delete a[c];var b=!1;if(void 0!==a[f.DEVICE_TYPE]){for(var d in h.DeviceType)if(a[f.DEVICE_TYPE]===h.DeviceType[d]){b=!0;break}b||delete a[f.DEVICE_TYPE]}if(b=!1,void 0!==a[f.DEVICE_CATEGORY]){for(var g in h.DeviceCategory)if(a[f.DEVICE_CATEGORY]===h.DeviceCategory[g]){b=!0;break}b||delete a[f.DEVICE_CATEGORY]}this.ml=e.Zc(a)}};f.BROWSER_NAME="browserName",f.BROWSER_VERSION="browserVersion",f.DEVICE_BRAND="deviceBrand",f.DEVICE_MANUFACTURER="deviceManufacturer",f.DEVICE_MODEL="deviceModel",f.DEVICE_TYPE="deviceType",f.DEVICE_VERSION="deviceVersion",f.FRAMEWORK_NAME="frameworkName",f.FRAMEWORK_VERSION="frameworkVersion",f.OPERATING_SYSTEM_NAME="operatingSystemName",f.OPERATING_SYSTEM_VERSION="operatingSystemVersion",f.DEVICE_CATEGORY="deviceCategory",f.SCREEN_WIDTH="screenWidth",f.SCREEN_HEIGHT="screenHeight",f.SCALE_FACTOR="scaleFactor";var ak=a.Time=function(a,b){this.$n=a,this.c=b,this.current=function(){var a=this.$n.getEpochTimeMs();return e.lt(a),a}},al=a.Timer=function(c,a,b){var d=this;this.ti=a,this.w=b,this.create=function(c,a,b){return this.createTimer(function(){d.w.m(b,function(){c()})},a,b)},this.createOnce=function(e,b,c){var a={cancel:null};return a.cancel=this.createTimer(function(){d.w.m(c,function(){a&&"function"==typeof a.cancel&&(a.cancel(),a.cancel=null,a=null),e()})},b,c),a.cancel},this.createTimer=function(a,b,c){return this.ti.createTimer(a,b,c)}}}(),b});"use strict";const CONVIVA_CALLBACK_FUNCTIONS={[Conviva.Constants.CallbackFunctions.CONSOLE_LOG](b,a){"undefined"!=typeof console&&(console.log&&a===Conviva.SystemSettings.LogLevel.DEBUG||a===Conviva.SystemSettings.LogLevel.INFO?console.log(b):console.warn&&a===Conviva.SystemSettings.LogLevel.WARNING?console.warn(b):console.error&&a===Conviva.SystemSettings.LogLevel.ERROR&&console.error(b))},[Conviva.Constants.CallbackFunctions.MAKE_REQUEST](d,e,f,b,c,g){let a=new XMLHttpRequest;a.open(d,e,!0),b&&a.overrideMimeType&&(a.overrideMimeType=b),b&&a.setRequestHeader&&a.setRequestHeader("Content-Type",b),c>0&&(a.timeout=c,a.ontimeout=()=>{a.ontimeout=a.onreadystatechange=null,g&&g(!1,"timeout after "+c+" ms")}),a.onreadystatechange=()=>{4===a.readyState&&(a.ontimeout=a.onreadystatechange=null,200===a.status?g&&g(!0,a.responseText):g&&g(!1,"http status "+a.status))},a.send(f)},[Conviva.Constants.CallbackFunctions.SAVE_DATA](b,c,d,a){try{localStorage.setItem(b+"."+c,d),a(!0,void 0)}catch(e){a(!1,e.toString())}},[Conviva.Constants.CallbackFunctions.LOAD_DATA](b,c,a){try{let d=localStorage.getItem(b+"."+c);a(!0,d)}catch(e){a(!1,e.toString())}},[Conviva.Constants.CallbackFunctions.GET_EPOCH_TIME_IN_MS]:()=>new Date().getTime(),[Conviva.Constants.CallbackFunctions.CREATE_TIMER](a,b){let c=setInterval(a,b);return()=>{-1!==c&&(clearInterval(c),c=-1)}}};function collectDeviceMetadata(){return{[Conviva.Constants.DeviceMetadata.TYPE]:Conviva.Constants.DeviceType.DESKTOP,[Conviva.Constants.DeviceMetadata.CATEGORY]:Conviva.Constants.DeviceCategory.WEB}}function collectPlayerInfo(){return{[Conviva.Constants.FRAMEWORK_NAME]:"BrightCoveHTML5Player",[Conviva.Constants.FRAMEWORK_VERSION]:"NaForHTML5"}}function collectContentMetdata(b,a){return Object.assign({[Conviva.Constants.ASSET_NAME]:"["+a.assetID+"] "+a.title,[Conviva.Constants.STREAM_URL]:a.url,[Conviva.Constants.IS_LIVE]:!0==a.live?Conviva.Constants.StreamType.LIVE:Conviva.Constants.StreamType.VOD,[Conviva.Constants.PLAYER_NAME]:a.playerName,[Conviva.Constants.VIEWER_ID]:a.adobeViewerID,[Conviva.Constants.DURATION]:a.durationSec,[Conviva.Constants.DEFAULT_RESOURCE]:"Akamai"},a)}function collectAdMetadata(a){return{[Conviva.Constants.ASSET_NAME]:a.title||a.id,[Conviva.Constants.STREAM_URL]:a.mediaUrl||a.resourceURI,[Conviva.Constants.PLAYER_NAME]:"THEOplayer",[Conviva.Constants.DURATION]:a.duration,[Conviva.Constants.IS_LIVE]:Conviva.Constants.StreamType.VOD}}function calculateBufferLength(a){let b=a.buffered;if(void 0===b)return;let d=0;for(let c=0;c<b.length;c+=1){let f=b.start(c),e=b.end(c);f<=a.currentTime&&a.currentTime<e&&(d+=e-a.currentTime)}return 1e3*d}function findCurrentLinearAd(b){for(let a of b)if("linear"===a.type)return a}class NewConvivaIntegration{constructor(a,b,c){this._convivaVideoAnalytics=void 0,this._convivaAdAnalytics=void 0,this._isFirstContentPlay=!0,this._isAdBreakEnabled=!0,this._contentPlaybackEnded=!1,this._allAdsCompleted=!0,this._isPlayingAd=!1,this._isPlayingPostRoll=!1,this._currentAdBreak=void 0,this._adBreakStartSent=!1,this._adStartSent=!1,this._onPlayerLoadedMetadata=()=>{if(this._player&& !this._isPlayingAd&&this._convivaVideoAnalytics){let a=this._player.duration();if(!isNaN(a)&&a!==1/0){let b={[Conviva.Constants.DURATION]:a};this._convivaVideoAnalytics.setContentInfo(b)}this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.RESOLUTION,this._player.videoWidth(),this._player.videoHeight())}},this._onPlayerPlay=()=>{this._player&&(this._isFirstContentPlay&&(this._convivaVideoAnalytics||this._initConvivaClient(b),this._convivaVideoAnalytics.reportPlaybackRequested(collectContentMetdata(this._player,c))),this._isFirstContentPlay=!1)},this._onPlayerPlaying=()=>{this._player&& !this._isPlayingAd&&this._convivaVideoAnalytics&&this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PLAYING)},this._onPlayerPause=()=>{this._player&& !this._isPlayingAd&&this._convivaVideoAnalytics&&this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PAUSED)},this._onPlayerEmptied=()=>{this._player&& !this._isPlayingAd&&this._convivaVideoAnalytics&&this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.BUFFERING)},this._onPlayerWaiting=()=>{this._player&& !this._isPlayingAd&&this._convivaVideoAnalytics&&this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.BUFFERING)},this._onPlayerSeeking=()=>{this._player&& !this._isPlayingAd&&this._convivaVideoAnalytics&&this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.SEEK_STARTED)},this._onPlayerSeeked=()=>{this._player&& !this._isPlayingAd&&this._convivaVideoAnalytics&&this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.SEEK_ENDED)},this._onPlayerError=()=>{this._player&&(this._convivaVideoAnalytics||(this._convivaVideoAnalytics=Conviva.Analytics.buildVideoAnalytics()),this._convivaVideoAnalytics.reportPlaybackFailed("Fatal error occured"),this._convivaVideoAnalytics.release(),this._convivaVideoAnalytics=void 0,Conviva.Analytics.release(),this._contentPlaybackEnded=!0)},this._onSegmentNotFound=()=>{this._player&&(this._convivaVideoAnalytics||(this._convivaVideoAnalytics=Conviva.Analytics.buildVideoAnalytics()),this._convivaVideoAnalytics.reportPlaybackError("A Video Playback Failure has occurred: Segment not found",Conviva.Constants.ErrorSeverity.FATAL))},this._reportManifestOffline=()=>{this._player&&(this._convivaVideoAnalytics||(this._convivaVideoAnalytics=Conviva.Analytics.buildVideoAnalytics()),this._convivaVideoAnalytics.reportPlaybackError("A Video Playback Failure has occurred: Waiting for the manifest to come back online",Conviva.Constants.ErrorSeverity.FATAL))},this._onPlayerEnded=()=>{this._player&&(!this._isPlayingAd&&this._convivaVideoAnalytics&&(this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),this._allAdsCompleted&&(this._convivaVideoAnalytics.reportPlaybackEnded(),this._convivaVideoAnalytics.release(),this._convivaVideoAnalytics=void 0,Conviva.Analytics.release())),this._contentPlaybackEnded=!0,this._isFirstContentPlay=!0)},this._onAdStopped=()=>{this._player&&this._convivaAdAnalytics&&(this._convivaAdAnalytics.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),this._convivaAdAnalytics.reportAdSkipped(),this._convivaAdAnalytics.release(),this._convivaAdAnalytics=void 0)},this._onAdBuffering=()=>{this._player&&this._convivaAdAnalytics&&this._convivaAdAnalytics.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.BUFFERING)},this._onAdBreakBegin=()=>{if(this._player&&(this._isPlayingAd=!0,this._allAdsCompleted=!1,this._convivaVideoAnalytics&&this._player.ads)){if(this._isAdBreakEnabled){let b=this._currentAdBreak=this._player.ads.ad||void 0;if(!b)return;let c=b.timeOffset,a;0===c?a="Pre-roll":c<0?(a="Post-roll",this._isPlayingPostRoll=!0):a="Mid-roll";let d=this._player.ads.pod.id,e={[Conviva.Constants.POD_POSITION]:a,[Conviva.Constants.POD_DURATION]:b.duration,[Conviva.Constants.POD_INDEX]:d};this._convivaVideoAnalytics.reportAdBreakStarted(Conviva.Constants.AdType.CLIENT_SIDE,Conviva.Constants.AdPlayer.CONTENT,e),this._adBreakStartSent=!0}else this._convivaVideoAnalytics.reportPlayerInFocus(!1)}},this._onAdBreakEnd=()=>{this._player&&this._player.ads&&(this._convivaVideoAnalytics&&(this._isAdBreakEnabled?this._adBreakStartSent&&this._convivaVideoAnalytics.reportAdBreakEnded():this._isPlayingPostRoll||this._convivaVideoAnalytics.reportPlayerInFocus(!0),this._isPlayingPostRoll&&(this._convivaVideoAnalytics.reportPlaybackEnded(),this._convivaVideoAnalytics.release(),this._convivaVideoAnalytics=void 0,Conviva.Analytics.release(),this._contentPlaybackEnded=!0,this._allAdsCompleted=!0)),this._adBreakStartSent=!1,this._isPlayingAd=!1,this._currentAdBreak=void 0)},this._onAdBegin=()=>{this._player&&(this._adStartSent=!1,this._player.addEventListener("playing",this._onAdsPlayerPlaying),this._player.addEventListener("pause",this._onAdsPlayerPause))},this._onAdsPlayerPlaying=()=>{if(!this._player||!this._player.ads)return;let a=findCurrentLinearAd(this._player.ads.currentAds);if(a){if(this._adStartSent)this._convivaAdAnalytics&&this._convivaAdAnalytics.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PLAYING);else if(this._convivaAdAnalytics||(this._convivaAdAnalytics=Conviva.Analytics.buildAdAnalytics(this._convivaVideoAnalytics)),this._convivaAdAnalytics){let b=collectAdMetadata(a);this._convivaAdAnalytics.setAdInfo(b),this._convivaAdAnalytics.reportAdLoaded(),this._convivaAdAnalytics.reportAdStarted(),this._adStartSent=!0,this._convivaAdAnalytics.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PLAYING),this._convivaAdAnalytics.reportAdMetric(Conviva.Constants.Playback.RESOLUTION,this._player.videoWidth,this._player.videoHeight),this._convivaAdAnalytics.reportAdMetric(Conviva.Constants.Playback.BITRATE,a.bitrate||0)}}},this._onAdsPlayerPause=()=>{if(!this._player||!this._player.ads)return;let a=findCurrentLinearAd(this._player.ads.currentAds);a&&this._convivaAdAnalytics&&this._convivaAdAnalytics.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PAUSED)},this._onAdEnd=()=>{if(!this._player||!this._player.ads)return;let a=findCurrentLinearAd(this._player.ads.currentAds);a||(this._convivaAdAnalytics&&this._convivaAdAnalytics.reportAdEnded(),this.contentPlaybackEnded&&this._convivaVideoAnalytics&&(this._convivaVideoAnalytics.reportPlaybackEnded(),this._convivaVideoAnalytics.release(),this._convivaVideoAnalytics=void 0,Conviva.Analytics.release()),this._player.removeEventListener("playing",this._onAdsPlayerPlaying),this._player.removeEventListener("pause",this._onAdsPlayerPause))},this._onAdsError=a=>{this._player&&(this._player.removeEventListener("playing",this._onAdsPlayerPlaying),this._player.removeEventListener("pause",this._onAdsPlayerPause),this._convivaAdAnalytics||(this._convivaAdAnalytics=Conviva.Analytics.buildAdAnalytics(this._convivaVideoAnalytics)),this._convivaAdAnalytics&&(this._convivaAdAnalytics.reportAdFailed(a.message||"Ad Request Failed"),this._convivaAdAnalytics.release(),this._convivaAdAnalytics=void 0))},this._player=a,this._initConvivaClient(b),this._registerVideoListeners(),this._registerAdsLoaderListeners()}_initConvivaClient(a){Conviva.Analytics.init(a[Conviva.Constants.CUSTOMER_KEY],CONVIVA_CALLBACK_FUNCTIONS,a),Conviva.Analytics.setDeviceMetadata(collectDeviceMetadata()),this._convivaVideoAnalytics||(this._convivaVideoAnalytics=Conviva.Analytics.buildVideoAnalytics(),this._convivaVideoAnalytics.setPlayerInfo(collectPlayerInfo()),this._convivaVideoAnalytics.setCallback(()=>{if(this._convivaVideoAnalytics&&this._player&&(this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.PLAY_HEAD_TIME,1e3*this._player.currentTime()),this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.BUFFER_LENGTH,calculateBufferLength(this._player)),this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.RESOLUTION,this._player.videoWidth(),this._player.videoHeight()),this._player.tech(!0).vhs.playlists.media().attributes.BANDWIDTH)){let a=this._player.tech(!0).vhs.playlists.media().attributes.BANDWIDTH/1e3,b=this._player.tech(!0).vhs.playlists.media().attributes["FRAME-RATE"];this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.BITRATE,a),this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.RENDERED_FRAMERATE,b)}}),this._contentPlaybackEnded=!1)}_registerVideoListeners(){this._player.on("play",this._onPlayerPlay),this._player.on("pause",this._onPlayerPause),this._player.on("playing",this._onPlayerPlaying),this._player.on("emptied",this._onPlayerEmptied),this._player.on("waiting",this._onPlayerWaiting),this._player.on("error",this._onPlayerError),this._player.on("loadedmetadata",this._onPlayerLoadedMetadata),this._player.on("seeking",this._onPlayerSeeking),this._player.on("seeked",this._onPlayerSeeked),this._player.on("ended",this._onPlayerEnded),this._player.on("loadstart",this._onPlayerWaiting),this._player.on("segmentnotfound",this._onSegmentNotFound)}_registerAdsLoaderListeners(){this._player.ads&&(this._convivaAdAnalytics=Conviva.Analytics.buildAdAnalytics(this._convivaVideoAnalytics),this._player.on("ads-ad-started",this._onAdBreakBegin),this._player.on("ads-ad-ended",this._onAdBreakEnd))}destroy(){this._player.removeEventListener("play",this._onPlayerPlay),this._player.removeEventListener("pause",this._onPlayerPause),this._player.removeEventListener("playing",this._onPlayerPlaying),this._player.removeEventListener("emptied",this._onPlayerEmptied),this._player.removeEventListener("waiting",this._onPlayerWaiting),this._player.removeEventListener("error",this._onPlayerError),this._player.removeEventListener("loadedmetadata",this._onPlayerLoadedMetadata),this._player.removeEventListener("seeking",this._onPlayerSeeking),this._player.removeEventListener("seeked",this._onPlayerSeeked),this._player.removeEventListener("ended",this._onPlayerEnded),this._player.removeEventListener("loadstart",this._onPlayerWaiting),this._player.removeEventListener("segmentnotfound",this._onSegmentNotFound),this._player.network.removeEventListener("offline",this._reportManifestOffline),this._player.ads&&(this._player.ads.removeEventListener("aderror",this._onAdsError),this._player.ads.removeEventListener("adbreakbegin",this._onAdBreakBegin),this._player.ads.removeEventListener("adbreakend",this._onAdBreakEnd),this._player.ads.removeEventListener("adbegin",this._onAdBegin),this._player.ads.removeEventListener("adend",this._onAdEnd),this._player.ads.removeEventListener("adskip",this._onAdStopped),this._player.ads.removeEventListener("adbuffering",this._onAdBuffering)),this._convivaAdAnalytics&&this._convivaAdAnalytics.release(),this._convivaVideoAnalytics&&this._convivaVideoAnalytics.release(),Conviva.Analytics.release(),this._player=void 0,this._convivaVideoAnalytics=void 0,this._convivaAdAnalytics=void 0,this._currentAdBreak=void 0}}

            //plugin
            videojs.registerPlugin('AdobeConviva', function(options) {
                function log(m, p) {
                    if (!p) {
                        console.log(m)
                    }
                }
                var prod = false;
                var adobe = true;
                if (!options) {
                    console.log("Options has not been added, please add the options on video cloud")
                } else {
                    prod = (window.localStorage.getItem("sdsat_debug") == 'false') || (options["env"] == "production");
                    adobe = options["adobe"];
                }

                var myPlayer = this;
                var isContentLoaded = false;
                var videoDuration;
                var mediaName;
                var mediaPlayerName = window.location.hostname;
                var currentTime;
                var isPlaying = false;
                var videoEnd = false;
                var bitRate = 0;

                var metadata = {};
                var firstPlay = false;
                var tmAdReq = false;
                var tmAdPlay = false;
                var tmAdBeacon = false;

                var integration;
                //Setting Up Conviva Configs default as test
                
                var TEST_CUSTOMER_KEY = options.testing.customerKey; //'69b93c2f8bf26c0edf513501a13f4da18556fb68';
                var TOUCHSTONE_SERVICE_URL = options.testing.gatewayUrl; //'https://telstra-afl.testonly.conviva.com';

                var convivaConfigs = {};
                convivaConfigs[Conviva.Constants.GATEWAY_URL] = TOUCHSTONE_SERVICE_URL;
                convivaConfigs[Conviva.Constants.LOG_LEVEL] = Conviva.Constants.LogLevel.DEBUG;
                convivaConfigs[Conviva.Constants.CUSTOMER_KEY] = TEST_CUSTOMER_KEY;
                
                switch (prod)
                {
                    case true:
                        
                        convivaConfigs[Conviva.Constants.GATEWAY_URL] = options.production.gatewayUrl;
                        convivaConfigs[Conviva.Constants.LOG_LEVEL] = Conviva.Constants.LogLevel.ERROR;
                        convivaConfigs[Conviva.Constants.CUSTOMER_KEY] = options.production.customerKey;
                    break;    
                    case false:
                        convivaConfigs[Conviva.Constants.GATEWAY_URL] = options.testing.gatewayUrl;
                        convivaConfigs[Conviva.Constants.LOG_LEVEL] = Conviva.Constants.LogLevel.DEBUG;
                        convivaConfigs[Conviva.Constants.CUSTOMER_KEY] = options.testing.customerKey;
           
                    break;    
                }
                


                var viewerID = "random:" + Math.random() * 1e9;

                if (adobe) {
                    viewerID = s.visitor.getMarketingCloudVisitorID();
                }

                function ABDMediaOPEN() {
                    log("++ IN ABDMediaOPEN TOP ++", prod);

                    //Check the metadata is loaded
                    if (isContentLoaded) {
                        log("++ IN ABDMediaOPEN content loaded ++", prod);
                        //Get all required metadata
                        currentTime = myPlayer.currentTime();
                        mediaName = myPlayer.mediainfo.name;
                        videoDuration = myPlayer.mediainfo.duration;

                        metadata = {};

                        metadata["id"] = myPlayer.mediainfo.id;
                        metadata["title"] = mediaName;
                        metadata["url"] = myPlayer.mediainfo.sources[0].src;
                        metadata["live"] = myPlayer.mediainfo.duration == 0 ? true : false;
                        metadata["durationSec"] = ""+videoDuration;
                        metadata["streamType"] = myPlayer.mediainfo.sources[0].type;
                        metadata["applicationName"] = window.location.hostname;

                        //when live streaming append the matchname from the datalayer // may need to be fixed up
                        if (getSafe(()=>dataLayer.filter(function(obj) {
                            return obj.event === 'matchView'
                        })[0].matchName, false)) {
                            metadata["title"] = mediaName + " - " + dataLayer.filter(function(obj) {
                                return obj.event === 'matchView'
                            })[0].matchName;
                        }

                        //when unily grab the page title as well
                        var top_url = top_url = (window.location != window.parent.location) ? document.referrer != "" ? document.referrer : document.location.href : document.location.href;
                        var t_test = new URL(top_url);

                        if (/telstra\.unily\.com/.test(top_url) && t_test.pathname.length > 0) {
                            metadata["title"] = mediaName + " [" + t_test.pathname + "]";
                        }

                        //custom 
                        metadata["assetID"] = myPlayer.mediainfo.id;
                        metadata["channel"] = window.location.hostname;
                        metadata["playerName"] = getPlayerName();

                        metadata["adobeViewerID"] = viewerID;

                        //createConvivaSession
                        userData = {}
                        userData["id"] = viewerID;
                        userData["hostname"] = window.location.hostname;

                        //add all custom fields 
                        Object.assign(metadata, myPlayer.mediainfo.customFields);
                        Object.assign(metadata, userData);

                        log(JSON.stringify(metadata), prod)

                        //Open adobe Analytics Media Module	

                        adobe && s.Media.open(mediaName, videoDuration, mediaPlayerName);

                        //Check if video is playing
                        //if (isPlaying) {
                        //    log("++IN ABDMediaOPEN video is playing " + mediaName + " | " + videoDuration, prod);
                        //Play Adobe Analytics Media module from beginning.
                        //    adobe && s.Media.play(mediaName, currentTime);
                        // }
                    }
                }

                //Used to reset the variables as when the next videos play, the play event is called before loadstart ...
                function resetVariables() {
                    isContentLoaded = false;
                    videoDuration = currentTime = "";
                    videoEnd = true;
                    bitRate = 0;
                }

                myPlayer.on('loadstart', function() {
                    log("++loadstart - " + myPlayer.mediainfo.name, prod);
                    firstPlay = true;
                    //Check that metadata is loaded
                    if (myPlayer.mediainfo.name) {
                        isContentLoaded = true;
                        //Initiate Adobe Analytics Media Module tracking && Conviva Analytics
                    }
                });

                myPlayer.on('ads-request', function() {
                    log("++ads-ad-request - " + myPlayer.mediainfo.name, prod);
                    tmAdReq = true;
                });

                myPlayer.on('ads-ad-ended', function() {
                    log("++ads-ad-ended - " + myPlayer.mediainfo.name, prod);
                    tmAdPlay = true;
                });

                myPlayer.on('play', function() {
                    log("++Played - " + myPlayer.mediainfo.name, prod);
                    isPlaying = true;
                    if (firstPlay) {
                        log("++ First Play via played - " + myPlayer.mediainfo.name, prod);
                        firstPlay = false;
                        isContentLoaded = true;
                        ABDMediaOPEN();
                        //integration = new NewConvivaIntegration(myPlayer, convivaConfigs, metadata);
                        //convivaHelper.createConvivaSession(userData, metadata);
                        //convivaHelper.attachPlayerToSession();

                    }

                    if (videoEnd) {
                        //user has restarted video from end 
                        videoEnd = false;
                        isContentLoaded = true;
                        ABDMediaOPEN();
                        //convivaHelper.createConvivaSession(userData, metadata);
                        //convivaHelper.attachPlayerToSession();

                    }

                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        if (adobe) {
                            s.eVar63 = mediaName
                            //s.Media.play(mediaName, currentTime);

                        }

                    }
                });

                myPlayer.on("playing", function() {
                    log("++ In Playing ++", prod)

                    //convivaHelper.setPlayerWidthAndHeight(myPlayer.videoWidth(), myPlayer.videoHeight());
                    //convivaHelper.updatePlayerState("playing");
                });

                myPlayer.on('pause', function() {
                    isPlaying = false;
                    log("++paused - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        adobe && s.Media.stop(mediaName, currentTime);
                        //convivaHelper.updatePlayerState("pause");
                    }
                });

                myPlayer.on('progress', function() {
                    log("progressed - " + myPlayer.mediainfo.name, prod);

                });

                myPlayer.on('resize', function() {
                    log("resized - " + myPlayer.mediainfo.name, prod);
                });

                myPlayer.on('seeked', function() {
                    log("++seeked - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        adobe && s.Media.play(mediaName, currentTime);
                        //convivaHelper.contentSeeked();
                    }
                });

                myPlayer.on('seeking', function() {
                    log("++seeking - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        adobe && s.Media.stop(mediaName, currentTime);
                    }
                });

                myPlayer.on('stalled', function() {
                    log("++stalled - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.

                });

                myPlayer.on('timeupdate', function() {
                    log("++timeupdate - " + myPlayer.currentTime(), prod);

                    if (adobe && isPlaying && !tmAdBeacon && myPlayer.currentTime() > 0) {

                        //s.Media.trackVars+= ",contextData.tmAdReq,contextData.tmAdPlay"
                        tmAdReq ? s.contextData['tmAdReq'] = "yes" : s.contextData['tmAdReq'] = "no";
                        tmAdPlay ? s.contextData['tmAdPlay'] = "yes" : s.contextData['tmAdPlay'] = "no";

                        //s.tl();
                        tmAdBeacon = true;
                        log("++ In timeupdate ++ " + mediaName + " | " + videoDuration, prod);
                        //Play Adobe Analytics Media module from beginning.
                        s.Media.play(mediaName, currentTime);
                    }

                });

                myPlayer.on('volumechange', function() {
                    log("++volumechange - " + myPlayer.mediainfo.name, prod);
                });

                myPlayer.on('waiting', function() {
                    log("++waiting - " + myPlayer.mediainfo.name, prod);
                    if (isContentLoaded) {//convivaHelper.updatePlayerState("waiting");
                    }
                });

                myPlayer.on('durationchange', function() {
                    log("++durationchange - " + myPlayer.mediainfo.name, prod);
                });

                myPlayer.on('ended', function() {
                    log("++ended - " + myPlayer.mediainfo.description, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        adobe && s.Media.stop(mediaName, currentTime);
                        adobe && s.Media.close(mediaName);
                        //convivaHelper.updatePlayerState("ended");
                        //convivaHelper.cleanupConvivaSession();
                        resetVariables();
                    }
                });

                myPlayer.on("bc-catalog-error", function() {
                    log("++ In Catalog Error ++", prod);
                    var error = myPlayer.error_;
                    var code = error.code;
                    var message = error.message;
                    var type = error.type;
                    //convivaHelper.contentReportError(code + ": " + message + " " + type, Conviva.Client.ErrorSeverity.FATAL);
                    //convivaHelper.cleanupConvivaSession();
                });

                myPlayer.on("error", function() {
                    log("++ In Error ++", prod);
                    var error = myPlayer.error_;
                    var code = error.code;
                    var message = error.message;
                    var type = error.type;
                    //convivaHelper.contentReportError(code + ": " + message + " " + type, Conviva.Client.ErrorSeverity.FATAL);
                    //convivaHelper.cleanupConvivaSession();
                });

                myPlayer.on('fullscreenchange', function() {
                    log("++fullscreenchange - " + myPlayer.mediainfo.name, prod);
                });

                myPlayer.on('loadedalldata', function() {
                    log("++loadedalldata - " + myPlayer.mediainfo.name, prod);

                });

                myPlayer.on('loadeddata', function() {
                    log("++loadeddata - " + myPlayer.mediainfo.name, prod);

                    //integration.collectContentMetdata();
                    integration = new NewConvivaIntegration(myPlayer,convivaConfigs,metadata);

                });

                myPlayer.on('loadedmetadata', function() {
                    log("++loadedmetadata - " + myPlayer.mediainfo.name, prod);
                    if (myPlayer.mediainfo.name) {
                        isContentLoaded = true;
                        //Initiate Adobe Analytics Media Module tracking && Conviva Analytics
                        ABDMediaOPEN();
                    }
                });

                function getSafe(fn, defaultVal) {
                    try {
                        return fn();
                    } catch (e) {
                        return defaultVal;
                    }
                }

                function getPlayerName() {
                    var hostname = window.location.hostname.replace(/^(www\.|m\.)/, '');

                    aflSitesArray = new Object();
                    aflSitesArray['afl.com.au'] = 'AFL Network';
                    aflSitesArray['fantasy.afl.com.au'] = 'AFL Fantasy';
                    aflSitesArray['tipping.afl.com.au'] = 'AFL Tipping';
                    aflSitesArray['afc.com.au'] = 'Adelaide Crows';
                    aflSitesArray['lions.com.au'] = 'Brisbane Lions';
                    aflSitesArray['carltonfc.com.au'] = 'Carlton Blues';
                    aflSitesArray['collingwoodfc.com.au'] = 'Collingwood Magpies';
                    aflSitesArray['essendonfc.com.au'] = 'Essendon Bombers';
                    aflSitesArray['fremantlefc.com.au'] = 'Fremantle';
                    aflSitesArray['geelongcats.com.au'] = 'Geelong Cats';
                    aflSitesArray['goldcoastfc.com.au'] = 'Gold Coast';
                    aflSitesArray['gwsgiants.com.au'] = 'GWS';
                    aflSitesArray['hawthornfc.com.au'] = 'Hawthorn Hawks';
                    aflSitesArray['melbournefc.com.au'] = 'Melbourne Demons';
                    aflSitesArray['nmfc.com.au'] = 'Kangaroos';
                    aflSitesArray['portadelaidefc.com.au'] = 'Port Adelaide';
                    aflSitesArray['richmondfc.com.au'] = 'Richmond Tigers';
                    aflSitesArray['saints.com.au'] = 'St.Kilda Saints';
                    aflSitesArray['sydneyswans.com.au'] = 'Sydney Swans';
                    aflSitesArray['westcoasteagles.com.au'] = 'West Coast Eagles';
                    aflSitesArray['westernbulldogs.com.au'] = 'Western Bulldogs';
                    aflSitesArray['womens.afl'] = 'AFLW Network';

                    return aflSitesArray[hostname] || "AFL test";
                }

            });
