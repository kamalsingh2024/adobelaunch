/*! (C) 2023 Conviva, Inc. All rights reserved. Confidential and proprietary. */ !function(t,e){"function"==typeof define&&define.amd?define(e):("object"==typeof exports||"object"==typeof module&&module.exports)&&(module.exports=e()),void 0!==t&&t&&(t.Conviva||t.ConvivaLoading||(t.ConvivaLoading=!0,t.Conviva=e(),delete t.ConvivaLoading))}(this,function(){var t,e={};return t={},!function(){var i=e.Constants={};i.version="4.5.9",i.CUSTOMER_KEY="customerKey",i.GATEWAY_URL="gatewayUrl",i.LOG_LEVEL="logLevel",i.ASSET_NAME="Conviva.assetName",i.PLAYER_NAME="Conviva.applicationName",i.APPLICATION_VERSION="c3.app.version",i.IS_LIVE="Conviva.streamType",i.ENCODED_FRAMERATE="Conviva.encodedFrameRate",i.DEFAULT_RESOURCE="Conviva.defaultResource",i.STREAM_URL="Conviva.streamUrl",i.VIEWER_ID="Conviva.viewerId",i.DURATION="Conviva.duration",i.UTM_TRACKING_URL="c3.cm.utmTrackingUrl",i.POD_INDEX="podIndex",i.POD_POSITION="podPosition",i.POD_DURATION="podDuration",i.AD_TYPE="adType",i.MODULE_NAME="Conviva.moduleName",i.MODULE_VERSION="Conviva.moduleVersion",i.FRAMEWORK_NAME="Conviva.frameworkName",i.FRAMEWORK_VERSION="Conviva.frameworkVersion",i.i="Constants not yet configured",i.e="Invalid : Did you report playback ended?",i.s="Invalid : Did you report ad playback ended?",i.o="Player cannot be null",i.u="PlaybackAnlytics already built",i.h="PlaybackAnlytics not yet built",i.Playback={BITRATE:"BITRATE",PLAY_HEAD_TIME:"PLAY_HEAD_TIME",RESOLUTION:"RESOLUTION",BUFFER_LENGTH:"BUFFER_LENGTH",PLAYER_STATE:"PLAYER_STATE",RENDERED_FRAMERATE:"RENDERED_FRAMERATE",SEEK_STARTED:"SEEK_STARTED",SEEK_ENDED:"SEEK_ENDED",CDN_IP:"CDN_IP",DROPPED_FRAMES_TOTAL:"DROPPED_FRAMES_TOTAL",DROPPED_FRAMES_COUNT:"DROPPED_FRAMES_COUNT"},i.Network={SIGNAL_STRENGTH:"SIGNAL_STRENGTH",LINK_ENCRYPTION:"LINK_ENCRYPTION",CONNECTION_TYPE:"CONNECTION_TYPE"},i.ErrorSeverity={FATAL:1,WARNING:0},i.NO_SESSION_KEY=-2,i.AdPosition={PREROLL:"Pre-roll",MIDROLL:"Mid-roll",POSTROLL:"Post-roll"},i.AdPlayer={CONTENT:"CONTENT",SEPARATE:"SEPARATE"},i.DeviceType={DESKTOP:"DESKTOP",CONSOLE:"Console",SETTOP:"Settop",MOBILE:"Mobile",TABLET:"Tablet",SMARTTV:"SmartTV"},i.AdType={CLIENT_SIDE:"Client Side",SERVER_SIDE:"Server Side"},i.AdSlates={BLACKOUT_SLATE:"Blackout slate",TECHNICAL_DIFFICULTIES_SLATE:"Technical Difficulties slate",COMMERCIAL_SLATE:"Commercial Break slate",OTHER_SLATE:"Other slate",VPAID:"VPAID",REGULAR:"Regular Ad"},i.AdServingType={INLINE:"Inline",WRAPPER:"Wrapper"},i.DeviceCategory={ANDROID_DEVICE:"AND",APPLE_DEVICE:"APL",CHROMECAST:"CHR",DESKTOP_APP:"DSKAPP",DEVICE_SIMULATOR:"SIMULATOR",LG_TV:"LGTV",NINTENDO:"NINTENDO",PLAYSTATION:"PS",ROKU:"RK",SAMSUNG_TV:"SAMSUNGTV",SMART_TV:"TV",SET_TOP_BOX:"STB",TIVO:"TIVO",WEB:"WEB",WINDOWS_DEVICE:"WIN",XBOX:"XB",KAIOS_DEVICE:"KAIOS"},i.LogLevel={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},i.PlayerState={STOPPED:"STOPPED",PLAYING:"PLAYING",BUFFERING:"BUFFERING",PAUSED:"PAUSED",UNKNOWN:"UNKNOWN",NOT_MONITORED:"NOT_MONITORED"},i.Events={USER_WAIT_STARTED:"Conviva.UserWaitStarted",USER_WAIT_ENDED:"Conviva.UserWaitEnded",BUMPER_VIDEO_STARTED:"Conviva.BumperVideoStarted",BUMPER_VIDEO_ENDED:"Conviva.BumperVideoEnded",AD_REQUESTED:"Conviva.AdRequested",AD_RESPONSE:"Conviva.AdResponse",AD_SLOT_STARTED:"Conviva.SlotStarted",AD_ATTEMPTED:"Conviva.AdAttempted",AD_SLOT_ENDED:"Conviva.SlotEnded",AD_IMPRESSION_START:"Conviva.AdImpression",AD_START:"Conviva.AdStart",AD_FIRST_QUARTILE:"Conviva.AdFirstQuartile",AD_MID_QUARTILE:"Conviva.AdMidQuartile",AD_THIRD_QUARTILE:"Conviva.AdThirdQuartile",AD_COMPLETE:"Conviva.AdComplete",AD_END:"Conviva.AdEnd",AD_IMPRESSION_END:"Conviva.AdImpressionEnd",AD_SKIPPED:"Conviva.AdSkipped",AD_ERROR:"Conviva.AdError",AD_PROGRESS:"Conviva.AdProgress",AD_CLOSE:"Conviva.AdClose",CONTENT_PAUSED:"Conviva.PauseContent",CONTENT_RESUMED:"Conviva.ResumeContent",POD_START:"Conviva.PodStart",POD_END:"Conviva.PodEnd"},i.ErrorType={ERROR_UNKNOWN:"ERROR_UNKNOWN",ERROR_IO:"ERROR_IO",ERROR_TIMEOUT:"ERROR_TIMEOUT",ERROR_NULL_ASSET:"ERROR_NULL_ASSET",ERROR_MISSING_PARAMETER:"ERROR_MISSING_PARAMETER",ERROR_NO_AD_AVAILABLE:"ERROR_NO_AD_AVAILABLE",ERROR_PARSE:"ERROR_PARSE",ERROR_INVALID_VALUE:"ERROR_INVALID_VALUE",ERROR_INVALID_SLOT:"ERROR_INVALID_SLOT",ERROR_3P_COMPONENT:"ERROR_3P_COMPONENT",ERROR_UNSUPPORTED_3P_FEATURE:"ERROR_UNSUPPORTED_3P_FEATURE",ERROR_DEVICE_LIMIT:"ERROR_DEVICE_LIMIT",ERROR_UNMATCHED_SLOT_SIZE:"ERROR_UNMATCHED_SLOT_SIZE"},i.StreamType={UNKNOWN:"UNKNOWN",LIVE:"LIVE",VOD:"VOD"},i.CallbackFunctions={CONSOLE_LOG:"consoleLog",MAKE_REQUEST:"makeRequest",SAVE_DATA:"saveData",LOAD_DATA:"loadData",GET_EPOCH_TIME_IN_MS:"getEpochTimeInMs",CREATE_TIMER:"createTimer",GENERATE_HASH:"generateHash",BASE64_ENCODE:"base64Encode"},i.DeviceMetadata={BRAND:"DeviceBrand",MANUFACTURER:"DeviceManufacturer",MODEL:"DeviceModel",TYPE:"DeviceType",VERSION:"DeviceVersion",OS_NAME:"OperatingSystemName",OS_VERSION:"OperatingSystemVersion",CATEGORY:"DeviceCategory",SCREEN_RESOLUTION_WIDTH:"ScreenWidth",SCREEN_RESOLUTION_HEIGHT:"ScreenHeight",SCREEN_RESOLUTION_SCALE_FACTOR:"ScaleFactor"},i.AD_PRELOAD_FEATURE="adPreloading",i.AD_TAG_URL="adTagUrl",i.IMASDK_CONTENT_PLAYER="imaMainContentPlayer",i.CONVIVA_AD_MODULE="convivaAdModule",i.CONVIVA_MODULE="convivaModule",i.MEDIA_ELEMENT="mediaElement";var n=e.Client=function(){var t=this;this.a=!1,this.version=n.version,this.c=null,this.l=null,this.v=null,this.d=-1,this.p=null,this.R=null,this.w=null,this.T=null,this.g=-1,this.S=!1,this.N={},this.O=function(){t.c},this._={},this.A=null,this.C=null,this.I=null,this.y=function(){this.w.m("Client.makeIPV4IPV6GlobalSessions",function(){var e;!t.T||null!==(e=t.T.get(X.D))&&e!==K.P&&t.l&&((e=new a).custom["c3.IPV4IPV6GlobalSession"]="T",e.custom["c3.domain"]=t.p.M.indexOf(s.L)>-1?s.L:s.U,t.V=t.l.k(e,null),(e=new a).custom["c3.IPV4IPV6GlobalSession"]="T",e.custom["c3.domain"]=t.p.F.indexOf(s.H)>-1?s.H:s.B,t.G=t.l.k(e,null))})},this.j=function(e){t.w.m("Client.updateConnectionType",function(){if(t.A=e,t.l){var i,n=t.l.K();for(i in n)n[i].W(e)}})},this.q=function(e){t.w.m("Client.updateLinkEncryption",function(){if(t.C=e,t.l){var i,n=t.l.K();for(i in n)n[i].Y(e)}})},this.J=function(e){t.w.m("Client.updateSignalStrength",function(){t.I=e})},(function(e,n,a,r){if(!(e instanceof s))throw Error("clientSettings parameter should be an instance of ClientSettings.");if(!(n instanceof E))throw Error("systemFactory parameter should be an instance of SystemFactory.");e.gatewayUrl!==s.X+s.Q&&e.gatewayUrl!==s.Z+s.Q||(this.a=!0),r&&(this.version=r),this.p=e.z(),this.v=n,this.v.$("SDK",this.p,this.version),this.w=this.v.tt(this.version),this.w.m("Client.init",function(){if(t.T=t.v.nt(),t.T.it(),t.g=t.T.get(X.et),-1!==t.g&&void 0!==t.g&&null!==t.g||(t.g=ts.ot()),t.l=t.v.rt(t,t.p,t.T),a)for(var e in a)switch(e){case i.Network.CONNECTION_TYPE:t.j(a[e]);break;case i.Network.LINK_ENCRYPTION:t.q(a[e]);break;case i.Network.SIGNAL_STRENGTH:t.J(a[e])}t.y()},function(t){throw Error("Client constructor failed: "+t.message)})}).apply(this,arguments),this.release=function(){this.S||this.w.m("Client.release",function(){t.c,t.l.ut(),t.l=null,t.d=-1,t.g=-1,t.w=null,t.p=null,t.R=null,t.v=null,t.S=!0})},this.createSession=function(e,s,r){var o=n.NO_SESSION_KEY;return this.S||(!e||e instanceof a)&&this.w.m("Client.createSession",function(){o=t.l.ht(e,W.ct.ft,s,(r?i:t).version)}),o},this.createAdSession=function(e,s,r,o,c){var h=n.NO_SESSION_KEY;return this.S||(!s||s instanceof a)&&this.w.m("Client.createAdSession",function(){var u,l;s||(s=new a),!te.lt(e)||e===n.NO_SESSION_KEY||(u=t.l.vt(e))&&(l=s.custom[i.APPLICATION_VERSION],s.applicationName&&s.viewerId&&void 0!==l&&l||u.dt&&u.dt.Et&&(!s.viewerId&&u.dt.Et.viewerId&&(s.viewerId=u.dt.Et.viewerId),!s.applicationName&&u.dt.Et.applicationName&&(s.applicationName=u.dt.Et.applicationName),void 0!==l&&l||void 0!==(l=u.dt.Et.custom[i.APPLICATION_VERSION])&&l&&(s.custom[i.APPLICATION_VERSION]=l)),s.custom["c3.csid"]=te.pt(u.g)),h=t.l.ht(s,W.ct.Rt,r,(o?i:t).version,c)}),h},this.reportError=function(e,i,s){this.S||te.wt(i)&&(s!==n.ErrorSeverity.FATAL&&s!==n.ErrorSeverity.WARNING||this.w.m("Client.reportError",function(){var n=t.l.vt(e);n&&n.Tt(i,s)}))},this.updateContentMetadata=function(e,i){this.S||i instanceof a&&this.w.m("Client.updateContentMetadata",function(){var n,s=t.l.vt(e);s&&(n=i.z(),s.gt(n))})},this.detachPlayer=function(e){this.S||this.w.m("Client.detachPlayer",function(){var i=t.l.vt(e);i&&i.St()})},this.Nt=function(e){this.S||this.w.m("Client.offFocus",function(){var i=t.l.vt(e);i&&i.Nt()})},this.attachPlayer=function(e,i){this.S||i instanceof r&&this.w.m("Client.attachPlayer",function(){var n=t.l.vt(e);n&&n.Ot(i)})},this._t=function(e){this.S||this.w.m("Client.onFocus",function(){var i=t.l.vt(e);i&&i._t()})},this.contentPreload=function(e){this.S||this.w.m("Client.contentPreload",function(){var i=t.l.vt(e);i&&i.At()})},this.contentStart=function(e){this.S||this.w.m("Client.contentStart",function(){var i=t.l.vt(e);i&&i.Ct()})},this.sendCustomEvent=function(e,i,s){this.S||te.wt(i)&&(te.It(s),this.w.m("Client.sendCustomEvent",function(){e===n.NO_SESSION_KEY&&(t.d<0&&(o=new a,t.d=t.l.k(o,null)),e=t.d);var r=te.yt(s),o=t.l.mt(e);o&&o.Dt(i,r)}))},this.adStart=function(e,i,s,a){this.S||i!==n.AdStream.CONTENT&&i!==n.AdStream.SEPARATE||s!==n.AdPlayer.CONTENT&&s!==n.AdPlayer.SEPARATE||(a!==n.AdPosition.PREROLL&&a!==n.AdPosition.MIDROLL&&n.AdPosition.POSTROLL,this.w.m("Client.adStart",function(){var n=t.l.vt(e);n&&n.bt(i,s,a)}))},this.adEnd=function(e){this.S||this.w.m("Client.adEnd",function(){var i=t.l.vt(e);i&&i.Pt()})},this.cleanupSession=function(e){this.S||e!==n.NO_SESSION_KEY&&this.w.m("Client.cleanupSession",function(){t.l.vt(e)&&t.l.Mt(e)})},this.getAttachedPlayer=function(e){var i=null;return this.S||e===n.NO_SESSION_KEY||this.w.m("Client.getAttachedPlayer",function(){var n=t.l.vt(e);n&&(i=n.Lt())}),i},this.isPlayerAttached=function(t){return!this.S&&null!==this.getAttachedPlayer(t)},this.getPlayerStateManager=function(e){if(this.S)throw Error("This instance of Conviva.Client has been released.");return new r(this.v,(e?i:t).version)},this.releasePlayerStateManager=function(t){if(this.S)throw Error("This instance of Conviva.Client has been released.");this.w.m("Client.releasePlayerStateManager",function(){t instanceof r&&t.release()})},this.Ut=function(){return this.p},this.getId=function(){return this.g},this.getSessionId=function(e){if(this.S)return i.NO_SESSION_KEY;var n=null;return this.w.m("Client.getSessionId",function(){var i=t.l.vt(e);i&&(n=i.Vt())}),n},this.getClientId=function(e){if(this.S)return null;var i=null;return this.w.m("Client.getClientId",function(){var n=t.l.vt(e);n&&(i=n.kt())}),i},this.Ft=function(e,i,n){this.S||this.w.m("Client.updateCustomMetric",function(){var s=t.l.vt(e);s&&s.Ft(i,n)})},this.setUniqueIdentifier=function(t,e){if(this.S)throw Error("This instance of Conviva.Client has been released.");if(!t||void 0===t||"{}"===JSON.stringify(t))throw Error("Identifiers are not set. No action taken !!");for(var i in t)this.N[i]=t[i];e&&(this.O=e)},this.setUserPreferenceForDataCollection=function(t,e){if(this.S)throw Error("This instance of Conviva.Client has been released.");if(!t||void 0===t||"{}"===JSON.stringify(t))throw Error("Identifiers are not set. No action taken !!");for(var i in t)"false"===t[i]?this._[i]=e?X.Bt.Ht:X.Bt.Gt:this._[i]=X.Bt.jt},this.setUserPreferenceForDataDeletion=function(t){if(this.S)throw Error("This instance of Conviva.Client has been released.");if(!t||void 0===t||"{}"===JSON.stringify(t))throw Error("Identifiers are not set. No action taken !!");for(var e in t)"true"===t[e]?this._[e]=X.Bt.Kt:this._[e]=X.Bt.jt}};n.version="4.5.9L",n.NO_SESSION_KEY=i.NO_SESSION_KEY,n.AdPosition={PREROLL:i.AdPosition.PREROLL,MIDROLL:i.AdPosition.MIDROLL,POSTROLL:i.AdPosition.POSTROLL},n.AdStream={CONTENT:i.AdPlayer.CONTENT,SEPARATE:i.AdPlayer.SEPARATE},n.AdPlayer={CONTENT:i.AdPlayer.CONTENT,SEPARATE:i.AdPlayer.SEPARATE},n.ErrorSeverity={FATAL:i.ErrorSeverity.FATAL,WARNING:i.ErrorSeverity.WARNING},n.DeviceType={DESKTOP:i.DeviceType.DESKTOP,CONSOLE:i.DeviceType.CONSOLE,SETTOP:i.DeviceType.SETTOP,MOBILE:i.DeviceType.MOBILE,TABLET:i.DeviceType.TABLET,SMARTTV:i.DeviceType.SMARTTV},n.AdTechnology={CLIENT_SIDE:i.AdType.CLIENT_SIDE,SERVER_SIDE:i.AdType.SERVER_SIDE},n.AdType={BLACKOUT_SLATE:i.AdSlates.BLACKOUT_SLATE,TECHNICAL_DIFFICULTIES_SLATE:i.AdSlates.TECHNICAL_DIFFICULTIES_SLATE,COMMERCIAL_SLATE:i.AdSlates.COMMERCIAL_SLATE,OTHER_SLATE:i.AdSlates.OTHER_SLATE,VPAID:i.AdSlates.VPAID,REGULAR:i.AdSlates.REGULAR},n.AdServingType={INLINE:i.AdServingType.INLINE,WRAPPER:i.AdServingType.WRAPPER},n.DeviceCategory={ANDROID_DEVICE:i.DeviceCategory.ANDROID_DEVICE,APPLE_DEVICE:i.DeviceCategory.APPLE_DEVICE,CHROMECAST:i.DeviceCategory.CHROMECAST,DESKTOP_APP:i.DeviceCategory.DESKTOP_APP,DEVICE_SIMULATOR:i.DeviceCategory.DEVICE_SIMULATOR,LG_TV:i.DeviceCategory.LG_TV,NINTENDO:i.DeviceCategory.NINTENDO,PLAYSTATION:i.DeviceCategory.PLAYSTATION,ROKU:i.DeviceCategory.ROKU,SAMSUNG_TV:i.DeviceCategory.SAMSUNG_TV,SMART_TV:i.DeviceCategory.SMART_TV,SET_TOP_BOX:i.DeviceCategory.SET_TOP_BOX,TIVO:i.DeviceCategory.TIVO,WEB:i.DeviceCategory.WEB,WINDOWS_DEVICE:i.DeviceCategory.WINDOWS_DEVICE,XBOX:i.DeviceCategory.XBOX,KAIOS_DEVICE:i.DeviceCategory.KAIOS_DEVICE};var s=e.ClientSettings=function(){var t=this;this.Wt=null,te.xt(this,"customerKey",function(){return this.Wt}),te.qt(this,"customerKey",function(t){te.wt(t)&&(this.Wt=t)}),this.Yt=s.Jt,te.xt(this,"heartbeatInterval",function(){return this.Yt}),te.qt(this,"heartbeatInterval",function(t){var e;"number"!=typeof t||(e=te.Xt(t))===t&&(this.Yt=e)}),this.Qt=null,this.M=null,this.F=null,te.xt(this,"gatewayUrl",function(){return this.Qt}),te.qt(this,"gatewayUrl",function(t){var e;te.wt(t)&&("https"!==(e=t.split("://"))[0]&&"http"!==e[0]||-1!==t.indexOf(".com",t.length-4)&&(this.Qt=t))}),(function(t){if(!te.wt(t))throw Error("customerKey must be valid");this.customerKey=t}).apply(this,arguments),this.equals=function(t){return this.customerKey===t.customerKey&&this.gatewayUrl===t.gatewayUrl&&this.heartbeatInterval===t.heartbeatInterval},this.z=function(){var e=new s(this.customerKey);return e.gatewayUrl=function(e){if(te.wt(e)){var i=e.split("://");if(-1===i[1].indexOf("cws.conviva.com")&&("https"===i[0]||"http"===i[0]))return t.M="https://"+t.customerKey+"."+s.U,t.F="https://"+t.customerKey+"."+s.B,e}return t.M="https://"+t.customerKey+"."+s.L,t.F="https://"+t.customerKey+"."+s.H,"https://"+t.customerKey+"."+s.Q}(this.gatewayUrl),e.heartbeatInterval=this.heartbeatInterval,e.M=this.M,e.F=this.F,e}};s.Zt="https://conviva.testonly.conviva.com",s.zt="https://cws.conviva.com",s.Q="cws.conviva.com",s.L="ipv4.cws.conviva.com",s.H="ipv6.cws.conviva.com",s.$t="conviva.testonly.conviva.com",s.U="ipv4.testonly.conviva.com",s.B="ipv6.testonly.conviva.com",s.X="https://",s.Z="http://",s.tn=5,s.Jt=20;var a=e.ContentMetadata=function(){this.nn=null,te.xt(this,"assetName",function(){return this.nn}),te.qt(this,"assetName",function(t){"string"==typeof t&&(this.nn=t)}),this.in={},te.xt(this,"custom",function(){return this.in}),te.qt(this,"custom",function(t){"object"==typeof t&&(this.in=te.yt(t))}),this.en=null,te.xt(this,"defaultResource",function(){return this.en}),te.qt(this,"defaultResource",function(t){"string"==typeof t&&(this.en=t)}),this.sn=null,te.xt(this,"viewerId",function(){return this.sn}),te.qt(this,"viewerId",function(t){"string"==typeof t&&(this.sn=t)}),this.on=null,te.xt(this,"applicationName",function(){return this.on}),te.qt(this,"applicationName",function(t){"string"==typeof t&&(this.on=t)}),this.rn=null,te.xt(this,"streamUrl",function(){return this.rn}),te.qt(this,"streamUrl",function(t){"string"==typeof t&&(this.rn=t)}),this.un=a.StreamType.UNKNOWN,te.xt(this,"streamType",function(){return this.un}),te.qt(this,"streamType",function(t){t!==a.StreamType.UNKNOWN&&t!==a.StreamType.VOD&&t!==a.StreamType.LIVE||(this.un=t)}),this.hn=-1,te.xt(this,"duration",function(){return this.hn}),te.qt(this,"duration",function(t){this.hn=ta.an(t)}),this.fn=-1,te.xt(this,"encodedFrameRate",function(){return this.fn}),te.qt(this,"encodedFrameRate",function(t){this.fn=ta.an(t)}),(function(){}).apply(this,arguments),this.z=function(){var t,e=new a;for(t in e.assetName=this.assetName,e.applicationName=this.applicationName,e.streamUrl=this.streamUrl,e.viewerId=this.viewerId,e.defaultResource=this.defaultResource,e.streamType=this.streamType,e.duration=this.duration,e.encodedFrameRate=this.encodedFrameRate,this.custom)e.custom[t]=this.custom[t];return e}};a.StreamType={UNKNOWN:i.StreamType.UNKNOWN,LIVE:i.StreamType.LIVE,VOD:i.StreamType.VOD},e.ErrorType={ERROR_UNKNOWN:i.ErrorType.ERROR_UNKNOWN,ERROR_IO:i.ErrorType.ERROR_IO,ERROR_TIMEOUT:i.ErrorType.ERROR_TIMEOUT,ERROR_NULL_ASSET:i.ErrorType.ERROR_NULL_ASSET,ERROR_MISSING_PARAMETER:i.ErrorType.ERROR_MISSING_PARAMETER,ERROR_NO_AD_AVAILABLE:i.ErrorType.ERROR_NO_AD_AVAILABLE,ERROR_PARSE:i.ErrorType.ERROR_PARSE,ERROR_INVALID_VALUE:i.ErrorType.ERROR_INVALID_VALUE,ERROR_INVALID_SLOT:i.ErrorType.ERROR_INVALID_SLOT,ERROR_3P_COMPONENT:i.ErrorType.ERROR_3P_COMPONENT,ERROR_UNSUPPORTED_3P_FEATURE:i.ErrorType.ERROR_UNSUPPORTED_3P_FEATURE,ERROR_DEVICE_LIMIT:i.ErrorType.ERROR_DEVICE_LIMIT,ERROR_UNMATCHED_SLOT_SIZE:i.ErrorType.ERROR_UNMATCHED_SLOT_SIZE},e.Events={AD_REQUESTED:i.Events.AD_REQUESTED,AD_RESPONSE:i.Events.AD_RESPONSE,AD_SLOT_STARTED:i.Events.AD_SLOT_STARTED,AD_ATTEMPTED:i.Events.AD_ATTEMPTED,AD_SLOT_ENDED:i.Events.AD_SLOT_ENDED,AD_IMPRESSION_START:i.Events.AD_IMPRESSION_START,AD_START:i.Events.AD_START,AD_FIRST_QUARTILE:i.Events.AD_FIRST_QUARTILE,AD_MID_QUARTILE:i.Events.AD_MID_QUARTILE,AD_THIRD_QUARTILE:i.Events.AD_THIRD_QUARTILE,AD_COMPLETE:i.Events.AD_COMPLETE,AD_END:i.Events.AD_END,AD_IMPRESSION_END:i.Events.AD_IMPRESSION_END,AD_SKIPPED:i.Events.AD_SKIPPED,AD_ERROR:i.Events.AD_ERROR,AD_PROGRESS:i.Events.AD_PROGRESS,AD_CLOSE:i.Events.AD_CLOSE,CONTENT_PAUSED:i.Events.CONTENT_PAUSED,CONTENT_RESUMED:i.Events.CONTENT_RESUMED,POD_START:i.Events.POD_START,POD_END:i.Events.POD_END};var r=e.PlayerStateManager=function(){var t=this;t.cn=null,t.ln=-2,t.vn=r.PlayerState.UNKNOWN,t.dn={},t.En=-2,t.fn=-2,t.hn=-2,t.pn=null,t.Rn=null,t.rn=null,t.wn=null,t.Tn=null,t.gn=-1,t.Sn=-1,t.A=null,t.C=null,t.Nn=null,t.On=[],t.S=!1,this.release=function(){t.S||t.w.m("PlayerStateManager.release",function(){t.cn&&t.cn._n(),t.An(),t.v=null,t.w=null,t.S=!0})},this.setPlayheadTime=function(){},this.setBufferLength=function(){},this.setRenderedFrameRate=function(){},this.getEncodedFrameRate=function(){return t.fn},this.setEncodedFrameRate=function(e){t.S||t.w.m("PlayerStateManager.setEncodedFrameRate",function(){var i=ta.an(e);i>=-1&&(t.fn=i,t.cn&&t.cn.Cn(t.fn))})},this.getDuration=function(){return t.hn},this.setClientMeasureInterface=function(t){te.In(t,new e.ClientMeasureInterface,"ClientMeasureInterface"),this.yn=t},this.getPHT=function(){return this.yn&&"function"==typeof this.yn.getPHT?this.yn.getPHT():r.DEFAULT_PHT},this.getBufferLength=function(){return this.yn&&"function"==typeof this.yn.getBufferLength?this.yn.getBufferLength():r.DEFAULT_BUFFER_LENGTH},this.getSignalStrength=function(){return this.yn&&"function"==typeof this.yn.getSignalStrength?this.yn.getSignalStrength():r.DEFAULT_SIGNAL_STRENGTH},this.getRenderedFrameRate=function(){return this.yn&&"function"==typeof this.yn.getRenderedFrameRate?this.yn.getRenderedFrameRate():r.DEFAULT_RENDERED_FRAME_RATE},this.setDuration=function(e){t.S||t.w.m("PlayerStateManager.setDuration",function(){var i=ta.an(e);i>=-1&&(t.hn=i,t.cn&&t.cn.mn(t.hn))})},this.getStreamUrl=function(){return t.rn},this.setStreamUrl=function(e){t.S||t.w.m("PlayerStateManager.setStreamUrl",function(){e&&(t.rn=e,t.cn&&t.cn.Dn(t.rn))})},this.bn=function(){return t.wn},this.Pn=function(){return t.Tn},this.setModuleNameAndVersion=function(e,i){t.wn=e,t.Tn=i},this.Mn=function(){return t.Rn},this.setPlayerType=function(e){t.S||t.w.m("PlayerStateManager.setPlayerType",function(){t.Rn=e,t.cn&&t.cn.Ln(t.Rn)})},this.Un=function(){return t.pn},this.setPlayerVersion=function(e){t.S||t.w.m("PlayerStateManager.setPlayerVersion",function(){t.pn=e,t.cn&&t.cn.Vn(t.pn)})},this.setMonitoringNotifier=function(e){return!t.S&&!t.cn&&(t.cn=e,t.c,!0)},this.An=function(){t.S||(t.cn=null,t.c)},this.kn=function(){t.setPlayerState(t.getPlayerState()),t.setBitrateKbps(t.Fn()),t.setDuration(t.getDuration()),t.setEncodedFrameRate(t.getEncodedFrameRate()),t.setStreamUrl(t.getStreamUrl()),t.setPlayerType(t.Mn()),t.setPlayerVersion(t.Un());for(var e=0;e<t.On.length;e++){var i=t.On[e];t.Hn(i)}t.On=[]},this.getPlayerState=function(){return t.vn},this.setPlayerState=function(e){t.S||t.w.m("PlayerStateManager.setPlayerState",function(){r.Bn(e)&&(t.vn=e,t.cn&&t.cn.Gn(t.vn))})},this.Fn=function(){return t.ln},this.setBitrateKbps=function(e){t.S||t.w.m("PlayerStateManager.setBitrateKbps",function(){var i=ta.an(e);i>=-1&&(t.ln=i,t.cn&&t.cn.jn(t.ln))})},this.setPlayerSeekStart=function(e){t.S||t.w.m("PlayerStateManager.setPlayerSeekStart()",function(){t.cn&&t.cn.Kn(r.SEEK_ACTIONS_TYPE.SEEK_START,e)})},this.setPlayerSeekEnd=function(){t.S||t.w.m("PlayerStateManager.setPlayerSeekEnd()",function(){t.cn&&t.cn.Kn(r.SEEK_ACTIONS_TYPE.SEEK_END,-1)})},this.setUserSeekButtonUp=function(){t.S||t.w.m("PlayerStateManager.setUserSeekButtonUp()",function(){t.cn&&t.cn.Kn(r.SEEK_ACTIONS_TYPE.BUTTON_UP,-1)})},this.setUserSeekButtonDown=function(){t.S||t.w.m("PlayerStateManager.setUserSeekButtonDown()",function(){t.cn&&t.cn.Kn(r.SEEK_ACTIONS_TYPE.BUTTON_DOWN,-1)})},this.setVideoResolutionWidth=function(e){t.S||t.w.m("PlayerStateManager.setVideoResolutionWidth()",function(){var i=ta.an(e);i>0&&(t.gn=i),t.cn&&t.cn.Wn(t.gn)})},this.setVideoResolutionHeight=function(e){t.S||t.w.m("PlayerStateManager.setVideoResolutionHeight()",function(){var i=ta.an(e);i>0&&(t.Sn=i),t.cn&&t.cn.xn(t.Sn)})},this.setConnectionType=function(e){t.S||t.w.m("PlayerStateManager.setConnectionType()",function(){t.A=e,t.cn&&t.cn.W(t.A)})},this.setLinkEncryption=function(e){t.S||t.w.m("PlayerStateManager.setLinkEncryption()",function(){t.C=e,t.cn&&t.cn.Y(t.C)})},this.setSignalStrength=function(){},this.Hn=function(e){var i,n;t.Nn=e,t.cn?(i=e.errorCode,n=e.severity,t.cn.qn(i,n)):t.On.push(e)},this.sendError=function(e,i){t.S||t.w.m("PlayerStateManager.sendError",function(){var n=new tr(e,i);t.Hn(n)})},this.reset=function(){t.S||t.w.m("PlayerStateManager.reset",function(){t.ln=-2,t.vn=r.PlayerState.UNKNOWN,t.dn={},t.En=-1,t.fn=-1,t.hn=-1,t.pn=null,t.Rn=null,t.rn=null,t.Nn=null,t.On=[]})},this.setCDNServerIP=function(e){t.S||t.w.m("PlayerStateManager.setCDNServerIP",function(){t.cn&&t.cn.Yn(e)})},this.Jn=function(){return t.Xn},this.setDroppedFramesTotal=function(e){t.S||t.w.m("PlayerStateManager.setDroppedFramesTotal",function(){t.cn&&t.cn.Qn(e)})},this.setDroppedFramesCount=function(e){t.S||t.w.m("PlayerStateManager.setDroppedFramesCount",function(){t.cn&&t.cn.Zn(e)})},this.zn=function(){return t.Nn},(function(e,i){t.v=e,t.w=t.v.tt(i)}).apply(t,arguments)};r.PlayerState={STOPPED:i.PlayerState.STOPPED,PLAYING:i.PlayerState.PLAYING,BUFFERING:i.PlayerState.BUFFERING,PAUSED:i.PlayerState.PAUSED,UNKNOWN:i.PlayerState.UNKNOWN,NOT_MONITORED:i.PlayerState.NOT_MONITORED},r.Bn=function(t){return t===r.PlayerState.STOPPED||t===r.PlayerState.PLAYING||t===r.PlayerState.BUFFERING||t===r.PlayerState.PAUSED||t===r.PlayerState.UNKNOWN||t===r.PlayerState.NOT_MONITORED},r.SEEK_ACTIONS_TYPE={SEEK_START:"pss",SEEK_END:"pse",BUTTON_UP:"bu",BUTTON_DOWN:"bd"},r.DEFAULT_SIGNAL_STRENGTH=1e3,r.DEFAULT_RENDERED_FRAME_RATE=-1,r.DEFAULT_BUFFER_LENGTH=-1,r.DEFAULT_PHT=-1,e.ClientMeasureInterface=function(){this.getPHT=function(){},this.getBufferLength=function(){},this.getSignalStrength=function(){},this.getRenderedFrameRate=function(){}};var o=e.HttpInterface=function(){this.makeRequest=function(){},this.release=function(){}},c=e.LoggingInterface=function(){this.consoleLog=function(){},this.release=function(){}},h=e.MetadataInterface=function(){this.getBrowserName=function(){},this.getBrowserVersion=function(){},this.getDeviceBrand=function(){},this.getDeviceManufacturer=function(){},this.getDeviceModel=function(){},this.getDeviceType=function(){},this.getDeviceVersion=function(){},this.getFrameworkName=function(){},this.getFrameworkVersion=function(){},this.getOperatingSystemName=function(){},this.getOperatingSystemVersion=function(){},this.getDeviceCategory=function(){},this.getScreenWidth=function(){},this.getScreenHeight=function(){},this.getScaleFactor=function(){},this.release=function(){}},u=e.StorageInterface=function(){this.saveData=function(){},this.loadData=function(){},this.release=function(){}},l=e.SystemInterface=function(){(function(t,e,i,n,s,a){te.In(t,new f,"TimeInterface"),te.In(e,new d,"TimerInterface"),te.In(i,new o,"HttpInterface"),te.In(n,new u,"StorageInterface"),te.In(s,new h,"MetadataInterface"),te.In(a,new c,"LoggingInterface"),this.$n=t,this.ti=e,this.ni=i,this.ii=n,this.ei=s,this.si=a}).apply(this,arguments),this.release=function(){this.$n&&(this.$n.release(),this.$n=null),this.ti&&(this.ti.release(),this.ti=null),this.ni&&(this.ni.release(),this.ni=null),this.ii&&(this.ii.release(),this.ii=null),this.ei&&(this.ei.release(),this.ei=null),this.si&&(this.si.release(),this.si=null)}},f=e.TimeInterface=function(){this.getEpochTimeMs=function(){},this.release=function(){}},d=e.TimerInterface=function(){this.createTimer=function(){},this.release=function(){}},E=e.SystemFactory=function(){var e=this;(function(t,e){if(!(t instanceof l))throw Error("systemInterface parameter should be an instance of SystemInterface.");this.oi=t,this.$n=this.oi.$n,this.ti=this.oi.ti,this.ni=this.oi.ni,this.ii=this.oi.ii,this.ei=this.oi.ei,this.si=this.oi.si,this.p=e instanceof v?e.z():new v}).apply(this,arguments),this.$=function(t,e,i){this.ri=t,this.ui=e,this.hi=i},this.release=function(){this.oi.release(),this.oi=null,this.ri=null,this.p=null,this.ai=null},this.buildLogger=function(){return new tc(e.si,e.$n,e.Ut(),e.ai,e.ri)},this.rt=function(t,e,i){return new q(t,e,i,this)},this.fi=function(t){return new tn(this.buildLogger(),this.ci(),this.ui,t)},this.li=function(){return new j(this.buildTimer(e.hi))},this.vi=function(){var t=new tl(this.buildLogger(),this.ti,new z(this.buildLogger(),null,this.Ut()));return new j(t)},this.ci=function(){return new to(this.buildLogger(),this.ni,this.vi(),this.Ut())},this.tt=function(t){return new z(this.buildLogger(),this.fi(t),this.Ut())},this.buildTime=function(){return new tu(this.$n,this.buildLogger())},this.buildTimer=function(t){return new tl(this.buildLogger(),this.ti,this.tt(t))},this.di=function(){return new t.Storage(this.buildLogger(),this.ii,this.li(),this.Ut())},this.nt=function(){return new X(this.buildLogger(),this.di(),this.Ei())},this.pi=function(t){return new th(this.buildLogger(),this.ei,this.tt(t))},this.Ri=function(){return new K},this.wi=function(t,e){return new tt(t,this.buildLogger(),this.ci(),this.Ei(),e)},this.Ti=function(t,e,i,n,s){var a=this.wi(e,n.custom["c3.domain"]);return new W(this.gi(),t,e,this.buildLogger(),this.tt(s),this.buildTimer(s),a,this.Ri(),this.buildTime(),this.Si(),i,n,s)},this.Ni=function(t,e,i,n,s,a,r){return a=this.Ti(t,e.z(),i,a,r),new x(n,s,i,this.pi(r),a,this.tt(r),this.buildLogger())},this.gi=function(){return new Z},this.Ei=function(){return new G},this.Si=function(){return this.ai},this.Ut=function(){return this.p},this.ai=new ti},v=e.SystemSettings=function(){this.Oi=v._i,te.xt(this,"logLevel",function(){return this.Oi}),te.qt(this,"logLevel",function(t){var e;"number"!=typeof t||(e=te.Xt(t))===t&&e>=v.LogLevel.DEBUG&&e<=v.LogLevel.ERROR&&(this.Oi=e)}),this.Ai=v.Ci,te.xt(this,"allowUncaughtExceptions",function(){return this.Ai}),te.qt(this,"allowUncaughtExceptions",function(t){te.Ii(t)&&(this.Ai=t)}),this.yi=v.mi,te.xt(this,"storageTimeout",function(){return this.yi}),te.qt(this,"storageTimeout",function(t){var e;"number"!=typeof t||(e=te.Xt(t))===t&&(this.yi=e)}),this.Di=v.bi,te.xt(this,"httpTimeout",function(){return this.Di}),te.qt(this,"httpTimeout",function(t){var e;"number"!=typeof t||(e=te.Xt(t))===t&&(this.Di=e)}),(function(){}).apply(this,arguments),this.equals=function(t){return this.logLevel===t.logLevel&&this.allowUncaughtExceptions===t.allowUncaughtExceptions&&this.storageTimeout===t.storageTimeout&&this.httpTimeout===t.httpTimeout},this.z=function(){var t=new v;return t.logLevel=this.logLevel,t.allowUncaughtExceptions=this.allowUncaughtExceptions,t.storageTimeout=this.storageTimeout,t.httpTimeout=this.httpTimeout,t}};v.LogLevel={DEBUG:i.LogLevel.DEBUG,INFO:i.LogLevel.INFO,WARNING:i.LogLevel.WARNING,ERROR:i.LogLevel.ERROR,NONE:i.LogLevel.NONE},v.Pi=v.LogLevel.DEBUG,v._i=v.LogLevel.NONE,v.Mi=!0,v.Ci=!1,v.mi=10,v.bi=10;var y=t.AdAnalytics=function(){var t=this;function s(e){t.Li?(te.It(e)>0&&t.setAdInfo(e),t.Li.Ui()||(t.Li.Vi(t.ki),t.Li.Fi(!0))):t.c}t.Hi=null,t.v=null,t.Bi=null,t.ki=null,t.Li=null,t.Gi=null,t.ji=null,t.Ki=null,(function(e,n,s){t.Hi=e,t.Ki=s,t.v=n,s&&(t.ki=s.Wi()),t.Bi=n.buildTimer(i.version),t.Li=new A(t.Hi,t.Bi),p.call(this)}).apply(this,arguments),this.setAdInfo=function(e){0>=te.It(e)?t.c:(t.c,t.Li&&t.Li.xi(e))},this.setAdPlayerInfo=function(e){0>=te.It(e)?t.c:(t.c,t.Li&&t.Li.xi(e))},this.reportAdMetric=function(){0!==arguments.length?1===arguments.length?t.qi(arguments[0]):2===arguments.length?t.qi(arguments[0],arguments[1]):3===arguments.length?t.qi(arguments[0],arguments[1],arguments[2]):4===arguments.length&&t.qi(arguments[0],arguments[1],arguments[2],arguments[3]):t.c},this.setCallback=function(e){t.Li&&t.Li.Yi(e)},this.reportAdFailed=function(e,i){t.Li?(te.It(i)>0&&t.setAdInfo(i),t.Li.Ui()?(t.c,t.reportAdError(e,n.ErrorSeverity.FATAL),t.reportAdEnded()):(t.Li.Vi(t.ki),t.c,e=new tr(e,n.ErrorSeverity.FATAL),t.Li.Fi(!0,e))):t.c},this.reportAdLoaded=function(e){t.c,s(e)},this.reportAdStarted=function(e){t.c,s(e)},this.reportAdEnded=function(){t.Li?(t.c,t.Li.Ui()&&(t.Li.Vi(null),t.Li.Fi(!1))):t.c},this.reportAdError=function(e,i){t.Li?(t.c,i=new tr(e,i),t.Li.Hn(i)):t.c},this.reportAdPlayerEvent=function(e,n){if(te.wt(e)){if(t.c,t.Li)switch(e){case i.Events.USER_WAIT_STARTED:case i.Events.BUMPER_VIDEO_STARTED:t.Li.St();break;case i.Events.USER_WAIT_ENDED:case i.Events.BUMPER_VIDEO_ENDED:t.Li.Ot();break;default:t.Li.Ji(e,n)}else t.c}else t.c},this.reportAdSkipped=function(){t.Li?(t.c,t.reportAdPlayerEvent(i.Events.AD_SKIPPED),t.reportAdEnded()):t.c},this.release=function(){t.c,t.Li&&(t.Li.Ui()&&(t.Li.Vi(null),t.Li.Fi(!1)),t.Li.Yi(null),t.Li.Xi(),t.Li=null),void 0!==e.AdProxyMonitor&&t.ji&&(e.AdProxyMonitor.release(t.ji),t.ji=null)},this.setAdListener=function(i,n){i&&(void 0!==n&&void 0!==n.convivaModule?e.AdProxyMonitor=n.convivaModule.AdProxyMonitor:"undefined"!=typeof ConvivaModule&&(e.AdProxyMonitor=ConvivaModule.AdProxyMonitor),void 0!==e.AdProxyMonitor&&(!i&&t.ji?(e.AdProxyMonitor.release(t.ji),t.ji=null):i&&t.ji?(e.AdProxyMonitor.release(t.ji),t.c,t.ji=e.AdProxyMonitor.initConvivaDropIn(i,n,this,e,t.v)):i&&!t.ji&&(t.c,t.ji=e.AdProxyMonitor.initConvivaDropIn(i,n,this,e,t.v))))},this.reportAdBreakStarted=function(e,i,n){t.ki&&(t.c,t.Qi=e,t.Gi=i,t.ki.Zi(e,i,n))},this.reportAdBreakEnded=function(){t.ki&&(t.c,t.Qi=null,t.Gi=null,t.ki.zi())},this.getSessionId=function(){return t.ki?(t.c,t.Li.Vt()):i.NO_SESSION_KEY},this.getClientId=function(){return t.ki?(t.c,t.Li.kt()):null},this.getPlayerMonitor=function(){return t.ki},this.getAdPlayerMonitor=function(){return t.Li},this.getVideoAnalytics=function(){return t.Ki},this.getAdType=function(){return t.ki?t.ki.Qi:null},this.$i=function(){return t.ki?t.ki.Gi:null},y.prototype=Object.create(p.prototype),y.prototype.constructor=y},A=t.AdPlayerMonitorImpl=function(){var t=this;t.te=null,t.ne=null,(function(t,e){T.call(this,t,e)}).apply(this,arguments),this.Vi=function(e){this.ie()!==e&&(this.ee(),t.ne=e||null)},this.ie=function(){return t.ne},this.se=function(e){var i,n=this.ie(),s={};s.error=e,t.te&&(t.oe=t.te.getPlayerStateManager(!0),t.re(),t.oe.setClientMeasureInterface(this),i=null,n&&(i=n.ue()),t.he=t.te.createAdSession(i,t.Et,t.oe,!0,s),void 0!==e&&(t.ae(),t.Xi()))},A.prototype=Object.create(T.prototype),A.prototype.constructor=A},S=e.Analytics={init:function(t,a,r){if(this.Hi,arguments.length<=0)throw Error("customerKey must be valid");var o=null,c=null,h=null;if("string"==typeof t&&(o=t,!te.wt(o)))throw Error("customerKey must be valid");arguments.length>=2&&"object"==typeof a&&(c=a),arguments.length>=3&&"object"==typeof r&&(h=r);var u=new s(o),f=new v;te.It(h)>0&&(h[i.GATEWAY_URL]&&(u.gatewayUrl=h[i.GATEWAY_URL]),h[i.LOG_LEVEL]>=0&&(f.logLevel=h[i.LOG_LEVEL])),t=new e.Impl.Html5Logging,a=new e.Impl.Html5Storage,r=new e.Impl.Html5Http,o=new e.Impl.Html5Timer,h=new e.Impl.Html5Time,this.ei||(this.ei=new e.Impl.Html5Metadata),c&&(c[i.CallbackFunctions.CONSOLE_LOG]&&(t.consoleLog=c[i.CallbackFunctions.CONSOLE_LOG]),c[i.CallbackFunctions.MAKE_REQUEST]&&(r.makeRequest=c[i.CallbackFunctions.MAKE_REQUEST]),c[i.CallbackFunctions.SAVE_DATA]&&(a.saveData=c[i.CallbackFunctions.SAVE_DATA]),c[i.CallbackFunctions.LOAD_DATA]&&(a.loadData=c[i.CallbackFunctions.LOAD_DATA]),c[i.CallbackFunctions.GET_EPOCH_TIME_IN_MS]&&(h.getEpochTimeMs=c[i.CallbackFunctions.GET_EPOCH_TIME_IN_MS]),c[i.CallbackFunctions.CREATE_TIMER]&&(o.createTimer=c[i.CallbackFunctions.CREATE_TIMER])),this.oi=new l(h,o,r,a,this.ei,t),this.v=new E(this.oi,f),this.v.$("Analytics",u),this.Hi=new n(u,this.v,this.fe,S.version)},release:function(){var t=0;if(this.ce){for(t=0;t<this.ce.length;t++){var e=this.ce[t];e&&(e.release(),e.c=null,e.Bi=null,this.ce.splice(t,1),t--)}this.ce=null}if(this.le){for(t=0;t<this.le.length;t++){var i=this.le[t];i&&(i.release(),i.c=null,i.Bi=null,this.le.splice(t,1),t--)}this.le=null}this.v&&(this.v.release(),this.v=null),this.Hi&&(this.Hi.release(),this.Hi=null),this.Hi=null,this.c=null,this.oi=null,this.ei=null,this.fe=null},setUniqueIdentifier:function(t,e){if(!this.Hi)throw Error(i.i);this.Hi.setUniqueIdentifier(t,e)},setUserPreferenceForDataCollection:function(t,e){if(!this.Hi)throw Error(i.i);this.Hi.setUserPreferenceForDataCollection(t,e)},setUserPreferenceForDataDeletion:function(t){if(!this.Hi)throw Error(i.i);this.Hi.setUserPreferenceForDataDeletion(t)},reportAppEvent:function(t,e){if(!this.Hi)throw Error(i.i);this.Hi.sendCustomEvent(n.NO_SESSION_KEY,t,e)},reportAppBackgrounded:function(){if(!this.Hi)throw Error(i.i);this.Hi.sendCustomEvent(n.NO_SESSION_KEY,"App.Backgrounded",null)},reportAppForegrounded:function(){if(!this.Hi)throw Error(i.i);this.Hi.sendCustomEvent(n.NO_SESSION_KEY,"App.Foregrounded",null)},configureExistingClient:function(t){if(!(t instanceof n))throw Error(i.i);this.Hi=t,this.v=this.Hi.v},buildVideoAnalytics:function(){if(!this.Hi)throw Error(i.i);var t=new I(this.Hi,this.v);return this.le||(this.le=[]),this.le.push(t),t},buildAdAnalytics:function(t){if(!this.Hi)throw Error(i.i);return t=new y(this.Hi,this.v,t||null),this.ce||(this.ce=[]),this.ce.push(t),t},setDeviceMetadata:function(t){var n,s,a;arguments.length<=0||0===te.It(t)||(this.ei||(this.ei=new e.Impl.Html5Metadata),t[i.DeviceMetadata.BRAND]&&(this.ei.getDeviceBrand=function(){return t[i.DeviceMetadata.BRAND]}),t[i.DeviceMetadata.MANUFACTURER]&&(this.ei.getDeviceManufacturer=function(){return t[i.DeviceMetadata.MANUFACTURER]}),t[i.DeviceMetadata.MODEL]&&(this.ei.getDeviceModel=function(){return t[i.DeviceMetadata.MODEL]}),t[i.DeviceMetadata.TYPE]&&(this.ei.getDeviceType=function(){return t[i.DeviceMetadata.TYPE]}),t[i.DeviceMetadata.VERSION]&&(this.ei.getDeviceVersion=function(){return t[i.DeviceMetadata.VERSION]}),t[i.DeviceMetadata.OS_NAME]&&(this.ei.getOperatingSystemName=function(){return t[i.DeviceMetadata.OS_NAME]}),t[i.DeviceMetadata.OS_VERSION]&&(this.ei.getOperatingSystemVersion=function(){return t[i.DeviceMetadata.OS_VERSION]}),t[i.DeviceMetadata.CATEGORY]&&(this.ei.getDeviceCategory=function(){return t[i.DeviceMetadata.CATEGORY]}),n=t[i.DeviceMetadata.SCREEN_RESOLUTION_WIDTH],te.lt(n)&&(this.ei.getScreenWidth=function(){return n.toString()}),s=t[i.DeviceMetadata.SCREEN_RESOLUTION_HEIGHT],te.lt(s)&&(this.ei.getScreenHeight=function(){return s.toString()}),a=t[i.DeviceMetadata.SCREEN_RESOLUTION_SCALE_FACTOR],te.lt(a)&&(this.ei.getScaleFactor=function(){return a.toString()}))},reportDeviceMetric:function(t,e){switch(this.fe||(this.fe={}),t){case i.Network.CONNECTION_TYPE:if(!te.wt(e))return;this.fe[t]=e,this.Hi&&this.Hi.j(this.fe[i.Network.CONNECTION_TYPE]);break;case i.Network.LINK_ENCRYPTION:if(!te.wt(e))return;this.fe[t]=e,this.Hi&&this.Hi.q(this.fe[i.Network.LINK_ENCRYPTION]);break;case i.Network.SIGNAL_STRENGTH:var n=parseInt(e,10);if(!te.lt(n)||r.DEFAULT_SIGNAL_STRENGTH===n)return;this.fe[t]=n,this.Hi&&this.Hi.J(n)}}};S.version="4.5.9";var p=t.AnalyticsImpl=function(){var t=this;function e(){var e=!!t.Li,n=t.getAdType(),s=t.$i();return n===i.AdType.SERVER_SIDE&&s===i.AdPlayer.CONTENT?p.de.ve:n!==i.AdType.SERVER_SIDE||s!==i.AdPlayer.SEPARATE?n===i.AdType.CLIENT_SIDE&&s===i.AdPlayer.CONTENT?p.de.Ee:(n===i.AdType.CLIENT_SIDE&&i.AdPlayer.SEPARATE,e?p.de.Ee:p.de.pe):void 0}function n(e,i,n){e=parseInt(e,10),i=parseInt(i,10),isNaN(e)&&isNaN(i)||(isNaN(e),isNaN(i),t.Li&&(n===p.de.Ee||n===p.de.ve)&&t.Li.Re(e,i),t.ki&&(n===p.de.pe||n===p.de.ve)&&t.ki.Re(e,i))}function s(e,i){r.Bn(e)&&(t.Li&&(i===p.de.Ee||i===p.de.ve)&&t.Li.we(e),(t.ki&&i===p.de.pe||i===p.de.ve)&&t.ki.we(e))}function a(e,i){e=parseInt(e,10),isNaN(e)||(t.Li&&(i===p.de.Ee||i===p.de.ve)&&t.Li.Te(e),t.ki&&(i===p.de.pe||i===p.de.ve)&&t.ki.Te(e))}function o(e,i){e=parseInt(e,10),isNaN(e)||(t.Li&&(i===p.de.Ee||i===p.de.ve)&&t.Li.ge(e),t.ki&&(i===p.de.pe||i===p.de.ve)&&t.ki.ge(e))}function c(e,i){e=parseInt(e,10),t.Li&&(i===p.de.Ee||i===p.de.ve)&&t.Li.Se(!0,e),t.ki&&(i===p.de.pe||i===p.de.ve)&&t.ki.Se(!0,e)}function h(e){t.Li&&(e===p.de.Ee||e===p.de.ve)&&t.Li.Se(!1,-1),t.ki&&(e===p.de.pe||e===p.de.ve)&&t.ki.Se(!1,-1)}function u(e,i){e=parseInt(e,10),isNaN(e)||(t.Li&&(i===p.de.Ee||i===p.de.ve)&&t.Li.Ne(e),t.ki&&(i===p.de.pe||i===p.de.ve)&&t.ki.Ne(e))}function l(e,i){e=parseInt(e,10),isNaN(e)||(t.Li&&(i===p.de.Ee||i===p.de.ve)&&t.Li.Oe(e),t.ki&&(i===p.de.pe||i===p.de.ve)&&t.ki.Oe(e))}(function(){}).apply(this,arguments),this.qi=function(r,f,d,E){var v,y,A,S,g;switch(r){case i.Playback.BITRATE:E===p.de.Ee?u(f,p.de.Ee):u(f,e());break;case i.Playback.PLAY_HEAD_TIME:E===p.de.Ee?a(f,p.de.Ee):a(f,e());break;case i.Playback.RESOLUTION:E===p.de.Ee?n(f,d,p.de.Ee):n(f,d,e());break;case i.Playback.BUFFER_LENGTH:E===p.de.Ee?o(f,p.de.Ee):o(f,e());break;case i.Playback.PLAYER_STATE:E===p.de.Ee?s(f,p.de.Ee):s(f,e());break;case i.Playback.RENDERED_FRAMERATE:E===p.de.Ee?l(f,p.de.Ee):l(f,e());break;case i.Playback.SEEK_STARTED:arguments.length>=2&&"CONVIVA"!==f?c(f,e()):d===p.de.Ee?c(-1,p.de.Ee):c(-1,e());break;case i.Playback.SEEK_ENDED:d===p.de.Ee?h(p.de.Ee):h(e());break;case i.Playback.CDN_IP:S=f,g=e(),te.wt(S)&&(t.Li&&(g===p.de.Ee||g===p.de.ve)&&t.Li._e(S),t.ki&&(g===p.de.pe||g===p.de.ve)&&t.ki._e(S));break;case i.Playback.DROPPED_FRAMES_TOTAL:A=f,S=e(),A=parseInt(A,10),isNaN(A)||(t.Li&&(S===p.de.Ee||S===p.de.ve)&&t.Li.Ae(A),t.ki&&(S===p.de.pe||S===p.de.ve)&&t.ki.Ae(A));break;case i.Playback.DROPPED_FRAMES_COUNT:v=f,y=e(),v=parseInt(v,10),isNaN(v)||(t.Li&&(y===p.de.Ee||y===p.de.ve)&&t.Li.Ce(v),t.ki&&(y===p.de.pe||y===p.de.ve)&&t.ki.Ce(v));break;default:A=r,y=f,v=e(),te.wt(A),t.Li,p.de.Ee,p.de.ve,t.Li.Ft(A,y),t.ki,p.de.pe,p.de.ve,t.ki.Ft(A,y)}}};t.AnalyticsImpl.de={Ee:1,pe:2,ve:3};var g=t.PlayerMonitor=function(){var t=this;this.Ie=null,this.ye=null,this.Et=null,this.me=null,this.vn=r.PlayerState.UNKNOWN,this.De=-1,this.be=-1,this.On=[],this.Pe=null,this.Me=null,this.Le=-2,this.En=-1,this.I=r.DEFAULT_SIGNAL_STRENGTH,this.Ue=null,this.Xn=null,this.C=null,this.A=null,this.Bi=null,this.Ve=null,this.ke=null,this.Fe=null,this.He=null,this.Qi=null,this.Gi=null,(function(e){t.Bi=e}).apply(this,arguments),this.Be=function(){return t.vn},this.we=function(e){t.vn!==e&&(t.ee(),t.vn=e,t.Ge())},this.je=function(){return t.Ke},this.We=function(){return t.xe},this.Se=function(e,i){t.ee(),t.Ke=e,t.xe=i,t.qe()},this.Ye=function(){return t.De},this.Te=function(e){t.De=e},this.Je=function(){return t.be},this.ge=function(e){t.be=e},this.Xe=function(){return t.Le},this.Ne=function(e){t.Le!==e&&(t.Le=e,t.Ge())},this.Qe=function(){return t.En},this.Oe=function(e){t.En=e},this.Ze=function(){return t.Ue},this._e=function(e){t.Ue=e,t.Ge()},this.Jn=function(){return t.Xn},this.Ae=function(e){t.Xn=e,t.Ge()},this.Ce=function(e){t.ze(e)},this.$e=function(){return t.I},this.ts=function(){return t.ns},this.es=function(){return t.ss},this.Re=function(e,i){e<0&&(e=0),i<0&&(i=0),t.ns===e&&t.ss===i||(t.ns=e,t.ss=i,t.Ge())},this.os=function(){return t.ye},this.rs=function(){t.os()&&(t.Et=new a,t.me={},t.ke={},t.us())},this.hs=function(e){(t.ye||e)&&(this.ee(),t.ye&&(t.ye=null,t.rs()),e&&(t.ye=te.as(t.ye,e),t.rs()))},this.xi=function(e){if(e){if(t.Et){var i,n=!1;for(i in e)if(t.Et[i]!==e[i]){n=!0;break}n&&(t.ee(),t.ye=te.as(e),t.us())}else t.hs(e)}},this.Yi=function(e){e?t.Fe!==e&&(t.Fe=e,t.fs()):(t.Fe=null,t.ae())},this.ee=function(){t.cs||t.Fe&&(t.cs=!0,t.Fe(),t.cs=!1)},this.Ui=function(){return t.Ie},this.Fi=function(e,i){t.Ie!==e&&(t.ee(),t.Ie&&(t.ls(),t.ae(),t.Xi()),t.Ie=e,t.Ie&&t.se(i))},this.vs=function(){return t.Pe},this.ds=function(){return t.Me||null},this.Es=function(){return t.On},this.ps=function(){t.On=[]},this.Hn=function(e){this.ee(),t.On.push(e),t.qn()},this.Ji=function(e,i){t.ee(),t.Pe=e,t.Me=i,t.Rs()},this.ws=function(){t.ee()},this.fs=function(){t.ae(),t.Ve=t.Bi.create(t.ws,1e3,"PlayerMonitor.update")},this.ae=function(){t.Ve&&(t.Ve(),t.Ve=null)},this.Zi=function(e,n,s){t.He=s,t.Qi=e,t.Ts(),t.Gi=n,t.Qi&&i.AdType.CLIENT_SIDE===t.Qi&&(t.vn=i.PlayerState.UNKNOWN,t.gs(t.Qi,n,s?s[i.POD_POSITION]:null))},this.zi=function(){t.Qi&&i.AdType.CLIENT_SIDE===t.Qi&&(t.Ss(),t.vn=i.PlayerState.UNKNOWN),t.Ns(),t.Qi=null,t.Gi=null},this.Os=function(){return t.He},this._s=function(){return t.Qi},this.getContentMetadata=function(){return this.Et},this.Xi=function(){this.Ie=null,this.ye=null,this.Et=null,this.me=null,this.vn=r.PlayerState.UNKNOWN,this.De=-1,this.be=-1,this.On=[],this.Pe=null,this.Me=null,this.Le=-2,this.En=-1,this.I=r.DEFAULT_SIGNAL_STRENGTH,this.Ue=null,this.Xn=null,this.C=null,this.A=null,this.Bi=null,this.Ve=null,this.ke=null,this.Fe=null,this.He=null,this.Qi=null,this.Gi=null,t.oe=null,t.he=n.NO_SESSION_KEY}},T=t.PlayerMonitorImpl=function(){var t=this;t.te=null,t.oe=null,t.he=n.NO_SESSION_KEY,(function(e,i){g.call(this,i),t.te=e}).apply(this,arguments),this.getPHT=function(){return t.Ye()},this.getBufferLength=function(){return t.Je()},this.getRenderedFrameRate=function(){return t.Qe()},this.getSignalStrength=function(){return t.$e()},this.qe=function(){t.oe&&t.As!==n.NO_SESSION_KEY&&(t.je()?t.oe.setPlayerSeekStart(t.We()):t.oe.setPlayerSeekEnd())},this.Ge=function(){t.oe&&(t.oe.setPlayerState(t.Be()),t.Xe()>0&&t.oe.setBitrateKbps(t.Xe()),t.ts()>0&&t.oe.setVideoResolutionWidth(t.ts()),t.es()>0&&t.oe.setVideoResolutionHeight(t.es()),t.Ze()&&t.oe.setCDNServerIP(t.Ze()),te.lt(t.Jn())&&t.oe.setDroppedFramesTotal(t.Jn()))},this.gt=function(){t.he!==n.NO_SESSION_KEY&&t.te&&t.te.updateContentMetadata(t.he,t.Et)},this.re=function(){if(t.oe){t.ke&&te.It(t.ke)>0&&(t.ke[i.MODULE_NAME]&&t.ke[i.MODULE_VERSION]&&(e=t.ke[i.MODULE_NAME],n=t.ke[i.MODULE_VERSION],te.wt(e)&&te.wt(n)&&t.oe.setModuleNameAndVersion(e,n)),t.ke[i.FRAMEWORK_NAME]&&(s=t.ke[i.FRAMEWORK_NAME],te.wt(s)&&t.oe.setPlayerType(s)),t.ke[i.FRAMEWORK_VERSION]&&(s=t.ke[i.FRAMEWORK_VERSION],te.wt(s)&&t.oe.setPlayerVersion(s)));var e,n,s,a=t.Es();t.ps();for(var r=0;r<a.length;r++){var o=a[r];t.oe.Hn(o)}}},this.Ss=function(){t.oe&&t.he!==n.NO_SESSION_KEY&&(t.Ge(),this.Cs())},this.Ot=function(){t.oe&&t.he!==n.NO_SESSION_KEY&&(t.Ge(),t.te._t(t.he))},this.Cs=function(){t.te&&t.he!==i.NO_SESSION_KEY&&t.te.adEnd(t.he)},this.gs=function(e,s,a){var r;t.oe&&t.he!==i.NO_SESSION_KEY&&(r=null,i.AdType.CLIENT_SIDE===e?r=n.AdStream.SEPARATE:i.AdType.SERVER_SIDE===e&&(r=n.AdStream.CONTENT),t.Is(r,s,a))},this.St=function(){t.oe&&t.he!==i.NO_SESSION_KEY&&t.te.Nt(t.he)},this.Is=function(e,n,s){t.te&&t.he!==i.NO_SESSION_KEY&&t.te.adStart(t.he,e,n,s)},this.se=function(){if(t.te){t.oe=t.te.getPlayerStateManager(!0),t.re(),t.oe.setClientMeasureInterface(this);try{var e;t.Et&&t.Et.custom&&!t.Et.custom[i.UTM_TRACKING_URL]&&(Array.prototype.filter||(Array.prototype.filter=function(t){if(void 0===this||null===this)throw TypeError();var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw TypeError();for(var n,s=[],a=arguments.length>=2?arguments[1]:void 0,r=0;r<i;r++)r in e&&(n=e[r],t.call(a,n,r,e)&&s.push(n));return s}),""!==(e=te.ys().split("?").join("").split("&").filter(function(t){return 2===t.split("=").length&&t.split("=")[0].toLowerCase().indexOf("utm_")>=0}).join("&"))&&(t.Et.custom[i.UTM_TRACKING_URL]=e))}catch(n){t.c.error("PlayerMonitorImpl _createSession : "+n)}t.he=t.te.createSession(t.Et,t.oe,!0)}},this.ls=function(){t.te&&(t.oe&&(t.oe.setPlayerState(i.PlayerState.STOPPED),t.oe=null),t.he!==i.NO_SESSION_KEY&&(t.te.cleanupSession(t.he),t.he=i.NO_SESSION_KEY))},this.qn=function(){if(t.te&&t.he!==n.NO_SESSION_KEY){var e=t.Es();t.ps();for(var i=0;i<e.length;i++){var s=e[i];t.te.reportError(t.he,s.ms(),s.Ds())}}},this.Rs=function(){t.he!==n.NO_SESSION_KEY&&t.te&&t.te.sendCustomEvent(t.he,t.vs(),t.ds())},this.us=function(){var e,n=t.os(),s=!1,a=!1;for(e in n){var r=n[e];if(te.wt(e)&&null!=r)switch(e){case i.STREAM_URL:a=!0,t.Et.streamUrl=r;break;case i.ASSET_NAME:a=!0,t.Et.assetName=r;break;case i.DEFAULT_RESOURCE:a=!0,t.Et.defaultResource=r;break;case i.VIEWER_ID:a=!0,t.Et.viewerId=r;break;case i.PLAYER_NAME:a=!0,t.Et.applicationName=r;break;case i.DURATION:a=!0,t.Et.duration=r;break;case i.IS_LIVE:a=!0,t.Et.streamType=r;break;case i.ENCODED_FRAMERATE:a=!0,t.Et.encodedFrameRate=r;break;case i.MODULE_NAME:case i.MODULE_VERSION:case i.FRAMEWORK_NAME:case i.FRAMEWORK_VERSION:s=!0,t.ke[e]=r;break;case i.APPLICATION_VERSION:default:a=!0,t.Et.custom[e]=r}}s&&this.re(),a&&this.gt()},this.Ts=function(){this.bs(i.Events.POD_START)},this.Ns=function(){this.bs(i.Events.POD_END)},this.bs=function(e){var n,s,a,r;t.te&&t.he!==i.NO_SESSION_KEY&&(s={},(n=this.Os())&&((a=n[i.POD_POSITION])&&(s[i.POD_POSITION]=a),(a=n[i.POD_INDEX])&&(s[i.POD_INDEX]=a+""),e!==i.Events.POD_START||(r=n[i.POD_DURATION])&&(s[i.POD_DURATION]=r+"")),(r=this._s())&&(s[i.AD_TYPE]=r),t.te.sendCustomEvent(t.he,e,s))},this.ze=function(e){t.oe.setDroppedFramesCount(e)},this.Ps=function(t){this.he===i.NO_SESSION_KEY&&t!==i.NO_SESSION_KEY&&(this.he=t)},this.ue=function(){return this.he},this.Vt=function(){return t.te.getSessionId(this.he)},this.kt=function(){return t.te.getClientId(this.he)},this.Ft=function(e,i){t.te.Ft(this.he,e,i)},T.prototype=Object.create(g.prototype),T.prototype.constructor=T};e.Impl=e.Impl||{},e.Impl.Html5Http=function(){(function(){}).apply(this,arguments),this.makeRequest=function(){return this.makeRequestStandard.apply(this,arguments)},this.makeRequestStandard=function(t,e,i,n,s,a){var r=new XMLHttpRequest;return r.open(t,e,!0),n&&r.overrideMimeType&&(r.overrideMimeType=n),n&&r.setRequestHeader&&r.setRequestHeader("Content-Type",n),s>0&&(r.timeout=s,r.ontimeout=function(){r.ontimeout=r.onreadystatechange=null,a&&a(!1,"timeout after "+s+" ms")}),r.onreadystatechange=function(){4===r.readyState&&(r.ontimeout=r.onreadystatechange=null,200===r.status?a&&a(!0,r.responseText):a&&a(!1,"http status "+r.status))},r.send(i),null},this.release=function(){}},e.Impl=e.Impl||{},e.Impl.Html5Logging=function(){(function(){}).apply(this,arguments),this.consoleLog=function(t,e){"undefined"!=typeof console&&(console.log&&e===v.LogLevel.DEBUG||e===v.LogLevel.INFO?console.log(t):console.warn&&e===v.LogLevel.WARNING?console.warn(t):console.error&&e===v.LogLevel.ERROR&&console.error(t))},this.release=function(){}},e.Impl=e.Impl||{},e.Impl.Html5Metadata=function(){(function(){}).apply(this,arguments),this.getBrowserName=function(){return null},this.getBrowserVersion=function(){return null},this.getDeviceBrand=function(){return null},this.getDeviceManufacturer=function(){return null},this.getDeviceModel=function(){return null},this.getDeviceType=function(){return null},this.getDeviceVersion=function(){return null},this.getFrameworkName=function(){return null},this.getFrameworkVersion=function(){return null},this.getOperatingSystemName=function(){return null},this.getOperatingSystemVersion=function(){return null},this.getDeviceCategory=function(){return null},this.getScreenWidth=function(){return"undefined"!=typeof window&&window&&window.screen&&window.screen.width?window.screen.width.toString():null},this.getScreenHeight=function(){return"undefined"!=typeof window&&window&&window.screen&&window.screen.height?window.screen.height.toString():null},this.getScaleFactor=function(){return"undefined"!=typeof window&&window&&window.devicePixelRatio?window.devicePixelRatio.toString():null},this.release=function(){}},e.Impl=e.Impl||{},e.Impl.Html5Storage=function(){(function(){}).apply(this,arguments),this.saveData=function(t,e,i,n){try{localStorage.setItem(t+"."+e,i),n(!0,null)}catch(s){n(!1,s.toString())}},this.loadData=function(t,e,i){try{i(!0,localStorage.getItem(t+"."+e))}catch(n){i(!1,n.toString())}},this.release=function(){}},e.Impl=e.Impl||{},e.Impl.Html5Time=function(){(function(){}).apply(this,arguments),this.getEpochTimeMs=function(){return(new Date).getTime()},this.release=function(){}},e.Impl=e.Impl||{},e.Impl.Html5Timer=function(){(function(){}).apply(this,arguments),this.createTimer=function(t,e){var i=setInterval(t,e);return function(){-1!==i&&(clearInterval(i),i=-1)}},this.release=function(){}};var R,N,m,P,O,I=t.VideoAnalytics=function(){var t=this;t.Hi=null,t.v=null,t.Bi=null,t.ki=null,t.ji=null,this.release=function(){t.c,t.ki&&t.ki.Ui()&&t.ki.Fi(!1),void 0!==e.ProxyMonitor&&t.ji&&(e.ProxyMonitor.release(t.ji),t.ji=null),t.ki&&(t.ki.Yi(null),t.ki.Xi(),t.ki=null),t.Bi=null},(function(e,n){t.Hi=e,t.v=n,t.Bi=n.buildTimer(i.version),t.ki=new T(t.Hi,t.Bi),p.call(this)}).apply(this,arguments),this.reportPlaybackRequested=function(e){t.c,t.ki&&(te.It(e)>0&&t.setContentInfo(e),t.ki.Ui()||t.ki.Fi(!0))},this.reportPlaybackEnded=function(){t.c,t.ki&&t.ki.Ui()&&(t.ki.Fi(!1),void 0!==e.ProxyMonitor&&t.ji&&(e.ProxyMonitor.release(t.ji),t.ji=null),t.ki.Yi(null))},this.reportPlaybackFailed=function(e,i){t.ki&&(te.It(i)>0&&t.setContentInfo(i),t.ki.Ui()||t.ki.Fi(!0),t.c,t.reportPlaybackError(e,n.ErrorSeverity.FATAL),t.reportPlaybackEnded())},this.setContentInfo=function(e){0>=te.It(e)||t.ki&&(t.c,t.ki.xi(e))},this.setPlayerInfo=function(e){0>=te.It(e)||t.ki&&(t.c,t.ki.xi(e))},this.reportPlaybackMetric=function(){0!==arguments.length&&(1===arguments.length?t.qi(arguments[0]):2===arguments.length?t.qi(arguments[0],arguments[1]):3===arguments.length?t.qi(arguments[0],arguments[1],arguments[2]):4===arguments.length&&t.qi(arguments[0],arguments[1],arguments[2],arguments[3]))},this.reportPlaybackError=function(e,i){t.ki&&te.wt(e)&&(t.c,i=new tr(e,i),t.ki.Hn(i))},this.reportPlaybackEvent=function(e,n){if(te.wt(e)&&t.ki&&(t.c,t.ki))switch(e){case i.Events.USER_WAIT_STARTED:case i.Events.BUMPER_VIDEO_STARTED:t.ki.St();break;case i.Events.USER_WAIT_ENDED:case i.Events.BUMPER_VIDEO_ENDED:t.ki.Ot();break;default:t.ki.Ji(e,n)}},this.setCallback=function(e){t.c,t.ki&&t.ki.Yi(e)},this.reportAdBreakStarted=function(e,i,n){t.ki&&(t.c,t.ki.Zi(e,i,n))},this.reportAdBreakEnded=function(){t.ki&&(t.c,t.ki.zi())},this.setPlayer=function(n,s){var a,r;void 0!==n&&(s&&(a=s[i.CONVIVA_MODULE],r=s[i.MEDIA_ELEMENT]),void 0!==a?e.ProxyMonitor=a.ProxyMonitor:"undefined"!=typeof ConvivaModule&&(e.ProxyMonitor=ConvivaModule.ProxyMonitor),void 0!==e.ProxyMonitor&&(t.c,!n&&t.ji?(e.ProxyMonitor.release(t.ji),t.ji=null):n?(t.ji&&e.ProxyMonitor.release(t.ji),t.c,t.ji=void 0!==r?e.ProxyMonitor.initConvivaDropIn(n,r,t.v,this,e):e.ProxyMonitor.initConvivaDropIn(n,t.v,this,e)):n||void 0===r||(t.ji=e.ProxyMonitor.initConvivaDropIn(n,r,t.v,this,e))))},this.setAdAnalytics=function(e){e?t.getAdType()&&(t.getAdType()===i.AdType.SERVER_SIDE?t.Li=e.getAdPlayerMonitor():t.getAdType()===i.AdType.CLIENT_SIDE&&t.c):t.Li=null},this.configureExistingSession=function(e){e!==i.NO_SESSION_KEY&&t.ki&&(t.c,t.ki.Ps(e))},this.getSessionId=function(){return t.ki?(t.c,t.ki.Vt()):i.NO_SESSION_KEY},this.getClientId=function(){return t.ki?(t.c,t.ki.kt()):null},this.Wi=function(){return t.c,this.ki},this.getAdType=function(){return t.ki?t.ki.Qi:null},this.$i=function(){return t.ki?t.ki.Gi:null},I.prototype=Object.create(p.prototype),I.prototype.constructor=I};function C(t){throw{name:"SyntaxError",message:t,at:R,text:m}}function D(t){return t&&t!==N&&C("Expected '"+t+"' instead of '"+N+"'"),N=m.charAt(R),R+=1,N}function L(){var t,e="";for("-"===N&&D(e="-");N>="0"&&N<="9";)e+=N,D();if("."===N)for(e+=".";D()&&N>="0"&&N<="9";)e+=N;if("e"===N||"E"===N)for(e+=N,D(),"-"!==N&&"+"!==N||(e+=N,D());N>="0"&&N<="9";)e+=N,D();if(!isNaN(t=+e))return t;C("Bad number")}function M(){var t,e,i,n="";if('"'===N)for(;D();){if('"'===N)return D(),n;if("\\"===N){if(D(),"u"===N){for(e=i=0;e<4&&(t=parseInt(D(),16),isFinite(t));e+=1)i=16*i+t;n+=String.fromCharCode(i)}else{if("string"!=typeof P[N])break;n+=P[N]}}else n+=N}C("Bad string")}function w(){for(;N&&N<=" ";)D()}t.JsonParse=(P={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},O=function(){switch(w(),N){case"{":return function(){var t,e={};if("{"===N){if(D("{"),w(),"}"===N)return D("}"),e;for(;N;){if(t=M(),w(),D(":"),Object.hasOwnProperty.call(e,t)&&C('Duplicate key "'+t+'"'),e[t]=O(),w(),"}"===N)return D("}"),e;D(","),w()}}C("Bad object")}();case"[":return function(){var t=[];if("["===N){if(D("["),w(),"]"===N)return D("]"),t;for(;N;){if(t.push(O()),w(),"]"===N)return D("]"),t;D(","),w()}}C("Bad array")}();case'"':return M();case"-":return L();default:return(N>="0"&&N<="9"?L:function(){switch(N){case"t":return D("t"),D("r"),D("u"),D("e"),!0;case"f":return D("f"),D("a"),D("l"),D("s"),D("e"),!1;case"n":return D("n"),D("u"),D("l"),D("l"),null}C("Unexpected '"+N+"'")})()}},function(t,e){return m=t,R=0,N=" ",t=O(),w(),N&&C("Syntax error"),"function"==typeof e?function t(i,n){var s,a,r=i[n];if(r&&"object"==typeof r)for(s in r)Object.hasOwnProperty.call(r,s)&&(void 0!==(a=t(r,s))?r[s]=a:delete r[s]);return e.call(i,n,r)}({"":t},""):t});var $,b,k,U,V,F=t.JSON2={};function _(t){return t<10?"0"+t:t}function H(t){return $.lastIndex=0,$.test(t)?'"'+t.replace($,function(t){var e=U[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+_(this.getUTCMonth()+1)+"-"+_(this.getUTCDate())+"T"+_(this.getUTCHours())+":"+_(this.getUTCMinutes())+":"+_(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}),"function"!=typeof F.stringify&&($=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,U={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},F.stringify=function(t,e,i){var n;if(k=b="","number"==typeof i)for(n=0;n<i;n+=1)k+=" ";else"string"==typeof i&&(k=i);if((V=e)&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw Error("JSON2.stringify");return function t(e,i){var n,s,a,r,o,c=b,h=i[e];switch(h&&"object"==typeof h&&"function"==typeof h.toJSON&&(h=h.toJSON(e)),"function"==typeof V&&(h=V.call(i,e,h)),typeof h){case"string":return H(h);case"number":return isFinite(h)?String(h):"null";case"boolean":case"null":return String(h);case"object":if(!h)return"null";if(b+=k,o=[],Object.prototype.toString.apply(h)===Object.prototype.toString.apply([])){for(r=h.length,n=0;n<r;n+=1)o[n]=t(n,h)||"null";return a=0===o.length?"[]":b?"[\n"+b+o.join(",\n"+b)+"\n"+c+"]":"["+o.join(",")+"]",b=c,a}if(V&&"object"==typeof V)for(r=V.length,n=0;n<r;n+=1)"string"==typeof V[n]&&(a=t(s=V[n],h))&&o.push(H(s)+(b?": ":":")+a);else for(s in h)Object.prototype.hasOwnProperty.call(h,s)&&(a=t(s,h))&&o.push(H(s)+(b?": ":":")+a);return a=0===o.length?"{}":b?"{\n"+b+o.join(",\n"+b)+"\n"+c+"}":"{"+o.join(",")+"}",b=c,a}}("",{"":t})});var B=t.Ms={};B.Ls="0123456789abcdef",B.Us=function(t){for(var e="",i=7;i>=0;i--)e+=B.Ls.charAt(t>>4*i&15);return e},B.Vs=function(t){for(var e=1+(t.length+8>>6),i=Array(16*e),n=0;n<16*e;n++)i[n]=0;for(n=0;n<t.length;n++)i[n>>2]|=t.charCodeAt(n)<<24-n%4*8;return i[n>>2]|=128<<24-n%4*8,i[16*e-1]=8*t.length,i},B.ks=function(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i},B.Fs=function(t,e){return t<<e|t>>>32-e},B.Hs=function(t,e,i,n){return t<20?e&i|~e&n:!(t<40)&&t<60?e&i|e&n|i&n:e^i^n},B.Bs=function(t){return t<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514},B.Gs=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return B.js(e)},B.js=function(t){if(""===t)return"";for(var e,i=B.Vs(t),n=Array(80),s=1732584193,a=-271733879,r=-1732584194,o=271733878,c=-1009589776,h=0;h<i.length;h+=16){for(var u=s,l=a,f=r,d=o,E=c,v=0;v<80;v++)n[v]=v<16?i[h+v]:B.Fs(n[v-3]^n[v-8]^n[v-14]^n[v-16],1),e=B.ks(B.ks(B.Fs(s,5),B.Hs(v,a,r,o)),B.ks(B.ks(c,n[v]),B.Bs(v))),c=o,o=r,r=B.Fs(a,30),a=s,s=e;s=B.ks(s,u),a=B.ks(a,l),r=B.ks(r,f),o=B.ks(o,d),c=B.ks(c,E)}return B.Us(s)+B.Us(a)+B.Us(r)+B.Us(o)+B.Us(c)};var K=t.CwsProtocol=function(){this.Ks=function(t,e,i,n){return n.seq=t,n.st=e,n.t=i,n},this.Ws=function(t,e){var i=K.xs;return this.Ks(t,e,i,{})}};K.version="2.6",K.qs="/0/wsg",K.P="0",K.Ys=-1,K.Js=!1,K.Xs=2,K.Qs=-1,K.Zs=-1,K.zs=1e3,K.$s="sdk.js.1",K.no="CwsStateChangeEvent",K.io="CwsErrorEvent",K.xs="CwsSessionEndEvent",K.eo="CwsCustomEvent",K.so="CwsSeekEvent",K.oo="CwsDataSamplesEvent",K.ro="ok",K.uo="err",K.ho="clid",K.ao="cfg",K.fo="evs",K.co="maxhbinfos",K.lo="slg",K.vo="hbi",K.do="gw",K.Eo="fp",K.po="csi_en",K.Ro="CwsSessionHb",K.wo="t",K.To="st",K.go="sst",K.So="lv",K.No="seq",K.Oo="cid",K._o="clid",K.Ao="clv",K.Co="pver",K.Io="iid",K.yo="sid",K.mo="vid",K.Do="an",K.bo="pn",K.Po="tags",K.Mo="sf",K.Lo="evs",K.Uo="lg",K.Vo="hbinfos",K.ko="sdk",K.Fo="pj",K.Ho="ps",K.Bo="br",K.Go="cl",K.jo="efps",K.Ko="afps",K.Wo="rfpstot",K.xo="rfpscnt",K.qo="rs",K.Yo="pht",K.Jo="bl",K.Xo="url",K.Qo="caps",K.Zo="pm",K.zo="w",K.$o="h",K.tr="ct",K.nr="le",K.ir="dftot",K.er="dfcnt",K.sr="ss",K.or="csi_n",K.rr="csi_t",K.ur="csi_l",K.hr="csi_v",K.ar="csi_c",K.fr="sch",K.cr="br",K.lr="brv",K.vr="dvb",K.dr="dvma",K.Er="dvm",K.pr="dvt",K.Rr="dvv",K.wr="sw",K.Tr="sh",K.gr="scf",K.Sr="fw",K.Nr="fwv",K.Or="cc",K._r="mn",K.Ar="mv",K.Cr="os",K.Ir="osv",K.yr="cat",K.mr="caps",K.Dr="t",K.br="seq",K.Pr="st",K.Mr="act",K.Lr="skto",K.Ur="err",K.Vr="ft",K.kr="new",K.Fr="old",K.Hr="name",K.Br="attr",K.Gr="seq",K.jr="err",K.Kr="rtt",K.Wr="ad",K.xr="csi",K.qr=function(t){switch(t){case r.PlayerState.STOPPED:return K.Yr;case r.PlayerState.PLAYING:return K.Jr;case r.PlayerState.BUFFERING:return K.Xr;case r.PlayerState.PAUSED:return K.Qr;case r.PlayerState.NOT_MONITORED:return K.Zr;default:return K.zr}},K.Yr=1,K.Jr=3,K.Xr=6,K.Qr=12,K.Zr=98,K.zr=100,K.$r={tu:0,ft:1,nu:2,iu:4},K.eu={su:0};var G=t.LibJSONInterface=function(){this.ou=function(t){var e=null;try{e=F.stringify(t)}catch(i){}return e},this.ru=function(e){var i=null;try{i=t.JsonParse(e)}catch(n){return i}return te.uu(i)||(i=null),i}},Y=t.CwsHeartbeat=function(){this.hu={},(function(){}).apply(this,arguments),this.get=function(){return this.hu},this.au=function(t,e){this.hu[t]=e},this.fu=function(t,e,i){this.hu[t]||(this.hu[t]={}),this.hu[t][e]=i},this.cu=function(t){this.au(K.wo,t)},this.lu=function(t){this.au(K.To,t)},this.vu=function(t){this.au(K.go,t)},this.du=function(t){this.au(K.So,t)},this.Eu=function(t){this.au(K.No,t)},this.pu=function(t){this.au(K.Oo,t)},this.Ru=function(t){this.au(K._o,t)},this.wu=function(t){this.au(K.Ao,t)},this.Tu=function(t){this.au(K.Co,t)},this.gu=function(t){this.au(K.mr,t)},this.Su=function(t){this.au(K.yo,t)},this.Nu=function(t){this.au(K.Io,t)},this.Ou=function(t){this.au(K.mo,t)},this._u=function(t){this.au(K.Do,t)},this.Au=function(t){this.au(K.bo,t)},this.Cu=function(t){this.au(K.Po,t)},this.Iu=function(t){this.au(K.Mo,t)},this.yu=function(t){this.au(K.Qo,t)},this.mu=function(t){this.au(K.Lo,t)},this.Du=function(t){this.au(K.ko,t)},this.bu=function(t){this.au(K.Uo,t)},this.Pu=function(t){this.au(K.Vo,t)},this.we=function(t){this.au(K.Ho,t)},this.Mu=function(t){this.au(K.Fo,t)},this.Lu=function(t){this.au(K.Go,t)},this.Uu=function(t){this.au(K.Bo,t)},this.Vu=function(t){this.au(K.qo,t)},this.ku=function(t){this.au(K.jo,t)},this.Fu=function(t){this.au(K.Ko,t)},this.Hu=function(t){this.au(K.xo,t)},this.Bu=function(t){this.au(K.Wo,t)},this.Gu=function(t){this.fu(K.Zo,K.fr,t)},this.ju=function(t){this.fu(K.Zo,K.cr,t)},this.Ku=function(t){this.fu(K.Zo,K.lr,t)},this.Wu=function(t){this.fu(K.Zo,K.vr,t)},this.xu=function(t){this.fu(K.Zo,K.dr,t)},this.qu=function(t){this.fu(K.Zo,K.Er,t)},this.Yu=function(t){this.fu(K.Zo,K.pr,t)},this.Ju=function(t){this.fu(K.Zo,K.Rr,t)},this.Xu=function(t){this.fu(K.Zo,K.Sr,t),this.au(K.Sr,t)},this.Qu=function(t){this.fu(K.Zo,K.Nr,t),this.au(K.Nr,t)},this.Zu=function(t){this.fu(K.Zo,K.Cr,t.toUpperCase())},this.zu=function(t){this.fu(K.Zo,K.Ir,t)},this.$u=function(t){this.fu(K.Zo,K.yr,t)},this.th=function(t){this.fu(K.Zo,K.wr,t)},this.nh=function(t){this.fu(K.Zo,K.Tr,t)},this.ih=function(t){this.fu(K.Zo,K.gr,t)},this.eh=function(t){this.au(K.ir,t)},this.ze=function(t){this.au(K.er,t)},this.sh=function(t){this.au(K.Yo,t)},this.oh=function(t){this.au(K.Jo,t)},this.rh=function(t){this.au(K.Xo,t)},this.uh=function(t){this.au(K.zo,t)},this.hh=function(t){this.au(K.$o,t)},this.ah=function(t){this.au(K.tr,t)},this.fh=function(t){this.au(K.nr,t)},this.ch=function(){this.au(K.Wr,!0)},this.lh=function(t){this.au(K.sr,t)},this.setModuleName=function(t){this.fu(K.Or,K._r,t)},this.vh=function(t){this.fu(K.Or,K.Ar,t)},this.dh=function(t){this.au(K.xr,t)},this.Eh=function(t){t&&this.au(K.or,t)},this.ph=function(t){t&&this.au(K.rr,t)},this.Rh=function(t){t&&this.au(K.ur,t)},this.wh=function(t){t&&this.au(K.hr,t)},this.Th=function(t){t&&this.au(K.ar,t)}},W=t.CwsSession=function(){var t=this;t.gh=null,t.Et=null,t.Sh=0,t.Nh=0,t.Oh=K.$r.tu,t._h=K.eu.su,t.Ah=[],t.Ch=-1,t.ln=-2,t.Xn=-1,t.Ih=-1,t.yh=null,t.vn=r.PlayerState.UNKNOWN,t.fn=-1,t.mh=-1,t.rn=null,t.gn=-1,t.Sn=-1,t.oe=null,t.nn=null,t.sn=null,t.Dh=null,t.bh=null,t.Ph={},t.Mh=null,t.Lh=null,t.Uh=null,t.Vh=null,t.kh=null,t.Fh=null,t.Hh=null,t.Bh=null,t.Gh=null,t.jh=null,t.Kh=null,t.Wh=null,t.xh=null,t.qh=null,t.Yh=null,t.wn=null,t.Tn=null,t.A=null,t.C=null,t.Ue=null,t.Jh=null,t.Xh=!1,t.Qh=!1,t.Zh=!1,t.zh=!1,t.$h=!1,t.ta=null,t.na=1e3,t.ia=0,t.ea=0,t.sa={},t.N={},t.oa=!1,t.ra=null,t.ua=null,t.ha=null,t.aa=null,t.fa=null,t.ca=null,t.la=12e4,t.va=K.Js,t.da=!1,t.Ea=null,t.hi=null,(function(e,i,n,s,a,r,o,c,h,u,l,f,d){this.pa=e,this.Hi=i,this.ui=n,this.c=s,this.c.setModuleName("CwsSession"),this.w=a,this.Bi=r,this.Ra=o,this.wa=c,this.Ta=h,this.ai=u,this.ga=l,this.Et=f,this.Et&&(t.fn=this.Et.encodedFrameRate,t.rn=this.Et.streamUrl,t.mh=this.Et.duration),this.ga&&(t.Ea=t.ga.get(X.D)),t.hi=d}).apply(this,arguments),this.ut=function(){this.ga=null,this.ai=null,this.R=null,this.Ta=null,this.wa=null,this.Ra=null,this.Bi=null,this.w=null,this.c=null,this.ui=null,this.Hi=null,this.pa.Sa(),this.pa=null,this.Jh=null,this.Zh=!0},this.Na=function(e){this.Oa=e,this._a=this.Oa._a,this.c.Su(this.Oa.g),this.Sh=this.Ta.current(),this.Aa()||this.Ca()?(this.Oh+=W.Ia,t.c.info("start(): assetName="+t.Et.assetName)):t.c.info("start()"+t.ya())},this.ma=function(){this.zh=!0},this.Da=function(){this.c.debug("initialize()"),(this.Aa()||this.Ca()||this.ba())&&(t.Pa(),t.Ma(),t.La(),(this.Aa()||this.Ca())&&t.Ua())},this.Va=function(){this.c.debug("end(): schedule the last hb before session cleanup"+t.ya()),this.ka(),this.Fa(),this.Ha(),this.Ba()},this.Ga=function(){this.zh||(this.Ba(),this.ja())},this.ju=function(e){var i=t.Mh;i!==e&&e&&(t.c.debug("Change browserName from "+i+" to "+e),t.Mh=e)},this.Ku=function(e){var i=t.Lh;i!==e&&e&&(t.c.debug("Change browserVersion from "+i+" to "+e),t.Lh=e)},this.Wu=function(e){var i=t.Uh;i!==e&&e&&(t.c.debug("Change deviceBrand from "+i+" to "+e),t.Uh=e)},this.xu=function(e){var i=t.Vh;i!==e&&e&&(t.c.debug("Change deviceManufacturer from "+i+" to "+e),t.Vh=e)},this.qu=function(e){var i=t.kh;i!==e&&e&&(t.c.debug("Change deviceModel from "+i+" to "+e),t.kh=e)},this.Yu=function(e){var i=t.Fh;i!==e&&e&&(t.c.debug("Change deviceType from "+i+" to "+e),t.Fh=e)},this.Ju=function(e){var i=t.Hh;i!==e&&e&&(t.c.debug("Change deviceVersion from "+i+" to "+e),t.Hh=e)},this.Zu=function(e){var i=t.jh;i!==e&&e&&(t.c.debug("Change operatingSystemName from "+i+" to "+e),t.jh=e)},this.zu=function(e){var i=t.Kh;i!==e&&e&&(t.c.debug("Change operatingSystemVersion from "+i+" to "+e),t.Kh=e)},this.$u=function(e){var i=t.Wh;i!==e&&e&&(t.c.debug("Change deviceCategory from "+i+" to "+e),t.Wh=e)},this.th=function(e){var i=t.xh;i!==e&&e&&(t.c.debug("Change screenWidth from "+i+" to "+e),t.xh=e)},this.nh=function(e){var i=t.qh;i!==e&&e&&(t.c.debug("Change screenHeight from "+i+" to "+e),t.qh=e)},this.ih=function(e){var i=t.Wh;i!==e&&e&&(t.c.debug("Change scaleFactor from "+i+" to "+e),t.Yh=e)},this.Ka=function(){return t.Bh},this.Xu=function(e){var i=t.Bh;i!==e&&e&&(t.c.debug("Change frameworkName from "+i+" to "+e),t.Bh=e)},this.Wa=function(){return t.Gh},this.Qu=function(e){var i=t.Gh;i!==e&&e&&(t.c.debug("Change frameworkVersion from "+i+" to "+e),t.Gh=e)},this.rh=function(e){var i;t.Et.streamUrl||(i=t.rn)!==e&&e&&(t.c.debug("Change stream url from "+i+" to "+e),t.rn=e)},this.xa=function(){t.Fa(),t.da||(t.qa(),t.ca=t.Bi.create(t.qa,t.la,"CwsSession.startCdnTimer"),t.c.debug("fetching cdn ip timer started"))},this.Fa=function(){t.ca&&(t.ca(),t.Ya(null,null,null,null,null),t.ca=null)},this.qa=function(){t.c.debug("detectCDNServerIp(): For "+t.rn),t.va?t.Ja():t.Fa()},this.Ja=function(){try{var e;"function"==typeof XMLHttpRequest||"object"==typeof XMLHttpRequest?((e=new XMLHttpRequest).open("HEAD",t.rn,!0),e.setRequestHeader("Pragma","akamai-x-cache-on"),e.onreadystatechange=function(){4===this.readyState&&(200===this.status&&(this.getAllResponseHeaders().indexOf("x-cache")>=0||this.getAllResponseHeaders().indexOf("X-Cache")>=0)?t.Ya("Akamai","header","X-Cache",""+this.getResponseHeader("X-Cache"),""+this.status):t.Ya("null","header","null","null",""+this.status))},e.send()):t.c.info("xmlhttpreq is not available here to fetch CDN Server Ip")}catch(i){t.c.info("Exception caught in makeAkamaiHeadRequest")}},this.Ya=function(e,i,n,s,a){var r={},o={};t.ra!==e&&(null!==t.ra&&(o[K.or]=t.ra),t.ra=e,null===t.ra?r[K.or]="null":r[K.or]=t.ra),t.ua!==i&&(null!==t.ua&&(o[K.rr]=t.ua),t.ua=i,null===t.ua?r[K.rr]="null":r[K.rr]=t.ua),t.ha!==n&&(null!==t.ha&&(o[K.ur]=t.ha),t.ha=n,null===t.ha?r[K.ur]="null":r[K.ur]=t.ha),t.aa!==s&&(null!==t.aa&&(o[K.hr]=t.aa),t.aa=s,null===t.aa?r[K.hr]="null":r[K.hr]=t.aa),t.fa!==a&&(null!==t.fa&&(o[K.ar]=t.fa),t.fa=a,null===t.fa?r[K.ar]="null":r[K.ar]=t.fa),"{}"!==JSON.stringify(r)&&t.Xa(r,o)},this.Qa=function(e){var i=t.ln;i!==e&&e>0&&(t.c.info("Change bitrate from "+i+" to "+e),t.Za(i,e),t.ln=e)},this.eh=function(e){var i=t.Xn;i!==e&&e>=0&&(t.c.info("Change dropped frames total from "+i+" to "+e),t.za(i,e),t.Xn=e)},this.ze=function(e){var i=t.Ih,n=e+(-1===t.Ih?0:t.Ih);i!==e&&n>=0&&(t.c.info("Change dropped frames count from "+i+" to "+n),t.$a(i,n),t.Ih=n)},this.Vu=function(e){var i=t.yh;i!==e&&e&&(t.c.info("Change resource from "+i+" to "+e),t.yh=e)},this._u=function(e){t.nn!==e&&e&&(t.c.info("Change assetName from "+t.nn+" to "+e),t.nn=e)},this.du=function(e){var i=t.bh;i!==e&&te.Ii(e)&&(t.c.info("Change isLive from "+i+" to "+e),t.bh=e)},this.Ou=function(e){var i=t.sn;i!==e&&e&&(t.c.info("Change viewerId from "+i+" to "+e),t.sn=e)},this.Au=function(e){var i=t.Dh;i!==e&&e&&(t.c.info("Change playerName from "+i+" to "+e),t.Dh=e)},this.Cu=function(e){var i=t.Ph;!te.tf(i,e)&&e&&(t.c.info("Change tags from "+te.nf(i)+" to "+te.nf(e)),t.Ph=e)},this.ku=function(e){t.Et.encodedFrameRate>0||(t.c.debug("setEncodedFrameRate(): "+e),t.fn=e)},this.Lu=function(e){t.Et.duration>0||(t.c.debug("setContentLength(): "+e),t.mh=e)},this.we=function(e){var i,n=!1;t.Qh||e!==r.PlayerState.PLAYING||(t.Qh=!0,t.Aa()&&(n=!0),te.wt(t.Et.viewerId)||t.c.error("Missing viewerId. viewerId should be updated before first frame is rendered."),te.wt(t.Et.streamType)&&a.StreamType.UNKNOWN!==t.Et.streamType||t.c.error("Missing streamType - Live or VOD. streamType should be updated before first frame is rendered."),te.wt(t.Et.applicationName)||t.c.error("Missing applicationName. applicationName should be updated before first frame is rendered.")),t.vn!==e&&(i=t.vn,t.c.info("setPlayerState(): changing player state from "+i+" to "+e),t.if(i,e),t.vn=e,n&&(t.c.info("SetPlayerState(): to playing state triggered urgent HB"),t.ef()))},this.sf=function(e){var i=t.gn;i!==e&&e>0&&(t.c.debug("Change stream resolution width from "+i+" to "+e),t.rf(i,e),t.gn=e)},this.uf=function(e){var i=t.Sn;i!==e&&e>0&&(t.c.debug("Change stream resolution height from "+i+" to "+e),t.hf(i,e),t.Sn=e)},this.ah=function(e){var i=t.A;i!==e&&e&&(t.c.debug("Change network connection type from "+i+" to "+e),t.af(i,e),t.A=e)},this.fh=function(e){var i=t.C;i!==e&&e&&(t.c.debug("Change network link encryption from "+i+" to "+e),t.ff(i,e),t.C=e)},this.dh=function(e){t.da=!0,t.Fa();var i=t.Ue;i!==e&&te.wt(e)&&(t.c.debug("Change CDN Server IP from "+i+" to "+e),t.cf(i,e),t.Ue=e)},this.lf=function(e){var i;t.c.debug("togglePauseJoin()"),t.Xh!==e?(i=t.Xh,e=!t.Xh,t.vf(i,e),t.Xh=!t.Xh):t.c.debug("togglePauseJoin(): same value, ignoring")},this.df=function(e,i){t.Ef(e,i),t.c.info("sendError(): triggered urgent HB"),t.ef()},this.pf=function(t,e){var i;e[K.Dr]=t,e[K.Pr]=this.Rf(),e[K.br]=this.pa.wf(),this.oe&&(i=ta.Tf(this.oe.getPHT(),0,null,-1),t=ta.Tf(this.oe.getBufferLength(),0,null,-1),i>=0&&(e[K.Yo]=i),t>0&&(e[K.Jo]=t)),this.pa.gf(e)},this.Sf=function(e){t.oe=e,t.oe?t.Nf():t.Of()},this.ka=function(){var t=this.wa.Ws(this._f(),this.Rf());this.pa.gf(t)},this.Ef=function(t,e){var i={};i[K.Ur]=t,i[K.Vr]=e,this.pf(K.io,i)},this.Za=function(t,e){var i={},n={};t>0&&(n[K.Bo]=t),i[K.Bo]=e,this.Xa(i,n)},this.Af=function(t,e){var i={};i[K.Mr]=t,e>=0&&(i[K.Lr]=e),this.pf(K.so,i)},this.rf=function(t,e){var i={},n={};-1!==t&&(n[K.zo]=t),i[K.zo]=e,this.Xa(i,n)},this.hf=function(t,e){var i={},n={};-1!==t&&(n[K.$o]=t),i[K.$o]=e,this.Xa(i,n)},this.af=function(t,e){var i={},n={};null!==t&&(n[K.tr]=t),i[K.tr]=e,this.Xa(i,n)},this.ff=function(t,e){var i={},n={};null!==t&&(n[K.nr]=t),i[K.nr]=e,this.Xa(i,n)},this.cf=function(t,e){var i={},n={};te.wt(t)&&(n[K.xr]=t),i[K.xr]=e,this.Xa(i,n)},this.za=function(t,e){var i={},n={};t>=0&&(n[K.ir]=t),i[K.ir]=e,this.Xa(i,n)},this.$a=function(t,e){var i={},n={};t>=0&&(n[K.er]=t),i[K.er]=e,this.Xa(i,n)},this.vf=function(t,e){var i={},n={};n[K.Fo]=t,i[K.Fo]=e,this.Xa(i,n)},this.if=function(t,e){var i={},n={};i[K.Ho]=K.qr(e),n[K.Ho]=K.qr(t),this.Xa(i,n)},this.Xa=function(t,e){var i={};i[K.kr]=t,e&&te.It(e)>0&&(i[K.Fr]=e),this.pf(K.no,i)},this.Cf=function(t,e){var i={};i[K.Hr]=t,te.It(e)>0&&(i[K.Br]=e),this.pf(K.eo,i)},this.Ha=function(){t.gh&&(t.gh(),t.gh=null)},this.ja=function(){t.Ha();var e=1e3*t.ui.heartbeatInterval;t.gh=t.Bi.create(t.Ba,e,"Session.sendHeartbeat:"+this._a)},this.Of=function(){t.ta&&(t.ta(),t.ta=null)},this.Nf=function(){t.Of(),t.ta=t.Bi.create(t.If,t.na,"Session.startRfpsTimer")},this.yf=function(){var e={err:"pending"};e.seq=t.Nh-1,e.sentAt=t.Rf(),e.rtt=-1,t.Ah.push(e);for(var i=0;i<t.Ah.length;i++)"ok"===(e=t.Ah[i]).err&&(t.Ah.splice(i,1),i--)},this.mf=function(e,i){for(var n=0;n<t.Ah.length;n++){var s=t.Ah[n];s.seq===e&&(s.rtt=t.Rf()-s.sentAt,s.err=i)}},this.Df=function(e){for(var i=0;i<t.Ah.length;i++){var n=t.Ah[i];n.seq===e&&(n.rtt=t.Rf()-n.sentAt,n.err="ok")}},this.bf=function(){for(var e,i,n=t.ga.get(X.Pf),s=[],a=-1,r=0;r<t.Ah.length;r++)if("ok"===(i=t.Ah[r]).err){a=i.seq;break}for(var o=0;o<t.Ah.length;o++)((e=(i=t.Ah[o]).seq)<t.Nh-n||e<a)&&s.push(o);for(var c=[],h=0;h<t.Ah.length;h++)e=(i=t.Ah[h]).seq,0>s.indexOf(h)&&c.push(t.Ah[h]);t.Ah=c},this.Mf=function(){t.bf();for(var e=[],i=0;i<t.Ah.length;i++){var n=t.Ah[i],s={};s[K.Gr]=n.seq,s[K.Kr]=n.rtt,s[K.jr]=n.err,e.push(s)}return e},this.Lf=function(){var e,n=-1,s=-1,a=t.pa.Sa();if(t.ba()&&0===a.length)return null;var o=new Y;o.cu(K.Ro),o.pu(t.ui.customerKey),o.Ru(t.ga.get(X.D)),o.Su(t.Oa.g),o.Eu(t.Nh),o.Tu(K.version);var c=i.version;if(t.hi&&(c=t.hi),o.wu(c),o.Nu(t.Hi.g),o.gu(0),t.Hi.A?o.ah(t.Hi.A):t.A&&o.ah(t.A),t.Hi.C?o.fh(t.Hi.C):t.C&&o.fh(t.C),te.wt(t.Ue)&&o.dh(t.Ue),o.Gu(K.$s),t.Mh&&o.ju(t.Mh),t.Lh&&o.Ku(t.Lh),t.Uh&&o.Wu(t.Uh),t.Vh&&o.xu(t.Vh),t.kh&&o.qu(t.kh),t.Fh&&o.Yu(t.Fh),t.Hh&&o.Ju(t.Hh),t.jh&&o.Zu(t.jh),t.Kh&&o.zu(t.Kh),t.Wh&&o.$u(t.Wh),t.Bh&&o.Xu(t.Bh),t.Gh&&o.Qu(t.Gh),t.xh&&!isNaN(t.xh)&&o.th(parseInt(t.xh,10)),t.qh&&!isNaN(t.qh)&&o.nh(parseInt(t.qh,10)),t.Yh&&!isNaN(t.Yh)?o.ih(parseFloat(t.Yh)):(t.xh&&!isNaN(t.xh)||t.qh&&!isNaN(t.qh))&&o.ih(1),t.oe&&(t.wn=t.oe.bn(),t.wn&&o.setModuleName(t.wn),t.Tn=t.oe.Pn(),t.Tn&&o.vh(t.Tn),t.oe.Mn()&&(t.Bh=t.oe.Mn(),o.Xu(t.Bh)),t.oe.Un()&&(t.Gh=t.oe.Un(),o.Qu(t.Gh))),t.sn&&o.Ou(t.sn),te.It(t.Ph)>0&&o.Cu(t.Ph),t.Aa()||t.Ca()){if(t.Ca()&&o.ch(),t.nn&&o._u(t.nn),o.Iu(t.Oh),c=K.qr(t.vn),o.we(c),o.Mu(t.Xh),t.Dh&&o.Au(t.Dh),te.Ii(t.bh)&&o.du(t.bh),t.mh>0&&o.Lu(t.mh),t.ln>0&&o.Uu(t.ln),null!==t.yh&&o.Vu(t.yh),t.fn>0&&o.ku(t.fn),t.oe&&(n=ta.Tf(t.oe.getPHT(),0,null,-1),s=ta.Tf(t.oe.getBufferLength(),0,null,-1)),te.lt(t.Hi.I)?e=t.Hi.I:t.oe&&(e=t.oe.getSignalStrength()),n>=0&&o.sh(n),s>0&&o.oh(s),(s=t.Uf())>0&&o.Fu(s),t.ea>0&&o.Bu(ta.Tf(t.ea,0,null,-1)),t.ia>0&&o.Hu(ta.Tf(t.ia,0,null,-1)),e!==r.DEFAULT_SIGNAL_STRENGTH&&o.lh(e),t.rn&&o.rh(t.rn),t.gn>0&&o.uh(t.gn),t.Sn>0&&o.hh(t.Sn),t.Xn>-1&&o.eh(t.Xn),t.Ih>-1&&(o.ze(t.Ih),t.Ih>0&&(t.$a(t.Ih,0),t.Ih=0)),void 0!==t.Jh)for(var h in t.Jh)o.au(h,t.Jh[h])}else o.Iu(K.$r.tu);return a.length>0&&o.mu(a),o.yu(t._h),o.Du(!0),t.ga.get(X.Vf)&&o.bu(t.ai.Sa()),t.ga.get(X.Pf)>0&&(a=t.Mf()).length>0&&o.Pu(a),0===t.Nh&&(o=t.kf(o)),0!==t.Nh&&(o=t.Ff(o)),o.vu(t.Sh),o.lu(t.Rf()),t.va&&(o.Eh(t.ra),o.ph(t.ua),o.Rh(t.ha),o.wh(t.aa),o.Th(t.fa)),t.Nh++,o.get()},this.Ff=function(e){var i,n=t.N,s={};for(i in e.hu.tags)Object.prototype.hasOwnProperty.call(n,i)||(s[i]=e.hu.tags[i]);e.hu.tags=s,t.N={};for(var a=0;a<t.sa.length;a++)Object.prototype.hasOwnProperty.call(t.Hi.N,t.sa[a])?Object.prototype.hasOwnProperty.call(t.Hi._,t.sa[a])?t.Hi._[t.sa[a]]===X.Bt.Gt?(t.N[X.Hf+""+t.sa[a]]=X.Bt.Gt,t.Hi.O("End-user chose to opt-out of personal data collection")):t.Hi._[t.sa[a]]===X.Bt.Kt?(t.N[X.Hf+""+t.sa[a]]=X.Bt.Kt,t.Hi.O("End-user chose to opt-out of personal data collection")):t.Hi._[t.sa[a]]===X.Bt.Ht?(t.N[X.Hf+""+t.sa[a]]=X.Bt.Ht,t.Hi.O("End-user used privacy settings and chose to opt-out of personal data collection")):(t.N[X.Hf+""+t.sa[a]]=t.Hi.N[t.sa[a]],t.Hi.O("Data collection successful")):(t.N[X.Hf+""+t.sa[a]]=t.Hi.N[t.sa[a]],t.Hi.O("Data collection successful")):t.N[X.Hf+""+t.sa[a]]=X.Bt.Bf;var r,o={};for(r in n){var c=r.split(".");"{}"!==JSON.stringify(t.sa)&&-1!==t.sa.indexOf(""+c[2])||n[X.Hf+""+c[2]]===X.Bt.Gf||(t.Hi.O("Data collection restricted from Conviva back-end"),t.N[X.Hf+""+c[2]]=X.Bt.Gf,o[X.Hf+""+c[2]]=X.Bt.Gf)}if("{}"!==JSON.stringify(t.N)){var h,u=te.jf(t.N);for(h in e.hu.tags)u[h]=e.hu.tags[h];if(e.hu.tags=u,!te.tf(n,t.N)){var l={};if("{}"!==JSON.stringify(o)&&(l[K.Po]=o),"{}"!==JSON.stringify(n)){for(var f in n)t.N[f]&&n[f]!==t.N[f]&&(l[K.Po]||(l[K.Po]={}),l[K.Po][f]=t.N[f]);for(var d in t.N)Object.prototype.hasOwnProperty.call(n,d)&&n[d]===t.N[d]||(l[K.Po]||(l[K.Po]={}),l[K.Po][d]=t.N[d])}"{}"===JSON.stringify(n)&&(l[K.Po]=t.N);var E,v,y={};y[K.kr]=l,y[K.Dr]=K.no,y[K.Pr]=t.Rf(),y[K.br]=t.pa.wf(),t.oe&&(E=ta.Tf(t.oe.getPHT(),0,null,-1),v=ta.Tf(t.oe.getBufferLength(),0,null,-1),E>=0&&(y[K.Yo]=E),v>0&&(y[K.Jo]=v)),e.hu.evs||(e.hu.evs=[]),e.hu.evs.push(y)}}return e},this.kf=function(e){var i=t.Kf();if("{}"===JSON.stringify(i))return e;var n,s=te.jf(i);for(n in e.hu.tags)s[n]=e.hu.tags[n];e.hu.tags=s;var a={};a[K.Po]=i;var r={};return r[K.kr]=a,r[K.Dr]=K.no,r[K.Pr]=t.Rf(),r[K.br]=t.pa.wf(),t.oe&&(i=ta.Tf(t.oe.getPHT(),0,null,-1),a=ta.Tf(t.oe.getBufferLength(),0,null,-1),i>=0&&(r[K.Yo]=i),a>0&&(r[K.Jo]=a)),e.hu.evs||(e.hu.evs=[]),e.hu.evs.push(r),e},this.Kf=function(){var e={};if("undefined"!=typeof navigator&&navigator){if(e["c3.fp.cookie"]=void 0!==navigator.cookieEnabled&&navigator.cookieEnabled?""+navigator.cookieEnabled:"",e["c3.fp.memory"]=void 0!==navigator.deviceMemory&&navigator.deviceMemory?""+navigator.deviceMemory:"",e["c3.fp.hwConc"]=void 0!==navigator.hardwareConcurrency&&navigator.hardwareConcurrency?""+navigator.hardwareConcurrency:"",e["c3.fp.java"]=""+("function"!=typeof navigator.javaEnabled)?"false":navigator.javaEnabled(),e["c3.fp.lang"]=void 0!==navigator.language&&navigator.language?""+navigator.language:"",e["c3.fp.langs"]=void 0!==navigator.languages&&navigator.languages&&navigator.languages.length>0?""+navigator.languages.toString():"",e["c3.fp.maxTp"]=void 0!==navigator.maxTouchPoints&&navigator.maxTouchPoints?""+navigator.maxTouchPoints:"",e["c3.fp.plugins"]="",void 0!==navigator.plugins&&navigator.plugins&&navigator.plugins.length>0)for(var i=0;i<navigator.plugins.length;i++)e["c3.fp.plugins"]+=navigator.plugins[i].name+",";if(e["c3.fp.mime"]="",void 0!==navigator.mimeTypes&&navigator.mimeTypes&&navigator.mimeTypes.length>0)for(var n=0;n<navigator.mimeTypes.length;n++)e["c3.fp.mime"]+=navigator.mimeTypes[n].type+",";e["c3.fp.sysLang"]=void 0!==navigator.systemLanguage&&navigator.systemLanguage?""+navigator.systemLanguage:"",e["c3.fp.platform"]=void 0!==navigator.platform&&navigator.platform?""+navigator.platform:"",e["c3.fp.product"]=void 0!==navigator.product&&navigator.product?""+navigator.product:"",e["c3.fp.productSub"]=void 0!==navigator.productSub&&navigator.productSub?""+navigator.productSub:"",e["c3.fp.vendor"]=void 0!==navigator.vendor&&navigator.vendor?""+navigator.vendor:"",e["c3.fp.vendorSub"]=void 0!==navigator.vendorSub&&navigator.vendorSub?""+navigator.vendorSub:"";var s=t.Wf();""!==s&&(e["c3.fp.canvFp"]=s)}return"undefined"!=typeof window&&window&&(void 0!==window.screen&&window.screen&&(e["c3.fp.availHeight"]=void 0!==window.screen.availHeight&&window.screen.availHeight?""+window.screen.availHeight:"",e["c3.fp.availWidth"]=void 0!==window.screen.availWidth&&window.screen.availWidth?""+window.screen.availWidth:"",e["c3.fp.height"]=void 0!==window.screen.height&&window.screen.height?""+window.screen.height:"",e["c3.fp.width"]=void 0!==window.screen.width&&window.screen.width?""+window.screen.width:"",e["c3.fp.colorDepth"]=void 0!==window.screen.colorDepth&&window.screen.colorDepth?""+window.screen.colorDepth:"",e["c3.fp.deviceXDPI"]=void 0!==window.screen.deviceXDPI&&window.screen.deviceXDPI?""+window.screen.deviceXDPI:"",e["c3.fp.deviceYDPI"]=void 0!==window.screen.deviceYDPI&&window.screen.deviceYDPI?""+window.screen.deviceYDPI:""),e["c3.fp.dpi"]=void 0!==window.devicePixelRatio&&window.devicePixelRatio?""+window.devicePixelRatio:"",e["c3.fp.secure"]="boolean"==typeof window.isSecureContext?""+window.isSecureContext:""),e},this.Wf=function(){try{if("undefined"!=typeof document&&document){var t=document.createElement("CANVAS");if(void 0!==t&&t&&"function"==typeof t.getContext){var e=t.getContext("2d"),i="conviva";return e.textBaseline="top",e.font="14px Arial",e.textBaseline="alphabetic",e.fillStyle="#f40",e.fillRect(void 0!==navigator.plugins&&navigator.plugins?navigator.plugins.length:0,void 0!==navigator.mimeTypes&&navigator.mimeTypes?navigator.mimeTypes.length:0,void 0!==navigator.product&&navigator.product?navigator.product.length:0,void 0!==navigator.vendor&&navigator.vendor?navigator.vendor.length:0),e.fillStyle="#069",e.fillText(i,void 0!==navigator.maxTouchPoints&&navigator.maxTouchPoints>=0?navigator.maxTouchPoints:0,void 0!==navigator.product&&navigator.product?navigator.product.length:0),e.fillStyle="rgba(102, 204, 0, 0.7)",e.fillText(i,void 0!==navigator.deviceMemory&&navigator.deviceMemory?navigator.deviceMemory:0,void 0!==navigator.hardwareConcurrency&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:0),B.js(t.toDataURL())}}return""}catch(n){return""}},this.Ba=function(){var e;t.Zh||(e=t.Lf())&&t.xf(e)},this.If=function(){var e;t.vn!==r.PlayerState.PLAYING||!t.oe||(e=t.oe.getRenderedFrameRate())>0&&(t.ea+=e,t.ia++)},this.Uf=function(){return t.ea>0&&t.ia>0?te.qf.Cast(+t.ea/t.ia):(this.If(),t.ea>0&&t.ia>0?te.qf.Cast(+t.ea/t.ia):r.DEFAULT_RENDERED_FRAME_RATE)},this.xf=function(e){t.yf();var i=t.Nh-1;t.c.info("postHeartbeat(): Send HB["+i+"]"+t.ya()),t.Ra.Yf(e,function(e,n){t.Jf(e,n,i)})},this.Jf=function(e,i,n){t.Zh||t.w.m("onHeartbeatResponse",function(){var s,a,r;e?i?(t.c.debug("onHeartbeatResponse(): received valid response for HB["+n+"]"),t.Df(n),(r=i[K.ho])&&r!==(s=t.ga.get(X.D))&&(t.c.debug("onHeartbeatResponse(): setting the client id to "+r+" (from gateway)"),t.ga.set(X.D,r),t.ga.Xf(),s===K.P&&r!==K.P&&(t.Hi.y(),t.$h&&(t.c.debug("Send enqueued urgent hb as client id is available"),t.ef()))),(s=i[K.uo])&&s!==K.ro&&t.c.error("onHeartbeatResponse(): error from gateway: "+s),"object"==typeof(r=i[K.ao])&&((s=r[K.co])>=0&&t.ga.get(X.Pf)!==s&&(t.c.debug("onHeartbeatResponse(): setting Maximum Heartbeat Infos to "+s+" (from gateway)"),t.ga.set(X.Pf,s)),s=r[K.lo],(s=!!te.Ii(s)&&s)!==t.ga.get(X.Vf)&&(t.c.debug("onHeartbeatResponse(): turning "+(s?"on":"off")+" sending of logs"),t.ga.set(X.Vf,s)),s=r[K.vo],!te.lt(s)||(a=te.qf.Cast(s))!==t.ui.heartbeatInterval&&(t.c.debug("onHeartbeatResponse(): received hbIntervalMs from gateway: "+a),t.ui.heartbeatInterval=a,t.gh&&t.ja()),(a=r[K.do])&&a!==t.ui.gatewayUrl&&(t.c.debug("onHeartbeatResponse(): received gatewayUrl from gateway: "+a),t.ui.gatewayUrl=a),t.Qf()||(t.sa={},(a=r[K.Eo])&&(t.oa||(t.oa=!0),t.c.debug("onHeartbeatResponse(): received fp from gateway: "+a),t.sa=a.split(",")),t.va=r[K.po],te.Ii(t.va)&&(t.va?(t.c.debug("onHeartbeatResponse(): enabling the CDN Server IP collection"),t.ca||t.xa()):t.Fa())))):t.c.warning("onHeartbeatResponse(): decoded heartbeat response is null."):(r=i,te.wt(r)?te.Zf(r,"HTTP timeout")?t.c.warning("onHeartbeatResponse(): "+r):t.c.error("onHeartbeatResponse(): failed to send heartbeat: "+r):(r=x.zf,t.c.error("onHeartbeatResponse(): "+r)),t.mf(n,r))})},this.Rf=function(){return te.qf.Cast(t.Ta.current()-t.Sh)},this._f=function(){return this.pa.wf()},this.ya=function(){return this.ba()?" (global session)":""},this.ba=function(){return this._a===W.ct.tu},this.Qf=function(){return this._a===W.ct.tu&&"T"===this.Ph["c3.IPV4IPV6GlobalSession"]},this.Aa=function(){return this._a===W.ct.ft},this.Ca=function(){return this._a===W.ct.Rt},this.gt=function(e){t.$f(e),t.Pa()},this.$f=function(e){var i={},n={};if(te.wt(e.assetName)&&(t.Et.assetName!==e.assetName?(t.Et.assetName&&(i[K.Do]=t.Et.assetName),n[K.Do]=e.assetName,t.Et.assetName=e.assetName):t.c.warning("mergeContentMetadata(): assetName was not changed.")),te.wt(e.applicationName)&&(t.Et.applicationName!==e.applicationName?(t.Et.applicationName&&(i[K.bo]=t.Et.applicationName),n[K.bo]=e.applicationName,t.Et.applicationName=e.applicationName):t.c.warning("mergeContentMetadata(): applicationName was not changed.")),te.wt(e.streamUrl)&&(t.Et.streamUrl!==e.streamUrl?(t.Et.streamUrl&&(i[K.Xo]=t.Et.streamUrl),n[K.Xo]=e.streamUrl,t.Et.streamUrl=e.streamUrl,t.rn=t.Et.streamUrl):t.c.warning("mergeContentMetadata(): streamUrl was not changed.")),te.wt(e.viewerId)&&(t.Et.viewerId!==e.viewerId?(t.Et.viewerId&&(i[K.mo]=t.Et.viewerId),n[K.mo]=e.viewerId,t.Et.viewerId=e.viewerId):t.c.warning("mergeContentMetadata(): viewerId was not changed.")),te.wt(e.defaultResource)&&(t.Et.defaultResource!==e.defaultResource?(t.Et.defaultResource&&(i[K.qo]=t.Et.defaultResource),n[K.qo]=e.defaultResource,t.Et.defaultResource=e.defaultResource):t.c.warning("mergeContentMetadata(): defaultResource was not changed.")),te.lt(e.duration)&&e.duration>0&&(t.Et.duration!==e.duration?(t.mh>0&&(i[K.Go]=t.mh),n[K.Go]=e.duration,t.Et.duration=e.duration,t.mh=t.Et.duration):t.c.warning("mergeContentMetadata(): duration was not changed.")),te.lt(e.encodedFrameRate)&&e.encodedFrameRate>0&&(t.Et.encodedFrameRate!==e.encodedFrameRate?(t.Et.encodedFrameRate>-1&&(i[K.jo]=t.Et.encodedFrameRate),n[K.jo]=e.encodedFrameRate,t.Et.encodedFrameRate=e.encodedFrameRate,t.fn=t.Et.encodedFrameRate):t.c.warning("mergeContentMetadata(): encodedFrameRate was not changed.")),e.streamType!==a.StreamType.UNKNOWN&&(t.Et.streamType!==e.streamType?(t.Et.streamType!==a.StreamType.UNKNOWN&&(t.Et.streamType===a.StreamType.LIVE?i[K.So]=!0:i[K.So]=!1),e.streamType===a.StreamType.LIVE?n[K.So]=!0:n[K.So]=!1,t.Et.streamType=e.streamType):t.c.warning("mergeContentMetadata(): streamType was not changed.")),te.It(e.custom)>0){var s,r={},o={};for(s in e.custom)t.Et.custom[s]!==e.custom[s]?(r[s]=e.custom[s],t.Et.custom[s]&&(o[s]=t.Et.custom[s]),t.Et.custom[s]=e.custom[s]):t.c.info("mergeContentMetadata(): custom."+s+" was not changed.");te.It(r)>0?(te.It(o)>0&&(i[K.Po]=o),n[K.Po]=r):t.c.warning("mergeContentMetadata(): custom was not changed.")}te.It(n)>0&&this.Xa(n,i)},this.Pa=function(){var e;t.c.debug("setStatesFromContentMetadata()"),t.Et.defaultResource&&this.Vu(t.Et.defaultResource),t.Et.streamUrl&&this.rh(t.Et.streamUrl),t.Et.duration>0&&this.Lu(t.Et.duration),t.Et.encodedFrameRate>0&&this.ku(t.Et.encodedFrameRate),t.Et.streamType!==a.StreamType.UNKNOWN&&(e=t.Et.streamType===a.StreamType.LIVE,this.du(e)),t.Et.assetName&&this._u(t.Et.assetName),t.Et.viewerId&&this.Ou(t.Et.viewerId),(t.Et.applicationName||t.Et.playerName)&&this.Au(t.Et.applicationName||t.Et.playerName),te.It(t.Et.custom)>0&&this.Cu(t.Et.custom)},this.Ma=function(){var e={};if(this.ba()||(t.Et.assetName?e[K.Do]=t.Et.assetName:t.c.warning("enqueueEventForContentMetadata(): assetName was not set."),t.Et.applicationName?e[K.bo]=t.Et.applicationName:t.c.warning("enqueueEventForContentMetadata(): applicationName was not set."),t.Et.streamUrl?e[K.Xo]=t.Et.streamUrl:t.c.warning("enqueueEventForContentMetadata(): streamUrl was not set."),t.Et.viewerId?e[K.mo]=t.Et.viewerId:t.c.warning("enqueueEventForContentMetadata(): viewerId was not set."),t.Et.defaultResource?e[K.qo]=t.Et.defaultResource:t.c.warning("enqueueEventForContentMetadata(): defaultResource was not set."),t.Et.duration>-1?e[K.Go]=t.Et.duration:t.c.warning("enqueueEventForContentMetadata(): duration was not set."),t.Et.encodedFrameRate>-1?e[K.jo]=t.Et.encodedFrameRate:t.c.warning("enqueueEventForContentMetadata(): encodedFrameRate was not set."),t.Et.streamType!==a.StreamType.UNKNOWN?t.Et.streamType===a.StreamType.LIVE?e[K.So]=!0:e[K.So]=!1:t.c.warning("enqueueEventForContentMetadata(): streamType was not set.")),te.It(t.Et.custom)>0)for(var i in e[K.Po]={},t.Et.custom)e[K.Po][i]=t.Et.custom[i];else this.ba()||t.c.warning("enqueueEventForContentMetadata(): custom tags were not set.");te.It(e)>0&&this.Xa(e,null)},this.Ua=function(){t.Et&&te.wt(t.Et.assetName)||t.c.warning("Missing assetName during session creation"),t.Et&&te.wt(t.Et.defaultResource)||t.c.warning("Missing resource during session creation"),t.Et&&te.wt(t.Et.streamUrl)||t.c.warning("Missing streamUrl during session creation"),(!t.Et||t.Et.encodedFrameRate<=0)&&t.c.warning("Missing encodedFrameRate during session creation"),t.Et&&te.wt(t.Et.viewerId)||t.c.warning("Missing viewerId during session creation"),t.Et&&t.Et.streamType&&a.StreamType.UNKNOWN!==t.Et.streamType||t.c.warning("Missing streamType during session creation"),t.Et&&te.wt(t.Et.applicationName)||t.c.warning("Missing applicationName during session creation"),(!t.Et||t.Et.duration<=0)&&t.c.warning("Missing duration during session creation")},this.Ft=function(e,i){t.Jh||(t.Jh={}),t.Jh[e]=i},this.La=function(){var e={};t.Hi.A&&(e[K.tr]=t.Hi.A,t.A=t.Hi.A),t.Hi.C&&(e[K.nr]=t.Hi.C,t.C=t.Hi.C),te.It(e)>0&&this.Xa(e,null)},this.ef=function(){var e;t.zh||((e=t.ga.get(X.D))&&e!==K.P&&""!==e&&"null"!==e?(t.c.debug("Send urgent hb:::"),t.$h=!1,t.ja(),t.Ba()):(t.c.debug("Delay sending of urgent hb due to missing client id"),t.$h=!0))}};W.Ia=K.$r.ft+K.$r.nu+K.$r.iu,W.ct={ft:"Video",tu:"Global",Rt:"Ad"};var x=t.Session=function(){var t=this;t.oe=null,t.g=0,t._a=W.ct.ft,t.tc=!1,t.Zh=!1,t.nc=!1,t.ic=null,t.Gi=null,t.ec=null,t.sc=!1,t.oc=r.PlayerState.NOT_MONITORED,t.rc=!1,t.uc=!1,t.hc=!1,t.ac=!1,t.fc=!1,(function(t,e,i,n,s,a,r){this.g=t,this._a=e,this.ga=i,this.cc=n,this.dt=s,this.w=a,this.c=r}).apply(t,arguments),this.Na=function(e,i){t.dt.Na(this),e&&t.Ot(e),t.ga.lc()?t.vc(i):t.ga.dc(function(){t.vc(i)})},this.cleanup=function(){t.tc=!0,t.dt.ma(),t.ga.lc()?t.Ec():t.ga.dc(function(){t.Ec()})},this.pc=function(){(t.Aa()||t.Ca())&&t.oe&&t.Rc(),t.w=null,t.Hi=null,t.ga=null,t.cc=null,t.dt.ut(),t.dt=null,t.Zh=!0},this.Ec=function(){t.dt.Va(),t.pc()},this.vc=function(e){t.dt.Da(),t.wc(),e?(t.Tt(e.ms(),e.Ds()),t.dt.we(r.PlayerState.STOPPED),t.dt.Va(),t.pc()):t.dt.Ga()},this.wc=function(){var e=t.cc.get(),i=e[th.BROWSER_NAME];i&&t.dt.ju(i),(i=e[th.BROWSER_VERSION])&&t.dt.Ku(i),(i=e[th.DEVICE_BRAND])&&t.dt.Wu(i),(i=e[th.DEVICE_MANUFACTURER])&&t.dt.xu(i),(i=e[th.DEVICE_MODEL])&&t.dt.qu(i),(i=e[th.DEVICE_TYPE])&&t.dt.Yu(i),(i=e[th.DEVICE_VERSION])&&t.dt.Ju(i),(i=e[th.FRAMEWORK_NAME])&&t.dt.Xu(i),(i=e[th.FRAMEWORK_VERSION])&&t.dt.Qu(i),(i=e[th.OPERATING_SYSTEM_NAME])&&t.dt.Zu(i),(i=e[th.OPERATING_SYSTEM_VERSION])&&t.dt.zu(i),(i=e[th.DEVICE_CATEGORY])&&t.dt.$u(i),(i=e[th.SCREEN_WIDTH])&&t.dt.th(i),(i=e[th.SCREEN_HEIGHT])&&t.dt.nh(i),(e=e[th.SCALE_FACTOR])&&t.dt.ih(e)},this.Gn=function(e){t.dt.vn!==e&&(t.dt.vn===r.PlayerState.NOT_MONITORED&&e!==r.PlayerState.NOT_MONITORED&&(t.oc=e),t.sc||t.dt.we(e))},this.jn=function(e){t.rc||t.dt.Qa(e)},this.Qn=function(e){t.uc||t.dt.eh(e)},this.Zn=function(e){t.uc||t.dt.ze(e)},this.Kn=function(e,i){te.lt(i)||(i=-1),t.dt.Af(e,i)},this.Cn=function(e){e>0&&(t.ac||t.dt.ku(e))},this.mn=function(e){e>0&&(t.ac||t.dt.Lu(e))},this.Dn=function(e){t.dt.rh(e)},this.Wn=function(e){t.dt.sf(e)},this.xn=function(e){t.dt.uf(e)},this.W=function(e){t.dt.ah(e)},this.Y=function(e){t.dt.fh(e)},this.Ln=function(e){t.dt.Ka()||t.dt.Xu(e)},this.Vn=function(e){t.dt.Wa()||t.dt.Qu(e)},this.Yn=function(e){t.dt.dh(e)},this.qn=function(e,i){t.Tt(e,i)},this._n=function(){t.Rc()},this.bt=function(e,i,s){t.nc||(t.nc=!0,t.ic=e,t.Gi=i,t.ec=s,t.dt.lf(!0),t.ic===n.AdStream.CONTENT||t.Gi===n.AdPlayer.SEPARATE?(t.dt.vn!==r.PlayerState.NOT_MONITORED&&(t.oc=t.dt.vn),t.dt.we(r.PlayerState.NOT_MONITORED),t.sc=!0):t.ic===n.AdStream.SEPARATE&&t.Gi===n.AdPlayer.CONTENT&&(t.dt.vn!==r.PlayerState.NOT_MONITORED&&(t.oc=t.dt.vn),t.dt.we(r.PlayerState.NOT_MONITORED),t.sc=!0,t.rc=!0,t.uc=!0,t.ac=!0,t.hc=!0))},this.Pt=function(){t.nc&&(t.dt.lf(!1),t.ic===n.AdStream.CONTENT||t.Gi===n.AdPlayer.SEPARATE?t.Tc||(t.sc=!1,t.dt.we(t.oc)):t.ic===n.AdStream.SEPARATE&&t.Gi===n.AdPlayer.CONTENT&&(t.rc=!1,t.uc=!1,t.ac=!1,t.hc=!1,t.fc=!1,t.Tc||(t.sc=!1,t.dt.we(t.oc))),t.nc=!1,t.ic=t.Gi=t.ec=null)},this.St=function(){t.oe&&t.oe&&(t.w.m("Session.detachPlayer",function(){t.oe.An()}),t.oe=null,t.dt.Sf(null),t.dt.we(r.PlayerState.NOT_MONITORED))},this.Rc=function(){t.oe&&(t.w.m("Session.releasePlayerStateManager",function(){t.oe.An()}),t.oe=null,t.dt.Sf(null),t.dt.we(r.PlayerState.NOT_MONITORED))},this.Nt=function(){t.dt.lf(!0),t.dt.vn!==r.PlayerState.NOT_MONITORED&&(t.oc=t.dt.vn),t.dt.we(r.PlayerState.NOT_MONITORED),t.sc=!0},this.Ot=function(e){t.oe||e instanceof r&&t.w.m("Session.attachPlayer()",function(){e.setMonitoringNotifier(t,t.g)&&(e.kn(),t.oe=e,t.dt.Sf(t.oe))})},this._t=function(){t.dt.lf(!1),t.rc=!1,t.uc=!1,t.ac=!1,t.hc=!1,t.fc=!1,t.Tc||(t.sc=!1,t.oc!==r.PlayerState.NOT_MONITORED&&t.dt.we(t.oc))},this.Lt=function(){return t.oe},this.At=function(){t.Tc||(t.Tc=!0,t.sc=!0)},this.Ct=function(){t.Tc&&(t.Tc=!1,t.nc||(t.sc=!1,t.oc!==r.PlayerState.NOT_MONITORED&&t.dt.we(t.oc)))},this.Tt=function(e,i){te.wt(e)&&(i!==n.ErrorSeverity.FATAL&&i!==n.ErrorSeverity.WARNING||t.fc||(i=i===n.ErrorSeverity.FATAL,t.dt.df(e,i)))},this.gt=function(e){t.w.m("Session.updateContentMetadata",function(){t.dt.gt(e)})},this.Dt=function(e,i){t.dt.Cf(e,i)},this.ba=function(){return t._a===W.ct.tu},this.Aa=function(){return t._a===W.ct.ft},this.Ca=function(){return t._a===W.ct.Rt},this.ya=function(){return t.ba()?" (global session)":""},this.Vt=function(){return this.g},this.kt=function(){var e=null;return t.ga.lc()&&(e=t.ga.get(X.D)),e},this.Ft=function(e,i){t.dt.Ft(e,i)}};x.zf="received no response (or a bad response) to heartbeat POST request";var q=t.SessionFactory=function(){var t=this;t.ai=null,t.gc=0,t.Sc=null,(function(e,i,n,s){t.Hi=e,t.ui=i,t.ga=n,t.v=s,t.gc=0,t.Sc={}}).apply(t,arguments),this.ut=function(){for(var e in t.ai=null,t.Sc)t.Sc[e].cleanup();t.Sc=null,t.gc=0},this.Nc=function(){var e=t.gc;return t.gc++,e},this.ht=function(e,i,n,s,r){return e||(e=new a),t.Oc(e,i,n,s,r)},this.k=function(e){return t.Oc(e,W.ct.tu,void 0,i.version)},this._c=function(){return ts.Ac()},this.Oc=function(e,i,n,s,a){return e=t.v.Ni(t.Hi,t.ui,t.ga,t._c(),i,e.z(),s),s=t.Nc(),void 0!==a&&void 0!==a.error?e.Na(n,a.error):(t.Cc(s,e),e.Na(n)),s},this.mt=function(e){return e=t.Sc[e]},this.vt=function(t){return(t=this.mt(t))&&(t.Aa()||t.Ca()||(t=null)),t},this.Cc=function(e,i){t.Sc[e]=i},this.Ic=function(e){delete t.Sc[e]},this.Mt=function(e){var i=t.mt(e);t.Ic(e),i.cleanup()},this.K=function(){return t.Sc}},j=t.yc=function(t){this.Bi=t,this.mc=function(t,e,i){var n=!1;return this.Bi.createOnce(function(){n||t((n=!0,!1),i+" ("+e+" ms)")},e,"CallbackWithTimeout.wrap"),function(e,i){n||(n=!0,t(e,i))}}},X=t.Config=function(t,e,i){var n=this;this.Dc=e,this.bc=i,this.Pc={clientId:K.P,iid:K.Ys,sendLogs:!1,maxHbInfos:K.Xs},this.T=te.jf(this.Pc),this.Mc=!1,this.Lc=!1,this.Uc=[],this.lc=function(){return this.Mc},this.it=function(){this.Dc.it(X.Vc,function(t,e){t&&n.kc(e),n.Mc=!0,n.Fc()})},this.kc=function(t){var e=this.bc.ru(t);e?e&&(t=e[X.Hc],e=e[X.et],t&&t!==K.P&&""!==t&&"null"!==t&&(this.T[X.D]=t),e!==K.Ys&&""!==e&&"null"!==e&&(this.T[X.et]=e)):this.Lc=!0},this.Bc=function(){var t={};return t[X.Hc]=this.T.clientId,this.bc.ou(t)},this.Xf=function(){this.Dc.Xf(X.Vc,this.Bc(),function(){})},this.dc=function(t){this.lc()?t():this.Uc.push(t)},this.get=function(t){return this.Mc?this.T[t]:null},this.set=function(t,e){this.Mc&&(this.T[t]=e)},this.Fc=function(){for(var t;void 0!==(t=this.Uc.shift());)t()}};X.Vc="sdkConfig",X.Hc="clId",X.et="iid",X.D="clientId",X.Vf="sendLogs",X.Pf="maxHbInfos",X.Hf="c3.fp.",X.Bt={Bf:"0",Gc:"1",Gt:"2",Ht:"3",Gf:"4",Kt:"5",jt:"6"};var Q,J,Z=t.EventQueue=function(){this.jc=[],this.Kc=0,this.gf=function(t){this.jc.push(t)},this.wf=function(){var t=this.Kc;return this.Kc++,t},this.Sa=function(){var t=this.jc;return this.jc=[],t}},z=t.ExceptionCatcher=function(t,e,i){this.Wc=e,this.R=i,this.m=function(t,e,i){try{e()}catch(n){if(i)i(n);else{if(this.R.allowUncaughtExceptions)throw n;this.xc(t,n)}}},this.xc=function(t,e){var i="Uncaught exception: "+t+": "+e.toString();if(this.Wc)try{this.Wc.Yf(i)}catch(n){}}},tt=t.GatewayControl=function(t,e,i,n,s){var a=this;this.ui=t,this.qc=i,this.bc=n,this.Yc=s,this.Yf=function(t,e){var i=(this.Yc?this.Yc.indexOf("ipv4")>-1?this.ui.M:this.ui.F:this.ui.gatewayUrl)+K.qs;this.qc.Jc("POST",i,this.bc.ou(t),"application/json",function(t,i){var n;t?e(t,n=a.bc.ru(i)):e(t,i)})}},te=t.Lang={};te.Xc=function(t){return te.wt(t)&&t&&"undefined"!==t&&"null"!==t},te.yt=function(t){var e,i,n={};for(e in t)te.Xc(e)&&(i=t[e],te.Xc(i)&&(n[e]=i));return n},te.In=function(t,e,i){if(!t)throw Error("Expected "+i+" implementation is null.");for(var n in e)if("function"!=typeof t[n])throw Error("Expected method "+n+" in "+i+" implementation.")},te.It=function(t){var e,i=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&i++;return i},te.pt=function(t){return""+t},te.Qc=function(t){return Math.floor(t)},te.Xt=function(t){return Math.abs(te.Qc(t))},te.Zc=function(t){return Boolean(t)},te.wt=function(t){return"string"==typeof t&&""!==t},te.Zf=function(t,e){return"string"==typeof t&&"string"==typeof e&&"function"==typeof t.indexOf&&0===t.indexOf(e)},te.Ii=function(t){return"boolean"==typeof t},te.zc=function(t){return escape(t)},te.uu=function(t){return"object"==typeof t},te.nf=function(t){var e,i="";for(e in t)i+=e+"="+t[e];return"Object{"+i+"}"},te.$c=function(t){var e,i=te.jf(t);for(e in i)i[e]||delete i[e];return i},te.jf=function(t){var e,i={};for(e in t)i[e]=t[e];return i},te.tf=function(t,e){if(typeof t!=typeof e)return!1;if(t instanceof Object&&e instanceof Object){if(te.It(t)!==te.It(e))return!1;for(var i in t)if(t[i]!==e[i])return!1;return!0}return t===e},te.as=function(){for(var t={},e=0;e<arguments.length;e++)for(var i in arguments[e])arguments[e][i]&&(t[i]=arguments[e][i]);return t},te.lt=function(t){return"number"==typeof t&&Math.round(t)===t},te.tl=function(t){return"[object Array]"===Object.prototype.toString.call(t)},te.nl=function(t,e){if(t===e)return!0;if(!t||!e||t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(te.tl(t[i])&&te.tl(e[i])){if(!te.nl(t[i],e[i]))return!1}else if(t[i]!==e[i])return!1;return!0},te.il=function(){return void 0!==Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(t){return!1}}()},te.xt=function(t,e,i){if(te.il())Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:i});else{if(void 0===t.__defineGetter__)throw Error("JavaScript runtime must support either Object.defineProperty or __defineGetter__");t.__defineGetter__(e,i)}},te.qt=function(t,e,i){if(te.il())Object.defineProperty(t,e,{configurable:!0,set:i});else{if(void 0===t.__defineSetter__)throw Error("JavaScript runtime must support either Object.defineProperty or __defineSetter__");t.__defineSetter__(e,i)}},(Q={two32:4294967296}).el=Q.two32-1,Q.sl=0,te.ol=Q,te.ol.Cast=function(t){return(t=parseInt(t,10))>Q.el?t%=Q.two32:t<Q.sl&&(t=-t%Q.two32,t=Q.two32-t),t},te.ol.rl=function(t){return(t=parseInt(t,10))<=Q.el&&t>=Q.sl},J={el:2147483647,sl:-2147483648},te.qf=J,te.qf.Cast=function(t){return(t=parseInt(t,10))>J.el?t%=J.el:t<J.sl&&(t=-t%J.el,t=J.el-t),t},te.qf.rl=function(t){return(t=parseInt(t,10))<=J.el&&t>=J.sl},te.ys=function(){return window&&window.location&&window.location.search?window.location.search:""},te.ul=function(){return document&&document.referrer?document.referrer:""};var ti=t.LogBuffer=function(){this.hl=[],this.ks=function(t){this.hl.length>=32&&this.hl.shift(),this.hl.push(t)},this.Sa=function(){var t=this.hl;return this.hl=[],t}},tn=t.Ping=function(t,e,i,s){this.al=!1,this.fl=null,this.c=t,this.c.setModuleName("Ping"),this.qc=e,this.ui=i,this.hi=s,this.Yf=function(t){this.al||(this.al=!0,t=this.cl()+"&d="+te.zc(t.toString()),this.c.error("send(): "+t),this.qc.Jc("GET",t,null,null,null),this.al=!1)},this.cl=function(){if(!this.fl){var t=tn.ll+"?comp="+tn.vl+"&clv="+(this.hi||n.version);if(this.ui&&(t+="&cid="+this.ui.customerKey),t+="&sch="+K.$s,!this.ui)return t;this.fl=t}return this.fl}};tn.vl="sdkjs",tn.ll="https://pings.conviva.com/ping.ping";var ts=t.dl={};ts.El=4294967295,ts.pl=2147483647,ts.Rl=-2147483648,ts.Ac=function(){return Math.floor(Math.random()*ts.El)+ts.Rl},ts.ot=function(){return Math.floor(Math.random()*ts.El)};var ta=t.wl={};ta.Tf=function(t,e,i,n){return isNaN(t)||"number"!=typeof t||t===n?n:(t=te.Qc(t),ta.Tl(t,e,i))},ta.Tl=function(t,e,i){return te.lt(i)&&t>i?t=i:te.lt(e)&&t<e&&(t=e),t},ta.an=function(t){return -1===t||-2===t?t:t=ta.Tf(t,0,null,-1)};var tr=t.StreamerError=function(){var t=this;t.errorCode=null,t.severity=n.ErrorSeverity.FATAL,(function(e,i){t.errorCode=e,t.severity=i}).apply(t,arguments),this.ms=function(){return t.errorCode},this.Ds=function(){return t.severity}},to=t.HttpClient=function(t,e,i,n){this.ni=e,this.gl=i,this.R=n,this.Jc=function(t,e,i,n,s){var a=1e3*this.R.httpTimeout,r=null;s&&(r=this.gl.mc(s,a,"HTTP timeout")),this.ni.makeRequest(t,e,i,n,a,r)}},tc=t.Logger=function(t,e,i,n,s){this.si=t,this.$n=e,this.p=i,this.ai=n,this.ri=s,this.debug=function(t){this.log(t,v.LogLevel.DEBUG)},this.info=function(t){this.log(t,v.LogLevel.INFO)},this.warning=function(t){this.log(t,v.LogLevel.WARNING)},this.error=function(t){this.log(t,v.LogLevel.ERROR)},this.log=function(t,e){t=this.Sl(t,e),this.ai.ks(t),this.p.logLevel<=e&&this.si.consoleLog(t,e)},this.Nl=function(t){return"["+this.wn+"] "+t},this.Ol=function(t){return"["+this.ri+"] "+t},this._l=function(t){return"[Conviva] "+t},this.Al=function(t){return"["+(this.$n.getEpochTimeMs()/1e3).toFixed(3).toString()+"] "+t},this.Cl=function(t,e){return"["+tc.Il(e)+"] "+t},this.yl=function(t){return this.ml&&(t="sid="+this.ml+" "+t),t},this.Su=function(t){this.ml=t},this.setModuleName=function(t){this.wn=t},this.Sl=function(t,e){return this._l(this.Al(this.Cl(this.Ol(this.Nl(this.yl(t))),e)))}};tc.Il=function(t){var e;switch(t){case v.LogLevel.ERROR:e="ERROR";break;case v.LogLevel.WARNING:e="WARNING";break;case v.LogLevel.INFO:e="INFO";break;case v.LogLevel.DEBUG:e="DEBUG"}return e},t.Storage=function(e,i,n,s){this.ii=i,this.gl=n,this.R=s,this.it=function(e,i){i=this.gl.mc(i,1e3*this.R.storageTimeout,"storage load timeout"),this.ii.loadData(t.Storage.Dl,e,i)},this.Xf=function(e,i,n){n=this.gl.mc(n,1e3*this.R.storageTimeout,"storage save timeout"),this.ii.saveData(t.Storage.Dl,e,i,n)}},t.Storage.Dl="Conviva";var th=t.SystemMetadata=function(t,e,i){this.ei=e,this.w=i,this.bl=null,this.get=function(){return this.bl||this.retrieve(),this.bl},this.retrieve=function(){var t={};t[th.BROWSER_NAME]=this.ei.getBrowserName,t[th.BROWSER_VERSION]=this.ei.getBrowserVersion,t[th.DEVICE_BRAND]=this.ei.getDeviceBrand,t[th.DEVICE_MANUFACTURER]=this.ei.getDeviceManufacturer,t[th.DEVICE_MODEL]=this.ei.getDeviceModel,t[th.DEVICE_TYPE]=this.ei.getDeviceType,t[th.DEVICE_VERSION]=this.ei.getDeviceVersion,t[th.FRAMEWORK_NAME]=this.ei.getFrameworkName,t[th.FRAMEWORK_VERSION]=this.ei.getFrameworkVersion,t[th.OPERATING_SYSTEM_NAME]=this.ei.getOperatingSystemName,t[th.OPERATING_SYSTEM_VERSION]=this.ei.getOperatingSystemVersion,t[th.DEVICE_CATEGORY]=this.ei.getDeviceCategory,t[th.SCREEN_WIDTH]=this.ei.getScreenWidth,t[th.SCREEN_HEIGHT]=this.ei.getScreenHeight,t[th.SCALE_FACTOR]=this.ei.getScaleFactor;var e,i=this;for(e in t)(function(t,e){i.w.m("Session.getSystemMetadataSchema(): "+t,function(){var n=e[t];e[t]=n.call(i.ei)})})(e,t),te.wt(t[e])||delete t[e];var s=!1;if(void 0!==t[th.DEVICE_TYPE]){for(var a in n.DeviceType)if(t[th.DEVICE_TYPE]===n.DeviceType[a]){s=!0;break}s||delete t[th.DEVICE_TYPE]}if(s=!1,void 0!==t[th.DEVICE_CATEGORY]){for(var r in n.DeviceCategory)if(t[th.DEVICE_CATEGORY]===n.DeviceCategory[r]){s=!0;break}s||delete t[th.DEVICE_CATEGORY]}this.bl=te.$c(t)}};th.BROWSER_NAME="browserName",th.BROWSER_VERSION="browserVersion",th.DEVICE_BRAND="deviceBrand",th.DEVICE_MANUFACTURER="deviceManufacturer",th.DEVICE_MODEL="deviceModel",th.DEVICE_TYPE="deviceType",th.DEVICE_VERSION="deviceVersion",th.FRAMEWORK_NAME="frameworkName",th.FRAMEWORK_VERSION="frameworkVersion",th.OPERATING_SYSTEM_NAME="operatingSystemName",th.OPERATING_SYSTEM_VERSION="operatingSystemVersion",th.DEVICE_CATEGORY="deviceCategory",th.SCREEN_WIDTH="screenWidth",th.SCREEN_HEIGHT="screenHeight",th.SCALE_FACTOR="scaleFactor";var tu=t.Time=function(t,e){this.$n=t,this.c=e,this.current=function(){var t=this.$n.getEpochTimeMs();return te.lt(t),t}},tl=t.Timer=function(t,e,i){var n=this;this.ti=e,this.w=i,this.create=function(t,e,i){return this.createTimer(function(){n.w.m(i,function(){t()})},e,i)},this.createOnce=function(t,e,i){var s={cancel:null};return s.cancel=this.createTimer(function(){n.w.m(i,function(){s&&"function"==typeof s.cancel&&(s.cancel(),s.cancel=null,s=null),t()})},e,i),s.cancel},this.createTimer=function(t,e,i){return this.ti.createTimer(t,e,i)}}}(),e});"use strict";const CONVIVA_CALLBACK_FUNCTIONS={[Conviva.Constants.CallbackFunctions.CONSOLE_LOG](t,e){"undefined"!=typeof console&&(console.log&&e===Conviva.SystemSettings.LogLevel.DEBUG||e===Conviva.SystemSettings.LogLevel.INFO?console.log(t):console.warn&&e===Conviva.SystemSettings.LogLevel.WARNING?console.warn(t):console.error&&e===Conviva.SystemSettings.LogLevel.ERROR&&console.error(t))},[Conviva.Constants.CallbackFunctions.MAKE_REQUEST](t,e,i,n,s,a){let r=new XMLHttpRequest;r.open(t,e,!0),n&&r.overrideMimeType&&(r.overrideMimeType=n),n&&r.setRequestHeader&&r.setRequestHeader("Content-Type",n),s>0&&(r.timeout=s,r.ontimeout=()=>{r.ontimeout=r.onreadystatechange=null,a&&a(!1,"timeout after "+s+" ms")}),r.onreadystatechange=()=>{4===r.readyState&&(r.ontimeout=r.onreadystatechange=null,200===r.status?a&&a(!0,r.responseText):a&&a(!1,"http status "+r.status))},r.send(i)},[Conviva.Constants.CallbackFunctions.SAVE_DATA](t,e,i,n){try{localStorage.setItem(t+"."+e,i),n(!0,void 0)}catch(s){n(!1,s.toString())}},[Conviva.Constants.CallbackFunctions.LOAD_DATA](t,e,i){try{let n=localStorage.getItem(t+"."+e);i(!0,n)}catch(s){i(!1,s.toString())}},[Conviva.Constants.CallbackFunctions.GET_EPOCH_TIME_IN_MS]:()=>new Date().getTime(),[Conviva.Constants.CallbackFunctions.CREATE_TIMER](t,e){let i=setInterval(t,e);return()=>{-1!==i&&(clearInterval(i),i=-1)}}};function collectDeviceMetadata(){return{[Conviva.Constants.DeviceMetadata.TYPE]:Conviva.Constants.DeviceType.DESKTOP,[Conviva.Constants.DeviceMetadata.CATEGORY]:Conviva.Constants.DeviceCategory.WEB}}function collectPlayerInfo(){return{[Conviva.Constants.FRAMEWORK_NAME]:"BrightCoveHTML5Player",[Conviva.Constants.FRAMEWORK_VERSION]:"NaForHTML5"}}function collectContentMetdata(t,e){return Object.assign({[Conviva.Constants.ASSET_NAME]:"["+e.assetID+"] "+e.title,[Conviva.Constants.STREAM_URL]:e.url,[Conviva.Constants.IS_LIVE]:!0==e.live?Conviva.Constants.StreamType.LIVE:Conviva.Constants.StreamType.VOD,[Conviva.Constants.PLAYER_NAME]:e.playerName,[Conviva.Constants.VIEWER_ID]:e.adobeViewerID,[Conviva.Constants.DURATION]:e.durationSec,[Conviva.Constants.DEFAULT_RESOURCE]:"Akamai"},e)}function collectAdMetadata(t){return{[Conviva.Constants.ASSET_NAME]:t.title||t.id,[Conviva.Constants.STREAM_URL]:t.mediaUrl||t.resourceURI,[Conviva.Constants.PLAYER_NAME]:"THEOplayer",[Conviva.Constants.DURATION]:t.duration,[Conviva.Constants.IS_LIVE]:Conviva.Constants.StreamType.VOD}}function calculateBufferLength(t){let e=t.buffered;if(void 0===e)return;let i=0;for(let n=0;n<e.length;n+=1){let s=e.start(n),a=e.end(n);s<=t.currentTime&&t.currentTime<a&&(i+=a-t.currentTime)}return 1e3*i}function findCurrentLinearAd(t){for(let e of t)if("linear"===e.type)return e}var prod="true"==window.localStorage.getItem("sdsat_debug");function log(t,e){e||console.log(t)}class NewConvivaIntegration{constructor(t,e,i){this._convivaVideoAnalytics=void 0,this._convivaAdAnalytics=void 0,this._isFirstContentPlay=!0,this._isAdBreakEnabled=!0,this._contentPlaybackEnded=!1,this._allAdsCompleted=!0,this._isPlayingAd=!1,this._isPlayingPostRoll=!1,this._currentAdBreak=void 0,this._adBreakStartSent=!1,this._adStartSent=!1,this._onPlayerLoadedMetadata=()=>{if(log("++<<_onPlayerLoadedMetadata ++<< ",prod),this._player&&!this._isPlayingAd&&this._convivaVideoAnalytics){let t=this._player.duration();if(!isNaN(t)&&t!==1/0){let e={[Conviva.Constants.DURATION]:t};this._convivaVideoAnalytics.setContentInfo(e)}this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.RESOLUTION,this._player.videoWidth(),this._player.videoHeight())}},this._onPlayerPlay=()=>{log("++<<_onPlayerPlay ++<< ",prod),this._player&&(this._isFirstContentPlay&&(this._convivaVideoAnalytics||(this._initConvivaClient(e),log("++<<_onPlayerPlay  ************************* new conviva Object++<< "+this._player.mediainfo.name,prod)),this._convivaVideoAnalytics.reportPlaybackRequested(collectContentMetdata(this._player,i))),this._isFirstContentPlay=!1)},this._onPlayerPlaying=()=>{log("++<<_onPlayerPlaying ++<< "+this._player.mediainfo.name,prod),this._player&&(this._onPlayerPlay(),!this._isPlayingAd&&this._convivaVideoAnalytics&&this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PLAYING))},this._onPlayerPause=()=>{log("++<<_onPlayerPause ++<<"+this._player.mediainfo.name,prod),this._player&&!this._isPlayingAd&&this._convivaVideoAnalytics&&this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PAUSED)},this._onPlayerEmptied=()=>{log("++<<_onPlayerEmptied ++<<",prod),this._player&&(!this._isPlayingAd&&this._convivaVideoAnalytics&&this._player.currentTime()>0&&this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.BUFFERING),!this._isPlayingAd&&this._convivaVideoAnalytics&&0==this._player.currentTime()&&log("++<<_onPlayerEmptied ++ _onPlayerEnded ********* <<"+this._player.mediainfo.name,prod),this._isFirstContentPlay=!1)},this._onPlayerAbort=()=>{log("++<<_onPlayerAbort ++<<",prod),this._player&&(this._isPlayingAd||void 0===this._convivaVideoAnalytics||(this._convivaVideoAnalytics.reportPlaybackEnded(),this._convivaVideoAnalytics.release(),this._convivaVideoAnalytics=void 0,Conviva.Analytics.release(),this._isFirstContentPlay=!1),this._contentPlaybackEnded=!0,this._isFirstContentPlay=!0)},this._onPlayerWaiting=()=>{log("++<<_onPlayerWaiting ++<<"+this._player.mediainfo.name,prod),this._player&&!this._isPlayingAd&&this._convivaVideoAnalytics&&this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.BUFFERING)},this._onPlayerWaiting=()=>{log("++<<_onPlayerWaiting ++<<",prod),this._player&&!this._isPlayingAd&&this._convivaVideoAnalytics&&this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.SEEK_STARTED)},this._onPlayerSeeking=()=>{log("++<<_onPlayerSeeking ++<<"+this._player.mediainfo.name,prod),this._player&&!this._isPlayingAd&&this._convivaVideoAnalytics&&this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.SEEK_STARTED)},this._onPlayerSeeked=()=>{log("++<<_onPlayerSeeked ++<<"+this._player.mediainfo.name,prod),this._player&&!this._isPlayingAd&&this._convivaVideoAnalytics&&this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.SEEK_ENDED)},this._onPlayerError=()=>{log("++<<_onPlayerError ++<<"+this._player.mediainfo.name+this._player.mediainfo.name,prod),this._player&&(this._convivaVideoAnalytics||(this._convivaVideoAnalytics=Conviva.Analytics.buildVideoAnalytics()),this._convivaVideoAnalytics.reportPlaybackFailed("Fatal error occured"),this._convivaVideoAnalytics.release(),this._convivaVideoAnalytics=void 0,Conviva.Analytics.release(),this._contentPlaybackEnded=!0)},this._onSegmentNotFound=()=>{log("++<<_onSegmentNotFound ++<<",prod),this._player&&(this._convivaVideoAnalytics||(this._convivaVideoAnalytics=Conviva.Analytics.buildVideoAnalytics()),this._convivaVideoAnalytics.reportPlaybackError("A Video Playback Failure has occurred: Segment not found",Conviva.Constants.ErrorSeverity.FATAL))},this._reportManifestOffline=()=>{log("++<<_reportManifestOffline ++<<",prod),this._player&&(this._convivaVideoAnalytics||(this._convivaVideoAnalytics=Conviva.Analytics.buildVideoAnalytics()),this._convivaVideoAnalytics.reportPlaybackError("A Video Playback Failure has occurred: Waiting for the manifest to come back online",Conviva.Constants.ErrorSeverity.FATAL))},this._onPlayerEnded=()=>{log("++<<_onPlayerEnded ++<<"+this._player.mediainfo.name,prod),this._player&&(!this._isPlayingAd&&void 0!==this._convivaVideoAnalytics&&(this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),this._allAdsCompleted&&(this._convivaVideoAnalytics.reportPlaybackEnded(),this._convivaAdAnalytics&&this._convivaAdAnalytics.release(),this._convivaVideoAnalytics&&this._convivaVideoAnalytics.release(),Conviva.Analytics.release(),this._convivaVideoAnalytics=void 0,this._convivaAdAnalytics=void 0,this._currentAdBreak=void 0)),this._contentPlaybackEnded=!1,this._isFirstContentPlay=!0)},this._onAdStopped=()=>{log("++<<_onAdStopped ++<<"+this._player.mediainfo.name,prod),this._player&&this._convivaAdAnalytics&&(this._convivaAdAnalytics.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.STOPPED),this._convivaAdAnalytics.reportAdSkipped(),this._convivaAdAnalytics.release(),this._convivaAdAnalytics=void 0)},this._onAdBuffering=()=>{log("++<<_onAdBuffering ++<<"+this._player.mediainfo.name,prod),this._player&&this._convivaAdAnalytics&&this._convivaAdAnalytics.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.BUFFERING)},this._onAdBreakBegin=()=>{if(log("++<<_onAdBreakBegin ++<<"+this._player.mediainfo.name,prod),this._player&&(this._onPlayerPlay(),this._isPlayingAd=!0,this._allAdsCompleted=!1,this._convivaVideoAnalytics&&this._player.ads)){if(this._isAdBreakEnabled){let t=this._currentAdBreak=this._player.ads.ad||void 0;if(!t)return;let e=t.timeOffset,i;0===e?i="Pre-roll":e<0?(i="Post-roll",this._isPlayingPostRoll=!0):i="Mid-roll";let n=this._player.ads.pod.id,s={[Conviva.Constants.POD_POSITION]:i,[Conviva.Constants.POD_DURATION]:t.duration,[Conviva.Constants.POD_INDEX]:n};this._convivaVideoAnalytics.reportAdBreakStarted(Conviva.Constants.AdType.CLIENT_SIDE,Conviva.Constants.AdPlayer.CONTENT,s),this._adBreakStartSent=!0}else this._convivaVideoAnalytics.reportPlayerInFocus(!1)}},this._onAdBreakEnd=()=>{if(!this._player||!this._player.ads){log("++<<_onAdBreakEnd ++<<"+this._player.mediainfo.name,prod);return}this._convivaVideoAnalytics&&(this._isAdBreakEnabled?this._adBreakStartSent&&this._convivaVideoAnalytics.reportAdBreakEnded():this._isPlayingPostRoll||this._convivaVideoAnalytics.reportPlayerInFocus(!0),this._isPlayingPostRoll&&(this._convivaVideoAnalytics.reportPlaybackEnded(),this._convivaVideoAnalytics.release(),this._convivaVideoAnalytics=void 0,Conviva.Analytics.release(),this._contentPlaybackEnded=!0,this._allAdsCompleted=!0),this._allAdsCompleted=!0),this._adBreakStartSent=!1,this._isPlayingAd=!1,this._currentAdBreak=void 0},this._onAdBegin=()=>{log("++<<_onAdBegin ++<<"+this._player.mediainfo.name,prod),this._player&&(this._adStartSent=!1,this._player.addEventListener("playing",this._onAdsPlayerPlaying),this._player.addEventListener("pause",this._onAdsPlayerPause))},this._onAdsPlayerPlaying=()=>{if(log("++<<_onAdsPlayerPlaying ++<<"+this._player.mediainfo.name,prod),!this._player||!this._player.ads)return;let t=findCurrentLinearAd(this._player.ads.currentAds);if(t){if(this._adStartSent)this._convivaAdAnalytics&&this._convivaAdAnalytics.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PLAYING);else if(this._convivaAdAnalytics||(this._convivaAdAnalytics=Conviva.Analytics.buildAdAnalytics(this._convivaVideoAnalytics)),this._convivaAdAnalytics){let e=collectAdMetadata(t);this._convivaAdAnalytics.setAdInfo(e),this._convivaAdAnalytics.reportAdLoaded(),this._convivaAdAnalytics.reportAdStarted(),this._adStartSent=!0,this._convivaAdAnalytics.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PLAYING),this._convivaAdAnalytics.reportAdMetric(Conviva.Constants.Playback.RESOLUTION,this._player.videoWidth,this._player.videoHeight),this._convivaAdAnalytics.reportAdMetric(Conviva.Constants.Playback.BITRATE,t.bitrate||0)}}},this._onAdsPlayerPause=()=>{if(log("++<<_onAdsPlayerPause ++<<"+this._player.mediainfo.name,prod),!this._player||!this._player.ads)return;let t=findCurrentLinearAd(this._player.ads.currentAds);t&&this._convivaAdAnalytics&&this._convivaAdAnalytics.reportAdMetric(Conviva.Constants.Playback.PLAYER_STATE,Conviva.Constants.PlayerState.PAUSED)},this._onAdEnd=()=>{if(log("++<<_onAdEnd ++<<"+this._player.mediainfo.name,prod),!this._player||!this._player.ads)return;let t=findCurrentLinearAd(this._player.ads.currentAds);!t&&(this._convivaAdAnalytics&&this._convivaAdAnalytics.reportAdEnded(),this.contentPlaybackEnded&&this._convivaVideoAnalytics&&(this._convivaVideoAnalytics.reportPlaybackEnded(),this._convivaVideoAnalytics.release(),this._convivaVideoAnalytics=void 0,Conviva.Analytics.release()),this._player.removeEventListener("playing",this._onAdsPlayerPlaying),this._player.removeEventListener("pause",this._onAdsPlayerPause))},this._onAdsError=t=>{log("++<<_onAdsError ++<<"+this._player.mediainfo.name,prod),this._player&&(this._player.removeEventListener("playing",this._onAdsPlayerPlaying),this._player.removeEventListener("pause",this._onAdsPlayerPause),this._convivaAdAnalytics||(this._convivaAdAnalytics=Conviva.Analytics.buildAdAnalytics(this._convivaVideoAnalytics)),this._convivaAdAnalytics&&(this._convivaAdAnalytics.reportAdFailed(t.message||"Ad Request Failed"),this._convivaAdAnalytics.release(),this._convivaAdAnalytics=void 0))},this._player=t,this._initConvivaClient(e,i),this._registerVideoListeners(),this._registerAdsLoaderListeners()}_initConvivaClient(t){log("++<<_initConvivaClient ++<<"+this._player.mediainfo.name,prod),Conviva.Analytics.init(t[Conviva.Constants.CUSTOMER_KEY],CONVIVA_CALLBACK_FUNCTIONS,t),Conviva.Analytics.setDeviceMetadata(collectDeviceMetadata()),this._convivaVideoAnalytics||(this._convivaVideoAnalytics=Conviva.Analytics.buildVideoAnalytics(),this._convivaVideoAnalytics.setPlayerInfo(collectPlayerInfo()),this._convivaVideoAnalytics.setCallback(()=>{if(this._convivaVideoAnalytics&&this._player&&(this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.PLAY_HEAD_TIME,1e3*this._player.currentTime()),this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.BUFFER_LENGTH,calculateBufferLength(this._player)),this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.RESOLUTION,this._player.videoWidth(),this._player.videoHeight()),this._player.tech(!0).vhs.playlists.media().attributes.BANDWIDTH)){let t=this._player.tech(!0).vhs.playlists.media().attributes.BANDWIDTH/1e3,e=this._player.tech(!0).vhs.playlists.media().attributes["FRAME-RATE"];this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.BITRATE,t),this._convivaVideoAnalytics.reportPlaybackMetric(Conviva.Constants.Playback.RENDERED_FRAMERATE,e)}}),this._contentPlaybackEnded=!1)}_registerVideoListeners(){this._player.on("play",this._onPlayerPlay),this._player.on("pause",this._onPlayerPause),this._player.on("playing",this._onPlayerPlaying),this._player.on("emptied",this._onPlayerEmptied),this._player.on("waiting",this._onPlayerWaiting),this._player.on("error",this._onPlayerError),this._player.on("loadedmetadata",this._onPlayerLoadedMetadata),this._player.on("seeking",this._onPlayerSeeking),this._player.on("seeked",this._onPlayerSeeked),this._player.on("ended",this._onPlayerEnded),this._player.on("loadstart",this._onPlayerWaiting),this._player.on("abort",this._onPlayerAbort)}_registerAdsLoaderListeners(){this._player.ads&&(this._convivaAdAnalytics=Conviva.Analytics.buildAdAnalytics(this._convivaVideoAnalytics),this._player.on("ads-ad-started",this._onAdBreakBegin),this._player.on("ads-ad-ended",this._onAdBreakEnd))}destroy(){log("++<<********************************************destroy*****************************************++<<",prod),this._player.off("play",this._onPlayerPlay),this._player.off("pause",this._onPlayerPause),this._player.off("playing",this._onPlayerPlaying),this._player.off("emptied",this._onPlayerEmptied),this._player.off("waiting",this._onPlayerWaiting),this._player.off("error",this._onPlayerError),this._player.off("loadedmetadata",this._onPlayerLoadedMetadata),this._player.off("seeking",this._onPlayerSeeking),this._player.off("seeked",this._onPlayerSeeked),this._player.off("ended",this._onPlayerEnded),this._player.off("loadstart",this._onPlayerWaiting),this._player.off("abort",this._onPlayerAbort),this._player.ads&&(this._player.off("ads-ad-started",this._onAdBreakBegin),this._player.off("ads-ad-ended",this._onAdBreakEnd)),this._convivaAdAnalytics&&this._convivaAdAnalytics.release(),this._convivaVideoAnalytics&&this._convivaVideoAnalytics.release(),Conviva.Analytics.release(),this._player=void 0,this._convivaVideoAnalytics=void 0,this._convivaAdAnalytics=void 0,this._currentAdBreak=void 0}}
            //plugin
            videojs.registerPlugin('AdobeConviva', function(options) {
                function log(m, p) {
                    if (!p) {
                        console.log(m)
                    }
                }
                var prod = false;
                var adobe = true;
                if (!options) {
                    console.log("Options has not been added, please add the options on video cloud")
                } else {
                    prod = (window.localStorage.getItem("sdsat_debug") == 'true') || (options["env"] == "production");
                    adobe = options["adobe"];
                }

                var myPlayer = this;
                var isContentLoaded = false;
                var videoDuration;
                var mediaName;
                var mediaPlayerName = window.location.hostname;
                var currentTime;
                var isPlaying = false;
                var videoEnd = false;
                var bitRate = 0;

                var metadata = {};
                var firstPlay = false;
                var tmAdReq = false;
                var tmAdPlay = false;
                var tmAdBeacon = false;

                var integration;
                //Setting Up Conviva Configs default as test
                
                var TEST_CUSTOMER_KEY = options.testing.customerKey; //'69b93c2f8bf26c0edf513501a13f4da18556fb68';
                var TOUCHSTONE_SERVICE_URL = options.testing.gatewayUrl; //'https://telstra-afl.testonly.conviva.com';

                var convivaConfigs = {};
                convivaConfigs[Conviva.Constants.GATEWAY_URL] = TOUCHSTONE_SERVICE_URL;
                convivaConfigs[Conviva.Constants.LOG_LEVEL] = Conviva.Constants.LogLevel.ERROR;
                convivaConfigs[Conviva.Constants.CUSTOMER_KEY] = TEST_CUSTOMER_KEY;
                
                switch (prod)
                {
                    case true:
                        
                        convivaConfigs[Conviva.Constants.GATEWAY_URL] = options.production.gatewayUrl;
                        convivaConfigs[Conviva.Constants.LOG_LEVEL] = Conviva.Constants.LogLevel.ERROR;
                        convivaConfigs[Conviva.Constants.CUSTOMER_KEY] = options.production.customerKey;
                    break;    
                    case false:
                        convivaConfigs[Conviva.Constants.GATEWAY_URL] = options.testing.gatewayUrl;
                        convivaConfigs[Conviva.Constants.LOG_LEVEL] = Conviva.Constants.LogLevel.DEBUG;
                        convivaConfigs[Conviva.Constants.CUSTOMER_KEY] = options.testing.customerKey;
           
                    break;    
                }
                


                var viewerID = "random:" + Math.random() * 1e9;

                if (adobe) {
                    viewerID = s.visitor.getMarketingCloudVisitorID();
                }

                function ABDMediaOPEN() {
                    log("++ IN ABDMediaOPEN TOP ++", prod);

                    //Check the metadata is loaded
                    if (isContentLoaded) {
                        log("++ IN ABDMediaOPEN content loaded ++", prod);
                        //Get all required metadata
                        currentTime = myPlayer.currentTime();
                        mediaName = myPlayer.mediainfo.name;
                        videoDuration = myPlayer.mediainfo.duration;

                        metadata = {};

                        metadata["id"] = myPlayer.mediainfo.id;
                        metadata["title"] = mediaName;
                        metadata["url"] = myPlayer.mediainfo.sources[0].src;
                        metadata["live"] = myPlayer.mediainfo.duration == 0 ? true : false;
                        metadata["durationSec"] = ""+videoDuration;
                        metadata["streamType"] = myPlayer.mediainfo.sources[0].type;
                        metadata["applicationName"] = window.location.hostname;

                        //when live streaming append the matchname from the datalayer // may need to be fixed up
                        if (getSafe(()=>dataLayer.filter(function(obj) {
                            return obj.event === 'matchView'
                        })[0].matchName, false)) {
                            metadata["title"] = mediaName + " - " + dataLayer.filter(function(obj) {
                                return obj.event === 'matchView'
                            })[0].matchName;
                        }

                        //when unily grab the page title as well
                        var top_url = top_url = (window.location != window.parent.location) ? document.referrer != "" ? document.referrer : document.location.href : document.location.href;
                        var t_test = new URL(top_url);

                        if (/telstra\.unily\.com/.test(top_url) && t_test.pathname.length > 0) {
                            metadata["title"] = mediaName + " [" + t_test.pathname + "]";
                        }

                        //custom 
                        metadata["assetID"] = myPlayer.mediainfo.id;
                        metadata["channel"] = window.location.hostname;
                        metadata["playerName"] = getPlayerName();

                        metadata["adobeViewerID"] = viewerID;

                        //createConvivaSession
                        userData = {}
                        userData["id"] = viewerID;
                        userData["hostname"] = window.location.hostname;

                        //add all custom fields 
                        Object.assign(metadata, myPlayer.mediainfo.customFields);
                        Object.assign(metadata, userData);

                        log(JSON.stringify(metadata), prod)

                        //Open adobe Analytics Media Module	

                        //adobe && s.Media.open(mediaName, videoDuration, mediaPlayerName);

                        //Check if video is playing
                        //if (isPlaying) {
                        //    log("++IN ABDMediaOPEN video is playing " + mediaName + " | " + videoDuration, prod);
                        //Play Adobe Analytics Media module from beginning.
                        //    adobe && s.Media.play(mediaName, currentTime);
                        // }
                    }
                }

                //Used to reset the variables as when the next videos play, the play event is called before loadstart ...
                function resetVariables() {
                    isContentLoaded = false;
                    videoDuration = currentTime = "";
                    videoEnd = true;
                    bitRate = 0;
                    tmAdBeacon=false;
                }

                myPlayer.on('loadstart', function() {
                    log("++loadstart - " + myPlayer.mediainfo.name, prod);
                    firstPlay = true;
                    //Check that metadata is loaded
                    if (myPlayer.mediainfo.name) {
                        isContentLoaded = true;
                        //Initiate Adobe Analytics Media Module tracking && Conviva Analytics
                    }
                });

                myPlayer.on('ads-request', function() {
                    log("++ads-ad-request - " + myPlayer.mediainfo.name, prod);
                    tmAdReq = true;
                });

                myPlayer.on('ads-ad-ended', function() {
                    log("++ads-ad-ended - " + myPlayer.mediainfo.name, prod);
                    tmAdPlay = true;
                });

                myPlayer.on('play', function() {
                    log("++play - " + myPlayer.mediainfo.name, prod);
                    isPlaying = true;
                    if (firstPlay) {
                        log("++ First Play via played - " + myPlayer.mediainfo.name, prod);
                        firstPlay = false;
                        isContentLoaded = true;
                        ABDMediaOPEN();
                        //integration = new NewConvivaIntegration(myPlayer, convivaConfigs, metadata);
                        //convivaHelper.createConvivaSession(userData, metadata);
                        //convivaHelper.attachPlayerToSession();

                    }

                    if (videoEnd) {
                        //user has restarted video from end 
                        videoEnd = false;
                        isContentLoaded = false;
                        ABDMediaOPEN();
                        //convivaHelper.createConvivaSession(userData, metadata);
                        //convivaHelper.attachPlayerToSession();

                    }

                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        if (adobe) {
                            s.eVar63 = mediaName
                            //s.Media.play(mediaName, currentTime);

                        }

                    }
                });

                myPlayer.on("playing", function() {
                    log("++ In Playing ++", prod)

                    //convivaHelper.setPlayerWidthAndHeight(myPlayer.videoWidth(), myPlayer.videoHeight());
                    //convivaHelper.updatePlayerState("playing");
                                
                });

                myPlayer.on('pause', function() {
                    isPlaying = false;
                    log("++paused - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        adobe && s.Media.stop(mediaName, currentTime);
                        //convivaHelper.updatePlayerState("pause");
                    }
                });

                myPlayer.on('progress', function() {
                    //log("progressed - " + myPlayer.mediainfo.name, prod);

                });

                myPlayer.on('resize', function() {
                    log("resized - " + myPlayer.mediainfo.name, prod);
                });

                myPlayer.on('seeked', function() {
                    log("++seeked - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        adobe && s.Media.play(mediaName, currentTime);
                        //convivaHelper.contentSeeked();
                    }
                });

                myPlayer.on('seeking', function() {
                    log("++seeking - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        adobe && s.Media.stop(mediaName, currentTime);
                    }
                });

                myPlayer.on('stalled', function() {
                    log("++stalled - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.

                });

                myPlayer.on('timeupdate', function() {
                    if(myPlayer.currentTime() % 5 <= 0.25)log("++timeupdate - " + myPlayer.currentTime(), prod);

                    if (adobe && isPlaying && !tmAdBeacon && myPlayer.currentTime() > 0) {

                        //s.Media.trackVars+= ",contextData.tmAdReq,contextData.tmAdPlay"
                        tmAdReq ? s.contextData['tmAdReq'] = "yes" : s.contextData['tmAdReq'] = "no";
                        tmAdPlay ? s.contextData['tmAdPlay'] = "yes" : s.contextData['tmAdPlay'] = "no";

                        //s.tl();
                        tmAdBeacon = true;
                        log("++ In timeupdate and adreq adplay update ++ " + mediaName + " | " + videoDuration, prod);
                        //Play Adobe Analytics Media module from beginning.
                        s.Media.play(mediaName, currentTime);
                    }

                });

                myPlayer.on('volumechange', function() {
                    log("++volumechange - " + myPlayer.mediainfo.name, prod);
                });

                myPlayer.on('waiting', function() {
                    log("++waiting - " + myPlayer.mediainfo.name, prod);
                    if (isContentLoaded) {//convivaHelper.updatePlayerState("waiting");
                    }
                });

                myPlayer.on('durationchange', function() {
                    log("++durationchange - " + myPlayer.mediainfo.name, prod);
                });

                myPlayer.on('ended', function() {
                    log("++ended - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                    if (isContentLoaded) {
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        adobe && s.Media.stop(mediaName, currentTime);
                        adobe && s.Media.close(mediaName);
                        //convivaHelper.updatePlayerState("ended");
                        //convivaHelper.cleanupConvivaSession();
                        resetVariables();
                    }
                });
                            
                myPlayer.on('abort', function() {
                    log("++abort - " + myPlayer.mediainfo.name, prod);
                    //Check if metadata loaded - needed to make sure correct video media module instance is tracked.
                        currentTime = myPlayer.currentTime();
                        //Play Adobe Analytics Media module from the current head.
                        adobe && s.Media.stop(mediaName, currentTime);
                        adobe && s.Media.close(mediaName);
                        //convivaHelper.updatePlayerState("ended");
                        //convivaHelper.cleanupConvivaSession();
                        resetVariables();
                });                            

                myPlayer.on("bc-catalog-error", function() {
                    log("++ In Catalog Error ++", prod);
                    var error = myPlayer.error_;
                    var code = error.code;
                    var message = error.message;
                    var type = error.type;
                    //convivaHelper.contentReportError(code + ": " + message + " " + type, Conviva.Client.ErrorSeverity.FATAL);
                    //convivaHelper.cleanupConvivaSession();
                });

                myPlayer.on("error", function() {
                    log("++ In Error ++", prod);
                    var error = myPlayer.error_;
                    var code = error.code;
                    var message = error.message;
                    var type = error.type;
                    //convivaHelper.contentReportError(code + ": " + message + " " + type, Conviva.Client.ErrorSeverity.FATAL);
                    //convivaHelper.cleanupConvivaSession();
                });

                myPlayer.on('fullscreenchange', function() {
                    log("++fullscreenchange - " + myPlayer.mediainfo.name, prod);
                });

                myPlayer.on('loadedalldata', function() {
                    log("++loadedalldata - " + myPlayer.mediainfo.name, prod);

                });

                myPlayer.on('loadeddata', function() {
                    log("++loadeddata *****Video Start**** - " + myPlayer.mediainfo.name, prod);

                    //integration.collectContentMetdata();
                    //    adobe && s.Media.stop(mediaName, currentTime);
                    //    adobe && s.Media.close(mediaName);
                
                                //kill all old sessions                
                if (integration && integration.destroy) {
                      integration.destroy(); integration = null;
                                
                }
                //start new sessions
                                
                adobe && s.Media.open(mediaName, videoDuration, mediaPlayerName);  
                adobe &&s.Media.play(mediaName, currentTime);  
                                
                integration = new NewConvivaIntegration(myPlayer,convivaConfigs,metadata);
                });

                myPlayer.on('loadedmetadata', function() {
                    log("++loadedmetadata - " + myPlayer.mediainfo.name, prod);
                    if (myPlayer.mediainfo.name) {
                        isContentLoaded = true;
                        //Initiate Adobe Analytics Media Module tracking && Conviva Analytics
                        ABDMediaOPEN();
                        //integration = new NewConvivaIntegration(myPlayer,convivaConfigs,metadata);
                    }
                });

                function getSafe(fn, defaultVal) {
                    try {
                        return fn();
                    } catch (e) {
                        return defaultVal;
                    }
                }

                function getPlayerName() {
                    var hostname = window.location.hostname.replace(/^(www\.|m\.)/, '');

                    aflSitesArray = new Object();
                    aflSitesArray['afl.com.au'] = 'AFL Network';
                    aflSitesArray['fantasy.afl.com.au'] = 'AFL Fantasy';
                    aflSitesArray['tipping.afl.com.au'] = 'AFL Tipping';
                    aflSitesArray['afc.com.au'] = 'Adelaide Crows';
                    aflSitesArray['lions.com.au'] = 'Brisbane Lions';
                    aflSitesArray['carltonfc.com.au'] = 'Carlton Blues';
                    aflSitesArray['collingwoodfc.com.au'] = 'Collingwood Magpies';
                    aflSitesArray['essendonfc.com.au'] = 'Essendon Bombers';
                    aflSitesArray['fremantlefc.com.au'] = 'Fremantle';
                    aflSitesArray['geelongcats.com.au'] = 'Geelong Cats';
                    aflSitesArray['goldcoastfc.com.au'] = 'Gold Coast';
                    aflSitesArray['gwsgiants.com.au'] = 'GWS';
                    aflSitesArray['hawthornfc.com.au'] = 'Hawthorn Hawks';
                    aflSitesArray['melbournefc.com.au'] = 'Melbourne Demons';
                    aflSitesArray['nmfc.com.au'] = 'Kangaroos';
                    aflSitesArray['portadelaidefc.com.au'] = 'Port Adelaide';
                    aflSitesArray['richmondfc.com.au'] = 'Richmond Tigers';
                    aflSitesArray['saints.com.au'] = 'St.Kilda Saints';
                    aflSitesArray['sydneyswans.com.au'] = 'Sydney Swans';
                    aflSitesArray['westcoasteagles.com.au'] = 'West Coast Eagles';
                    aflSitesArray['westernbulldogs.com.au'] = 'Western Bulldogs';
                    aflSitesArray['womens.afl'] = 'AFLW Network';

                    return aflSitesArray[hostname] || "AFL test";
                }

            });
